<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>halogen-xterm example</title>
  </head>
  <body>
   <script>var hw=Object.create;var mh=Object.defineProperty;var gw=Object.getOwnPropertyDescriptor;var Dw=Object.getOwnPropertyNames;var Cw=Object.getPrototypeOf,yw=Object.prototype.hasOwnProperty;var Cs=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var bw=(e,t,a,d)=>{if(t&&typeof t=="object"||typeof t=="function")for(let h of Dw(t))!yw.call(e,h)&&h!==a&&mh(e,h,{get:()=>t[h],enumerable:!(d=gw(t,h))||d.enumerable});return e};var ys=(e,t,a)=>(a=e!=null?hw(Cw(e)):{},bw(t||!e||!e.__esModule?mh(a,"default",{value:e,enumerable:!0}):a,e));var rb=Cs((El,Wv)=>{(function(e,t){typeof El=="object"&&typeof Wv=="object"?Wv.exports=t():typeof define=="function"&&define.amd?define([],t):typeof El=="object"?El.FitAddon=t():e.FitAddon=t()})(self,()=>(()=>{"use strict";var e={};return(()=>{var t=e;Object.defineProperty(t,"__esModule",{value:!0}),t.FitAddon=void 0,t.FitAddon=class{activate(a){this._terminal=a}dispose(){}fit(){let a=this.proposeDimensions();if(!a||!this._terminal||isNaN(a.cols)||isNaN(a.rows))return;let d=this._terminal._core;this._terminal.rows===a.rows&&this._terminal.cols===a.cols||(d._renderService.clear(),this._terminal.resize(a.cols,a.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;let a=this._terminal._core,d=a._renderService.dimensions;if(d.css.cell.width===0||d.css.cell.height===0)return;let h=this._terminal.options.scrollback===0?0:a.viewport.scrollBarWidth,n=window.getComputedStyle(this._terminal.element.parentElement),u=parseInt(n.getPropertyValue("height")),f=Math.max(0,parseInt(n.getPropertyValue("width"))),s=window.getComputedStyle(this._terminal.element),i=u-(parseInt(s.getPropertyValue("padding-top"))+parseInt(s.getPropertyValue("padding-bottom"))),p=f-(parseInt(s.getPropertyValue("padding-right"))+parseInt(s.getPropertyValue("padding-left")))-h;return{cols:Math.max(2,Math.floor(p/d.css.cell.width)),rows:Math.max(1,Math.floor(i/d.css.cell.height))}}}})(),e})())});var ab=Cs((Fl,Bv)=>{(function(e,t){typeof Fl=="object"&&typeof Bv=="object"?Bv.exports=t():typeof define=="function"&&define.amd?define([],t):typeof Fl=="object"?Fl.WebglAddon=t():e.WebglAddon=t()})(self,()=>(()=>{"use strict";var e={965:function(h,n,u){var f=this&&this.__decorate||function(S,v,y,M){var T,w=arguments.length,x=w<3?v:M===null?M=Object.getOwnPropertyDescriptor(v,y):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(S,v,y,M);else for(var I=S.length-1;I>=0;I--)(T=S[I])&&(x=(w<3?T(x):w>3?T(v,y,x):T(v,y))||x);return w>3&&x&&Object.defineProperty(v,y,x),x};Object.defineProperty(n,"__esModule",{value:!0}),n.GlyphRenderer=void 0;let s=u(374),i=u(509),p=u(855),m=u(859),g=u(776),l=u(381),r=11,o=r*Float32Array.BYTES_PER_ELEMENT,c,_=0,D=0,C=0;class b extends m.Disposable{constructor(v,y,M){super(),this._terminal=v,this._gl=y,this._dimensions=M,this._activeBuffer=0,this._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)]};let T=this._gl;i.TextureAtlas.maxAtlasPages===void 0&&(i.TextureAtlas.maxAtlasPages=Math.min(32,(0,s.throwIfFalsy)(T.getParameter(T.MAX_TEXTURE_IMAGE_UNITS))),i.TextureAtlas.maxTextureSize=(0,s.throwIfFalsy)(T.getParameter(T.MAX_TEXTURE_SIZE))),this._program=(0,s.throwIfFalsy)((0,l.createProgram)(T,`#version 300 es
layout (location = 0) in vec2 a_unitquad;
layout (location = 1) in vec2 a_cellpos;
layout (location = 2) in vec2 a_offset;
layout (location = 3) in vec2 a_size;
layout (location = 4) in float a_texpage;
layout (location = 5) in vec2 a_texcoord;
layout (location = 6) in vec2 a_texsize;

uniform mat4 u_projection;
uniform vec2 u_resolution;

out vec2 v_texcoord;
flat out int v_texpage;

void main() {
  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_texpage = int(a_texpage);
  v_texcoord = a_texcoord + a_unitquad * a_texsize;
}`,function(W){let E="";for(let L=1;L<W;L++)E+=` else if (v_texpage == ${L}) { outColor = texture(u_texture[${L}], v_texcoord); }`;return`#version 300 es
precision lowp float;

in vec2 v_texcoord;
flat in int v_texpage;

uniform sampler2D u_texture[${W}];

out vec4 outColor;

void main() {
  if (v_texpage == 0) {
    outColor = texture(u_texture[0], v_texcoord);
  } ${E}
}`}(i.TextureAtlas.maxAtlasPages))),this.register((0,m.toDisposable)(()=>T.deleteProgram(this._program))),this._projectionLocation=(0,s.throwIfFalsy)(T.getUniformLocation(this._program,"u_projection")),this._resolutionLocation=(0,s.throwIfFalsy)(T.getUniformLocation(this._program,"u_resolution")),this._textureLocation=(0,s.throwIfFalsy)(T.getUniformLocation(this._program,"u_texture")),this._vertexArrayObject=T.createVertexArray(),T.bindVertexArray(this._vertexArrayObject);let w=new Float32Array([0,0,1,0,0,1,1,1]),x=T.createBuffer();this.register((0,m.toDisposable)(()=>T.deleteBuffer(x))),T.bindBuffer(T.ARRAY_BUFFER,x),T.bufferData(T.ARRAY_BUFFER,w,T.STATIC_DRAW),T.enableVertexAttribArray(0),T.vertexAttribPointer(0,2,this._gl.FLOAT,!1,0,0);let I=new Uint8Array([0,1,2,3]),R=T.createBuffer();this.register((0,m.toDisposable)(()=>T.deleteBuffer(R))),T.bindBuffer(T.ELEMENT_ARRAY_BUFFER,R),T.bufferData(T.ELEMENT_ARRAY_BUFFER,I,T.STATIC_DRAW),this._attributesBuffer=(0,s.throwIfFalsy)(T.createBuffer()),this.register((0,m.toDisposable)(()=>T.deleteBuffer(this._attributesBuffer))),T.bindBuffer(T.ARRAY_BUFFER,this._attributesBuffer),T.enableVertexAttribArray(2),T.vertexAttribPointer(2,2,T.FLOAT,!1,o,0),T.vertexAttribDivisor(2,1),T.enableVertexAttribArray(3),T.vertexAttribPointer(3,2,T.FLOAT,!1,o,2*Float32Array.BYTES_PER_ELEMENT),T.vertexAttribDivisor(3,1),T.enableVertexAttribArray(4),T.vertexAttribPointer(4,1,T.FLOAT,!1,o,4*Float32Array.BYTES_PER_ELEMENT),T.vertexAttribDivisor(4,1),T.enableVertexAttribArray(5),T.vertexAttribPointer(5,2,T.FLOAT,!1,o,5*Float32Array.BYTES_PER_ELEMENT),T.vertexAttribDivisor(5,1),T.enableVertexAttribArray(6),T.vertexAttribPointer(6,2,T.FLOAT,!1,o,7*Float32Array.BYTES_PER_ELEMENT),T.vertexAttribDivisor(6,1),T.enableVertexAttribArray(1),T.vertexAttribPointer(1,2,T.FLOAT,!1,o,9*Float32Array.BYTES_PER_ELEMENT),T.vertexAttribDivisor(1,1),T.useProgram(this._program);let H=new Int32Array(i.TextureAtlas.maxAtlasPages);for(let W=0;W<i.TextureAtlas.maxAtlasPages;W++)H[W]=W;T.uniform1iv(this._textureLocation,H),T.uniformMatrix4fv(this._projectionLocation,!1,l.PROJECTION_MATRIX),this._atlasTextures=[];for(let W=0;W<i.TextureAtlas.maxAtlasPages;W++){let E=new l.GLTexture((0,s.throwIfFalsy)(T.createTexture()));this.register((0,m.toDisposable)(()=>T.deleteTexture(E.texture))),T.activeTexture(T.TEXTURE0+W),T.bindTexture(T.TEXTURE_2D,E.texture),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texImage2D(T.TEXTURE_2D,0,T.RGBA,1,1,0,T.RGBA,T.UNSIGNED_BYTE,new Uint8Array([255,0,0,255])),this._atlasTextures[W]=E}T.enable(T.BLEND),T.blendFunc(T.SRC_ALPHA,T.ONE_MINUS_SRC_ALPHA),this.handleResize()}beginFrame(){return!this._atlas||this._atlas.beginFrame()}updateCell(v,y,M,T,w,x,I,R){this._updateCell(this._vertices.attributes,v,y,M,T,w,x,I,R)}_updateCell(v,y,M,T,w,x,I,R,H){_=(M*this._terminal.cols+y)*r,T!==p.NULL_CELL_CODE&&T!==void 0?this._atlas&&(c=R&&R.length>1?this._atlas.getRasterizedGlyphCombinedChar(R,w,x,I,!1):this._atlas.getRasterizedGlyph(T,w,x,I,!1),D=Math.floor((this._dimensions.device.cell.width-this._dimensions.device.char.width)/2),w!==H&&c.offset.x>D?(C=c.offset.x-D,v[_]=-(c.offset.x-C)+this._dimensions.device.char.left,v[_+1]=-c.offset.y+this._dimensions.device.char.top,v[_+2]=(c.size.x-C)/this._dimensions.device.canvas.width,v[_+3]=c.size.y/this._dimensions.device.canvas.height,v[_+4]=c.texturePage,v[_+5]=c.texturePositionClipSpace.x+C/this._atlas.pages[c.texturePage].canvas.width,v[_+6]=c.texturePositionClipSpace.y,v[_+7]=c.sizeClipSpace.x-C/this._atlas.pages[c.texturePage].canvas.width,v[_+8]=c.sizeClipSpace.y):(v[_]=-c.offset.x+this._dimensions.device.char.left,v[_+1]=-c.offset.y+this._dimensions.device.char.top,v[_+2]=c.size.x/this._dimensions.device.canvas.width,v[_+3]=c.size.y/this._dimensions.device.canvas.height,v[_+4]=c.texturePage,v[_+5]=c.texturePositionClipSpace.x,v[_+6]=c.texturePositionClipSpace.y,v[_+7]=c.sizeClipSpace.x,v[_+8]=c.sizeClipSpace.y)):v.fill(0,_,_+r-1-2)}clear(){let v=this._terminal,y=v.cols*v.rows*r;this._vertices.count!==y?this._vertices.attributes=new Float32Array(y):this._vertices.attributes.fill(0);let M=0;for(;M<this._vertices.attributesBuffers.length;M++)this._vertices.count!==y?this._vertices.attributesBuffers[M]=new Float32Array(y):this._vertices.attributesBuffers[M].fill(0);this._vertices.count=y,M=0;for(let T=0;T<v.rows;T++)for(let w=0;w<v.cols;w++)this._vertices.attributes[M+9]=w/v.cols,this._vertices.attributes[M+10]=T/v.rows,M+=r}handleResize(){let v=this._gl;v.useProgram(this._program),v.viewport(0,0,v.canvas.width,v.canvas.height),v.uniform2f(this._resolutionLocation,v.canvas.width,v.canvas.height),this.clear()}render(v){if(!this._atlas)return;let y=this._gl;y.useProgram(this._program),y.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;let M=this._vertices.attributesBuffers[this._activeBuffer],T=0;for(let w=0;w<v.lineLengths.length;w++){let x=w*this._terminal.cols*r,I=this._vertices.attributes.subarray(x,x+v.lineLengths[w]*r);M.set(I,T),T+=I.length}y.bindBuffer(y.ARRAY_BUFFER,this._attributesBuffer),y.bufferData(y.ARRAY_BUFFER,M.subarray(0,T),y.STREAM_DRAW);for(let w=0;w<this._atlas.pages.length;w++)this._atlas.pages[w].version!==this._atlasTextures[w].version&&this._bindAtlasPageTexture(y,this._atlas,w);y.drawElementsInstanced(y.TRIANGLE_STRIP,4,y.UNSIGNED_BYTE,0,T/r)}setAtlas(v){this._atlas=v;for(let y of this._atlasTextures)y.version=-1}_bindAtlasPageTexture(v,y,M){v.activeTexture(v.TEXTURE0+M),v.bindTexture(v.TEXTURE_2D,this._atlasTextures[M].texture),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,y.pages[M].canvas),v.generateMipmap(v.TEXTURE_2D),this._atlasTextures[M].version=y.pages[M].version}setDimensions(v){this._dimensions=v}}n.GlyphRenderer=b,f([g.traceCall],b.prototype,"updateCell",null)},742:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.RectangleRenderer=void 0;let f=u(374),s=u(859),i=u(310),p=u(381),m=8*Float32Array.BYTES_PER_ELEMENT;class g{constructor(){this.attributes=new Float32Array(160),this.count=0}}let l=0,r=0,o=0,c=0,_=0,D=0,C=0;class b extends s.Disposable{constructor(v,y,M,T){super(),this._terminal=v,this._gl=y,this._dimensions=M,this._themeService=T,this._vertices=new g,this._verticesCursor=new g;let w=this._gl;this._program=(0,f.throwIfFalsy)((0,p.createProgram)(w,`#version 300 es
layout (location = 0) in vec2 a_position;
layout (location = 1) in vec2 a_size;
layout (location = 2) in vec4 a_color;
layout (location = 3) in vec2 a_unitquad;

uniform mat4 u_projection;

out vec4 v_color;

void main() {
  vec2 zeroToOne = a_position + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_color = a_color;
}`,`#version 300 es
precision lowp float;

in vec4 v_color;

out vec4 outColor;

void main() {
  outColor = v_color;
}`)),this.register((0,s.toDisposable)(()=>w.deleteProgram(this._program))),this._projectionLocation=(0,f.throwIfFalsy)(w.getUniformLocation(this._program,"u_projection")),this._vertexArrayObject=w.createVertexArray(),w.bindVertexArray(this._vertexArrayObject);let x=new Float32Array([0,0,1,0,0,1,1,1]),I=w.createBuffer();this.register((0,s.toDisposable)(()=>w.deleteBuffer(I))),w.bindBuffer(w.ARRAY_BUFFER,I),w.bufferData(w.ARRAY_BUFFER,x,w.STATIC_DRAW),w.enableVertexAttribArray(3),w.vertexAttribPointer(3,2,this._gl.FLOAT,!1,0,0);let R=new Uint8Array([0,1,2,3]),H=w.createBuffer();this.register((0,s.toDisposable)(()=>w.deleteBuffer(H))),w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,H),w.bufferData(w.ELEMENT_ARRAY_BUFFER,R,w.STATIC_DRAW),this._attributesBuffer=(0,f.throwIfFalsy)(w.createBuffer()),this.register((0,s.toDisposable)(()=>w.deleteBuffer(this._attributesBuffer))),w.bindBuffer(w.ARRAY_BUFFER,this._attributesBuffer),w.enableVertexAttribArray(0),w.vertexAttribPointer(0,2,w.FLOAT,!1,m,0),w.vertexAttribDivisor(0,1),w.enableVertexAttribArray(1),w.vertexAttribPointer(1,2,w.FLOAT,!1,m,2*Float32Array.BYTES_PER_ELEMENT),w.vertexAttribDivisor(1,1),w.enableVertexAttribArray(2),w.vertexAttribPointer(2,4,w.FLOAT,!1,m,4*Float32Array.BYTES_PER_ELEMENT),w.vertexAttribDivisor(2,1),this._updateCachedColors(T.colors),this.register(this._themeService.onChangeColors(W=>{this._updateCachedColors(W),this._updateViewportRectangle()}))}renderBackgrounds(){this._renderVertices(this._vertices)}renderCursor(){this._renderVertices(this._verticesCursor)}_renderVertices(v){let y=this._gl;y.useProgram(this._program),y.bindVertexArray(this._vertexArrayObject),y.uniformMatrix4fv(this._projectionLocation,!1,p.PROJECTION_MATRIX),y.bindBuffer(y.ARRAY_BUFFER,this._attributesBuffer),y.bufferData(y.ARRAY_BUFFER,v.attributes,y.DYNAMIC_DRAW),y.drawElementsInstanced(this._gl.TRIANGLE_STRIP,4,y.UNSIGNED_BYTE,0,v.count)}handleResize(){this._updateViewportRectangle()}setDimensions(v){this._dimensions=v}_updateCachedColors(v){this._bgFloat=this._colorToFloat32Array(v.background),this._cursorFloat=this._colorToFloat32Array(v.cursor)}_updateViewportRectangle(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.device.cell.width,this._terminal.rows*this._dimensions.device.cell.height,this._bgFloat)}updateBackgrounds(v){let y=this._terminal,M=this._vertices,T,w,x,I,R,H,W,E,L,A,O,U=1;for(T=0;T<y.rows;T++){for(x=-1,I=0,R=0,H=!1,w=0;w<y.cols;w++)W=(T*y.cols+w)*i.RENDER_MODEL_INDICIES_PER_CELL,E=v.cells[W+i.RENDER_MODEL_BG_OFFSET],L=v.cells[W+i.RENDER_MODEL_FG_OFFSET],A=!!(67108864&L),(E!==I||L!==R&&(H||A))&&((I!==0||H&&R!==0)&&(O=8*U++,this._updateRectangle(M,O,R,I,x,w,T)),x=w,I=E,R=L,H=A);(I!==0||H&&R!==0)&&(O=8*U++,this._updateRectangle(M,O,R,I,x,y.cols,T))}M.count=U}updateCursor(v){let y=this._verticesCursor,M=v.cursor;if(!M||M.style==="block")return void(y.count=0);let T,w=0;M.style!=="bar"&&M.style!=="outline"||(T=8*w++,this._addRectangleFloat(y.attributes,T,M.x*this._dimensions.device.cell.width,M.y*this._dimensions.device.cell.height,M.style==="bar"?M.dpr*M.cursorWidth:M.dpr,this._dimensions.device.cell.height,this._cursorFloat)),M.style!=="underline"&&M.style!=="outline"||(T=8*w++,this._addRectangleFloat(y.attributes,T,M.x*this._dimensions.device.cell.width,(M.y+1)*this._dimensions.device.cell.height-M.dpr,M.width*this._dimensions.device.cell.width,M.dpr,this._cursorFloat)),M.style==="outline"&&(T=8*w++,this._addRectangleFloat(y.attributes,T,M.x*this._dimensions.device.cell.width,M.y*this._dimensions.device.cell.height,M.width*this._dimensions.device.cell.width,M.dpr,this._cursorFloat),T=8*w++,this._addRectangleFloat(y.attributes,T,(M.x+M.width)*this._dimensions.device.cell.width-M.dpr,M.y*this._dimensions.device.cell.height,M.dpr,this._dimensions.device.cell.height,this._cursorFloat)),y.count=w}_updateRectangle(v,y,M,T,w,x,I){if(67108864&M)switch(50331648&M){case 16777216:case 33554432:l=this._themeService.colors.ansi[255&M].rgba;break;case 50331648:l=(16777215&M)<<8;break;default:l=this._themeService.colors.foreground.rgba}else switch(50331648&T){case 16777216:case 33554432:l=this._themeService.colors.ansi[255&T].rgba;break;case 50331648:l=(16777215&T)<<8;break;default:l=this._themeService.colors.background.rgba}v.attributes.length<y+4&&(v.attributes=(0,p.expandFloat32Array)(v.attributes,this._terminal.rows*this._terminal.cols*8)),r=w*this._dimensions.device.cell.width,o=I*this._dimensions.device.cell.height,c=(l>>24&255)/255,_=(l>>16&255)/255,D=(l>>8&255)/255,C=1,this._addRectangle(v.attributes,y,r,o,(x-w)*this._dimensions.device.cell.width,this._dimensions.device.cell.height,c,_,D,C)}_addRectangle(v,y,M,T,w,x,I,R,H,W){v[y]=M/this._dimensions.device.canvas.width,v[y+1]=T/this._dimensions.device.canvas.height,v[y+2]=w/this._dimensions.device.canvas.width,v[y+3]=x/this._dimensions.device.canvas.height,v[y+4]=I,v[y+5]=R,v[y+6]=H,v[y+7]=W}_addRectangleFloat(v,y,M,T,w,x,I){v[y]=M/this._dimensions.device.canvas.width,v[y+1]=T/this._dimensions.device.canvas.height,v[y+2]=w/this._dimensions.device.canvas.width,v[y+3]=x/this._dimensions.device.canvas.height,v[y+4]=I[0],v[y+5]=I[1],v[y+6]=I[2],v[y+7]=I[3]}_colorToFloat32Array(v){return new Float32Array([(v.rgba>>24&255)/255,(v.rgba>>16&255)/255,(v.rgba>>8&255)/255,(255&v.rgba)/255])}}n.RectangleRenderer=b},310:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.RenderModel=n.COMBINED_CHAR_BIT_MASK=n.RENDER_MODEL_EXT_OFFSET=n.RENDER_MODEL_FG_OFFSET=n.RENDER_MODEL_BG_OFFSET=n.RENDER_MODEL_INDICIES_PER_CELL=void 0;let f=u(296);n.RENDER_MODEL_INDICIES_PER_CELL=4,n.RENDER_MODEL_BG_OFFSET=1,n.RENDER_MODEL_FG_OFFSET=2,n.RENDER_MODEL_EXT_OFFSET=3,n.COMBINED_CHAR_BIT_MASK=2147483648,n.RenderModel=class{constructor(){this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection=(0,f.createSelectionRenderModel)()}resize(s,i){let p=s*i*n.RENDER_MODEL_INDICIES_PER_CELL;p!==this.cells.length&&(this.cells=new Uint32Array(p),this.lineLengths=new Uint32Array(i))}clear(){this.cells.fill(0,0),this.lineLengths.fill(0,0)}}},666:function(h,n,u){var f=this&&this.__decorate||function(x,I,R,H){var W,E=arguments.length,L=E<3?I:H===null?H=Object.getOwnPropertyDescriptor(I,R):H;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(x,I,R,H);else for(var A=x.length-1;A>=0;A--)(W=x[A])&&(L=(E<3?W(L):E>3?W(I,R,L):W(I,R))||L);return E>3&&L&&Object.defineProperty(I,R,L),L};Object.defineProperty(n,"__esModule",{value:!0}),n.JoinedCellData=n.WebglRenderer=void 0;let s=u(820),i=u(274),p=u(627),m=u(457),g=u(56),l=u(374),r=u(345),o=u(859),c=u(147),_=u(782),D=u(855),C=u(776),b=u(965),S=u(742),v=u(310),y=u(733);class M extends o.Disposable{constructor(I,R,H,W,E,L,A,O,U){super(),this._terminal=I,this._characterJoinerService=R,this._charSizeService=H,this._coreBrowserService=W,this._coreService=E,this._decorationService=L,this._optionsService=A,this._themeService=O,this._cursorBlinkStateManager=new o.MutableDisposable,this._charAtlasDisposable=this.register(new o.MutableDisposable),this._model=new v.RenderModel,this._workCell=new _.CellData,this._rectangleRenderer=this.register(new o.MutableDisposable),this._glyphRenderer=this.register(new o.MutableDisposable),this._onChangeTextureAtlas=this.register(new r.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new r.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new r.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onRequestRedraw=this.register(new r.EventEmitter),this.onRequestRedraw=this._onRequestRedraw.event,this._onContextLoss=this.register(new r.EventEmitter),this.onContextLoss=this._onContextLoss.event,this.register(this._themeService.onChangeColors(()=>this._handleColorChange())),this._cellColorResolver=new i.CellColorResolver(this._terminal,this._model.selection,this._decorationService,this._coreBrowserService,this._themeService),this._core=this._terminal._core,this._renderLayers=[new y.LinkRenderLayer(this._core.screenElement,2,this._terminal,this._core.linkifier2,this._coreBrowserService,A,this._themeService)],this.dimensions=(0,l.createRenderDimensions)(),this._devicePixelRatio=this._coreBrowserService.dpr,this._updateDimensions(),this._updateCursorBlink(),this.register(A.onOptionChange(()=>this._handleOptionsChanged())),this._canvas=document.createElement("canvas");let Y={antialias:!1,depth:!1,preserveDrawingBuffer:U};if(this._gl=this._canvas.getContext("webgl2",Y),!this._gl)throw new Error("WebGL2 not supported "+this._gl);this.register((0,s.addDisposableDomListener)(this._canvas,"webglcontextlost",ae=>{console.log("webglcontextlost event received"),ae.preventDefault(),this._contextRestorationTimeout=setTimeout(()=>{this._contextRestorationTimeout=void 0,console.warn("webgl context not restored; firing onContextLoss"),this._onContextLoss.fire(ae)},3e3)})),this.register((0,s.addDisposableDomListener)(this._canvas,"webglcontextrestored",ae=>{console.warn("webglcontextrestored event received"),clearTimeout(this._contextRestorationTimeout),this._contextRestorationTimeout=void 0,(0,p.removeTerminalFromCache)(this._terminal),this._initializeWebGLState(),this._requestRedrawViewport()})),this.register((0,g.observeDevicePixelDimensions)(this._canvas,this._coreBrowserService.window,(ae,z)=>this._setCanvasDevicePixelDimensions(ae,z))),this._core.screenElement.appendChild(this._canvas),[this._rectangleRenderer.value,this._glyphRenderer.value]=this._initializeWebGLState(),this._isAttached=this._coreBrowserService.window.document.body.contains(this._core.screenElement),this.register((0,o.toDisposable)(()=>{var ae;for(let z of this._renderLayers)z.dispose();(ae=this._canvas.parentElement)===null||ae===void 0||ae.removeChild(this._canvas),(0,p.removeTerminalFromCache)(this._terminal)}))}get textureAtlas(){var I;return(I=this._charAtlas)===null||I===void 0?void 0:I.pages[0].canvas}_handleColorChange(){this._refreshCharAtlas(),this._clearModel(!0)}handleDevicePixelRatioChange(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._terminal.cols,this._terminal.rows))}handleResize(I,R){var H,W,E,L;this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);for(let A of this._renderLayers)A.resize(this._terminal,this.dimensions);this._canvas.width=this.dimensions.device.canvas.width,this._canvas.height=this.dimensions.device.canvas.height,this._canvas.style.width=`${this.dimensions.css.canvas.width}px`,this._canvas.style.height=`${this.dimensions.css.canvas.height}px`,this._core.screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._core.screenElement.style.height=`${this.dimensions.css.canvas.height}px`,(H=this._rectangleRenderer.value)===null||H===void 0||H.setDimensions(this.dimensions),(W=this._rectangleRenderer.value)===null||W===void 0||W.handleResize(),(E=this._glyphRenderer.value)===null||E===void 0||E.setDimensions(this.dimensions),(L=this._glyphRenderer.value)===null||L===void 0||L.handleResize(),this._refreshCharAtlas(),this._clearModel(!1)}handleCharSizeChanged(){this.handleResize(this._terminal.cols,this._terminal.rows)}handleBlur(){var I;for(let R of this._renderLayers)R.handleBlur(this._terminal);(I=this._cursorBlinkStateManager.value)===null||I===void 0||I.pause(),this._requestRedrawViewport()}handleFocus(){var I;for(let R of this._renderLayers)R.handleFocus(this._terminal);(I=this._cursorBlinkStateManager.value)===null||I===void 0||I.resume(),this._requestRedrawViewport()}handleSelectionChanged(I,R,H){for(let W of this._renderLayers)W.handleSelectionChanged(this._terminal,I,R,H);this._model.selection.update(this._terminal,I,R,H),this._requestRedrawViewport()}handleCursorMove(){var I;for(let R of this._renderLayers)R.handleCursorMove(this._terminal);(I=this._cursorBlinkStateManager.value)===null||I===void 0||I.restartBlinkAnimation()}_handleOptionsChanged(){this._updateDimensions(),this._refreshCharAtlas(),this._updateCursorBlink()}_initializeWebGLState(){return this._rectangleRenderer.value=new S.RectangleRenderer(this._terminal,this._gl,this.dimensions,this._themeService),this._glyphRenderer.value=new b.GlyphRenderer(this._terminal,this._gl,this.dimensions),this.handleCharSizeChanged(),[this._rectangleRenderer.value,this._glyphRenderer.value]}_refreshCharAtlas(){var I;if(this.dimensions.device.char.width<=0&&this.dimensions.device.char.height<=0)return void(this._isAttached=!1);let R=(0,p.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,this._themeService.colors,this.dimensions.device.cell.width,this.dimensions.device.cell.height,this.dimensions.device.char.width,this.dimensions.device.char.height,this._coreBrowserService.dpr);this._charAtlas!==R&&(this._onChangeTextureAtlas.fire(R.pages[0].canvas),this._charAtlasDisposable.value=(0,o.getDisposeArrayDisposable)([(0,r.forwardEvent)(R.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),(0,r.forwardEvent)(R.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)])),this._charAtlas=R,this._charAtlas.warmUp(),(I=this._glyphRenderer.value)===null||I===void 0||I.setAtlas(this._charAtlas)}_clearModel(I){var R;this._model.clear(),I&&((R=this._glyphRenderer.value)===null||R===void 0||R.clear())}clearTextureAtlas(){var I;(I=this._charAtlas)===null||I===void 0||I.clearTexture(),this._clearModel(!0),this._requestRedrawViewport()}clear(){var I;this._clearModel(!0);for(let R of this._renderLayers)R.reset(this._terminal);(I=this._cursorBlinkStateManager.value)===null||I===void 0||I.restartBlinkAnimation(),this._updateCursorBlink()}registerCharacterJoiner(I){return-1}deregisterCharacterJoiner(I){return!1}renderRows(I,R){if(!this._isAttached){if(!(this._coreBrowserService.window.document.body.contains(this._core.screenElement)&&this._charSizeService.width&&this._charSizeService.height))return;this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0}for(let H of this._renderLayers)H.handleGridChanged(this._terminal,I,R);this._glyphRenderer.value&&this._rectangleRenderer.value&&(this._glyphRenderer.value.beginFrame()?(this._clearModel(!0),this._updateModel(0,this._terminal.rows-1)):this._updateModel(I,R),this._rectangleRenderer.value.renderBackgrounds(),this._glyphRenderer.value.render(this._model),this._cursorBlinkStateManager.value&&!this._cursorBlinkStateManager.value.isCursorVisible||this._rectangleRenderer.value.renderCursor())}_updateCursorBlink(){this._terminal.options.cursorBlink?this._cursorBlinkStateManager.value=new m.CursorBlinkStateManager(()=>{this._requestRedrawCursor()},this._coreBrowserService):this._cursorBlinkStateManager.clear(),this._requestRedrawCursor()}_updateModel(I,R){let H=this._core,W,E,L,A,O,U,Y,ae,z,fe,F,N,B,P=this._workCell;I=w(I,H.rows-1,0),R=w(R,H.rows-1,0);let le=this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY,j=Math.min(this._terminal.buffer.active.cursorX,H.cols-1),Fe=-1,rt=this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden&&(!this._cursorBlinkStateManager.value||this._cursorBlinkStateManager.value.isCursorVisible);this._model.cursor=void 0;let Be=!1;for(E=I;E<=R;E++)for(L=E+H.buffer.ydisp,A=H.buffer.lines.get(L),this._model.lineLengths[E]=0,O=this._characterJoinerService.getJoinedCharacters(L),N=0;N<H.cols;N++)if(W=this._cellColorResolver.result.bg,A.loadCell(N,P),N===0&&(W=this._cellColorResolver.result.bg),U=!1,Y=N,O.length>0&&N===O[0][0]&&(U=!0,ae=O.shift(),P=new T(P,A.translateToString(!0,ae[0],ae[1]),ae[1]-ae[0]),Y=ae[1]-1),z=P.getChars(),fe=P.getCode(),F=(E*H.cols+N)*v.RENDER_MODEL_INDICIES_PER_CELL,this._cellColorResolver.resolve(P,N,L),rt&&L===le&&(N===j&&(this._model.cursor={x:j,y:this._terminal.buffer.active.cursorY,width:P.getWidth(),style:this._coreBrowserService.isFocused?H.options.cursorStyle||"block":H.options.cursorInactiveStyle,cursorWidth:H.options.cursorWidth,dpr:this._devicePixelRatio},Fe=j+P.getWidth()-1),N>=j&&N<=Fe&&(this._coreBrowserService.isFocused&&(H.options.cursorStyle||"block")==="block"||this._coreBrowserService.isFocused===!1&&H.options.cursorInactiveStyle==="block")&&(this._cellColorResolver.result.fg=50331648|this._themeService.colors.cursorAccent.rgba>>8&16777215,this._cellColorResolver.result.bg=50331648|this._themeService.colors.cursor.rgba>>8&16777215)),fe!==D.NULL_CELL_CODE&&(this._model.lineLengths[E]=N+1),(this._model.cells[F]!==fe||this._model.cells[F+v.RENDER_MODEL_BG_OFFSET]!==this._cellColorResolver.result.bg||this._model.cells[F+v.RENDER_MODEL_FG_OFFSET]!==this._cellColorResolver.result.fg||this._model.cells[F+v.RENDER_MODEL_EXT_OFFSET]!==this._cellColorResolver.result.ext)&&(Be=!0,z.length>1&&(fe|=v.COMBINED_CHAR_BIT_MASK),this._model.cells[F]=fe,this._model.cells[F+v.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[F+v.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[F+v.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext,this._glyphRenderer.value.updateCell(N,E,fe,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,z,W),U))for(P=this._workCell,N++;N<Y;N++)B=(E*H.cols+N)*v.RENDER_MODEL_INDICIES_PER_CELL,this._glyphRenderer.value.updateCell(N,E,D.NULL_CELL_CODE,0,0,0,D.NULL_CELL_CHAR,0),this._model.cells[B]=D.NULL_CELL_CODE,this._model.cells[B+v.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[B+v.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[B+v.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext;Be&&this._rectangleRenderer.value.updateBackgrounds(this._model),this._rectangleRenderer.value.updateCursor(this._model)}_updateDimensions(){this._charSizeService.width&&this._charSizeService.height&&(this.dimensions.device.char.width=Math.floor(this._charSizeService.width*this._devicePixelRatio),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*this._devicePixelRatio),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=this._optionsService.rawOptions.lineHeight===1?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._terminal.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._terminal.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/this._devicePixelRatio),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/this._devicePixelRatio),this.dimensions.css.cell.height=this.dimensions.device.cell.height/this._devicePixelRatio,this.dimensions.css.cell.width=this.dimensions.device.cell.width/this._devicePixelRatio)}_setCanvasDevicePixelDimensions(I,R){this._canvas.width===I&&this._canvas.height===R||(this._canvas.width=I,this._canvas.height=R,this._requestRedrawViewport())}_requestRedrawViewport(){this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})}_requestRedrawCursor(){let I=this._terminal.buffer.active.cursorY;this._onRequestRedraw.fire({start:I,end:I})}}n.WebglRenderer=M,f([C.traceCall],M.prototype,"renderRows",null);class T extends c.AttributeData{constructor(I,R,H){super(),this.content=0,this.combinedData="",this.fg=I.fg,this.bg=I.bg,this.combinedData=R,this._width=H}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(I){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}function w(x,I,R=0){return Math.max(Math.min(x,I),R)}n.JoinedCellData=T},381:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GLTexture=n.expandFloat32Array=n.createShader=n.createProgram=n.PROJECTION_MATRIX=void 0;let f=u(374);function s(i,p,m){let g=(0,f.throwIfFalsy)(i.createShader(p));if(i.shaderSource(g,m),i.compileShader(g),i.getShaderParameter(g,i.COMPILE_STATUS))return g;console.error(i.getShaderInfoLog(g)),i.deleteShader(g)}n.PROJECTION_MATRIX=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]),n.createProgram=function(i,p,m){let g=(0,f.throwIfFalsy)(i.createProgram());if(i.attachShader(g,(0,f.throwIfFalsy)(s(i,i.VERTEX_SHADER,p))),i.attachShader(g,(0,f.throwIfFalsy)(s(i,i.FRAGMENT_SHADER,m))),i.linkProgram(g),i.getProgramParameter(g,i.LINK_STATUS))return g;console.error(i.getProgramInfoLog(g)),i.deleteProgram(g)},n.createShader=s,n.expandFloat32Array=function(i,p){let m=Math.min(2*i.length,p),g=new Float32Array(m);for(let l=0;l<i.length;l++)g[l]=i[l];return g},n.GLTexture=class{constructor(i){this.texture=i,this.version=-1}}},592:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BaseRenderLayer=void 0;let f=u(627),s=u(237),i=u(374),p=u(859);class m extends p.Disposable{constructor(l,r,o,c,_,D,C,b){super(),this._container=r,this._alpha=_,this._coreBrowserService=D,this._optionsService=C,this._themeService=b,this._deviceCharWidth=0,this._deviceCharHeight=0,this._deviceCellWidth=0,this._deviceCellHeight=0,this._deviceCharLeft=0,this._deviceCharTop=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add(`xterm-${o}-layer`),this._canvas.style.zIndex=c.toString(),this._initCanvas(),this._container.appendChild(this._canvas),this.register(this._themeService.onChangeColors(S=>{this._refreshCharAtlas(l,S),this.reset(l)})),this.register((0,p.toDisposable)(()=>{this._canvas.remove()}))}_initCanvas(){this._ctx=(0,i.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}handleBlur(l){}handleFocus(l){}handleCursorMove(l){}handleGridChanged(l,r,o){}handleSelectionChanged(l,r,o,c=!1){}_setTransparency(l,r){if(r===this._alpha)return;let o=this._canvas;this._alpha=r,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,o),this._refreshCharAtlas(l,this._themeService.colors),this.handleGridChanged(l,0,l.rows-1)}_refreshCharAtlas(l,r){this._deviceCharWidth<=0&&this._deviceCharHeight<=0||(this._charAtlas=(0,f.acquireTextureAtlas)(l,this._optionsService.rawOptions,r,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlas.warmUp())}resize(l,r){this._deviceCellWidth=r.device.cell.width,this._deviceCellHeight=r.device.cell.height,this._deviceCharWidth=r.device.char.width,this._deviceCharHeight=r.device.char.height,this._deviceCharLeft=r.device.char.left,this._deviceCharTop=r.device.char.top,this._canvas.width=r.device.canvas.width,this._canvas.height=r.device.canvas.height,this._canvas.style.width=`${r.css.canvas.width}px`,this._canvas.style.height=`${r.css.canvas.height}px`,this._alpha||this._clearAll(),this._refreshCharAtlas(l,this._themeService.colors)}_fillBottomLineAtCells(l,r,o=1){this._ctx.fillRect(l*this._deviceCellWidth,(r+1)*this._deviceCellHeight-this._coreBrowserService.dpr-1,o*this._deviceCellWidth,this._coreBrowserService.dpr)}_clearAll(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}_clearCells(l,r,o,c){this._alpha?this._ctx.clearRect(l*this._deviceCellWidth,r*this._deviceCellHeight,o*this._deviceCellWidth,c*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(l*this._deviceCellWidth,r*this._deviceCellHeight,o*this._deviceCellWidth,c*this._deviceCellHeight))}_fillCharTrueColor(l,r,o,c){this._ctx.font=this._getFont(l,!1,!1),this._ctx.textBaseline=s.TEXT_BASELINE,this._clipCell(o,c,r.getWidth()),this._ctx.fillText(r.getChars(),o*this._deviceCellWidth+this._deviceCharLeft,c*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}_clipCell(l,r,o){this._ctx.beginPath(),this._ctx.rect(l*this._deviceCellWidth,r*this._deviceCellHeight,o*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}_getFont(l,r,o){return`${o?"italic":""} ${r?l.options.fontWeightBold:l.options.fontWeight} ${l.options.fontSize*this._coreBrowserService.dpr}px ${l.options.fontFamily}`}}n.BaseRenderLayer=m},733:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.LinkRenderLayer=void 0;let f=u(197),s=u(237),i=u(592);class p extends i.BaseRenderLayer{constructor(g,l,r,o,c,_,D){super(r,g,"link",l,!0,c,_,D),this.register(o.onShowLinkUnderline(C=>this._handleShowLinkUnderline(C))),this.register(o.onHideLinkUnderline(C=>this._handleHideLinkUnderline(C)))}resize(g,l){super.resize(g,l),this._state=void 0}reset(g){this._clearCurrentLink()}_clearCurrentLink(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);let g=this._state.y2-this._state.y1-1;g>0&&this._clearCells(0,this._state.y1+1,this._state.cols,g),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}_handleShowLinkUnderline(g){if(g.fg===s.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:g.fg!==void 0&&(0,f.is256Color)(g.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[g.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,g.y1===g.y2)this._fillBottomLineAtCells(g.x1,g.y1,g.x2-g.x1);else{this._fillBottomLineAtCells(g.x1,g.y1,g.cols-g.x1);for(let l=g.y1+1;l<g.y2;l++)this._fillBottomLineAtCells(0,l,g.cols);this._fillBottomLineAtCells(0,g.y2,g.x2)}this._state=g}_handleHideLinkUnderline(g){this._clearCurrentLink()}}n.LinkRenderLayer=p},820:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.addDisposableDomListener=void 0,n.addDisposableDomListener=function(u,f,s,i){u.addEventListener(f,s,i);let p=!1;return{dispose:()=>{p||(p=!0,u.removeEventListener(f,s,i))}}}},274:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CellColorResolver=void 0;let u,f=0,s=0,i=!1,p=!1,m=!1;n.CellColorResolver=class{constructor(g,l,r,o,c){this._terminal=g,this._selectionRenderModel=l,this._decorationService=r,this._coreBrowserService=o,this._themeService=c,this.result={fg:0,bg:0,ext:0}}resolve(g,l,r){this.result.bg=g.bg,this.result.fg=g.fg,this.result.ext=268435456&g.bg?g.extended.ext:0,s=0,f=0,p=!1,i=!1,m=!1,u=this._themeService.colors,this._decorationService.forEachDecorationAtCell(l,r,"bottom",o=>{o.backgroundColorRGB&&(s=o.backgroundColorRGB.rgba>>8&16777215,p=!0),o.foregroundColorRGB&&(f=o.foregroundColorRGB.rgba>>8&16777215,i=!0)}),m=this._selectionRenderModel.isCellSelected(this._terminal,l,r),m&&(s=(this._coreBrowserService.isFocused?u.selectionBackgroundOpaque:u.selectionInactiveBackgroundOpaque).rgba>>8&16777215,p=!0,u.selectionForeground&&(f=u.selectionForeground.rgba>>8&16777215,i=!0)),this._decorationService.forEachDecorationAtCell(l,r,"top",o=>{o.backgroundColorRGB&&(s=o.backgroundColorRGB.rgba>>8&16777215,p=!0),o.foregroundColorRGB&&(f=o.foregroundColorRGB.rgba>>8&16777215,i=!0)}),p&&(s=m?-16777216&g.bg&-134217729|s|50331648:-16777216&g.bg|s|50331648),i&&(f=-16777216&g.fg&-67108865|f|50331648),67108864&this.result.fg&&(p&&!i&&(f=50331648&this.result.bg?-134217728&this.result.fg|67108863&this.result.bg:-134217728&this.result.fg|16777215&u.background.rgba>>8|50331648,i=!0),!p&&i&&(s=50331648&this.result.fg?-67108864&this.result.bg|67108863&this.result.fg:-67108864&this.result.bg|16777215&u.foreground.rgba>>8|50331648,p=!0)),u=void 0,this.result.bg=p?s:this.result.bg,this.result.fg=i?f:this.result.fg}}},627:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.removeTerminalFromCache=n.acquireTextureAtlas=void 0;let f=u(509),s=u(197),i=[];n.acquireTextureAtlas=function(p,m,g,l,r,o,c,_){let D=(0,s.generateConfig)(l,r,o,c,m,g,_);for(let S=0;S<i.length;S++){let v=i[S],y=v.ownedBy.indexOf(p);if(y>=0){if((0,s.configEquals)(v.config,D))return v.atlas;v.ownedBy.length===1?(v.atlas.dispose(),i.splice(S,1)):v.ownedBy.splice(y,1);break}}for(let S=0;S<i.length;S++){let v=i[S];if((0,s.configEquals)(v.config,D))return v.ownedBy.push(p),v.atlas}let C=p._core,b={atlas:new f.TextureAtlas(document,D,C.unicodeService),config:D,ownedBy:[p]};return i.push(b),b.atlas},n.removeTerminalFromCache=function(p){for(let m=0;m<i.length;m++){let g=i[m].ownedBy.indexOf(p);if(g!==-1){i[m].ownedBy.length===1?(i[m].atlas.dispose(),i.splice(m,1)):i[m].ownedBy.splice(g,1);break}}}},197:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.is256Color=n.configEquals=n.generateConfig=void 0;let f=u(160);n.generateConfig=function(s,i,p,m,g,l,r){let o={foreground:l.foreground,background:l.background,cursor:f.NULL_COLOR,cursorAccent:f.NULL_COLOR,selectionForeground:f.NULL_COLOR,selectionBackgroundTransparent:f.NULL_COLOR,selectionBackgroundOpaque:f.NULL_COLOR,selectionInactiveBackgroundTransparent:f.NULL_COLOR,selectionInactiveBackgroundOpaque:f.NULL_COLOR,ansi:l.ansi.slice(),contrastCache:l.contrastCache,halfContrastCache:l.halfContrastCache};return{customGlyphs:g.customGlyphs,devicePixelRatio:r,letterSpacing:g.letterSpacing,lineHeight:g.lineHeight,deviceCellWidth:s,deviceCellHeight:i,deviceCharWidth:p,deviceCharHeight:m,fontFamily:g.fontFamily,fontSize:g.fontSize,fontWeight:g.fontWeight,fontWeightBold:g.fontWeightBold,allowTransparency:g.allowTransparency,drawBoldTextInBrightColors:g.drawBoldTextInBrightColors,minimumContrastRatio:g.minimumContrastRatio,colors:o}},n.configEquals=function(s,i){for(let p=0;p<s.colors.ansi.length;p++)if(s.colors.ansi[p].rgba!==i.colors.ansi[p].rgba)return!1;return s.devicePixelRatio===i.devicePixelRatio&&s.customGlyphs===i.customGlyphs&&s.lineHeight===i.lineHeight&&s.letterSpacing===i.letterSpacing&&s.fontFamily===i.fontFamily&&s.fontSize===i.fontSize&&s.fontWeight===i.fontWeight&&s.fontWeightBold===i.fontWeightBold&&s.allowTransparency===i.allowTransparency&&s.deviceCharWidth===i.deviceCharWidth&&s.deviceCharHeight===i.deviceCharHeight&&s.drawBoldTextInBrightColors===i.drawBoldTextInBrightColors&&s.minimumContrastRatio===i.minimumContrastRatio&&s.colors.foreground.rgba===i.colors.foreground.rgba&&s.colors.background.rgba===i.colors.background.rgba},n.is256Color=function(s){return(50331648&s)==16777216||(50331648&s)==33554432}},237:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TEXT_BASELINE=n.DIM_OPACITY=n.INVERTED_DEFAULT_COLOR=void 0;let f=u(399);n.INVERTED_DEFAULT_COLOR=257,n.DIM_OPACITY=.5,n.TEXT_BASELINE=f.isFirefox||f.isLegacyEdge?"bottom":"ideographic"},457:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CursorBlinkStateManager=void 0,n.CursorBlinkStateManager=class{constructor(u,f){this._renderCallback=u,this._coreBrowserService=f,this.isCursorVisible=!0,this._coreBrowserService.isFocused&&this._restartInterval()}get isPaused(){return!(this._blinkStartTimeout||this._blinkInterval)}dispose(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}restartBlinkAnimation(){this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})))}_restartInterval(u=600){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(()=>{if(this._animationTimeRestarted){let f=600-(Date.now()-this._animationTimeRestarted);if(this._animationTimeRestarted=void 0,f>0)return void this._restartInterval(f)}this.isCursorVisible=!1,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0}),this._blinkInterval=this._coreBrowserService.window.setInterval(()=>{if(this._animationTimeRestarted){let f=600-(Date.now()-this._animationTimeRestarted);return this._animationTimeRestarted=void 0,void this._restartInterval(f)}this.isCursorVisible=!this.isCursorVisible,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})},600)},u)}pause(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}resume(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}},860:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.tryDrawCustomChar=n.powerlineDefinitions=n.boxDrawingDefinitions=n.blockElementDefinitions=void 0;let f=u(374);n.blockElementDefinitions={"\u2580":[{x:0,y:0,w:8,h:4}],"\u2581":[{x:0,y:7,w:8,h:1}],"\u2582":[{x:0,y:6,w:8,h:2}],"\u2583":[{x:0,y:5,w:8,h:3}],"\u2584":[{x:0,y:4,w:8,h:4}],"\u2585":[{x:0,y:3,w:8,h:5}],"\u2586":[{x:0,y:2,w:8,h:6}],"\u2587":[{x:0,y:1,w:8,h:7}],"\u2588":[{x:0,y:0,w:8,h:8}],"\u2589":[{x:0,y:0,w:7,h:8}],"\u258A":[{x:0,y:0,w:6,h:8}],"\u258B":[{x:0,y:0,w:5,h:8}],"\u258C":[{x:0,y:0,w:4,h:8}],"\u258D":[{x:0,y:0,w:3,h:8}],"\u258E":[{x:0,y:0,w:2,h:8}],"\u258F":[{x:0,y:0,w:1,h:8}],"\u2590":[{x:4,y:0,w:4,h:8}],"\u2594":[{x:0,y:0,w:8,h:1}],"\u2595":[{x:7,y:0,w:1,h:8}],"\u2596":[{x:0,y:4,w:4,h:4}],"\u2597":[{x:4,y:4,w:4,h:4}],"\u2598":[{x:0,y:0,w:4,h:4}],"\u2599":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\u259A":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"\u259B":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"\u259C":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"\u259D":[{x:4,y:0,w:4,h:4}],"\u259E":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"\u259F":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\u{1FB70}":[{x:1,y:0,w:1,h:8}],"\u{1FB71}":[{x:2,y:0,w:1,h:8}],"\u{1FB72}":[{x:3,y:0,w:1,h:8}],"\u{1FB73}":[{x:4,y:0,w:1,h:8}],"\u{1FB74}":[{x:5,y:0,w:1,h:8}],"\u{1FB75}":[{x:6,y:0,w:1,h:8}],"\u{1FB76}":[{x:0,y:1,w:8,h:1}],"\u{1FB77}":[{x:0,y:2,w:8,h:1}],"\u{1FB78}":[{x:0,y:3,w:8,h:1}],"\u{1FB79}":[{x:0,y:4,w:8,h:1}],"\u{1FB7A}":[{x:0,y:5,w:8,h:1}],"\u{1FB7B}":[{x:0,y:6,w:8,h:1}],"\u{1FB7C}":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\u{1FB7D}":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\u{1FB7E}":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\u{1FB7F}":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\u{1FB80}":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"\u{1FB81}":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"\u{1FB82}":[{x:0,y:0,w:8,h:2}],"\u{1FB83}":[{x:0,y:0,w:8,h:3}],"\u{1FB84}":[{x:0,y:0,w:8,h:5}],"\u{1FB85}":[{x:0,y:0,w:8,h:6}],"\u{1FB86}":[{x:0,y:0,w:8,h:7}],"\u{1FB87}":[{x:6,y:0,w:2,h:8}],"\u{1FB88}":[{x:5,y:0,w:3,h:8}],"\u{1FB89}":[{x:3,y:0,w:5,h:8}],"\u{1FB8A}":[{x:2,y:0,w:6,h:8}],"\u{1FB8B}":[{x:1,y:0,w:7,h:8}],"\u{1FB95}":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"\u{1FB96}":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"\u{1FB97}":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};let s={"\u2591":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"\u2592":[[1,0],[0,0],[0,1],[0,0]],"\u2593":[[0,1],[1,1],[1,0],[1,1]]};n.boxDrawingDefinitions={"\u2500":{1:"M0,.5 L1,.5"},"\u2501":{3:"M0,.5 L1,.5"},"\u2502":{1:"M.5,0 L.5,1"},"\u2503":{3:"M.5,0 L.5,1"},"\u250C":{1:"M0.5,1 L.5,.5 L1,.5"},"\u250F":{3:"M0.5,1 L.5,.5 L1,.5"},"\u2510":{1:"M0,.5 L.5,.5 L.5,1"},"\u2513":{3:"M0,.5 L.5,.5 L.5,1"},"\u2514":{1:"M.5,0 L.5,.5 L1,.5"},"\u2517":{3:"M.5,0 L.5,.5 L1,.5"},"\u2518":{1:"M.5,0 L.5,.5 L0,.5"},"\u251B":{3:"M.5,0 L.5,.5 L0,.5"},"\u251C":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u2523":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u2524":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u252B":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u252C":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2533":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2534":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"\u253B":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"\u253C":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"\u254B":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"\u2574":{1:"M.5,.5 L0,.5"},"\u2578":{3:"M.5,.5 L0,.5"},"\u2575":{1:"M.5,.5 L.5,0"},"\u2579":{3:"M.5,.5 L.5,0"},"\u2576":{1:"M.5,.5 L1,.5"},"\u257A":{3:"M.5,.5 L1,.5"},"\u2577":{1:"M.5,.5 L.5,1"},"\u257B":{3:"M.5,.5 L.5,1"},"\u2550":{1:(l,r)=>`M0,${.5-r} L1,${.5-r} M0,${.5+r} L1,${.5+r}`},"\u2551":{1:(l,r)=>`M${.5-l},0 L${.5-l},1 M${.5+l},0 L${.5+l},1`},"\u2552":{1:(l,r)=>`M.5,1 L.5,${.5-r} L1,${.5-r} M.5,${.5+r} L1,${.5+r}`},"\u2553":{1:(l,r)=>`M${.5-l},1 L${.5-l},.5 L1,.5 M${.5+l},.5 L${.5+l},1`},"\u2554":{1:(l,r)=>`M1,${.5-r} L${.5-l},${.5-r} L${.5-l},1 M1,${.5+r} L${.5+l},${.5+r} L${.5+l},1`},"\u2555":{1:(l,r)=>`M0,${.5-r} L.5,${.5-r} L.5,1 M0,${.5+r} L.5,${.5+r}`},"\u2556":{1:(l,r)=>`M${.5+l},1 L${.5+l},.5 L0,.5 M${.5-l},.5 L${.5-l},1`},"\u2557":{1:(l,r)=>`M0,${.5+r} L${.5-l},${.5+r} L${.5-l},1 M0,${.5-r} L${.5+l},${.5-r} L${.5+l},1`},"\u2558":{1:(l,r)=>`M.5,0 L.5,${.5+r} L1,${.5+r} M.5,${.5-r} L1,${.5-r}`},"\u2559":{1:(l,r)=>`M1,.5 L${.5-l},.5 L${.5-l},0 M${.5+l},.5 L${.5+l},0`},"\u255A":{1:(l,r)=>`M1,${.5-r} L${.5+l},${.5-r} L${.5+l},0 M1,${.5+r} L${.5-l},${.5+r} L${.5-l},0`},"\u255B":{1:(l,r)=>`M0,${.5+r} L.5,${.5+r} L.5,0 M0,${.5-r} L.5,${.5-r}`},"\u255C":{1:(l,r)=>`M0,.5 L${.5+l},.5 L${.5+l},0 M${.5-l},.5 L${.5-l},0`},"\u255D":{1:(l,r)=>`M0,${.5-r} L${.5-l},${.5-r} L${.5-l},0 M0,${.5+r} L${.5+l},${.5+r} L${.5+l},0`},"\u255E":{1:(l,r)=>`M.5,0 L.5,1 M.5,${.5-r} L1,${.5-r} M.5,${.5+r} L1,${.5+r}`},"\u255F":{1:(l,r)=>`M${.5-l},0 L${.5-l},1 M${.5+l},0 L${.5+l},1 M${.5+l},.5 L1,.5`},"\u2560":{1:(l,r)=>`M${.5-l},0 L${.5-l},1 M1,${.5+r} L${.5+l},${.5+r} L${.5+l},1 M1,${.5-r} L${.5+l},${.5-r} L${.5+l},0`},"\u2561":{1:(l,r)=>`M.5,0 L.5,1 M0,${.5-r} L.5,${.5-r} M0,${.5+r} L.5,${.5+r}`},"\u2562":{1:(l,r)=>`M0,.5 L${.5-l},.5 M${.5-l},0 L${.5-l},1 M${.5+l},0 L${.5+l},1`},"\u2563":{1:(l,r)=>`M${.5+l},0 L${.5+l},1 M0,${.5+r} L${.5-l},${.5+r} L${.5-l},1 M0,${.5-r} L${.5-l},${.5-r} L${.5-l},0`},"\u2564":{1:(l,r)=>`M0,${.5-r} L1,${.5-r} M0,${.5+r} L1,${.5+r} M.5,${.5+r} L.5,1`},"\u2565":{1:(l,r)=>`M0,.5 L1,.5 M${.5-l},.5 L${.5-l},1 M${.5+l},.5 L${.5+l},1`},"\u2566":{1:(l,r)=>`M0,${.5-r} L1,${.5-r} M0,${.5+r} L${.5-l},${.5+r} L${.5-l},1 M1,${.5+r} L${.5+l},${.5+r} L${.5+l},1`},"\u2567":{1:(l,r)=>`M.5,0 L.5,${.5-r} M0,${.5-r} L1,${.5-r} M0,${.5+r} L1,${.5+r}`},"\u2568":{1:(l,r)=>`M0,.5 L1,.5 M${.5-l},.5 L${.5-l},0 M${.5+l},.5 L${.5+l},0`},"\u2569":{1:(l,r)=>`M0,${.5+r} L1,${.5+r} M0,${.5-r} L${.5-l},${.5-r} L${.5-l},0 M1,${.5-r} L${.5+l},${.5-r} L${.5+l},0`},"\u256A":{1:(l,r)=>`M.5,0 L.5,1 M0,${.5-r} L1,${.5-r} M0,${.5+r} L1,${.5+r}`},"\u256B":{1:(l,r)=>`M0,.5 L1,.5 M${.5-l},0 L${.5-l},1 M${.5+l},0 L${.5+l},1`},"\u256C":{1:(l,r)=>`M0,${.5+r} L${.5-l},${.5+r} L${.5-l},1 M1,${.5+r} L${.5+l},${.5+r} L${.5+l},1 M0,${.5-r} L${.5-l},${.5-r} L${.5-l},0 M1,${.5-r} L${.5+l},${.5-r} L${.5+l},0`},"\u2571":{1:"M1,0 L0,1"},"\u2572":{1:"M0,0 L1,1"},"\u2573":{1:"M1,0 L0,1 M0,0 L1,1"},"\u257C":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u257D":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"\u257E":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u257F":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u250D":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"\u250E":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2511":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"\u2512":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"\u2515":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"\u2516":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u2519":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"\u251A":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"\u251D":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"\u251E":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u251F":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2520":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"\u2521":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"\u2522":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"\u2525":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"\u2526":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u2527":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"\u2528":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"\u2529":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"\u252A":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"\u252D":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u252E":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"\u252F":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"\u2530":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2531":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"\u2532":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"\u2535":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u2536":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u2537":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"\u2538":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u2539":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"\u253A":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"\u253D":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u253E":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u253F":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"\u2540":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u2541":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2542":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"\u2543":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"\u2544":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"\u2545":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"\u2546":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"\u2547":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"\u2548":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2549":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u254A":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u254C":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"\u254D":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"\u2504":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"\u2505":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"\u2508":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"\u2509":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"\u254E":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"\u254F":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"\u2506":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"\u2507":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"\u250A":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"\u250B":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"\u256D":{1:(l,r)=>`M.5,1 L.5,${.5+r/.15*.5} C.5,${.5+r/.15*.5},.5,.5,1,.5`},"\u256E":{1:(l,r)=>`M.5,1 L.5,${.5+r/.15*.5} C.5,${.5+r/.15*.5},.5,.5,0,.5`},"\u256F":{1:(l,r)=>`M.5,0 L.5,${.5-r/.15*.5} C.5,${.5-r/.15*.5},.5,.5,0,.5`},"\u2570":{1:(l,r)=>`M.5,0 L.5,${.5-r/.15*.5} C.5,${.5-r/.15*.5},.5,.5,1,.5`}},n.powerlineDefinitions={"\uE0B0":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"\uE0B1":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0B2":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"\uE0B3":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0B4":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"\uE0B5":{d:"M.2,1 C.422,1,.8,.826,.78,.5 C.8,.174,0.422,0,.2,0",type:1,rightPadding:1},"\uE0B6":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"\uE0B7":{d:"M.8,1 C0.578,1,0.2,.826,.22,.5 C0.2,0.174,0.578,0,0.8,0",type:1,leftPadding:1},"\uE0B8":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"\uE0B9":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0BA":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"\uE0BC":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"\uE0BD":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0BE":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},n.powerlineDefinitions["\uE0BB"]=n.powerlineDefinitions["\uE0BD"],n.powerlineDefinitions["\uE0BF"]=n.powerlineDefinitions["\uE0B9"],n.tryDrawCustomChar=function(l,r,o,c,_,D,C,b){let S=n.blockElementDefinitions[r];if(S)return function(T,w,x,I,R,H){for(let W=0;W<w.length;W++){let E=w[W],L=R/8,A=H/8;T.fillRect(x+E.x*L,I+E.y*A,E.w*L,E.h*A)}}(l,S,o,c,_,D),!0;let v=s[r];if(v)return function(T,w,x,I,R,H){let W=i.get(w);W||(W=new Map,i.set(w,W));let E=T.fillStyle;if(typeof E!="string")throw new Error(`Unexpected fillStyle type "${E}"`);let L=W.get(E);if(!L){let A=w[0].length,O=w.length,U=document.createElement("canvas");U.width=A,U.height=O;let Y=(0,f.throwIfFalsy)(U.getContext("2d")),ae=new ImageData(A,O),z,fe,F,N;if(E.startsWith("#"))z=parseInt(E.slice(1,3),16),fe=parseInt(E.slice(3,5),16),F=parseInt(E.slice(5,7),16),N=E.length>7&&parseInt(E.slice(7,9),16)||1;else{if(!E.startsWith("rgba"))throw new Error(`Unexpected fillStyle color format "${E}" when drawing pattern glyph`);[z,fe,F,N]=E.substring(5,E.length-1).split(",").map(B=>parseFloat(B))}for(let B=0;B<O;B++)for(let P=0;P<A;P++)ae.data[4*(B*A+P)]=z,ae.data[4*(B*A+P)+1]=fe,ae.data[4*(B*A+P)+2]=F,ae.data[4*(B*A+P)+3]=w[B][P]*(255*N);Y.putImageData(ae,0,0),L=(0,f.throwIfFalsy)(T.createPattern(U,null)),W.set(E,L)}T.fillStyle=L,T.fillRect(x,I,R,H)}(l,v,o,c,_,D),!0;let y=n.boxDrawingDefinitions[r];if(y)return function(T,w,x,I,R,H,W){T.strokeStyle=T.fillStyle;for(let[E,L]of Object.entries(w)){let A;T.beginPath(),T.lineWidth=W*Number.parseInt(E),A=typeof L=="function"?L(.15,.15/H*R):L;for(let O of A.split(" ")){let U=O[0],Y=m[U];if(!Y){console.error(`Could not find drawing instructions for "${U}"`);continue}let ae=O.substring(1).split(",");ae[0]&&ae[1]&&Y(T,g(ae,R,H,x,I,!0,W))}T.stroke(),T.closePath()}}(l,y,o,c,_,D,b),!0;let M=n.powerlineDefinitions[r];return!!M&&(function(T,w,x,I,R,H,W,E){var L,A;let O=new Path2D;O.rect(x,I,R,H),T.clip(O),T.beginPath();let U=W/12;T.lineWidth=E*U;for(let Y of w.d.split(" ")){let ae=Y[0],z=m[ae];if(!z){console.error(`Could not find drawing instructions for "${ae}"`);continue}let fe=Y.substring(1).split(",");fe[0]&&fe[1]&&z(T,g(fe,R,H,x,I,!1,E,((L=w.leftPadding)!==null&&L!==void 0?L:0)*(U/2),((A=w.rightPadding)!==null&&A!==void 0?A:0)*(U/2)))}w.type===1?(T.strokeStyle=T.fillStyle,T.stroke()):T.fill(),T.closePath()}(l,M,o,c,_,D,C,b),!0)};let i=new Map;function p(l,r,o=0){return Math.max(Math.min(l,r),o)}let m={C:(l,r)=>l.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]),L:(l,r)=>l.lineTo(r[0],r[1]),M:(l,r)=>l.moveTo(r[0],r[1])};function g(l,r,o,c,_,D,C,b=0,S=0){let v=l.map(y=>parseFloat(y)||parseInt(y));if(v.length<2)throw new Error("Too few arguments for instruction");for(let y=0;y<v.length;y+=2)v[y]*=r-b*C-S*C,D&&v[y]!==0&&(v[y]=p(Math.round(v[y]+.5)-.5,r,0)),v[y]+=c+b*C;for(let y=1;y<v.length;y+=2)v[y]*=o,D&&v[y]!==0&&(v[y]=p(Math.round(v[y]+.5)-.5,o,0)),v[y]+=_;return v}},56:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.observeDevicePixelDimensions=void 0;let f=u(859);n.observeDevicePixelDimensions=function(s,i,p){let m=new i.ResizeObserver(g=>{let l=g.find(c=>c.target===s);if(!l)return;if(!("devicePixelContentBoxSize"in l))return m?.disconnect(),void(m=void 0);let r=l.devicePixelContentBoxSize[0].inlineSize,o=l.devicePixelContentBoxSize[0].blockSize;r>0&&o>0&&p(r,o)});try{m.observe(s,{box:["device-pixel-content-box"]})}catch{m.disconnect(),m=void 0}return(0,f.toDisposable)(()=>m?.disconnect())}},374:(h,n)=>{function u(f){return 57508<=f&&f<=57558}Object.defineProperty(n,"__esModule",{value:!0}),n.createRenderDimensions=n.excludeFromContrastRatioDemands=n.isRestrictedPowerlineGlyph=n.isPowerlineGlyph=n.throwIfFalsy=void 0,n.throwIfFalsy=function(f){if(!f)throw new Error("value must not be falsy");return f},n.isPowerlineGlyph=u,n.isRestrictedPowerlineGlyph=function(f){return 57520<=f&&f<=57527},n.excludeFromContrastRatioDemands=function(f){return u(f)||function(s){return 9472<=s&&s<=9631}(f)},n.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},296:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createSelectionRenderModel=void 0;class u{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(s,i,p,m=!1){if(this.selectionStart=i,this.selectionEnd=p,!i||!p||i[0]===p[0]&&i[1]===p[1])return void this.clear();let g=i[1]-s.buffer.active.viewportY,l=p[1]-s.buffer.active.viewportY,r=Math.max(g,0),o=Math.min(l,s.rows-1);r>=s.rows||o<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=m,this.viewportStartRow=g,this.viewportEndRow=l,this.viewportCappedStartRow=r,this.viewportCappedEndRow=o,this.startCol=i[0],this.endCol=p[0])}isCellSelected(s,i,p){return!!this.hasSelection&&(p-=s.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?i>=this.startCol&&p>=this.viewportCappedStartRow&&i<this.endCol&&p<=this.viewportCappedEndRow:i<this.startCol&&p>=this.viewportCappedStartRow&&i>=this.endCol&&p<=this.viewportCappedEndRow:p>this.viewportStartRow&&p<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&p===this.viewportStartRow&&i>=this.startCol&&i<this.endCol||this.viewportStartRow<this.viewportEndRow&&p===this.viewportEndRow&&i<this.endCol||this.viewportStartRow<this.viewportEndRow&&p===this.viewportStartRow&&i>=this.startCol)}}n.createSelectionRenderModel=function(){return new u}},509:function(h,n,u){var f=this&&this.__decorate||function(M,T,w,x){var I,R=arguments.length,H=R<3?T:x===null?x=Object.getOwnPropertyDescriptor(T,w):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(M,T,w,x);else for(var W=M.length-1;W>=0;W--)(I=M[W])&&(H=(R<3?I(H):R>3?I(T,w,H):I(T,w))||H);return R>3&&H&&Object.defineProperty(T,w,H),H};Object.defineProperty(n,"__esModule",{value:!0}),n.TextureAtlas=void 0;let s=u(237),i=u(860),p=u(374),m=u(160),g=u(345),l=u(485),r=u(385),o=u(147),c=u(855),_=u(776),D={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}},C;class b{get pages(){return this._pages}constructor(T,w,x){this._document=T,this._config=w,this._unicodeService=x,this._didWarmUp=!1,this._cacheMap=new l.FourKeyMap,this._cacheMapCombined=new l.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new o.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new g.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new g.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=y(T,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,p.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}dispose(){for(let T of this.pages)T.canvas.remove();this._onAddTextureAtlasCanvas.dispose()}warmUp(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}_doWarmUp(){let T=new r.IdleTaskQueue;for(let w=33;w<126;w++)T.enqueue(()=>{if(!this._cacheMap.get(w,c.DEFAULT_COLOR,c.DEFAULT_COLOR,c.DEFAULT_EXT)){let x=this._drawToCache(w,c.DEFAULT_COLOR,c.DEFAULT_COLOR,c.DEFAULT_EXT);this._cacheMap.set(w,c.DEFAULT_COLOR,c.DEFAULT_COLOR,c.DEFAULT_EXT,x)}})}beginFrame(){return this._requestClearModel}clearTexture(){if(this._pages[0].currentRow.x!==0||this._pages[0].currentRow.y!==0){for(let T of this._pages)T.clear();this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}_createNewPage(){if(b.maxAtlasPages&&this._pages.length>=Math.max(4,b.maxAtlasPages)){let w=this._pages.filter(L=>2*L.canvas.width<=(b.maxTextureSize||4096)).sort((L,A)=>A.canvas.width!==L.canvas.width?A.canvas.width-L.canvas.width:A.percentageUsed-L.percentageUsed),x=-1,I=0;for(let L=0;L<w.length;L++)if(w[L].canvas.width!==I)x=L,I=w[L].canvas.width;else if(L-x==3)break;let R=w.slice(x,x+4),H=R.map(L=>L.glyphs[0].texturePage).sort((L,A)=>L>A?1:-1),W=this.pages.length-R.length,E=this._mergePages(R,W);E.version++;for(let L=H.length-1;L>=0;L--)this._deletePage(H[L]);this.pages.push(E),this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(E.canvas)}let T=new S(this._document,this._textureSize);return this._pages.push(T),this._activePages.push(T),this._onAddTextureAtlasCanvas.fire(T.canvas),T}_mergePages(T,w){let x=2*T[0].canvas.width,I=new S(this._document,x,T);for(let[R,H]of T.entries()){let W=R*H.canvas.width%x,E=Math.floor(R/2)*H.canvas.height;I.ctx.drawImage(H.canvas,W,E);for(let A of H.glyphs)A.texturePage=w,A.sizeClipSpace.x=A.size.x/x,A.sizeClipSpace.y=A.size.y/x,A.texturePosition.x+=W,A.texturePosition.y+=E,A.texturePositionClipSpace.x=A.texturePosition.x/x,A.texturePositionClipSpace.y=A.texturePosition.y/x;this._onRemoveTextureAtlasCanvas.fire(H.canvas);let L=this._activePages.indexOf(H);L!==-1&&this._activePages.splice(L,1)}return I}_deletePage(T){this._pages.splice(T,1);for(let w=T;w<this._pages.length;w++){let x=this._pages[w];for(let I of x.glyphs)I.texturePage--;x.version++}}getRasterizedGlyphCombinedChar(T,w,x,I,R){return this._getFromCacheMap(this._cacheMapCombined,T,w,x,I,R)}getRasterizedGlyph(T,w,x,I,R){return this._getFromCacheMap(this._cacheMap,T,w,x,I,R)}_getFromCacheMap(T,w,x,I,R,H=!1){return C=T.get(w,x,I,R),C||(C=this._drawToCache(w,x,I,R,H),T.set(w,x,I,R,C)),C}_getColorFromAnsiIndex(T){if(T>=this._config.colors.ansi.length)throw new Error("No color found for idx "+T);return this._config.colors.ansi[T]}_getBackgroundColor(T,w,x,I){if(this._config.allowTransparency)return m.NULL_COLOR;let R;switch(T){case 16777216:case 33554432:R=this._getColorFromAnsiIndex(w);break;case 50331648:let H=o.AttributeData.toColorRGB(w);R=m.rgba.toColor(H[0],H[1],H[2]);break;default:R=x?m.color.opaque(this._config.colors.foreground):this._config.colors.background}return R}_getForegroundColor(T,w,x,I,R,H,W,E,L,A){let O=this._getMinimumContrastColor(T,w,x,I,R,H,!1,L,E,A);if(O)return O;let U;switch(R){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&L&&H<8&&(H+=8),U=this._getColorFromAnsiIndex(H);break;case 50331648:let Y=o.AttributeData.toColorRGB(H);U=m.rgba.toColor(Y[0],Y[1],Y[2]);break;default:U=W?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(U=m.color.opaque(U)),E&&(U=m.color.multiplyOpacity(U,s.DIM_OPACITY)),U}_resolveBackgroundRgba(T,w,x){switch(T){case 16777216:case 33554432:return this._getColorFromAnsiIndex(w).rgba;case 50331648:return w<<8;default:return x?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}_resolveForegroundRgba(T,w,x,I){switch(T){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&I&&w<8&&(w+=8),this._getColorFromAnsiIndex(w).rgba;case 50331648:return w<<8;default:return x?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}_getMinimumContrastColor(T,w,x,I,R,H,W,E,L,A){if(this._config.minimumContrastRatio===1||A)return;let O=this._getContrastCache(L),U=O.getColor(T,I);if(U!==void 0)return U||void 0;let Y=this._resolveBackgroundRgba(w,x,W),ae=this._resolveForegroundRgba(R,H,W,E),z=m.rgba.ensureContrastRatio(Y,ae,this._config.minimumContrastRatio/(L?2:1));if(!z)return void O.setColor(T,I,null);let fe=m.rgba.toColor(z>>24&255,z>>16&255,z>>8&255);return O.setColor(T,I,fe),fe}_getContrastCache(T){return T?this._config.colors.halfContrastCache:this._config.colors.contrastCache}_drawToCache(T,w,x,I,R=!1){let H=typeof T=="number"?String.fromCharCode(T):T,W=Math.min(this._config.deviceCellWidth*Math.max(H.length,2)+4,this._textureSize);this._tmpCanvas.width<W&&(this._tmpCanvas.width=W);let E=Math.min(this._config.deviceCellHeight+8,this._textureSize);if(this._tmpCanvas.height<E&&(this._tmpCanvas.height=E),this._tmpCtx.save(),this._workAttributeData.fg=x,this._workAttributeData.bg=w,this._workAttributeData.extended.ext=I,this._workAttributeData.isInvisible())return D;let L=!!this._workAttributeData.isBold(),A=!!this._workAttributeData.isInverse(),O=!!this._workAttributeData.isDim(),U=!!this._workAttributeData.isItalic(),Y=!!this._workAttributeData.isUnderline(),ae=!!this._workAttributeData.isStrikethrough(),z=!!this._workAttributeData.isOverline(),fe=this._workAttributeData.getFgColor(),F=this._workAttributeData.getFgColorMode(),N=this._workAttributeData.getBgColor(),B=this._workAttributeData.getBgColorMode();if(A){let Q=fe;fe=N,N=Q;let me=F;F=B,B=me}let P=this._getBackgroundColor(B,N,A,O);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=P.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";let le=L?this._config.fontWeightBold:this._config.fontWeight,j=U?"italic":"";this._tmpCtx.font=`${j} ${le} ${this._config.fontSize*this._config.devicePixelRatio}px ${this._config.fontFamily}`,this._tmpCtx.textBaseline=s.TEXT_BASELINE;let Fe=H.length===1&&(0,p.isPowerlineGlyph)(H.charCodeAt(0)),rt=H.length===1&&(0,p.isRestrictedPowerlineGlyph)(H.charCodeAt(0)),Be=this._getForegroundColor(w,B,N,x,F,fe,A,O,L,(0,p.excludeFromContrastRatioDemands)(H.charCodeAt(0)));this._tmpCtx.fillStyle=Be.css;let Re=rt?0:4,qe=!1;this._config.customGlyphs!==!1&&(qe=(0,i.tryDrawCustomChar)(this._tmpCtx,H,Re,Re,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));let kt,sr=!Fe;if(kt=typeof T=="number"?this._unicodeService.wcwidth(T):this._unicodeService.getStringCellWidth(T),Y){this._tmpCtx.save();let Q=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),me=Q%2==1?.5:0;if(this._tmpCtx.lineWidth=Q,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())sr=!1,this._tmpCtx.strokeStyle=`rgb(${o.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(",")})`;else{sr=!1;let nr=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&nr<8&&(nr+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(nr).css}this._tmpCtx.beginPath();let $e=Re,ze=Math.ceil(Re+this._config.deviceCharHeight)-me-(R?2*Q:0),Tt=ze+Q,tr=ze+2*Q;for(let nr=0;nr<kt;nr++){this._tmpCtx.save();let nt=$e+nr*this._config.deviceCellWidth,ln=$e+(nr+1)*this._config.deviceCellWidth,E_=nt+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(nt,ze),this._tmpCtx.lineTo(ln,ze),this._tmpCtx.moveTo(nt,tr),this._tmpCtx.lineTo(ln,tr);break;case 3:let gs=Q<=1?tr:Math.ceil(Re+this._config.deviceCharHeight-Q/2)-me,Ds=Q<=1?ze:Math.ceil(Re+this._config.deviceCharHeight+Q/2)-me,vh=new Path2D;vh.rect(nt,ze,this._config.deviceCellWidth,tr-ze),this._tmpCtx.clip(vh),this._tmpCtx.moveTo(nt-this._config.deviceCellWidth/2,Tt),this._tmpCtx.bezierCurveTo(nt-this._config.deviceCellWidth/2,Ds,nt,Ds,nt,Tt),this._tmpCtx.bezierCurveTo(nt,gs,E_,gs,E_,Tt),this._tmpCtx.bezierCurveTo(E_,Ds,ln,Ds,ln,Tt),this._tmpCtx.bezierCurveTo(ln,gs,ln+this._config.deviceCellWidth/2,gs,ln+this._config.deviceCellWidth/2,Tt);break;case 4:this._tmpCtx.setLineDash([Math.round(Q),Math.round(Q)]),this._tmpCtx.moveTo(nt,ze),this._tmpCtx.lineTo(ln,ze);break;case 5:this._tmpCtx.setLineDash([4*this._config.devicePixelRatio,3*this._config.devicePixelRatio]),this._tmpCtx.moveTo(nt,ze),this._tmpCtx.lineTo(ln,ze);break;default:this._tmpCtx.moveTo(nt,ze),this._tmpCtx.lineTo(ln,ze)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!qe&&this._config.fontSize>=12&&!this._config.allowTransparency&&H!==" "){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";let nr=this._tmpCtx.measureText(H);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in nr&&nr.actualBoundingBoxDescent>0){this._tmpCtx.save();let nt=new Path2D;nt.rect($e,ze-Math.ceil(Q/2),this._config.deviceCellWidth*kt,tr-ze+Math.ceil(Q/2)),this._tmpCtx.clip(nt),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=P.css,this._tmpCtx.strokeText(H,Re,Re+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(z){let Q=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),me=Q%2==1?.5:0;this._tmpCtx.lineWidth=Q,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(Re,Re+me),this._tmpCtx.lineTo(Re+this._config.deviceCharWidth*kt,Re+me),this._tmpCtx.stroke()}if(qe||this._tmpCtx.fillText(H,Re,Re+this._config.deviceCharHeight),H==="_"&&!this._config.allowTransparency){let Q=v(this._tmpCtx.getImageData(Re,Re,this._config.deviceCellWidth,this._config.deviceCellHeight),P,Be,sr);if(Q)for(let me=1;me<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=P.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(H,Re,Re+this._config.deviceCharHeight-me),Q=v(this._tmpCtx.getImageData(Re,Re,this._config.deviceCellWidth,this._config.deviceCellHeight),P,Be,sr),Q);me++);}if(ae){let Q=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),me=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=Q,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(Re,Re+Math.floor(this._config.deviceCharHeight/2)-me),this._tmpCtx.lineTo(Re+this._config.deviceCharWidth*kt,Re+Math.floor(this._config.deviceCharHeight/2)-me),this._tmpCtx.stroke()}this._tmpCtx.restore();let dr=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height),dt;if(dt=this._config.allowTransparency?function(Q){for(let me=0;me<Q.data.length;me+=4)if(Q.data[me+3]>0)return!1;return!0}(dr):v(dr,P,Be,sr),dt)return D;let ce=this._findGlyphBoundingBox(dr,this._workBoundingBox,W,rt,qe,Re),ue,re;for(;;){if(this._activePages.length===0){let Q=this._createNewPage();ue=Q,re=Q.currentRow,re.height=ce.size.y;break}ue=this._activePages[this._activePages.length-1],re=ue.currentRow;for(let Q of this._activePages)ce.size.y<=Q.currentRow.height&&(ue=Q,re=Q.currentRow);for(let Q=this._activePages.length-1;Q>=0;Q--)for(let me of this._activePages[Q].fixedRows)me.height<=re.height&&ce.size.y<=me.height&&(ue=this._activePages[Q],re=me);if(re.y+ce.size.y>=ue.canvas.height||re.height>ce.size.y+2){let Q=!1;if(ue.currentRow.y+ue.currentRow.height+ce.size.y>=ue.canvas.height){let me;for(let $e of this._activePages)if($e.currentRow.y+$e.currentRow.height+ce.size.y<$e.canvas.height){me=$e;break}if(me)ue=me;else if(b.maxAtlasPages&&this._pages.length>=b.maxAtlasPages&&re.y+ce.size.y<=ue.canvas.height&&re.height>=ce.size.y&&re.x+ce.size.x<=ue.canvas.width)Q=!0;else{let $e=this._createNewPage();ue=$e,re=$e.currentRow,re.height=ce.size.y,Q=!0}}Q||(ue.currentRow.height>0&&ue.fixedRows.push(ue.currentRow),re={x:0,y:ue.currentRow.y+ue.currentRow.height,height:ce.size.y},ue.fixedRows.push(re),ue.currentRow={x:0,y:re.y+re.height,height:0})}if(re.x+ce.size.x<=ue.canvas.width)break;re===ue.currentRow?(re.x=0,re.y+=re.height,re.height=0):ue.fixedRows.splice(ue.fixedRows.indexOf(re),1)}return ce.texturePage=this._pages.indexOf(ue),ce.texturePosition.x=re.x,ce.texturePosition.y=re.y,ce.texturePositionClipSpace.x=re.x/ue.canvas.width,ce.texturePositionClipSpace.y=re.y/ue.canvas.height,ce.sizeClipSpace.x/=ue.canvas.width,ce.sizeClipSpace.y/=ue.canvas.height,re.height=Math.max(re.height,ce.size.y),re.x+=ce.size.x,ue.ctx.putImageData(dr,ce.texturePosition.x-this._workBoundingBox.left,ce.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,ce.size.x,ce.size.y),ue.addGlyph(ce),ue.version++,ce}_findGlyphBoundingBox(T,w,x,I,R,H){w.top=0;let W=I?this._config.deviceCellHeight:this._tmpCanvas.height,E=I?this._config.deviceCellWidth:x,L=!1;for(let A=0;A<W;A++){for(let O=0;O<E;O++){let U=A*this._tmpCanvas.width*4+4*O+3;if(T.data[U]!==0){w.top=A,L=!0;break}}if(L)break}w.left=0,L=!1;for(let A=0;A<H+E;A++){for(let O=0;O<W;O++){let U=O*this._tmpCanvas.width*4+4*A+3;if(T.data[U]!==0){w.left=A,L=!0;break}}if(L)break}w.right=E,L=!1;for(let A=H+E-1;A>=H;A--){for(let O=0;O<W;O++){let U=O*this._tmpCanvas.width*4+4*A+3;if(T.data[U]!==0){w.right=A,L=!0;break}}if(L)break}w.bottom=W,L=!1;for(let A=W-1;A>=0;A--){for(let O=0;O<E;O++){let U=A*this._tmpCanvas.width*4+4*O+3;if(T.data[U]!==0){w.bottom=A,L=!0;break}}if(L)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:w.right-w.left+1,y:w.bottom-w.top+1},sizeClipSpace:{x:w.right-w.left+1,y:w.bottom-w.top+1},offset:{x:-w.left+H+(I||R?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-w.top+H+(I||R?this._config.lineHeight===1?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}n.TextureAtlas=b,f([_.traceCall],b.prototype,"_drawToCache",null);class S{get percentageUsed(){return this._usedPixels/(this.canvas.width*this.canvas.height)}get glyphs(){return this._glyphs}addGlyph(T){this._glyphs.push(T),this._usedPixels+=T.size.x*T.size.y}constructor(T,w,x){if(this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],x)for(let I of x)this._glyphs.push(...I.glyphs),this._usedPixels+=I._usedPixels;this.canvas=y(T,w,w),this.ctx=(0,p.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}function v(M,T,w,x){let I=T.rgba>>>24,R=T.rgba>>>16&255,H=T.rgba>>>8&255,W=w.rgba>>>24,E=w.rgba>>>16&255,L=w.rgba>>>8&255,A=Math.floor((Math.abs(I-W)+Math.abs(R-E)+Math.abs(H-L))/12),O=!0;for(let U=0;U<M.data.length;U+=4)M.data[U]===I&&M.data[U+1]===R&&M.data[U+2]===H||x&&Math.abs(M.data[U]-I)+Math.abs(M.data[U+1]-R)+Math.abs(M.data[U+2]-H)<A?M.data[U+3]=0:O=!1;return O}function y(M,T,w){let x=M.createElement("canvas");return x.width=T,x.height=w,x}},160:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.contrastRatio=n.toPaddedHex=n.rgba=n.rgb=n.css=n.color=n.channels=n.NULL_COLOR=void 0;let f=u(399),s=0,i=0,p=0,m=0;var g,l,r,o,c;function _(C){let b=C.toString(16);return b.length<2?"0"+b:b}function D(C,b){return C<b?(b+.05)/(C+.05):(C+.05)/(b+.05)}n.NULL_COLOR={css:"#00000000",rgba:0},function(C){C.toCss=function(b,S,v,y){return y!==void 0?`#${_(b)}${_(S)}${_(v)}${_(y)}`:`#${_(b)}${_(S)}${_(v)}`},C.toRgba=function(b,S,v,y=255){return(b<<24|S<<16|v<<8|y)>>>0}}(g||(n.channels=g={})),function(C){function b(S,v){return m=Math.round(255*v),[s,i,p]=c.toChannels(S.rgba),{css:g.toCss(s,i,p,m),rgba:g.toRgba(s,i,p,m)}}C.blend=function(S,v){if(m=(255&v.rgba)/255,m===1)return{css:v.css,rgba:v.rgba};let y=v.rgba>>24&255,M=v.rgba>>16&255,T=v.rgba>>8&255,w=S.rgba>>24&255,x=S.rgba>>16&255,I=S.rgba>>8&255;return s=w+Math.round((y-w)*m),i=x+Math.round((M-x)*m),p=I+Math.round((T-I)*m),{css:g.toCss(s,i,p),rgba:g.toRgba(s,i,p)}},C.isOpaque=function(S){return(255&S.rgba)==255},C.ensureContrastRatio=function(S,v,y){let M=c.ensureContrastRatio(S.rgba,v.rgba,y);if(M)return c.toColor(M>>24&255,M>>16&255,M>>8&255)},C.opaque=function(S){let v=(255|S.rgba)>>>0;return[s,i,p]=c.toChannels(v),{css:g.toCss(s,i,p),rgba:v}},C.opacity=b,C.multiplyOpacity=function(S,v){return m=255&S.rgba,b(S,m*v/255)},C.toColorRGB=function(S){return[S.rgba>>24&255,S.rgba>>16&255,S.rgba>>8&255]}}(l||(n.color=l={})),function(C){let b,S;if(!f.isNode){let v=document.createElement("canvas");v.width=1,v.height=1;let y=v.getContext("2d",{willReadFrequently:!0});y&&(b=y,b.globalCompositeOperation="copy",S=b.createLinearGradient(0,0,1,1))}C.toColor=function(v){if(v.match(/#[\da-f]{3,8}/i))switch(v.length){case 4:return s=parseInt(v.slice(1,2).repeat(2),16),i=parseInt(v.slice(2,3).repeat(2),16),p=parseInt(v.slice(3,4).repeat(2),16),c.toColor(s,i,p);case 5:return s=parseInt(v.slice(1,2).repeat(2),16),i=parseInt(v.slice(2,3).repeat(2),16),p=parseInt(v.slice(3,4).repeat(2),16),m=parseInt(v.slice(4,5).repeat(2),16),c.toColor(s,i,p,m);case 7:return{css:v,rgba:(parseInt(v.slice(1),16)<<8|255)>>>0};case 9:return{css:v,rgba:parseInt(v.slice(1),16)>>>0}}let y=v.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(y)return s=parseInt(y[1]),i=parseInt(y[2]),p=parseInt(y[3]),m=Math.round(255*(y[5]===void 0?1:parseFloat(y[5]))),c.toColor(s,i,p,m);if(!b||!S)throw new Error("css.toColor: Unsupported css format");if(b.fillStyle=S,b.fillStyle=v,typeof b.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(b.fillRect(0,0,1,1),[s,i,p,m]=b.getImageData(0,0,1,1).data,m!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:g.toRgba(s,i,p,m),css:v}}}(r||(n.css=r={})),function(C){function b(S,v,y){let M=S/255,T=v/255,w=y/255;return .2126*(M<=.03928?M/12.92:Math.pow((M+.055)/1.055,2.4))+.7152*(T<=.03928?T/12.92:Math.pow((T+.055)/1.055,2.4))+.0722*(w<=.03928?w/12.92:Math.pow((w+.055)/1.055,2.4))}C.relativeLuminance=function(S){return b(S>>16&255,S>>8&255,255&S)},C.relativeLuminance2=b}(o||(n.rgb=o={})),function(C){function b(v,y,M){let T=v>>24&255,w=v>>16&255,x=v>>8&255,I=y>>24&255,R=y>>16&255,H=y>>8&255,W=D(o.relativeLuminance2(I,R,H),o.relativeLuminance2(T,w,x));for(;W<M&&(I>0||R>0||H>0);)I-=Math.max(0,Math.ceil(.1*I)),R-=Math.max(0,Math.ceil(.1*R)),H-=Math.max(0,Math.ceil(.1*H)),W=D(o.relativeLuminance2(I,R,H),o.relativeLuminance2(T,w,x));return(I<<24|R<<16|H<<8|255)>>>0}function S(v,y,M){let T=v>>24&255,w=v>>16&255,x=v>>8&255,I=y>>24&255,R=y>>16&255,H=y>>8&255,W=D(o.relativeLuminance2(I,R,H),o.relativeLuminance2(T,w,x));for(;W<M&&(I<255||R<255||H<255);)I=Math.min(255,I+Math.ceil(.1*(255-I))),R=Math.min(255,R+Math.ceil(.1*(255-R))),H=Math.min(255,H+Math.ceil(.1*(255-H))),W=D(o.relativeLuminance2(I,R,H),o.relativeLuminance2(T,w,x));return(I<<24|R<<16|H<<8|255)>>>0}C.ensureContrastRatio=function(v,y,M){let T=o.relativeLuminance(v>>8),w=o.relativeLuminance(y>>8);if(D(T,w)<M){if(w<T){let R=b(v,y,M),H=D(T,o.relativeLuminance(R>>8));if(H<M){let W=S(v,y,M);return H>D(T,o.relativeLuminance(W>>8))?R:W}return R}let x=S(v,y,M),I=D(T,o.relativeLuminance(x>>8));if(I<M){let R=b(v,y,M);return I>D(T,o.relativeLuminance(R>>8))?x:R}return x}},C.reduceLuminance=b,C.increaseLuminance=S,C.toChannels=function(v){return[v>>24&255,v>>16&255,v>>8&255,255&v]},C.toColor=function(v,y,M,T){return{css:g.toCss(v,y,M,T),rgba:g.toRgba(v,y,M,T)}}}(c||(n.rgba=c={})),n.toPaddedHex=_,n.contrastRatio=D},345:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.forwardEvent=n.EventEmitter=void 0,n.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=u=>(this._listeners.push(u),{dispose:()=>{if(!this._disposed){for(let f=0;f<this._listeners.length;f++)if(this._listeners[f]===u)return void this._listeners.splice(f,1)}}})),this._event}fire(u,f){let s=[];for(let i=0;i<this._listeners.length;i++)s.push(this._listeners[i]);for(let i=0;i<s.length;i++)s[i].call(void 0,u,f)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},n.forwardEvent=function(u,f){return u(s=>f.fire(s))}},859:(h,n)=>{function u(f){for(let s of f)s.dispose();f.length=0}Object.defineProperty(n,"__esModule",{value:!0}),n.getDisposeArrayDisposable=n.disposeArray=n.toDisposable=n.MutableDisposable=n.Disposable=void 0,n.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let f of this._disposables)f.dispose();this._disposables.length=0}register(f){return this._disposables.push(f),f}unregister(f){let s=this._disposables.indexOf(f);s!==-1&&this._disposables.splice(s,1)}},n.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(f){var s;this._isDisposed||f===this._value||((s=this._value)===null||s===void 0||s.dispose(),this._value=f)}clear(){this.value=void 0}dispose(){var f;this._isDisposed=!0,(f=this._value)===null||f===void 0||f.dispose(),this._value=void 0}},n.toDisposable=function(f){return{dispose:f}},n.disposeArray=u,n.getDisposeArrayDisposable=function(f){return{dispose:()=>u(f)}}},485:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FourKeyMap=n.TwoKeyMap=void 0;class u{constructor(){this._data={}}set(s,i,p){this._data[s]||(this._data[s]={}),this._data[s][i]=p}get(s,i){return this._data[s]?this._data[s][i]:void 0}clear(){this._data={}}}n.TwoKeyMap=u,n.FourKeyMap=class{constructor(){this._data=new u}set(f,s,i,p,m){this._data.get(f,s)||this._data.set(f,s,new u),this._data.get(f,s).set(i,p,m)}get(f,s,i,p){var m;return(m=this._data.get(f,s))===null||m===void 0?void 0:m.get(i,p)}clear(){this._data.clear()}}},399:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isChromeOS=n.isLinux=n.isWindows=n.isIphone=n.isIpad=n.isMac=n.getSafariVersion=n.isSafari=n.isLegacyEdge=n.isFirefox=n.isNode=void 0,n.isNode=typeof navigator>"u";let u=n.isNode?"node":navigator.userAgent,f=n.isNode?"node":navigator.platform;n.isFirefox=u.includes("Firefox"),n.isLegacyEdge=u.includes("Edge"),n.isSafari=/^((?!chrome|android).)*safari/i.test(u),n.getSafariVersion=function(){if(!n.isSafari)return 0;let s=u.match(/Version\/(\d+)/);return s===null||s.length<2?0:parseInt(s[1])},n.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(f),n.isIpad=f==="iPad",n.isIphone=f==="iPhone",n.isWindows=["Windows","Win16","Win32","WinCE"].includes(f),n.isLinux=f.indexOf("Linux")>=0,n.isChromeOS=/\bCrOS\b/.test(u)},385:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DebouncedIdleTask=n.IdleTaskQueue=n.PriorityTaskQueue=void 0;let f=u(399);class s{constructor(){this._tasks=[],this._i=0}enqueue(m){this._tasks.push(m),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(m){this._idleCallback=void 0;let g=0,l=0,r=m.timeRemaining(),o=0;for(;this._i<this._tasks.length;){if(g=Date.now(),this._tasks[this._i]()||this._i++,g=Math.max(1,Date.now()-g),l=Math.max(g,l),o=m.timeRemaining(),1.5*l>o)return r-g<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(r-g))}ms`),void this._start();r=o}this.clear()}}class i extends s{_requestCallback(m){return setTimeout(()=>m(this._createDeadline(16)))}_cancelCallback(m){clearTimeout(m)}_createDeadline(m){let g=Date.now()+m;return{timeRemaining:()=>Math.max(0,g-Date.now())}}}n.PriorityTaskQueue=i,n.IdleTaskQueue=!f.isNode&&"requestIdleCallback"in window?class extends s{_requestCallback(p){return requestIdleCallback(p)}_cancelCallback(p){cancelIdleCallback(p)}}:i,n.DebouncedIdleTask=class{constructor(){this._queue=new n.IdleTaskQueue}set(p){this._queue.clear(),this._queue.enqueue(p)}flush(){this._queue.flush()}}},147:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ExtendedAttrs=n.AttributeData=void 0;class u{constructor(){this.fg=0,this.bg=0,this.extended=new f}static toColorRGB(i){return[i>>>16&255,i>>>8&255,255&i]}static fromColorRGB(i){return(255&i[0])<<16|(255&i[1])<<8|255&i[2]}clone(){let i=new u;return i.fg=this.fg,i.bg=this.bg,i.extended=this.extended.clone(),i}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}n.AttributeData=u;class f{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(i){this._ext=i}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(i){this._ext&=-469762049,this._ext|=i<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(i){this._ext&=-67108864,this._ext|=67108863&i}get urlId(){return this._urlId}set urlId(i){this._urlId=i}constructor(i=0,p=0){this._ext=0,this._urlId=0,this._ext=i,this._urlId=p}clone(){return new f(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}n.ExtendedAttrs=f},782:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CellData=void 0;let f=u(133),s=u(855),i=u(147);class p extends i.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new i.ExtendedAttrs,this.combinedData=""}static fromCharData(g){let l=new p;return l.setFromCharData(g),l}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,f.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(g){this.fg=g[s.CHAR_DATA_ATTR_INDEX],this.bg=0;let l=!1;if(g[s.CHAR_DATA_CHAR_INDEX].length>2)l=!0;else if(g[s.CHAR_DATA_CHAR_INDEX].length===2){let r=g[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=r&&r<=56319){let o=g[s.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=o&&o<=57343?this.content=1024*(r-55296)+o-56320+65536|g[s.CHAR_DATA_WIDTH_INDEX]<<22:l=!0}else l=!0}else this.content=g[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|g[s.CHAR_DATA_WIDTH_INDEX]<<22;l&&(this.combinedData=g[s.CHAR_DATA_CHAR_INDEX],this.content=2097152|g[s.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}n.CellData=p},855:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WHITESPACE_CELL_CODE=n.WHITESPACE_CELL_WIDTH=n.WHITESPACE_CELL_CHAR=n.NULL_CELL_CODE=n.NULL_CELL_WIDTH=n.NULL_CELL_CHAR=n.CHAR_DATA_CODE_INDEX=n.CHAR_DATA_WIDTH_INDEX=n.CHAR_DATA_CHAR_INDEX=n.CHAR_DATA_ATTR_INDEX=n.DEFAULT_EXT=n.DEFAULT_ATTR=n.DEFAULT_COLOR=void 0,n.DEFAULT_COLOR=0,n.DEFAULT_ATTR=256|n.DEFAULT_COLOR<<9,n.DEFAULT_EXT=0,n.CHAR_DATA_ATTR_INDEX=0,n.CHAR_DATA_CHAR_INDEX=1,n.CHAR_DATA_WIDTH_INDEX=2,n.CHAR_DATA_CODE_INDEX=3,n.NULL_CELL_CHAR="",n.NULL_CELL_WIDTH=1,n.NULL_CELL_CODE=0,n.WHITESPACE_CELL_CHAR=" ",n.WHITESPACE_CELL_WIDTH=1,n.WHITESPACE_CELL_CODE=32},133:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Utf8ToUtf32=n.StringToUtf32=n.utf32ToString=n.stringFromCodePoint=void 0,n.stringFromCodePoint=function(u){return u>65535?(u-=65536,String.fromCharCode(55296+(u>>10))+String.fromCharCode(u%1024+56320)):String.fromCharCode(u)},n.utf32ToString=function(u,f=0,s=u.length){let i="";for(let p=f;p<s;++p){let m=u[p];m>65535?(m-=65536,i+=String.fromCharCode(55296+(m>>10))+String.fromCharCode(m%1024+56320)):i+=String.fromCharCode(m)}return i},n.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(u,f){let s=u.length;if(!s)return 0;let i=0,p=0;if(this._interim){let m=u.charCodeAt(p++);56320<=m&&m<=57343?f[i++]=1024*(this._interim-55296)+m-56320+65536:(f[i++]=this._interim,f[i++]=m),this._interim=0}for(let m=p;m<s;++m){let g=u.charCodeAt(m);if(55296<=g&&g<=56319){if(++m>=s)return this._interim=g,i;let l=u.charCodeAt(m);56320<=l&&l<=57343?f[i++]=1024*(g-55296)+l-56320+65536:(f[i++]=g,f[i++]=l)}else g!==65279&&(f[i++]=g)}return i}},n.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(u,f){let s=u.length;if(!s)return 0;let i,p,m,g,l=0,r=0,o=0;if(this.interim[0]){let D=!1,C=this.interim[0];C&=(224&C)==192?31:(240&C)==224?15:7;let b,S=0;for(;(b=63&this.interim[++S])&&S<4;)C<<=6,C|=b;let v=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,y=v-S;for(;o<y;){if(o>=s)return 0;if(b=u[o++],(192&b)!=128){o--,D=!0;break}this.interim[S++]=b,C<<=6,C|=63&b}D||(v===2?C<128?o--:f[l++]=C:v===3?C<2048||C>=55296&&C<=57343||C===65279||(f[l++]=C):C<65536||C>1114111||(f[l++]=C)),this.interim.fill(0)}let c=s-4,_=o;for(;_<s;){for(;!(!(_<c)||128&(i=u[_])||128&(p=u[_+1])||128&(m=u[_+2])||128&(g=u[_+3]));)f[l++]=i,f[l++]=p,f[l++]=m,f[l++]=g,_+=4;if(i=u[_++],i<128)f[l++]=i;else if((224&i)==192){if(_>=s)return this.interim[0]=i,l;if(p=u[_++],(192&p)!=128){_--;continue}if(r=(31&i)<<6|63&p,r<128){_--;continue}f[l++]=r}else if((240&i)==224){if(_>=s)return this.interim[0]=i,l;if(p=u[_++],(192&p)!=128){_--;continue}if(_>=s)return this.interim[0]=i,this.interim[1]=p,l;if(m=u[_++],(192&m)!=128){_--;continue}if(r=(15&i)<<12|(63&p)<<6|63&m,r<2048||r>=55296&&r<=57343||r===65279)continue;f[l++]=r}else if((248&i)==240){if(_>=s)return this.interim[0]=i,l;if(p=u[_++],(192&p)!=128){_--;continue}if(_>=s)return this.interim[0]=i,this.interim[1]=p,l;if(m=u[_++],(192&m)!=128){_--;continue}if(_>=s)return this.interim[0]=i,this.interim[1]=p,this.interim[2]=m,l;if(g=u[_++],(192&g)!=128){_--;continue}if(r=(7&i)<<18|(63&p)<<12|(63&m)<<6|63&g,r<65536||r>1114111)continue;f[l++]=r}}return l}}},776:function(h,n,u){var f=this&&this.__decorate||function(r,o,c,_){var D,C=arguments.length,b=C<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,c):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,o,c,_);else for(var S=r.length-1;S>=0;S--)(D=r[S])&&(b=(C<3?D(b):C>3?D(o,c,b):D(o,c))||b);return C>3&&b&&Object.defineProperty(o,c,b),b},s=this&&this.__param||function(r,o){return function(c,_){o(c,_,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.traceCall=n.setTraceLogger=n.LogService=void 0;let i=u(859),p=u(97),m={trace:p.LogLevelEnum.TRACE,debug:p.LogLevelEnum.DEBUG,info:p.LogLevelEnum.INFO,warn:p.LogLevelEnum.WARN,error:p.LogLevelEnum.ERROR,off:p.LogLevelEnum.OFF},g,l=n.LogService=class extends i.Disposable{get logLevel(){return this._logLevel}constructor(r){super(),this._optionsService=r,this._logLevel=p.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),g=this}_updateLogLevel(){this._logLevel=m[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(r){for(let o=0;o<r.length;o++)typeof r[o]=="function"&&(r[o]=r[o]())}_log(r,o,c){this._evalLazyOptionalParams(c),r.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+o,...c)}trace(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.TRACE&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.trace.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.log,r,o)}debug(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.DEBUG&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.debug.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.log,r,o)}info(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.INFO&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.info.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.info,r,o)}warn(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.WARN&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.warn.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.warn,r,o)}error(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.ERROR&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.error.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.error,r,o)}};n.LogService=l=f([s(0,p.IOptionsService)],l),n.setTraceLogger=function(r){g=r},n.traceCall=function(r,o,c){if(typeof c.value!="function")throw new Error("not supported");let _=c.value;c.value=function(...D){if(g.logLevel!==p.LogLevelEnum.TRACE)return _.apply(this,D);g.trace(`GlyphRenderer#${_.name}(${D.map(b=>JSON.stringify(b)).join(", ")})`);let C=_.apply(this,D);return g.trace(`GlyphRenderer#${_.name} return`,C),C}}},726:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createDecorator=n.getServiceDependencies=n.serviceRegistry=void 0;let u="di$target",f="di$dependencies";n.serviceRegistry=new Map,n.getServiceDependencies=function(s){return s[f]||[]},n.createDecorator=function(s){if(n.serviceRegistry.has(s))return n.serviceRegistry.get(s);let i=function(p,m,g){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(l,r,o){r[u]===r?r[f].push({id:l,index:o}):(r[f]=[{id:l,index:o}],r[u]=r)})(i,p,g)};return i.toString=()=>s,n.serviceRegistry.set(s,i),i}},97:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IDecorationService=n.IUnicodeService=n.IOscLinkService=n.IOptionsService=n.ILogService=n.LogLevelEnum=n.IInstantiationService=n.ICharsetService=n.ICoreService=n.ICoreMouseService=n.IBufferService=void 0;let f=u(726);var s;n.IBufferService=(0,f.createDecorator)("BufferService"),n.ICoreMouseService=(0,f.createDecorator)("CoreMouseService"),n.ICoreService=(0,f.createDecorator)("CoreService"),n.ICharsetService=(0,f.createDecorator)("CharsetService"),n.IInstantiationService=(0,f.createDecorator)("InstantiationService"),function(i){i[i.TRACE=0]="TRACE",i[i.DEBUG=1]="DEBUG",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.OFF=5]="OFF"}(s||(n.LogLevelEnum=s={})),n.ILogService=(0,f.createDecorator)("LogService"),n.IOptionsService=(0,f.createDecorator)("OptionsService"),n.IOscLinkService=(0,f.createDecorator)("OscLinkService"),n.IUnicodeService=(0,f.createDecorator)("UnicodeService"),n.IDecorationService=(0,f.createDecorator)("DecorationService")}},t={};function a(h){var n=t[h];if(n!==void 0)return n.exports;var u=t[h]={exports:{}};return e[h].call(u.exports,u,u.exports,a),u.exports}var d={};return(()=>{var h=d;Object.defineProperty(h,"__esModule",{value:!0}),h.WebglAddon=void 0;let n=a(345),u=a(859),f=a(399),s=a(666),i=a(776);class p extends u.Disposable{constructor(g){if(f.isSafari&&(0,f.getSafariVersion)()<16)throw new Error("Webgl2 is only supported on Safari 16 and above");super(),this._preserveDrawingBuffer=g,this._onChangeTextureAtlas=this.register(new n.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new n.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new n.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onContextLoss=this.register(new n.EventEmitter),this.onContextLoss=this._onContextLoss.event}activate(g){let l=g._core;if(!g.element)return void this.register(l.onWillOpen(()=>this.activate(g)));this._terminal=g;let r=l.coreService,o=l.optionsService,c=l,_=c._renderService,D=c._characterJoinerService,C=c._charSizeService,b=c._coreBrowserService,S=c._decorationService,v=c._logService,y=c._themeService;(0,i.setTraceLogger)(v),this._renderer=this.register(new s.WebglRenderer(g,D,C,b,r,S,o,y,this._preserveDrawingBuffer)),this.register((0,n.forwardEvent)(this._renderer.onContextLoss,this._onContextLoss)),this.register((0,n.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,n.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),this.register((0,n.forwardEvent)(this._renderer.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)),_.setRenderer(this._renderer),this.register((0,u.toDisposable)(()=>{let M=this._terminal._core._renderService;M.setRenderer(this._terminal._core._createRenderer()),M.handleResize(g.cols,g.rows)}))}get textureAtlas(){var g;return(g=this._renderer)===null||g===void 0?void 0:g.textureAtlas}clearTextureAtlas(){var g;(g=this._renderer)===null||g===void 0||g.clearTextureAtlas()}}h.WebglAddon=p})(),d})())});var ib=Cs((xl,$v)=>{(function(e,t){typeof xl=="object"&&typeof $v=="object"?$v.exports=t():typeof define=="function"&&define.amd?define([],t):typeof xl=="object"?xl.WebLinksAddon=t():e.WebLinksAddon=t()})(self,()=>(()=>{"use strict";var e={6:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.LinkComputer=n.WebLinkProvider=void 0,n.WebLinkProvider=class{constructor(f,s,i,p={}){this._terminal=f,this._regex=s,this._handler=i,this._options=p}provideLinks(f,s){let i=u.computeLink(f,this._regex,this._terminal,this._handler);s(this._addCallbacks(i))}_addCallbacks(f){return f.map(s=>(s.leave=this._options.leave,s.hover=(i,p)=>{if(this._options.hover){let{range:m}=s;this._options.hover(i,p,m)}},s))}};class u{static computeLink(s,i,p,m){let g=new RegExp(i.source,(i.flags||"")+"g"),[l,r]=u._getWindowedLineStrings(s-1,p),o=l.join(""),c,_=[];for(;c=g.exec(o);){let D=c[0];try{let M=new URL(D),T=decodeURI(M.toString());if(D!==T&&D+"/"!==T)continue}catch{continue}let[C,b]=u._mapStrIdx(p,r,0,c.index),[S,v]=u._mapStrIdx(p,C,b,D.length);if(C===-1||b===-1||S===-1||v===-1)continue;let y={start:{x:b+1,y:C+1},end:{x:v,y:S+1}};_.push({range:y,text:D,activate:m})}return _}static _getWindowedLineStrings(s,i){let p,m=s,g=s,l=0,r="",o=[];if(p=i.buffer.active.getLine(s)){let c=p.translateToString(!0);if(p.isWrapped&&c[0]!==" "){for(l=0;(p=i.buffer.active.getLine(--m))&&l<2048&&(r=p.translateToString(!0),l+=r.length,o.push(r),p.isWrapped&&r.indexOf(" ")===-1););o.reverse()}for(o.push(c),l=0;(p=i.buffer.active.getLine(++g))&&p.isWrapped&&l<2048&&(r=p.translateToString(!0),l+=r.length,o.push(r),r.indexOf(" ")===-1););}return[o,m]}static _mapStrIdx(s,i,p,m){let g=s.buffer.active,l=g.getNullCell(),r=p;for(;m;){let o=g.getLine(i);if(!o)return[-1,-1];for(let c=r;c<o.length;++c){o.getCell(c,l);let _=l.getChars();if(l.getWidth()&&(m-=_.length||1,c===o.length-1&&_==="")){let D=g.getLine(i+1);D&&D.isWrapped&&(D.getCell(0,l),l.getWidth()===2&&(m+=1))}if(m<0)return[i,c]}i++,r=0}return[i,r]}}n.LinkComputer=u}},t={};function a(h){var n=t[h];if(n!==void 0)return n.exports;var u=t[h]={exports:{}};return e[h](u,u.exports,a),u.exports}var d={};return(()=>{var h=d;Object.defineProperty(h,"__esModule",{value:!0}),h.WebLinksAddon=void 0;let n=a(6),u=/https?:[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function f(s,i){let p=window.open();if(p){try{p.opener=null}catch{}p.location.href=i}else console.warn("Opening link blocked as opener could not be cleared")}h.WebLinksAddon=class{constructor(s=f,i={}){this._handler=s,this._options=i}activate(s){this._terminal=s;let i=this._options,p=i.urlRegex||u;this._linkProvider=this._terminal.registerLinkProvider(new n.WebLinkProvider(this._terminal,p,this._handler,i))}dispose(){var s;(s=this._linkProvider)===null||s===void 0||s.dispose()}}})(),d})())});var pb=Cs((Rl,Vv)=>{(function(e,t){if(typeof Rl=="object"&&typeof Vv=="object")Vv.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var a=t();for(var d in a)(typeof Rl=="object"?Rl:e)[d]=a[d]}})(self,()=>(()=>{"use strict";var e={4567:function(h,n,u){var f=this&&this.__decorate||function(_,D,C,b){var S,v=arguments.length,y=v<3?D:b===null?b=Object.getOwnPropertyDescriptor(D,C):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(_,D,C,b);else for(var M=_.length-1;M>=0;M--)(S=_[M])&&(y=(v<3?S(y):v>3?S(D,C,y):S(D,C))||y);return v>3&&y&&Object.defineProperty(D,C,y),y},s=this&&this.__param||function(_,D){return function(C,b){D(C,b,_)}};Object.defineProperty(n,"__esModule",{value:!0}),n.AccessibilityManager=void 0;let i=u(9042),p=u(6114),m=u(9924),g=u(844),l=u(5596),r=u(4725),o=u(3656),c=n.AccessibilityManager=class extends g.Disposable{constructor(_,D){super(),this._terminal=_,this._renderService=D,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let C=0;C<this._terminal.rows;C++)this._rowElements[C]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[C]);if(this._topBoundaryFocusListener=C=>this._handleBoundaryFocus(C,0),this._bottomBoundaryFocusListener=C=>this._handleBoundaryFocus(C,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new m.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(C=>this._handleResize(C.rows))),this.register(this._terminal.onRender(C=>this._refreshRows(C.start,C.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(C=>this._handleChar(C))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(C=>this._handleTab(C))),this.register(this._terminal.onKey(C=>this._handleKey(C.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new l.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,o.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,g.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(_){for(let D=0;D<_;D++)this._handleChar(" ")}_handleChar(_){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==_&&(this._charsToAnnounce+=_):this._charsToAnnounce+=_,_===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=i.tooMuchOutput)),p.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,p.isMac&&this._liveRegion.remove()}_handleKey(_){this._clearLiveRegion(),/\p{Control}/u.test(_)||this._charsToConsume.push(_)}_refreshRows(_,D){this._liveRegionDebouncer.refresh(_,D,this._terminal.rows)}_renderRows(_,D){let C=this._terminal.buffer,b=C.lines.length.toString();for(let S=_;S<=D;S++){let v=C.translateBufferLineToString(C.ydisp+S,!0),y=(C.ydisp+S+1).toString(),M=this._rowElements[S];M&&(v.length===0?M.innerText="\xA0":M.textContent=v,M.setAttribute("aria-posinset",y),M.setAttribute("aria-setsize",b))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(_,D){let C=_.target,b=this._rowElements[D===0?1:this._rowElements.length-2];if(C.getAttribute("aria-posinset")===(D===0?"1":`${this._terminal.buffer.lines.length}`)||_.relatedTarget!==b)return;let S,v;if(D===0?(S=C,v=this._rowElements.pop(),this._rowContainer.removeChild(v)):(S=this._rowElements.shift(),v=C,this._rowContainer.removeChild(S)),S.removeEventListener("focus",this._topBoundaryFocusListener),v.removeEventListener("focus",this._bottomBoundaryFocusListener),D===0){let y=this._createAccessibilityTreeNode();this._rowElements.unshift(y),this._rowContainer.insertAdjacentElement("afterbegin",y)}else{let y=this._createAccessibilityTreeNode();this._rowElements.push(y),this._rowContainer.appendChild(y)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(D===0?-1:1),this._rowElements[D===0?1:this._rowElements.length-2].focus(),_.preventDefault(),_.stopImmediatePropagation()}_handleResize(_){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let D=this._rowContainer.children.length;D<this._terminal.rows;D++)this._rowElements[D]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[D]);for(;this._rowElements.length>_;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){let _=document.createElement("div");return _.setAttribute("role","listitem"),_.tabIndex=-1,this._refreshRowDimensions(_),_}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let _=0;_<this._terminal.rows;_++)this._refreshRowDimensions(this._rowElements[_])}}_refreshRowDimensions(_){_.style.height=`${this._renderService.dimensions.css.cell.height}px`}};n.AccessibilityManager=c=f([s(1,r.IRenderService)],c)},3614:(h,n)=>{function u(p){return p.replace(/\r?\n/g,"\r")}function f(p,m){return m?"\x1B[200~"+p+"\x1B[201~":p}function s(p,m,g,l){p=f(p=u(p),g.decPrivateModes.bracketedPasteMode&&l.rawOptions.ignoreBracketedPasteMode!==!0),g.triggerDataEvent(p,!0),m.value=""}function i(p,m,g){let l=g.getBoundingClientRect(),r=p.clientX-l.left-10,o=p.clientY-l.top-10;m.style.width="20px",m.style.height="20px",m.style.left=`${r}px`,m.style.top=`${o}px`,m.style.zIndex="1000",m.focus()}Object.defineProperty(n,"__esModule",{value:!0}),n.rightClickHandler=n.moveTextAreaUnderMouseCursor=n.paste=n.handlePasteEvent=n.copyHandler=n.bracketTextForPaste=n.prepareTextForTerminal=void 0,n.prepareTextForTerminal=u,n.bracketTextForPaste=f,n.copyHandler=function(p,m){p.clipboardData&&p.clipboardData.setData("text/plain",m.selectionText),p.preventDefault()},n.handlePasteEvent=function(p,m,g,l){p.stopPropagation(),p.clipboardData&&s(p.clipboardData.getData("text/plain"),m,g,l)},n.paste=s,n.moveTextAreaUnderMouseCursor=i,n.rightClickHandler=function(p,m,g,l,r){i(p,m,g),r&&l.rightClickSelect(p),m.value=l.selectionText,m.select()}},7239:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorContrastCache=void 0;let f=u(1505);n.ColorContrastCache=class{constructor(){this._color=new f.TwoKeyMap,this._css=new f.TwoKeyMap}setCss(s,i,p){this._css.set(s,i,p)}getCss(s,i){return this._css.get(s,i)}setColor(s,i,p){this._color.set(s,i,p)}getColor(s,i){return this._color.get(s,i)}clear(){this._color.clear(),this._css.clear()}}},3656:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.addDisposableDomListener=void 0,n.addDisposableDomListener=function(u,f,s,i){u.addEventListener(f,s,i);let p=!1;return{dispose:()=>{p||(p=!0,u.removeEventListener(f,s,i))}}}},6465:function(h,n,u){var f=this&&this.__decorate||function(r,o,c,_){var D,C=arguments.length,b=C<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,c):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,o,c,_);else for(var S=r.length-1;S>=0;S--)(D=r[S])&&(b=(C<3?D(b):C>3?D(o,c,b):D(o,c))||b);return C>3&&b&&Object.defineProperty(o,c,b),b},s=this&&this.__param||function(r,o){return function(c,_){o(c,_,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.Linkifier2=void 0;let i=u(3656),p=u(8460),m=u(844),g=u(2585),l=n.Linkifier2=class extends m.Disposable{get currentLink(){return this._currentLink}constructor(r){super(),this._bufferService=r,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new p.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new p.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,m.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,m.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}registerLinkProvider(r){return this._linkProviders.push(r),{dispose:()=>{let o=this._linkProviders.indexOf(r);o!==-1&&this._linkProviders.splice(o,1)}}}attachToDom(r,o,c){this._element=r,this._mouseService=o,this._renderService=c,this.register((0,i.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,i.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,i.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,i.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(r){if(this._lastMouseEvent=r,!this._element||!this._mouseService)return;let o=this._positionFromMouseEvent(r,this._element,this._mouseService);if(!o)return;this._isMouseOut=!1;let c=r.composedPath();for(let _=0;_<c.length;_++){let D=c[_];if(D.classList.contains("xterm"))break;if(D.classList.contains("xterm-hover"))return}this._lastBufferCell&&o.x===this._lastBufferCell.x&&o.y===this._lastBufferCell.y||(this._handleHover(o),this._lastBufferCell=o)}_handleHover(r){if(this._activeLine!==r.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(r,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,r)||(this._clearCurrentLink(),this._askForLink(r,!0))}_askForLink(r,o){var c,_;this._activeProviderReplies&&o||((c=this._activeProviderReplies)===null||c===void 0||c.forEach(C=>{C?.forEach(b=>{b.link.dispose&&b.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=r.y);let D=!1;for(let[C,b]of this._linkProviders.entries())o?!((_=this._activeProviderReplies)===null||_===void 0)&&_.get(C)&&(D=this._checkLinkProviderResult(C,r,D)):b.provideLinks(r.y,S=>{var v,y;if(this._isMouseOut)return;let M=S?.map(T=>({link:T}));(v=this._activeProviderReplies)===null||v===void 0||v.set(C,M),D=this._checkLinkProviderResult(C,r,D),((y=this._activeProviderReplies)===null||y===void 0?void 0:y.size)===this._linkProviders.length&&this._removeIntersectingLinks(r.y,this._activeProviderReplies)})}_removeIntersectingLinks(r,o){let c=new Set;for(let _=0;_<o.size;_++){let D=o.get(_);if(D)for(let C=0;C<D.length;C++){let b=D[C],S=b.link.range.start.y<r?0:b.link.range.start.x,v=b.link.range.end.y>r?this._bufferService.cols:b.link.range.end.x;for(let y=S;y<=v;y++){if(c.has(y)){D.splice(C--,1);break}c.add(y)}}}}_checkLinkProviderResult(r,o,c){var _;if(!this._activeProviderReplies)return c;let D=this._activeProviderReplies.get(r),C=!1;for(let b=0;b<r;b++)this._activeProviderReplies.has(b)&&!this._activeProviderReplies.get(b)||(C=!0);if(!C&&D){let b=D.find(S=>this._linkAtPosition(S.link,o));b&&(c=!0,this._handleNewLink(b))}if(this._activeProviderReplies.size===this._linkProviders.length&&!c)for(let b=0;b<this._activeProviderReplies.size;b++){let S=(_=this._activeProviderReplies.get(b))===null||_===void 0?void 0:_.find(v=>this._linkAtPosition(v.link,o));if(S){c=!0,this._handleNewLink(S);break}}return c}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(r){if(!this._element||!this._mouseService||!this._currentLink)return;let o=this._positionFromMouseEvent(r,this._element,this._mouseService);o&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,o)&&this._currentLink.link.activate(r,this._currentLink.link.text)}_clearCurrentLink(r,o){this._element&&this._currentLink&&this._lastMouseEvent&&(!r||!o||this._currentLink.link.range.start.y>=r&&this._currentLink.link.range.end.y<=o)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,m.disposeArray)(this._linkCacheDisposables))}_handleNewLink(r){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;let o=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);o&&this._linkAtPosition(r.link,o)&&(this._currentLink=r,this._currentLink.state={decorations:{underline:r.link.decorations===void 0||r.link.decorations.underline,pointerCursor:r.link.decorations===void 0||r.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,r.link,this._lastMouseEvent),r.link.decorations={},Object.defineProperties(r.link.decorations,{pointerCursor:{get:()=>{var c,_;return(_=(c=this._currentLink)===null||c===void 0?void 0:c.state)===null||_===void 0?void 0:_.decorations.pointerCursor},set:c=>{var _,D;!((_=this._currentLink)===null||_===void 0)&&_.state&&this._currentLink.state.decorations.pointerCursor!==c&&(this._currentLink.state.decorations.pointerCursor=c,this._currentLink.state.isHovered&&((D=this._element)===null||D===void 0||D.classList.toggle("xterm-cursor-pointer",c)))}},underline:{get:()=>{var c,_;return(_=(c=this._currentLink)===null||c===void 0?void 0:c.state)===null||_===void 0?void 0:_.decorations.underline},set:c=>{var _,D,C;!((_=this._currentLink)===null||_===void 0)&&_.state&&((C=(D=this._currentLink)===null||D===void 0?void 0:D.state)===null||C===void 0?void 0:C.decorations.underline)!==c&&(this._currentLink.state.decorations.underline=c,this._currentLink.state.isHovered&&this._fireUnderlineEvent(r.link,c))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(c=>{if(!this._currentLink)return;let _=c.start===0?0:c.start+1+this._bufferService.buffer.ydisp,D=this._bufferService.buffer.ydisp+1+c.end;if(this._currentLink.link.range.start.y>=_&&this._currentLink.link.range.end.y<=D&&(this._clearCurrentLink(_,D),this._lastMouseEvent&&this._element)){let C=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);C&&this._askForLink(C,!1)}})))}_linkHover(r,o,c){var _;!((_=this._currentLink)===null||_===void 0)&&_.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(o,!0),this._currentLink.state.decorations.pointerCursor&&r.classList.add("xterm-cursor-pointer")),o.hover&&o.hover(c,o.text)}_fireUnderlineEvent(r,o){let c=r.range,_=this._bufferService.buffer.ydisp,D=this._createLinkUnderlineEvent(c.start.x-1,c.start.y-_-1,c.end.x,c.end.y-_-1,void 0);(o?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(D)}_linkLeave(r,o,c){var _;!((_=this._currentLink)===null||_===void 0)&&_.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(o,!1),this._currentLink.state.decorations.pointerCursor&&r.classList.remove("xterm-cursor-pointer")),o.leave&&o.leave(c,o.text)}_linkAtPosition(r,o){let c=r.range.start.y*this._bufferService.cols+r.range.start.x,_=r.range.end.y*this._bufferService.cols+r.range.end.x,D=o.y*this._bufferService.cols+o.x;return c<=D&&D<=_}_positionFromMouseEvent(r,o,c){let _=c.getCoords(r,o,this._bufferService.cols,this._bufferService.rows);if(_)return{x:_[0],y:_[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(r,o,c,_,D){return{x1:r,y1:o,x2:c,y2:_,cols:this._bufferService.cols,fg:D}}};n.Linkifier2=l=f([s(0,g.IBufferService)],l)},9042:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.tooMuchOutput=n.promptLabel=void 0,n.promptLabel="Terminal input",n.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(h,n,u){var f=this&&this.__decorate||function(l,r,o,c){var _,D=arguments.length,C=D<3?r:c===null?c=Object.getOwnPropertyDescriptor(r,o):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(l,r,o,c);else for(var b=l.length-1;b>=0;b--)(_=l[b])&&(C=(D<3?_(C):D>3?_(r,o,C):_(r,o))||C);return D>3&&C&&Object.defineProperty(r,o,C),C},s=this&&this.__param||function(l,r){return function(o,c){r(o,c,l)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OscLinkProvider=void 0;let i=u(511),p=u(2585),m=n.OscLinkProvider=class{constructor(l,r,o){this._bufferService=l,this._optionsService=r,this._oscLinkService=o}provideLinks(l,r){var o;let c=this._bufferService.buffer.lines.get(l-1);if(!c)return void r(void 0);let _=[],D=this._optionsService.rawOptions.linkHandler,C=new i.CellData,b=c.getTrimmedLength(),S=-1,v=-1,y=!1;for(let M=0;M<b;M++)if(v!==-1||c.hasContent(M)){if(c.loadCell(M,C),C.hasExtendedAttrs()&&C.extended.urlId){if(v===-1){v=M,S=C.extended.urlId;continue}y=C.extended.urlId!==S}else v!==-1&&(y=!0);if(y||v!==-1&&M===b-1){let T=(o=this._oscLinkService.getLinkData(S))===null||o===void 0?void 0:o.uri;if(T){let w={start:{x:v+1,y:l},end:{x:M+(y||M!==b-1?0:1),y:l}},x=!1;if(!D?.allowNonHttpProtocols)try{let I=new URL(T);["http:","https:"].includes(I.protocol)||(x=!0)}catch{x=!0}x||_.push({text:T,range:w,activate:(I,R)=>D?D.activate(I,R,w):g(0,R),hover:(I,R)=>{var H;return(H=D?.hover)===null||H===void 0?void 0:H.call(D,I,R,w)},leave:(I,R)=>{var H;return(H=D?.leave)===null||H===void 0?void 0:H.call(D,I,R,w)}})}y=!1,C.hasExtendedAttrs()&&C.extended.urlId?(v=M,S=C.extended.urlId):(v=-1,S=-1)}}r(_)}};function g(l,r){if(confirm(`Do you want to navigate to ${r}?

WARNING: This link could potentially be dangerous`)){let o=window.open();if(o){try{o.opener=null}catch{}o.location.href=r}else console.warn("Opening link blocked as opener could not be cleared")}}n.OscLinkProvider=m=f([s(0,p.IBufferService),s(1,p.IOptionsService),s(2,p.IOscLinkService)],m)},6193:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.RenderDebouncer=void 0,n.RenderDebouncer=class{constructor(u,f){this._parentWindow=u,this._renderCallback=f,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(u){return this._refreshCallbacks.push(u),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(u,f,s){this._rowCount=s,u=u!==void 0?u:0,f=f!==void 0?f:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,u):u,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,f):f,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();let u=Math.max(this._rowStart,0),f=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(u,f),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(let u of this._refreshCallbacks)u(0);this._refreshCallbacks=[]}}},5596:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ScreenDprMonitor=void 0;let f=u(844);class s extends f.Disposable{constructor(p){super(),this._parentWindow=p,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,f.toDisposable)(()=>{this.clearListener()}))}setListener(p){this._listener&&this.clearListener(),this._listener=p,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var p;this._outerListener&&((p=this._resolutionMediaMatchList)===null||p===void 0||p.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}n.ScreenDprMonitor=s},3236:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Terminal=void 0;let f=u(3614),s=u(3656),i=u(6465),p=u(9042),m=u(3730),g=u(1680),l=u(3107),r=u(5744),o=u(2950),c=u(1296),_=u(428),D=u(4269),C=u(5114),b=u(8934),S=u(3230),v=u(9312),y=u(4725),M=u(6731),T=u(8055),w=u(8969),x=u(8460),I=u(844),R=u(6114),H=u(8437),W=u(2584),E=u(7399),L=u(5941),A=u(9074),O=u(2585),U=u(5435),Y=u(4567),ae=typeof window<"u"?window.document:null;class z extends w.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(F={}){super(F),this.browser=R,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new I.MutableDisposable),this._onCursorMove=this.register(new x.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new x.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new x.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new x.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new x.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new x.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new x.EventEmitter),this._onBlur=this.register(new x.EventEmitter),this._onA11yCharEmitter=this.register(new x.EventEmitter),this._onA11yTabEmitter=this.register(new x.EventEmitter),this._onWillOpen=this.register(new x.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(i.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(m.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(A.DecorationService),this._instantiationService.setService(O.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((N,B)=>this.refresh(N,B))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(N=>this._reportWindowsOptions(N))),this.register(this._inputHandler.onColor(N=>this._handleColorEvent(N))),this.register((0,x.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,x.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,x.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,x.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(N=>this._afterResize(N.cols,N.rows))),this.register((0,I.toDisposable)(()=>{var N,B;this._customKeyEventHandler=void 0,(B=(N=this.element)===null||N===void 0?void 0:N.parentNode)===null||B===void 0||B.removeChild(this.element)}))}_handleColorEvent(F){if(this._themeService)for(let N of F){let B,P="";switch(N.index){case 256:B="foreground",P="10";break;case 257:B="background",P="11";break;case 258:B="cursor",P="12";break;default:B="ansi",P="4;"+N.index}switch(N.type){case 0:let le=T.color.toColorRGB(B==="ansi"?this._themeService.colors.ansi[N.index]:this._themeService.colors[B]);this.coreService.triggerDataEvent(`${W.C0.ESC}]${P};${(0,L.toRgbString)(le)}${W.C1_ESCAPED.ST}`);break;case 1:if(B==="ansi")this._themeService.modifyColors(j=>j.ansi[N.index]=T.rgba.toColor(...N.color));else{let j=B;this._themeService.modifyColors(Fe=>Fe[j]=T.rgba.toColor(...N.color))}break;case 2:this._themeService.restoreColor(N.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(F){F?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(Y.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(F){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(W.C0.ESC+"[I"),this.updateCursorStyle(F),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var F;return(F=this.textarea)===null||F===void 0?void 0:F.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(W.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;let F=this.buffer.ybase+this.buffer.y,N=this.buffer.lines.get(F);if(!N)return;let B=Math.min(this.buffer.x,this.cols-1),P=this._renderService.dimensions.css.cell.height,le=N.getWidth(B),j=this._renderService.dimensions.css.cell.width*le,Fe=this.buffer.y*this._renderService.dimensions.css.cell.height,rt=B*this._renderService.dimensions.css.cell.width;this.textarea.style.left=rt+"px",this.textarea.style.top=Fe+"px",this.textarea.style.width=j+"px",this.textarea.style.height=P+"px",this.textarea.style.lineHeight=P+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,s.addDisposableDomListener)(this.element,"copy",N=>{this.hasSelection()&&(0,f.copyHandler)(N,this._selectionService)}));let F=N=>(0,f.handlePasteEvent)(N,this.textarea,this.coreService,this.optionsService);this.register((0,s.addDisposableDomListener)(this.textarea,"paste",F)),this.register((0,s.addDisposableDomListener)(this.element,"paste",F)),R.isFirefox?this.register((0,s.addDisposableDomListener)(this.element,"mousedown",N=>{N.button===2&&(0,f.rightClickHandler)(N,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,s.addDisposableDomListener)(this.element,"contextmenu",N=>{(0,f.rightClickHandler)(N,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),R.isLinux&&this.register((0,s.addDisposableDomListener)(this.element,"auxclick",N=>{N.button===1&&(0,f.moveTextAreaUnderMouseCursor)(N,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,s.addDisposableDomListener)(this.textarea,"keyup",F=>this._keyUp(F),!0)),this.register((0,s.addDisposableDomListener)(this.textarea,"keydown",F=>this._keyDown(F),!0)),this.register((0,s.addDisposableDomListener)(this.textarea,"keypress",F=>this._keyPress(F),!0)),this.register((0,s.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,s.addDisposableDomListener)(this.textarea,"compositionupdate",F=>this._compositionHelper.compositionupdate(F))),this.register((0,s.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,s.addDisposableDomListener)(this.textarea,"input",F=>this._inputEvent(F),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(F){var N;if(!F)throw new Error("Terminal requires a parent element.");F.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=F.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),F.appendChild(this.element);let B=ae.createDocumentFragment();this._viewportElement=ae.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),B.appendChild(this._viewportElement),this._viewportScrollArea=ae.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=ae.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=ae.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),B.appendChild(this.screenElement),this.textarea=ae.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",p.promptLabel),R.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(C.CoreBrowserService,this.textarea,(N=this._document.defaultView)!==null&&N!==void 0?N:window),this._instantiationService.setService(y.ICoreBrowserService,this._coreBrowserService),this.register((0,s.addDisposableDomListener)(this.textarea,"focus",P=>this._handleTextAreaFocus(P))),this.register((0,s.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(_.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(y.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(M.ThemeService),this._instantiationService.setService(y.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(D.CharacterJoinerService),this._instantiationService.setService(y.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(S.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(y.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(P=>this._onRender.fire(P))),this.onResize(P=>this._renderService.resize(P.cols,P.rows)),this._compositionView=ae.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(o.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(B);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(b.MouseService),this._instantiationService.setService(y.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(g.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(P=>this.scrollLines(P.amount,P.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(v.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(y.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(P=>this.scrollLines(P.amount,P.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(P=>this._renderService.handleSelectionChanged(P.start,P.end,P.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(P=>{this.textarea.value=P,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(P=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,s.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(l.BufferDecorationRenderer,this.screenElement)),this.register((0,s.addDisposableDomListener)(this.element,"mousedown",P=>this._selectionService.handleMouseDown(P))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(Y.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",P=>this._handleScreenReaderModeOptionChange(P))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(r.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",P=>{!this._overviewRulerRenderer&&P&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(r.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(c.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){let F=this,N=this.element;function B(j){let Fe=F._mouseService.getMouseReportCoords(j,F.screenElement);if(!Fe)return!1;let rt,Be;switch(j.overrideType||j.type){case"mousemove":Be=32,j.buttons===void 0?(rt=3,j.button!==void 0&&(rt=j.button<3?j.button:3)):rt=1&j.buttons?0:4&j.buttons?1:2&j.buttons?2:3;break;case"mouseup":Be=0,rt=j.button<3?j.button:3;break;case"mousedown":Be=1,rt=j.button<3?j.button:3;break;case"wheel":if(F.viewport.getLinesScrolled(j)===0)return!1;Be=j.deltaY<0?0:1,rt=4;break;default:return!1}return!(Be===void 0||rt===void 0||rt>4)&&F.coreMouseService.triggerMouseEvent({col:Fe.col,row:Fe.row,x:Fe.x,y:Fe.y,button:rt,action:Be,ctrl:j.ctrlKey,alt:j.altKey,shift:j.shiftKey})}let P={mouseup:null,wheel:null,mousedrag:null,mousemove:null},le={mouseup:j=>(B(j),j.buttons||(this._document.removeEventListener("mouseup",P.mouseup),P.mousedrag&&this._document.removeEventListener("mousemove",P.mousedrag)),this.cancel(j)),wheel:j=>(B(j),this.cancel(j,!0)),mousedrag:j=>{j.buttons&&B(j)},mousemove:j=>{j.buttons||B(j)}};this.register(this.coreMouseService.onProtocolChange(j=>{j?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(j)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&j?P.mousemove||(N.addEventListener("mousemove",le.mousemove),P.mousemove=le.mousemove):(N.removeEventListener("mousemove",P.mousemove),P.mousemove=null),16&j?P.wheel||(N.addEventListener("wheel",le.wheel,{passive:!1}),P.wheel=le.wheel):(N.removeEventListener("wheel",P.wheel),P.wheel=null),2&j?P.mouseup||(N.addEventListener("mouseup",le.mouseup),P.mouseup=le.mouseup):(this._document.removeEventListener("mouseup",P.mouseup),N.removeEventListener("mouseup",P.mouseup),P.mouseup=null),4&j?P.mousedrag||(P.mousedrag=le.mousedrag):(this._document.removeEventListener("mousemove",P.mousedrag),P.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,s.addDisposableDomListener)(N,"mousedown",j=>{if(j.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(j))return B(j),P.mouseup&&this._document.addEventListener("mouseup",P.mouseup),P.mousedrag&&this._document.addEventListener("mousemove",P.mousedrag),this.cancel(j)})),this.register((0,s.addDisposableDomListener)(N,"wheel",j=>{if(!P.wheel){if(!this.buffer.hasScrollback){let Fe=this.viewport.getLinesScrolled(j);if(Fe===0)return;let rt=W.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(j.deltaY<0?"A":"B"),Be="";for(let Re=0;Re<Math.abs(Fe);Re++)Be+=rt;return this.coreService.triggerDataEvent(Be,!0),this.cancel(j,!0)}return this.viewport.handleWheel(j)?this.cancel(j):void 0}},{passive:!1})),this.register((0,s.addDisposableDomListener)(N,"touchstart",j=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(j),this.cancel(j)},{passive:!0})),this.register((0,s.addDisposableDomListener)(N,"touchmove",j=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(j)?void 0:this.cancel(j)},{passive:!1}))}refresh(F,N){var B;(B=this._renderService)===null||B===void 0||B.refreshRows(F,N)}updateCursorStyle(F){var N;!((N=this._selectionService)===null||N===void 0)&&N.shouldColumnSelect(F)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(F,N,B=0){var P;B===1?(super.scrollLines(F,N,B),this.refresh(0,this.rows-1)):(P=this.viewport)===null||P===void 0||P.scrollLines(F)}paste(F){(0,f.paste)(F,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(F){this._customKeyEventHandler=F}registerLinkProvider(F){return this.linkifier2.registerLinkProvider(F)}registerCharacterJoiner(F){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");let N=this._characterJoinerService.register(F);return this.refresh(0,this.rows-1),N}deregisterCharacterJoiner(F){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(F)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(F){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+F)}registerDecoration(F){return this._decorationService.registerDecoration(F)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(F,N,B){this._selectionService.setSelection(F,N,B)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var F;(F=this._selectionService)===null||F===void 0||F.clearSelection()}selectAll(){var F;(F=this._selectionService)===null||F===void 0||F.selectAll()}selectLines(F,N){var B;(B=this._selectionService)===null||B===void 0||B.selectLines(F,N)}_keyDown(F){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1)return!1;let N=this.browser.isMac&&this.options.macOptionIsMeta&&F.altKey;if(!N&&!this._compositionHelper.keydown(F))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;N||F.key!=="Dead"&&F.key!=="AltGraph"||(this._unprocessedDeadKey=!0);let B=(0,E.evaluateKeyboardEvent)(F,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(F),B.type===3||B.type===2){let P=this.rows-1;return this.scrollLines(B.type===2?-P:P),this.cancel(F,!0)}return B.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,F)||(B.cancel&&this.cancel(F,!0),!B.key||!!(F.key&&!F.ctrlKey&&!F.altKey&&!F.metaKey&&F.key.length===1&&F.key.charCodeAt(0)>=65&&F.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(B.key!==W.C0.ETX&&B.key!==W.C0.CR||(this.textarea.value=""),this._onKey.fire({key:B.key,domEvent:F}),this._showCursor(),this.coreService.triggerDataEvent(B.key,!0),!this.optionsService.rawOptions.screenReaderMode||F.altKey||F.ctrlKey?this.cancel(F,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(F,N){let B=F.isMac&&!this.options.macOptionIsMeta&&N.altKey&&!N.ctrlKey&&!N.metaKey||F.isWindows&&N.altKey&&N.ctrlKey&&!N.metaKey||F.isWindows&&N.getModifierState("AltGraph");return N.type==="keypress"?B:B&&(!N.keyCode||N.keyCode>47)}_keyUp(F){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1||(function(N){return N.keyCode===16||N.keyCode===17||N.keyCode===18}(F)||this.focus(),this.updateCursorStyle(F),this._keyPressHandled=!1)}_keyPress(F){let N;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1)return!1;if(this.cancel(F),F.charCode)N=F.charCode;else if(F.which===null||F.which===void 0)N=F.keyCode;else{if(F.which===0||F.charCode===0)return!1;N=F.which}return!(!N||(F.altKey||F.ctrlKey||F.metaKey)&&!this._isThirdLevelShift(this.browser,F)||(N=String.fromCharCode(N),this._onKey.fire({key:N,domEvent:F}),this._showCursor(),this.coreService.triggerDataEvent(N,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(F){if(F.data&&F.inputType==="insertText"&&(!F.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;let N=F.data;return this.coreService.triggerDataEvent(N,!0),this.cancel(F),!0}return!1}resize(F,N){F!==this.cols||N!==this.rows?super.resize(F,N):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(F,N){var B,P;(B=this._charSizeService)===null||B===void 0||B.measure(),(P=this.viewport)===null||P===void 0||P.syncScrollArea(!0)}clear(){var F;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let N=1;N<this.rows;N++)this.buffer.lines.push(this.buffer.getBlankLine(H.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(F=this.viewport)===null||F===void 0||F.reset(),this.refresh(0,this.rows-1)}}reset(){var F,N;this.options.rows=this.rows,this.options.cols=this.cols;let B=this._customKeyEventHandler;this._setup(),super.reset(),(F=this._selectionService)===null||F===void 0||F.reset(),this._decorationService.reset(),(N=this.viewport)===null||N===void 0||N.reset(),this._customKeyEventHandler=B,this.refresh(0,this.rows-1)}clearTextureAtlas(){var F;(F=this._renderService)===null||F===void 0||F.clearTextureAtlas()}_reportFocus(){var F;!((F=this.element)===null||F===void 0)&&F.classList.contains("focus")?this.coreService.triggerDataEvent(W.C0.ESC+"[I"):this.coreService.triggerDataEvent(W.C0.ESC+"[O")}_reportWindowsOptions(F){if(this._renderService)switch(F){case U.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:let N=this._renderService.dimensions.css.canvas.width.toFixed(0),B=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${W.C0.ESC}[4;${B};${N}t`);break;case U.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:let P=this._renderService.dimensions.css.cell.width.toFixed(0),le=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${W.C0.ESC}[6;${le};${P}t`)}}cancel(F,N){if(this.options.cancelEvents||N)return F.preventDefault(),F.stopPropagation(),!1}}n.Terminal=z},9924:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TimeBasedDebouncer=void 0,n.TimeBasedDebouncer=class{constructor(u,f=1e3){this._renderCallback=u,this._debounceThresholdMS=f,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(u,f,s){this._rowCount=s,u=u!==void 0?u:0,f=f!==void 0?f:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,u):u,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,f):f;let i=Date.now();if(i-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=i,this._innerRefresh();else if(!this._additionalRefreshRequested){let p=i-this._lastRefreshMs,m=this._debounceThresholdMS-p;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},m)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;let u=Math.max(this._rowStart,0),f=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(u,f)}}},1680:function(h,n,u){var f=this&&this.__decorate||function(o,c,_,D){var C,b=arguments.length,S=b<3?c:D===null?D=Object.getOwnPropertyDescriptor(c,_):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(o,c,_,D);else for(var v=o.length-1;v>=0;v--)(C=o[v])&&(S=(b<3?C(S):b>3?C(c,_,S):C(c,_))||S);return b>3&&S&&Object.defineProperty(c,_,S),S},s=this&&this.__param||function(o,c){return function(_,D){c(_,D,o)}};Object.defineProperty(n,"__esModule",{value:!0}),n.Viewport=void 0;let i=u(3656),p=u(4725),m=u(8460),g=u(844),l=u(2585),r=n.Viewport=class extends g.Disposable{constructor(o,c,_,D,C,b,S,v){super(),this._viewportElement=o,this._scrollArea=c,this._bufferService=_,this._optionsService=D,this._charSizeService=C,this._renderService=b,this._coreBrowserService=S,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new m.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,i.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(y=>this._activeBuffer=y.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(y=>this._renderDimensions=y)),this._handleThemeChange(v.colors),this.register(v.onChangeColors(y=>this._handleThemeChange(y))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(o){this._viewportElement.style.backgroundColor=o.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(o){if(o)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;let c=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==c&&(this._lastRecordedBufferHeight=c,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}let o=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==o&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=o),this._refreshAnimationFrame=null}syncScrollArea(o=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(o);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(o)}_handleScroll(o){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});let c=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:c,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;let o=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(o*(this._smoothScrollState.target-this._smoothScrollState.origin)),o<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(o,c){let _=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(c<0&&this._viewportElement.scrollTop!==0||c>0&&_<this._lastRecordedBufferHeight)||(o.cancelable&&o.preventDefault(),!1)}handleWheel(o){let c=this._getPixelsScrolled(o);return c!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+c:this._smoothScrollState.target+=c,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=c,this._bubbleScroll(o,c))}scrollLines(o){if(o!==0)if(this._optionsService.rawOptions.smoothScrollDuration){let c=o*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+c,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:o,suppressScrollEvent:!1})}_getPixelsScrolled(o){if(o.deltaY===0||o.shiftKey)return 0;let c=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_LINE?c*=this._currentRowHeight:o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(c*=this._currentRowHeight*this._bufferService.rows),c}getBufferElements(o,c){var _;let D,C="",b=[],S=c??this._bufferService.buffer.lines.length,v=this._bufferService.buffer.lines;for(let y=o;y<S;y++){let M=v.get(y);if(!M)continue;let T=(_=v.get(y+1))===null||_===void 0?void 0:_.isWrapped;if(C+=M.translateToString(!T),!T||y===v.length-1){let w=document.createElement("div");w.textContent=C,b.push(w),C.length>0&&(D=w),C=""}}return{bufferElements:b,cursorElement:D}}getLinesScrolled(o){if(o.deltaY===0||o.shiftKey)return 0;let c=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(c/=this._currentRowHeight+0,this._wheelPartialScroll+=c,c=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(c*=this._bufferService.rows),c}_applyScrollModifier(o,c){let _=this._optionsService.rawOptions.fastScrollModifier;return _==="alt"&&c.altKey||_==="ctrl"&&c.ctrlKey||_==="shift"&&c.shiftKey?o*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:o*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(o){this._lastTouchY=o.touches[0].pageY}handleTouchMove(o){let c=this._lastTouchY-o.touches[0].pageY;return this._lastTouchY=o.touches[0].pageY,c!==0&&(this._viewportElement.scrollTop+=c,this._bubbleScroll(o,c))}};n.Viewport=r=f([s(2,l.IBufferService),s(3,l.IOptionsService),s(4,p.ICharSizeService),s(5,p.IRenderService),s(6,p.ICoreBrowserService),s(7,p.IThemeService)],r)},3107:function(h,n,u){var f=this&&this.__decorate||function(r,o,c,_){var D,C=arguments.length,b=C<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,c):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,o,c,_);else for(var S=r.length-1;S>=0;S--)(D=r[S])&&(b=(C<3?D(b):C>3?D(o,c,b):D(o,c))||b);return C>3&&b&&Object.defineProperty(o,c,b),b},s=this&&this.__param||function(r,o){return function(c,_){o(c,_,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.BufferDecorationRenderer=void 0;let i=u(3656),p=u(4725),m=u(844),g=u(2585),l=n.BufferDecorationRenderer=class extends m.Disposable{constructor(r,o,c,_){super(),this._screenElement=r,this._bufferService=o,this._decorationService=c,this._renderService=_,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,i.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(D=>this._removeDecoration(D))),this.register((0,m.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(let r of this._decorationService.decorations)this._renderDecoration(r);this._dimensionsChanged=!1}_renderDecoration(r){this._refreshStyle(r),this._dimensionsChanged&&this._refreshXPosition(r)}_createElement(r){var o,c;let _=document.createElement("div");_.classList.add("xterm-decoration"),_.classList.toggle("xterm-decoration-top-layer",((o=r?.options)===null||o===void 0?void 0:o.layer)==="top"),_.style.width=`${Math.round((r.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,_.style.height=(r.options.height||1)*this._renderService.dimensions.css.cell.height+"px",_.style.top=(r.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",_.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;let D=(c=r.options.x)!==null&&c!==void 0?c:0;return D&&D>this._bufferService.cols&&(_.style.display="none"),this._refreshXPosition(r,_),_}_refreshStyle(r){let o=r.marker.line-this._bufferService.buffers.active.ydisp;if(o<0||o>=this._bufferService.rows)r.element&&(r.element.style.display="none",r.onRenderEmitter.fire(r.element));else{let c=this._decorationElements.get(r);c||(c=this._createElement(r),r.element=c,this._decorationElements.set(r,c),this._container.appendChild(c),r.onDispose(()=>{this._decorationElements.delete(r),c.remove()})),c.style.top=o*this._renderService.dimensions.css.cell.height+"px",c.style.display=this._altBufferIsActive?"none":"block",r.onRenderEmitter.fire(c)}}_refreshXPosition(r,o=r.element){var c;if(!o)return;let _=(c=r.options.x)!==null&&c!==void 0?c:0;(r.options.anchor||"left")==="right"?o.style.right=_?_*this._renderService.dimensions.css.cell.width+"px":"":o.style.left=_?_*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(r){var o;(o=this._decorationElements.get(r))===null||o===void 0||o.remove(),this._decorationElements.delete(r),r.dispose()}};n.BufferDecorationRenderer=l=f([s(1,g.IBufferService),s(2,g.IDecorationService),s(3,p.IRenderService)],l)},5871:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorZoneStore=void 0,n.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(u){if(u.options.overviewRulerOptions){for(let f of this._zones)if(f.color===u.options.overviewRulerOptions.color&&f.position===u.options.overviewRulerOptions.position){if(this._lineIntersectsZone(f,u.marker.line))return;if(this._lineAdjacentToZone(f,u.marker.line,u.options.overviewRulerOptions.position))return void this._addLineToZone(f,u.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=u.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=u.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=u.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=u.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:u.options.overviewRulerOptions.color,position:u.options.overviewRulerOptions.position,startBufferLine:u.marker.line,endBufferLine:u.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(u){this._linePadding=u}_lineIntersectsZone(u,f){return f>=u.startBufferLine&&f<=u.endBufferLine}_lineAdjacentToZone(u,f,s){return f>=u.startBufferLine-this._linePadding[s||"full"]&&f<=u.endBufferLine+this._linePadding[s||"full"]}_addLineToZone(u,f){u.startBufferLine=Math.min(u.startBufferLine,f),u.endBufferLine=Math.max(u.endBufferLine,f)}}},5744:function(h,n,u){var f=this&&this.__decorate||function(D,C,b,S){var v,y=arguments.length,M=y<3?C:S===null?S=Object.getOwnPropertyDescriptor(C,b):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(D,C,b,S);else for(var T=D.length-1;T>=0;T--)(v=D[T])&&(M=(y<3?v(M):y>3?v(C,b,M):v(C,b))||M);return y>3&&M&&Object.defineProperty(C,b,M),M},s=this&&this.__param||function(D,C){return function(b,S){C(b,S,D)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OverviewRulerRenderer=void 0;let i=u(5871),p=u(3656),m=u(4725),g=u(844),l=u(2585),r={full:0,left:0,center:0,right:0},o={full:0,left:0,center:0,right:0},c={full:0,left:0,center:0,right:0},_=n.OverviewRulerRenderer=class extends g.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(D,C,b,S,v,y,M){var T;super(),this._viewportElement=D,this._screenElement=C,this._bufferService=b,this._decorationService=S,this._renderService=v,this._optionsService=y,this._coreBrowseService=M,this._colorZoneStore=new i.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(T=this._viewportElement.parentElement)===null||T===void 0||T.insertBefore(this._canvas,this._viewportElement);let w=this._canvas.getContext("2d");if(!w)throw new Error("Ctx cannot be null");this._ctx=w,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,g.toDisposable)(()=>{var x;(x=this._canvas)===null||x===void 0||x.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,p.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){let D=Math.floor(this._canvas.width/3),C=Math.ceil(this._canvas.width/3);o.full=this._canvas.width,o.left=D,o.center=C,o.right=D,this._refreshDrawHeightConstants(),c.full=0,c.left=0,c.center=o.left,c.right=o.left+o.center}_refreshDrawHeightConstants(){r.full=Math.round(2*this._coreBrowseService.dpr);let D=this._canvas.height/this._bufferService.buffer.lines.length,C=Math.round(Math.max(Math.min(D,12),6)*this._coreBrowseService.dpr);r.left=C,r.center=C,r.right=C}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*r.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*r.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*r.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*r.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(let C of this._decorationService.decorations)this._colorZoneStore.addDecoration(C);this._ctx.lineWidth=1;let D=this._colorZoneStore.zones;for(let C of D)C.position!=="full"&&this._renderColorZone(C);for(let C of D)C.position==="full"&&this._renderColorZone(C);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(D){this._ctx.fillStyle=D.color,this._ctx.fillRect(c[D.position||"full"],Math.round((this._canvas.height-1)*(D.startBufferLine/this._bufferService.buffers.active.lines.length)-r[D.position||"full"]/2),o[D.position||"full"],Math.round((this._canvas.height-1)*((D.endBufferLine-D.startBufferLine)/this._bufferService.buffers.active.lines.length)+r[D.position||"full"]))}_queueRefresh(D,C){this._shouldUpdateDimensions=D||this._shouldUpdateDimensions,this._shouldUpdateAnchor=C||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};n.OverviewRulerRenderer=_=f([s(2,l.IBufferService),s(3,l.IDecorationService),s(4,m.IRenderService),s(5,l.IOptionsService),s(6,m.ICoreBrowserService)],_)},2950:function(h,n,u){var f=this&&this.__decorate||function(l,r,o,c){var _,D=arguments.length,C=D<3?r:c===null?c=Object.getOwnPropertyDescriptor(r,o):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(l,r,o,c);else for(var b=l.length-1;b>=0;b--)(_=l[b])&&(C=(D<3?_(C):D>3?_(r,o,C):_(r,o))||C);return D>3&&C&&Object.defineProperty(r,o,C),C},s=this&&this.__param||function(l,r){return function(o,c){r(o,c,l)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CompositionHelper=void 0;let i=u(4725),p=u(2585),m=u(2584),g=n.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(l,r,o,c,_,D){this._textarea=l,this._compositionView=r,this._bufferService=o,this._optionsService=c,this._coreService=_,this._renderService=D,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(l){this._compositionView.textContent=l.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(l){if(this._isComposing||this._isSendingComposition){if(l.keyCode===229||l.keyCode===16||l.keyCode===17||l.keyCode===18)return!1;this._finalizeComposition(!1)}return l.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(l){if(this._compositionView.classList.remove("active"),this._isComposing=!1,l){let r={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let o;this._isSendingComposition=!1,r.start+=this._dataAlreadySent.length,o=this._isComposing?this._textarea.value.substring(r.start,r.end):this._textarea.value.substring(r.start),o.length>0&&this._coreService.triggerDataEvent(o,!0)}},0)}else{this._isSendingComposition=!1;let r=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(r,!0)}}_handleAnyTextareaChanges(){let l=this._textarea.value;setTimeout(()=>{if(!this._isComposing){let r=this._textarea.value,o=r.replace(l,"");this._dataAlreadySent=o,r.length>l.length?this._coreService.triggerDataEvent(o,!0):r.length<l.length?this._coreService.triggerDataEvent(`${m.C0.DEL}`,!0):r.length===l.length&&r!==l&&this._coreService.triggerDataEvent(r,!0)}},0)}updateCompositionElements(l){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){let r=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),o=this._renderService.dimensions.css.cell.height,c=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,_=r*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=_+"px",this._compositionView.style.top=c+"px",this._compositionView.style.height=o+"px",this._compositionView.style.lineHeight=o+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";let D=this._compositionView.getBoundingClientRect();this._textarea.style.left=_+"px",this._textarea.style.top=c+"px",this._textarea.style.width=Math.max(D.width,1)+"px",this._textarea.style.height=Math.max(D.height,1)+"px",this._textarea.style.lineHeight=D.height+"px"}l||setTimeout(()=>this.updateCompositionElements(!0),0)}}};n.CompositionHelper=g=f([s(2,p.IBufferService),s(3,p.IOptionsService),s(4,p.ICoreService),s(5,i.IRenderService)],g)},9806:(h,n)=>{function u(f,s,i){let p=i.getBoundingClientRect(),m=f.getComputedStyle(i),g=parseInt(m.getPropertyValue("padding-left")),l=parseInt(m.getPropertyValue("padding-top"));return[s.clientX-p.left-g,s.clientY-p.top-l]}Object.defineProperty(n,"__esModule",{value:!0}),n.getCoords=n.getCoordsRelativeToElement=void 0,n.getCoordsRelativeToElement=u,n.getCoords=function(f,s,i,p,m,g,l,r,o){if(!g)return;let c=u(f,s,i);return c?(c[0]=Math.ceil((c[0]+(o?l/2:0))/l),c[1]=Math.ceil(c[1]/r),c[0]=Math.min(Math.max(c[0],1),p+(o?1:0)),c[1]=Math.min(Math.max(c[1],1),m),c):void 0}},9504:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.moveToCellSequence=void 0;let f=u(2584);function s(r,o,c,_){let D=r-i(r,c),C=o-i(o,c),b=Math.abs(D-C)-function(S,v,y){let M=0,T=S-i(S,y),w=v-i(v,y);for(let x=0;x<Math.abs(T-w);x++){let I=p(S,v)==="A"?-1:1,R=y.buffer.lines.get(T+I*x);R?.isWrapped&&M++}return M}(r,o,c);return l(b,g(p(r,o),_))}function i(r,o){let c=0,_=o.buffer.lines.get(r),D=_?.isWrapped;for(;D&&r>=0&&r<o.rows;)c++,_=o.buffer.lines.get(--r),D=_?.isWrapped;return c}function p(r,o){return r>o?"A":"B"}function m(r,o,c,_,D,C){let b=r,S=o,v="";for(;b!==c||S!==_;)b+=D?1:-1,D&&b>C.cols-1?(v+=C.buffer.translateBufferLineToString(S,!1,r,b),b=0,r=0,S++):!D&&b<0&&(v+=C.buffer.translateBufferLineToString(S,!1,0,r+1),b=C.cols-1,r=b,S--);return v+C.buffer.translateBufferLineToString(S,!1,r,b)}function g(r,o){let c=o?"O":"[";return f.C0.ESC+c+r}function l(r,o){r=Math.floor(r);let c="";for(let _=0;_<r;_++)c+=o;return c}n.moveToCellSequence=function(r,o,c,_){let D=c.buffer.x,C=c.buffer.y;if(!c.buffer.hasScrollback)return function(v,y,M,T,w,x){return s(y,T,w,x).length===0?"":l(m(v,y,v,y-i(y,w),!1,w).length,g("D",x))}(D,C,0,o,c,_)+s(C,o,c,_)+function(v,y,M,T,w,x){let I;I=s(y,T,w,x).length>0?T-i(T,w):y;let R=T,H=function(W,E,L,A,O,U){let Y;return Y=s(L,A,O,U).length>0?A-i(A,O):E,W<L&&Y<=A||W>=L&&Y<A?"C":"D"}(v,y,M,T,w,x);return l(m(v,I,M,R,H==="C",w).length,g(H,x))}(D,C,r,o,c,_);let b;if(C===o)return b=D>r?"D":"C",l(Math.abs(D-r),g(b,_));b=C>o?"D":"C";let S=Math.abs(C-o);return l(function(v,y){return y.cols-v}(C>o?r:D,c)+(S-1)*c.cols+1+((C>o?D:r)-1),g(b,_))}},1296:function(h,n,u){var f=this&&this.__decorate||function(w,x,I,R){var H,W=arguments.length,E=W<3?x:R===null?R=Object.getOwnPropertyDescriptor(x,I):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(w,x,I,R);else for(var L=w.length-1;L>=0;L--)(H=w[L])&&(E=(W<3?H(E):W>3?H(x,I,E):H(x,I))||E);return W>3&&E&&Object.defineProperty(x,I,E),E},s=this&&this.__param||function(w,x){return function(I,R){x(I,R,w)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomRenderer=void 0;let i=u(3787),p=u(2550),m=u(2223),g=u(6171),l=u(4725),r=u(8055),o=u(8460),c=u(844),_=u(2585),D="xterm-dom-renderer-owner-",C="xterm-rows",b="xterm-fg-",S="xterm-bg-",v="xterm-focus",y="xterm-selection",M=1,T=n.DomRenderer=class extends c.Disposable{constructor(w,x,I,R,H,W,E,L,A,O){super(),this._element=w,this._screenElement=x,this._viewportElement=I,this._linkifier2=R,this._charSizeService=W,this._optionsService=E,this._bufferService=L,this._coreBrowserService=A,this._themeService=O,this._terminalClass=M++,this._rowElements=[],this.onRequestRedraw=this.register(new o.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(C),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(y),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,g.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(U=>this._injectCss(U))),this._injectCss(this._themeService.colors),this._rowFactory=H.createInstance(i.DomRendererRowFactory,document),this._element.classList.add(D+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(U=>this._handleLinkHover(U))),this.register(this._linkifier2.onHideLinkUnderline(U=>this._handleLinkLeave(U))),this.register((0,c.toDisposable)(()=>{this._element.classList.remove(D+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new p.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){let w=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*w,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*w),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/w),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/w),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(let I of this._rowElements)I.style.width=`${this.dimensions.css.canvas.width}px`,I.style.height=`${this.dimensions.css.cell.height}px`,I.style.lineHeight=`${this.dimensions.css.cell.height}px`,I.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));let x=`${this._terminalSelector} .${C} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=x,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(w){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let x=`${this._terminalSelector} .${C} { color: ${w.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;x+=`${this._terminalSelector} .${C} .xterm-dim { color: ${r.color.multiplyOpacity(w.foreground,.5).css};}`,x+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,x+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",x+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${w.cursor.css};  color: ${w.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${w.cursor.css}; }}`,x+=`${this._terminalSelector} .${C}.${v} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${C}.${v} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-block { background-color: ${w.cursor.css}; color: ${w.cursorAccent.css};}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${w.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${w.cursor.css} inset;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${w.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,x+=`${this._terminalSelector} .${y} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${y} div { position: absolute; background-color: ${w.selectionBackgroundOpaque.css};}${this._terminalSelector} .${y} div { position: absolute; background-color: ${w.selectionInactiveBackgroundOpaque.css};}`;for(let[I,R]of w.ansi.entries())x+=`${this._terminalSelector} .${b}${I} { color: ${R.css}; }${this._terminalSelector} .${b}${I}.xterm-dim { color: ${r.color.multiplyOpacity(R,.5).css}; }${this._terminalSelector} .${S}${I} { background-color: ${R.css}; }`;x+=`${this._terminalSelector} .${b}${m.INVERTED_DEFAULT_COLOR} { color: ${r.color.opaque(w.background).css}; }${this._terminalSelector} .${b}${m.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${r.color.multiplyOpacity(r.color.opaque(w.background),.5).css}; }${this._terminalSelector} .${S}${m.INVERTED_DEFAULT_COLOR} { background-color: ${w.foreground.css}; }`,this._themeStyleElement.textContent=x}_setDefaultSpacing(){let w=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${w}px`,this._rowFactory.defaultSpacing=w}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(w,x){for(let I=this._rowElements.length;I<=x;I++){let R=document.createElement("div");this._rowContainer.appendChild(R),this._rowElements.push(R)}for(;this._rowElements.length>x;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(w,x){this._refreshRowElements(w,x),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(v)}handleFocus(){this._rowContainer.classList.add(v),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(w,x,I){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(w,x,I),this.renderRows(0,this._bufferService.rows-1),!w||!x)return;let R=w[1]-this._bufferService.buffer.ydisp,H=x[1]-this._bufferService.buffer.ydisp,W=Math.max(R,0),E=Math.min(H,this._bufferService.rows-1);if(W>=this._bufferService.rows||E<0)return;let L=document.createDocumentFragment();if(I){let A=w[0]>x[0];L.appendChild(this._createSelectionElement(W,A?x[0]:w[0],A?w[0]:x[0],E-W+1))}else{let A=R===W?w[0]:0,O=W===H?x[0]:this._bufferService.cols;L.appendChild(this._createSelectionElement(W,A,O));let U=E-W-1;if(L.appendChild(this._createSelectionElement(W+1,0,this._bufferService.cols,U)),W!==E){let Y=H===E?x[0]:this._bufferService.cols;L.appendChild(this._createSelectionElement(E,0,Y))}}this._selectionContainer.appendChild(L)}_createSelectionElement(w,x,I,R=1){let H=document.createElement("div");return H.style.height=R*this.dimensions.css.cell.height+"px",H.style.top=w*this.dimensions.css.cell.height+"px",H.style.left=x*this.dimensions.css.cell.width+"px",H.style.width=this.dimensions.css.cell.width*(I-x)+"px",H}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(let w of this._rowElements)w.replaceChildren()}renderRows(w,x){let I=this._bufferService.buffer,R=I.ybase+I.y,H=Math.min(I.x,this._bufferService.cols-1),W=this._optionsService.rawOptions.cursorBlink,E=this._optionsService.rawOptions.cursorStyle,L=this._optionsService.rawOptions.cursorInactiveStyle;for(let A=w;A<=x;A++){let O=A+I.ydisp,U=this._rowElements[A],Y=I.lines.get(O);if(!U||!Y)break;U.replaceChildren(...this._rowFactory.createRow(Y,O,O===R,E,L,H,W,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${D}${this._terminalClass}`}_handleLinkHover(w){this._setCellUnderline(w.x1,w.x2,w.y1,w.y2,w.cols,!0)}_handleLinkLeave(w){this._setCellUnderline(w.x1,w.x2,w.y1,w.y2,w.cols,!1)}_setCellUnderline(w,x,I,R,H,W){I<0&&(w=0),R<0&&(x=0);let E=this._bufferService.rows-1;I=Math.max(Math.min(I,E),0),R=Math.max(Math.min(R,E),0),H=Math.min(H,this._bufferService.cols);let L=this._bufferService.buffer,A=L.ybase+L.y,O=Math.min(L.x,H-1),U=this._optionsService.rawOptions.cursorBlink,Y=this._optionsService.rawOptions.cursorStyle,ae=this._optionsService.rawOptions.cursorInactiveStyle;for(let z=I;z<=R;++z){let fe=z+L.ydisp,F=this._rowElements[z],N=L.lines.get(fe);if(!F||!N)break;F.replaceChildren(...this._rowFactory.createRow(N,fe,fe===A,Y,ae,O,U,this.dimensions.css.cell.width,this._widthCache,W?z===I?w:0:-1,W?(z===R?x:H)-1:-1))}}};n.DomRenderer=T=f([s(4,_.IInstantiationService),s(5,l.ICharSizeService),s(6,_.IOptionsService),s(7,_.IBufferService),s(8,l.ICoreBrowserService),s(9,l.IThemeService)],T)},3787:function(h,n,u){var f=this&&this.__decorate||function(b,S,v,y){var M,T=arguments.length,w=T<3?S:y===null?y=Object.getOwnPropertyDescriptor(S,v):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(b,S,v,y);else for(var x=b.length-1;x>=0;x--)(M=b[x])&&(w=(T<3?M(w):T>3?M(S,v,w):M(S,v))||w);return T>3&&w&&Object.defineProperty(S,v,w),w},s=this&&this.__param||function(b,S){return function(v,y){S(v,y,b)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomRendererRowFactory=void 0;let i=u(2223),p=u(643),m=u(511),g=u(2585),l=u(8055),r=u(4725),o=u(4269),c=u(6171),_=u(3734),D=n.DomRendererRowFactory=class{constructor(b,S,v,y,M,T,w){this._document=b,this._characterJoinerService=S,this._optionsService=v,this._coreBrowserService=y,this._coreService=M,this._decorationService=T,this._themeService=w,this._workCell=new m.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(b,S,v){this._selectionStart=b,this._selectionEnd=S,this._columnSelectMode=v}createRow(b,S,v,y,M,T,w,x,I,R,H){let W=[],E=this._characterJoinerService.getJoinedCharacters(S),L=this._themeService.colors,A,O=b.getNoBgTrimmedLength();v&&O<T+1&&(O=T+1);let U=0,Y="",ae=0,z=0,fe=0,F=!1,N=0,B=!1,P=0,le=[],j=R!==-1&&H!==-1;for(let Fe=0;Fe<O;Fe++){b.loadCell(Fe,this._workCell);let rt=this._workCell.getWidth();if(rt===0)continue;let Be=!1,Re=Fe,qe=this._workCell;if(E.length>0&&Fe===E[0][0]){Be=!0;let nt=E.shift();qe=new o.JoinedCellData(this._workCell,b.translateToString(!0,nt[0],nt[1]),nt[1]-nt[0]),Re=nt[1]-1,rt=qe.getWidth()}let kt=this._isCellInSelection(Fe,S),sr=v&&Fe===T,dr=j&&Fe>=R&&Fe<=H,dt=!1;this._decorationService.forEachDecorationAtCell(Fe,S,void 0,nt=>{dt=!0});let ce=qe.getChars()||p.WHITESPACE_CELL_CHAR;if(ce===" "&&(qe.isUnderline()||qe.isOverline())&&(ce="\xA0"),P=rt*x-I.get(ce,qe.isBold(),qe.isItalic()),A){if(U&&(kt&&B||!kt&&!B&&qe.bg===ae)&&(kt&&B&&L.selectionForeground||qe.fg===z)&&qe.extended.ext===fe&&dr===F&&P===N&&!sr&&!Be&&!dt){Y+=ce,U++;continue}U&&(A.textContent=Y),A=this._document.createElement("span"),U=0,Y=""}else A=this._document.createElement("span");if(ae=qe.bg,z=qe.fg,fe=qe.extended.ext,F=dr,N=P,B=kt,Be&&T>=Fe&&T<=Re&&(T=Fe),!this._coreService.isCursorHidden&&sr){if(le.push("xterm-cursor"),this._coreBrowserService.isFocused)w&&le.push("xterm-cursor-blink"),le.push(y==="bar"?"xterm-cursor-bar":y==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(M)switch(M){case"outline":le.push("xterm-cursor-outline");break;case"block":le.push("xterm-cursor-block");break;case"bar":le.push("xterm-cursor-bar");break;case"underline":le.push("xterm-cursor-underline")}}if(qe.isBold()&&le.push("xterm-bold"),qe.isItalic()&&le.push("xterm-italic"),qe.isDim()&&le.push("xterm-dim"),Y=qe.isInvisible()?p.WHITESPACE_CELL_CHAR:qe.getChars()||p.WHITESPACE_CELL_CHAR,qe.isUnderline()&&(le.push(`xterm-underline-${qe.extended.underlineStyle}`),Y===" "&&(Y="\xA0"),!qe.isUnderlineColorDefault()))if(qe.isUnderlineColorRGB())A.style.textDecorationColor=`rgb(${_.AttributeData.toColorRGB(qe.getUnderlineColor()).join(",")})`;else{let nt=qe.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&qe.isBold()&&nt<8&&(nt+=8),A.style.textDecorationColor=L.ansi[nt].css}qe.isOverline()&&(le.push("xterm-overline"),Y===" "&&(Y="\xA0")),qe.isStrikethrough()&&le.push("xterm-strikethrough"),dr&&(A.style.textDecoration="underline");let ue=qe.getFgColor(),re=qe.getFgColorMode(),Q=qe.getBgColor(),me=qe.getBgColorMode(),$e=!!qe.isInverse();if($e){let nt=ue;ue=Q,Q=nt;let ln=re;re=me,me=ln}let ze,Tt,tr,nr=!1;switch(this._decorationService.forEachDecorationAtCell(Fe,S,void 0,nt=>{nt.options.layer!=="top"&&nr||(nt.backgroundColorRGB&&(me=50331648,Q=nt.backgroundColorRGB.rgba>>8&16777215,ze=nt.backgroundColorRGB),nt.foregroundColorRGB&&(re=50331648,ue=nt.foregroundColorRGB.rgba>>8&16777215,Tt=nt.foregroundColorRGB),nr=nt.options.layer==="top")}),!nr&&kt&&(ze=this._coreBrowserService.isFocused?L.selectionBackgroundOpaque:L.selectionInactiveBackgroundOpaque,Q=ze.rgba>>8&16777215,me=50331648,nr=!0,L.selectionForeground&&(re=50331648,ue=L.selectionForeground.rgba>>8&16777215,Tt=L.selectionForeground)),nr&&le.push("xterm-decoration-top"),me){case 16777216:case 33554432:tr=L.ansi[Q],le.push(`xterm-bg-${Q}`);break;case 50331648:tr=l.rgba.toColor(Q>>16,Q>>8&255,255&Q),this._addStyle(A,`background-color:#${C((Q>>>0).toString(16),"0",6)}`);break;default:$e?(tr=L.foreground,le.push(`xterm-bg-${i.INVERTED_DEFAULT_COLOR}`)):tr=L.background}switch(ze||qe.isDim()&&(ze=l.color.multiplyOpacity(tr,.5)),re){case 16777216:case 33554432:qe.isBold()&&ue<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(ue+=8),this._applyMinimumContrast(A,tr,L.ansi[ue],qe,ze,void 0)||le.push(`xterm-fg-${ue}`);break;case 50331648:let nt=l.rgba.toColor(ue>>16&255,ue>>8&255,255&ue);this._applyMinimumContrast(A,tr,nt,qe,ze,Tt)||this._addStyle(A,`color:#${C(ue.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(A,tr,L.foreground,qe,ze,void 0)||$e&&le.push(`xterm-fg-${i.INVERTED_DEFAULT_COLOR}`)}le.length&&(A.className=le.join(" "),le.length=0),sr||Be||dt?A.textContent=Y:U++,P!==this.defaultSpacing&&(A.style.letterSpacing=`${P}px`),W.push(A),Fe=Re}return A&&U&&(A.textContent=Y),W}_applyMinimumContrast(b,S,v,y,M,T){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,c.excludeFromContrastRatioDemands)(y.getCode()))return!1;let w=this._getContrastCache(y),x;if(M||T||(x=w.getColor(S.rgba,v.rgba)),x===void 0){let I=this._optionsService.rawOptions.minimumContrastRatio/(y.isDim()?2:1);x=l.color.ensureContrastRatio(M||S,T||v,I),w.setColor((M||S).rgba,(T||v).rgba,x??null)}return!!x&&(this._addStyle(b,`color:${x.css}`),!0)}_getContrastCache(b){return b.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(b,S){b.setAttribute("style",`${b.getAttribute("style")||""}${S};`)}_isCellInSelection(b,S){let v=this._selectionStart,y=this._selectionEnd;return!(!v||!y)&&(this._columnSelectMode?v[0]<=y[0]?b>=v[0]&&S>=v[1]&&b<y[0]&&S<=y[1]:b<v[0]&&S>=v[1]&&b>=y[0]&&S<=y[1]:S>v[1]&&S<y[1]||v[1]===y[1]&&S===v[1]&&b>=v[0]&&b<y[0]||v[1]<y[1]&&S===y[1]&&b<y[0]||v[1]<y[1]&&S===v[1]&&b>=v[0])}};function C(b,S,v){for(;b.length<v;)b=S+b;return b}n.DomRendererRowFactory=D=f([s(1,r.ICharacterJoinerService),s(2,g.IOptionsService),s(3,r.ICoreBrowserService),s(4,g.ICoreService),s(5,g.IDecorationService),s(6,r.IThemeService)],D)},2550:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WidthCache=void 0,n.WidthCache=class{constructor(u){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=u.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";let f=u.createElement("span"),s=u.createElement("span");s.style.fontWeight="bold";let i=u.createElement("span");i.style.fontStyle="italic";let p=u.createElement("span");p.style.fontWeight="bold",p.style.fontStyle="italic",this._measureElements=[f,s,i,p],this._container.appendChild(f),this._container.appendChild(s),this._container.appendChild(i),this._container.appendChild(p),u.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(u,f,s,i){u===this._font&&f===this._fontSize&&s===this._weight&&i===this._weightBold||(this._font=u,this._fontSize=f,this._weight=s,this._weightBold=i,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${s}`,this._measureElements[1].style.fontWeight=`${i}`,this._measureElements[2].style.fontWeight=`${s}`,this._measureElements[3].style.fontWeight=`${i}`,this.clear())}get(u,f,s){let i=0;if(!f&&!s&&u.length===1&&(i=u.charCodeAt(0))<256)return this._flat[i]!==-9999?this._flat[i]:this._flat[i]=this._measure(u,0);let p=u;f&&(p+="B"),s&&(p+="I");let m=this._holey.get(p);if(m===void 0){let g=0;f&&(g|=1),s&&(g|=2),m=this._measure(u,g),this._holey.set(p,m)}return m}_measure(u,f){let s=this._measureElements[f];return s.textContent=u.repeat(32),s.offsetWidth/32}}},2223:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TEXT_BASELINE=n.DIM_OPACITY=n.INVERTED_DEFAULT_COLOR=void 0;let f=u(6114);n.INVERTED_DEFAULT_COLOR=257,n.DIM_OPACITY=.5,n.TEXT_BASELINE=f.isFirefox||f.isLegacyEdge?"bottom":"ideographic"},6171:(h,n)=>{function u(f){return 57508<=f&&f<=57558}Object.defineProperty(n,"__esModule",{value:!0}),n.createRenderDimensions=n.excludeFromContrastRatioDemands=n.isRestrictedPowerlineGlyph=n.isPowerlineGlyph=n.throwIfFalsy=void 0,n.throwIfFalsy=function(f){if(!f)throw new Error("value must not be falsy");return f},n.isPowerlineGlyph=u,n.isRestrictedPowerlineGlyph=function(f){return 57520<=f&&f<=57527},n.excludeFromContrastRatioDemands=function(f){return u(f)||function(s){return 9472<=s&&s<=9631}(f)},n.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionModel=void 0,n.SelectionModel=class{constructor(u){this._bufferService=u,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){let u=this.selectionStart[0]+this.selectionStartLength;return u>this._bufferService.cols?u%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)-1]:[u%this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)]:[u,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){let u=this.selectionStart[0]+this.selectionStartLength;return u>this._bufferService.cols?[u%this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)]:[Math.max(u,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){let u=this.selectionStart,f=this.selectionEnd;return!(!u||!f)&&(u[1]>f[1]||u[1]===f[1]&&u[0]>f[0])}handleTrim(u){return this.selectionStart&&(this.selectionStart[1]-=u),this.selectionEnd&&(this.selectionEnd[1]-=u),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(h,n,u){var f=this&&this.__decorate||function(r,o,c,_){var D,C=arguments.length,b=C<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,c):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,o,c,_);else for(var S=r.length-1;S>=0;S--)(D=r[S])&&(b=(C<3?D(b):C>3?D(o,c,b):D(o,c))||b);return C>3&&b&&Object.defineProperty(o,c,b),b},s=this&&this.__param||function(r,o){return function(c,_){o(c,_,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CharSizeService=void 0;let i=u(2585),p=u(8460),m=u(844),g=n.CharSizeService=class extends m.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(r,o,c){super(),this._optionsService=c,this.width=0,this.height=0,this._onCharSizeChange=this.register(new p.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new l(r,o,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){let r=this._measureStrategy.measure();r.width===this.width&&r.height===this.height||(this.width=r.width,this.height=r.height,this._onCharSizeChange.fire())}};n.CharSizeService=g=f([s(2,i.IOptionsService)],g);class l{constructor(o,c,_){this._document=o,this._parentElement=c,this._optionsService=_,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;let o={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return o.width!==0&&o.height!==0&&(this._result.width=o.width/32,this._result.height=Math.ceil(o.height)),this._result}}},4269:function(h,n,u){var f=this&&this.__decorate||function(o,c,_,D){var C,b=arguments.length,S=b<3?c:D===null?D=Object.getOwnPropertyDescriptor(c,_):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(o,c,_,D);else for(var v=o.length-1;v>=0;v--)(C=o[v])&&(S=(b<3?C(S):b>3?C(c,_,S):C(c,_))||S);return b>3&&S&&Object.defineProperty(c,_,S),S},s=this&&this.__param||function(o,c){return function(_,D){c(_,D,o)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CharacterJoinerService=n.JoinedCellData=void 0;let i=u(3734),p=u(643),m=u(511),g=u(2585);class l extends i.AttributeData{constructor(c,_,D){super(),this.content=0,this.combinedData="",this.fg=c.fg,this.bg=c.bg,this.combinedData=_,this._width=D}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(c){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}n.JoinedCellData=l;let r=n.CharacterJoinerService=class _b{constructor(c){this._bufferService=c,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new m.CellData}register(c){let _={id:this._nextCharacterJoinerId++,handler:c};return this._characterJoiners.push(_),_.id}deregister(c){for(let _=0;_<this._characterJoiners.length;_++)if(this._characterJoiners[_].id===c)return this._characterJoiners.splice(_,1),!0;return!1}getJoinedCharacters(c){if(this._characterJoiners.length===0)return[];let _=this._bufferService.buffer.lines.get(c);if(!_||_.length===0)return[];let D=[],C=_.translateToString(!0),b=0,S=0,v=0,y=_.getFg(0),M=_.getBg(0);for(let T=0;T<_.getTrimmedLength();T++)if(_.loadCell(T,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==y||this._workCell.bg!==M){if(T-b>1){let w=this._getJoinedRanges(C,v,S,_,b);for(let x=0;x<w.length;x++)D.push(w[x])}b=T,v=S,y=this._workCell.fg,M=this._workCell.bg}S+=this._workCell.getChars().length||p.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-b>1){let T=this._getJoinedRanges(C,v,S,_,b);for(let w=0;w<T.length;w++)D.push(T[w])}return D}_getJoinedRanges(c,_,D,C,b){let S=c.substring(_,D),v=[];try{v=this._characterJoiners[0].handler(S)}catch(y){console.error(y)}for(let y=1;y<this._characterJoiners.length;y++)try{let M=this._characterJoiners[y].handler(S);for(let T=0;T<M.length;T++)_b._mergeRanges(v,M[T])}catch(M){console.error(M)}return this._stringRangesToCellRanges(v,C,b),v}_stringRangesToCellRanges(c,_,D){let C=0,b=!1,S=0,v=c[C];if(v){for(let y=D;y<this._bufferService.cols;y++){let M=_.getWidth(y),T=_.getString(y).length||p.WHITESPACE_CELL_CHAR.length;if(M!==0){if(!b&&v[0]<=S&&(v[0]=y,b=!0),v[1]<=S){if(v[1]=y,v=c[++C],!v)break;v[0]<=S?(v[0]=y,b=!0):b=!1}S+=T}}v&&(v[1]=this._bufferService.cols)}}static _mergeRanges(c,_){let D=!1;for(let C=0;C<c.length;C++){let b=c[C];if(D){if(_[1]<=b[0])return c[C-1][1]=_[1],c;if(_[1]<=b[1])return c[C-1][1]=Math.max(_[1],b[1]),c.splice(C,1),c;c.splice(C,1),C--}else{if(_[1]<=b[0])return c.splice(C,0,_),c;if(_[1]<=b[1])return b[0]=Math.min(_[0],b[0]),c;_[0]<b[1]&&(b[0]=Math.min(_[0],b[0]),D=!0)}}return D?c[c.length-1][1]=_[1]:c.push(_),c}};n.CharacterJoinerService=r=f([s(0,g.IBufferService)],r)},5114:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CoreBrowserService=void 0,n.CoreBrowserService=class{constructor(u,f){this._textarea=u,this.window=f,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(h,n,u){var f=this&&this.__decorate||function(g,l,r,o){var c,_=arguments.length,D=_<3?l:o===null?o=Object.getOwnPropertyDescriptor(l,r):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(g,l,r,o);else for(var C=g.length-1;C>=0;C--)(c=g[C])&&(D=(_<3?c(D):_>3?c(l,r,D):c(l,r))||D);return _>3&&D&&Object.defineProperty(l,r,D),D},s=this&&this.__param||function(g,l){return function(r,o){l(r,o,g)}};Object.defineProperty(n,"__esModule",{value:!0}),n.MouseService=void 0;let i=u(4725),p=u(9806),m=n.MouseService=class{constructor(g,l){this._renderService=g,this._charSizeService=l}getCoords(g,l,r,o,c){return(0,p.getCoords)(window,g,l,r,o,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,c)}getMouseReportCoords(g,l){let r=(0,p.getCoordsRelativeToElement)(window,g,l);if(this._charSizeService.hasValidSize)return r[0]=Math.min(Math.max(r[0],0),this._renderService.dimensions.css.canvas.width-1),r[1]=Math.min(Math.max(r[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(r[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(r[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(r[0]),y:Math.floor(r[1])}}};n.MouseService=m=f([s(0,i.IRenderService),s(1,i.ICharSizeService)],m)},3230:function(h,n,u){var f=this&&this.__decorate||function(D,C,b,S){var v,y=arguments.length,M=y<3?C:S===null?S=Object.getOwnPropertyDescriptor(C,b):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(D,C,b,S);else for(var T=D.length-1;T>=0;T--)(v=D[T])&&(M=(y<3?v(M):y>3?v(C,b,M):v(C,b))||M);return y>3&&M&&Object.defineProperty(C,b,M),M},s=this&&this.__param||function(D,C){return function(b,S){C(b,S,D)}};Object.defineProperty(n,"__esModule",{value:!0}),n.RenderService=void 0;let i=u(3656),p=u(6193),m=u(5596),g=u(4725),l=u(8460),r=u(844),o=u(7226),c=u(2585),_=n.RenderService=class extends r.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(D,C,b,S,v,y,M,T){if(super(),this._rowCount=D,this._charSizeService=S,this._renderer=this.register(new r.MutableDisposable),this._pausedResizeTask=new o.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new l.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new l.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new l.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new l.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new p.RenderDebouncer(M.window,(w,x)=>this._renderRows(w,x)),this.register(this._renderDebouncer),this._screenDprMonitor=new m.ScreenDprMonitor(M.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(y.onResize(()=>this._fullRefresh())),this.register(y.buffers.onBufferActivate(()=>{var w;return(w=this._renderer.value)===null||w===void 0?void 0:w.clear()})),this.register(b.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(v.onDecorationRegistered(()=>this._fullRefresh())),this.register(v.onDecorationRemoved(()=>this._fullRefresh())),this.register(b.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(y.cols,y.rows),this._fullRefresh()})),this.register(b.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(y.buffer.y,y.buffer.y,!0))),this.register((0,i.addDisposableDomListener)(M.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(T.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in M.window){let w=new M.window.IntersectionObserver(x=>this._handleIntersectionChange(x[x.length-1]),{threshold:0});w.observe(C),this.register({dispose:()=>w.disconnect()})}}_handleIntersectionChange(D){this._isPaused=D.isIntersecting===void 0?D.intersectionRatio===0:!D.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(D,C,b=!1){this._isPaused?this._needsFullRefresh=!0:(b||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(D,C,this._rowCount))}_renderRows(D,C){this._renderer.value&&(D=Math.min(D,this._rowCount-1),C=Math.min(C,this._rowCount-1),this._renderer.value.renderRows(D,C),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:D,end:C}),this._onRender.fire({start:D,end:C}),this._isNextRenderRedrawOnly=!0)}resize(D,C){this._rowCount=C,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(D){this._renderer.value=D,this._renderer.value.onRequestRedraw(C=>this.refreshRows(C.start,C.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(D){return this._renderDebouncer.addRefreshCallback(D)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var D,C;this._renderer.value&&((C=(D=this._renderer.value).clearTextureAtlas)===null||C===void 0||C.call(D),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(D,C){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(D,C)):this._renderer.value.handleResize(D,C),this._fullRefresh())}handleCharSizeChanged(){var D;(D=this._renderer.value)===null||D===void 0||D.handleCharSizeChanged()}handleBlur(){var D;(D=this._renderer.value)===null||D===void 0||D.handleBlur()}handleFocus(){var D;(D=this._renderer.value)===null||D===void 0||D.handleFocus()}handleSelectionChanged(D,C,b){var S;this._selectionState.start=D,this._selectionState.end=C,this._selectionState.columnSelectMode=b,(S=this._renderer.value)===null||S===void 0||S.handleSelectionChanged(D,C,b)}handleCursorMove(){var D;(D=this._renderer.value)===null||D===void 0||D.handleCursorMove()}clear(){var D;(D=this._renderer.value)===null||D===void 0||D.clear()}};n.RenderService=_=f([s(2,c.IOptionsService),s(3,g.ICharSizeService),s(4,c.IDecorationService),s(5,c.IBufferService),s(6,g.ICoreBrowserService),s(7,g.IThemeService)],_)},9312:function(h,n,u){var f=this&&this.__decorate||function(v,y,M,T){var w,x=arguments.length,I=x<3?y:T===null?T=Object.getOwnPropertyDescriptor(y,M):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(v,y,M,T);else for(var R=v.length-1;R>=0;R--)(w=v[R])&&(I=(x<3?w(I):x>3?w(y,M,I):w(y,M))||I);return x>3&&I&&Object.defineProperty(y,M,I),I},s=this&&this.__param||function(v,y){return function(M,T){y(M,T,v)}};Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionService=void 0;let i=u(9806),p=u(9504),m=u(456),g=u(4725),l=u(8460),r=u(844),o=u(6114),c=u(4841),_=u(511),D=u(2585),C=String.fromCharCode(160),b=new RegExp(C,"g"),S=n.SelectionService=class extends r.Disposable{constructor(v,y,M,T,w,x,I,R,H){super(),this._element=v,this._screenElement=y,this._linkifier=M,this._bufferService=T,this._coreService=w,this._mouseService=x,this._optionsService=I,this._renderService=R,this._coreBrowserService=H,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new _.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new l.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new l.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new l.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new l.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=W=>this._handleMouseMove(W),this._mouseUpListener=W=>this._handleMouseUp(W),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(W=>this._handleTrim(W)),this.register(this._bufferService.buffers.onBufferActivate(W=>this._handleBufferActivate(W))),this.enable(),this._model=new m.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,r.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){let v=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;return!(!v||!y||v[0]===y[0]&&v[1]===y[1])}get selectionText(){let v=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;if(!v||!y)return"";let M=this._bufferService.buffer,T=[];if(this._activeSelectionMode===3){if(v[0]===y[0])return"";let w=v[0]<y[0]?v[0]:y[0],x=v[0]<y[0]?y[0]:v[0];for(let I=v[1];I<=y[1];I++){let R=M.translateBufferLineToString(I,!0,w,x);T.push(R)}}else{let w=v[1]===y[1]?y[0]:void 0;T.push(M.translateBufferLineToString(v[1],!0,v[0],w));for(let x=v[1]+1;x<=y[1]-1;x++){let I=M.lines.get(x),R=M.translateBufferLineToString(x,!0);I?.isWrapped?T[T.length-1]+=R:T.push(R)}if(v[1]!==y[1]){let x=M.lines.get(y[1]),I=M.translateBufferLineToString(y[1],!0,0,y[0]);x&&x.isWrapped?T[T.length-1]+=I:T.push(I)}}return T.map(w=>w.replace(b," ")).join(o.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(v){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),o.isLinux&&v&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(v){let y=this._getMouseBufferCoords(v),M=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;return!!(M&&T&&y)&&this._areCoordsInSelection(y,M,T)}isCellInSelection(v,y){let M=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;return!(!M||!T)&&this._areCoordsInSelection([v,y],M,T)}_areCoordsInSelection(v,y,M){return v[1]>y[1]&&v[1]<M[1]||y[1]===M[1]&&v[1]===y[1]&&v[0]>=y[0]&&v[0]<M[0]||y[1]<M[1]&&v[1]===M[1]&&v[0]<M[0]||y[1]<M[1]&&v[1]===y[1]&&v[0]>=y[0]}_selectWordAtCursor(v,y){var M,T;let w=(T=(M=this._linkifier.currentLink)===null||M===void 0?void 0:M.link)===null||T===void 0?void 0:T.range;if(w)return this._model.selectionStart=[w.start.x-1,w.start.y-1],this._model.selectionStartLength=(0,c.getRangeLength)(w,this._bufferService.cols),this._model.selectionEnd=void 0,!0;let x=this._getMouseBufferCoords(v);return!!x&&(this._selectWordAt(x,y),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(v,y){this._model.clearSelection(),v=Math.max(v,0),y=Math.min(y,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,v],this._model.selectionEnd=[this._bufferService.cols,y],this.refresh(),this._onSelectionChange.fire()}_handleTrim(v){this._model.handleTrim(v)&&this.refresh()}_getMouseBufferCoords(v){let y=this._mouseService.getCoords(v,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(y)return y[0]--,y[1]--,y[1]+=this._bufferService.buffer.ydisp,y}_getMouseEventScrollAmount(v){let y=(0,i.getCoordsRelativeToElement)(this._coreBrowserService.window,v,this._screenElement)[1],M=this._renderService.dimensions.css.canvas.height;return y>=0&&y<=M?0:(y>M&&(y-=M),y=Math.min(Math.max(y,-50),50),y/=50,y/Math.abs(y)+Math.round(14*y))}shouldForceSelection(v){return o.isMac?v.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:v.shiftKey}handleMouseDown(v){if(this._mouseDownTimeStamp=v.timeStamp,(v.button!==2||!this.hasSelection)&&v.button===0){if(!this._enabled){if(!this.shouldForceSelection(v))return;v.stopPropagation()}v.preventDefault(),this._dragScrollAmount=0,this._enabled&&v.shiftKey?this._handleIncrementalClick(v):v.detail===1?this._handleSingleClick(v):v.detail===2?this._handleDoubleClick(v):v.detail===3&&this._handleTripleClick(v),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(v){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(v))}_handleSingleClick(v){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(v)?3:0,this._model.selectionStart=this._getMouseBufferCoords(v),!this._model.selectionStart)return;this._model.selectionEnd=void 0;let y=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);y&&y.length!==this._model.selectionStart[0]&&y.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(v){this._selectWordAtCursor(v,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(v){let y=this._getMouseBufferCoords(v);y&&(this._activeSelectionMode=2,this._selectLineAt(y[1]))}shouldColumnSelect(v){return v.altKey&&!(o.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(v){if(v.stopImmediatePropagation(),!this._model.selectionStart)return;let y=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(v),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(v),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));let M=this._bufferService.buffer;if(this._model.selectionEnd[1]<M.lines.length){let T=M.lines.get(this._model.selectionEnd[1]);T&&T.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}y&&y[0]===this._model.selectionEnd[0]&&y[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});let v=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(v.ydisp+this._bufferService.rows,v.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=v.ydisp),this.refresh()}}_handleMouseUp(v){let y=v.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&y<500&&v.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){let M=this._mouseService.getCoords(v,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(M&&M[0]!==void 0&&M[1]!==void 0){let T=(0,p.moveToCellSequence)(M[0]-1,M[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(T,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){let v=this._model.finalSelectionStart,y=this._model.finalSelectionEnd,M=!(!v||!y||v[0]===y[0]&&v[1]===y[1]);M?v&&y&&(this._oldSelectionStart&&this._oldSelectionEnd&&v[0]===this._oldSelectionStart[0]&&v[1]===this._oldSelectionStart[1]&&y[0]===this._oldSelectionEnd[0]&&y[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(v,y,M)):this._oldHasSelection&&this._fireOnSelectionChange(v,y,M)}_fireOnSelectionChange(v,y,M){this._oldSelectionStart=v,this._oldSelectionEnd=y,this._oldHasSelection=M,this._onSelectionChange.fire()}_handleBufferActivate(v){this.clearSelection(),this._trimListener.dispose(),this._trimListener=v.activeBuffer.lines.onTrim(y=>this._handleTrim(y))}_convertViewportColToCharacterIndex(v,y){let M=y;for(let T=0;y>=T;T++){let w=v.loadCell(T,this._workCell).getChars().length;this._workCell.getWidth()===0?M--:w>1&&y!==T&&(M+=w-1)}return M}setSelection(v,y,M){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[v,y],this._model.selectionStartLength=M,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(v){this._isClickInSelection(v)||(this._selectWordAtCursor(v,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(v,y,M=!0,T=!0){if(v[0]>=this._bufferService.cols)return;let w=this._bufferService.buffer,x=w.lines.get(v[1]);if(!x)return;let I=w.translateBufferLineToString(v[1],!1),R=this._convertViewportColToCharacterIndex(x,v[0]),H=R,W=v[0]-R,E=0,L=0,A=0,O=0;if(I.charAt(R)===" "){for(;R>0&&I.charAt(R-1)===" ";)R--;for(;H<I.length&&I.charAt(H+1)===" ";)H++}else{let ae=v[0],z=v[0];x.getWidth(ae)===0&&(E++,ae--),x.getWidth(z)===2&&(L++,z++);let fe=x.getString(z).length;for(fe>1&&(O+=fe-1,H+=fe-1);ae>0&&R>0&&!this._isCharWordSeparator(x.loadCell(ae-1,this._workCell));){x.loadCell(ae-1,this._workCell);let F=this._workCell.getChars().length;this._workCell.getWidth()===0?(E++,ae--):F>1&&(A+=F-1,R-=F-1),R--,ae--}for(;z<x.length&&H+1<I.length&&!this._isCharWordSeparator(x.loadCell(z+1,this._workCell));){x.loadCell(z+1,this._workCell);let F=this._workCell.getChars().length;this._workCell.getWidth()===2?(L++,z++):F>1&&(O+=F-1,H+=F-1),H++,z++}}H++;let U=R+W-E+A,Y=Math.min(this._bufferService.cols,H-R+E+L-A-O);if(y||I.slice(R,H).trim()!==""){if(M&&U===0&&x.getCodePoint(0)!==32){let ae=w.lines.get(v[1]-1);if(ae&&x.isWrapped&&ae.getCodePoint(this._bufferService.cols-1)!==32){let z=this._getWordAt([this._bufferService.cols-1,v[1]-1],!1,!0,!1);if(z){let fe=this._bufferService.cols-z.start;U-=fe,Y+=fe}}}if(T&&U+Y===this._bufferService.cols&&x.getCodePoint(this._bufferService.cols-1)!==32){let ae=w.lines.get(v[1]+1);if(ae?.isWrapped&&ae.getCodePoint(0)!==32){let z=this._getWordAt([0,v[1]+1],!1,!1,!0);z&&(Y+=z.length)}}return{start:U,length:Y}}}_selectWordAt(v,y){let M=this._getWordAt(v,y);if(M){for(;M.start<0;)M.start+=this._bufferService.cols,v[1]--;this._model.selectionStart=[M.start,v[1]],this._model.selectionStartLength=M.length}}_selectToWordAt(v){let y=this._getWordAt(v,!0);if(y){let M=v[1];for(;y.start<0;)y.start+=this._bufferService.cols,M--;if(!this._model.areSelectionValuesReversed())for(;y.start+y.length>this._bufferService.cols;)y.length-=this._bufferService.cols,M++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?y.start:y.start+y.length,M]}}_isCharWordSeparator(v){return v.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(v.getChars())>=0}_selectLineAt(v){let y=this._bufferService.buffer.getWrappedRangeForLine(v),M={start:{x:0,y:y.first},end:{x:this._bufferService.cols-1,y:y.last}};this._model.selectionStart=[0,y.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,c.getRangeLength)(M,this._bufferService.cols)}};n.SelectionService=S=f([s(3,D.IBufferService),s(4,D.ICoreService),s(5,g.IMouseService),s(6,D.IOptionsService),s(7,g.IRenderService),s(8,g.ICoreBrowserService)],S)},4725:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IThemeService=n.ICharacterJoinerService=n.ISelectionService=n.IRenderService=n.IMouseService=n.ICoreBrowserService=n.ICharSizeService=void 0;let f=u(8343);n.ICharSizeService=(0,f.createDecorator)("CharSizeService"),n.ICoreBrowserService=(0,f.createDecorator)("CoreBrowserService"),n.IMouseService=(0,f.createDecorator)("MouseService"),n.IRenderService=(0,f.createDecorator)("RenderService"),n.ISelectionService=(0,f.createDecorator)("SelectionService"),n.ICharacterJoinerService=(0,f.createDecorator)("CharacterJoinerService"),n.IThemeService=(0,f.createDecorator)("ThemeService")},6731:function(h,n,u){var f=this&&this.__decorate||function(S,v,y,M){var T,w=arguments.length,x=w<3?v:M===null?M=Object.getOwnPropertyDescriptor(v,y):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(S,v,y,M);else for(var I=S.length-1;I>=0;I--)(T=S[I])&&(x=(w<3?T(x):w>3?T(v,y,x):T(v,y))||x);return w>3&&x&&Object.defineProperty(v,y,x),x},s=this&&this.__param||function(S,v){return function(y,M){v(y,M,S)}};Object.defineProperty(n,"__esModule",{value:!0}),n.ThemeService=n.DEFAULT_ANSI_COLORS=void 0;let i=u(7239),p=u(8055),m=u(8460),g=u(844),l=u(2585),r=p.css.toColor("#ffffff"),o=p.css.toColor("#000000"),c=p.css.toColor("#ffffff"),_=p.css.toColor("#000000"),D={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};n.DEFAULT_ANSI_COLORS=Object.freeze((()=>{let S=[p.css.toColor("#2e3436"),p.css.toColor("#cc0000"),p.css.toColor("#4e9a06"),p.css.toColor("#c4a000"),p.css.toColor("#3465a4"),p.css.toColor("#75507b"),p.css.toColor("#06989a"),p.css.toColor("#d3d7cf"),p.css.toColor("#555753"),p.css.toColor("#ef2929"),p.css.toColor("#8ae234"),p.css.toColor("#fce94f"),p.css.toColor("#729fcf"),p.css.toColor("#ad7fa8"),p.css.toColor("#34e2e2"),p.css.toColor("#eeeeec")],v=[0,95,135,175,215,255];for(let y=0;y<216;y++){let M=v[y/36%6|0],T=v[y/6%6|0],w=v[y%6];S.push({css:p.channels.toCss(M,T,w),rgba:p.channels.toRgba(M,T,w)})}for(let y=0;y<24;y++){let M=8+10*y;S.push({css:p.channels.toCss(M,M,M),rgba:p.channels.toRgba(M,M,M)})}return S})());let C=n.ThemeService=class extends g.Disposable{get colors(){return this._colors}constructor(S){super(),this._optionsService=S,this._contrastCache=new i.ColorContrastCache,this._halfContrastCache=new i.ColorContrastCache,this._onChangeColors=this.register(new m.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:r,background:o,cursor:c,cursorAccent:_,selectionForeground:void 0,selectionBackgroundTransparent:D,selectionBackgroundOpaque:p.color.blend(o,D),selectionInactiveBackgroundTransparent:D,selectionInactiveBackgroundOpaque:p.color.blend(o,D),ansi:n.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(S={}){let v=this._colors;if(v.foreground=b(S.foreground,r),v.background=b(S.background,o),v.cursor=b(S.cursor,c),v.cursorAccent=b(S.cursorAccent,_),v.selectionBackgroundTransparent=b(S.selectionBackground,D),v.selectionBackgroundOpaque=p.color.blend(v.background,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundTransparent=b(S.selectionInactiveBackground,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundOpaque=p.color.blend(v.background,v.selectionInactiveBackgroundTransparent),v.selectionForeground=S.selectionForeground?b(S.selectionForeground,p.NULL_COLOR):void 0,v.selectionForeground===p.NULL_COLOR&&(v.selectionForeground=void 0),p.color.isOpaque(v.selectionBackgroundTransparent)&&(v.selectionBackgroundTransparent=p.color.opacity(v.selectionBackgroundTransparent,.3)),p.color.isOpaque(v.selectionInactiveBackgroundTransparent)&&(v.selectionInactiveBackgroundTransparent=p.color.opacity(v.selectionInactiveBackgroundTransparent,.3)),v.ansi=n.DEFAULT_ANSI_COLORS.slice(),v.ansi[0]=b(S.black,n.DEFAULT_ANSI_COLORS[0]),v.ansi[1]=b(S.red,n.DEFAULT_ANSI_COLORS[1]),v.ansi[2]=b(S.green,n.DEFAULT_ANSI_COLORS[2]),v.ansi[3]=b(S.yellow,n.DEFAULT_ANSI_COLORS[3]),v.ansi[4]=b(S.blue,n.DEFAULT_ANSI_COLORS[4]),v.ansi[5]=b(S.magenta,n.DEFAULT_ANSI_COLORS[5]),v.ansi[6]=b(S.cyan,n.DEFAULT_ANSI_COLORS[6]),v.ansi[7]=b(S.white,n.DEFAULT_ANSI_COLORS[7]),v.ansi[8]=b(S.brightBlack,n.DEFAULT_ANSI_COLORS[8]),v.ansi[9]=b(S.brightRed,n.DEFAULT_ANSI_COLORS[9]),v.ansi[10]=b(S.brightGreen,n.DEFAULT_ANSI_COLORS[10]),v.ansi[11]=b(S.brightYellow,n.DEFAULT_ANSI_COLORS[11]),v.ansi[12]=b(S.brightBlue,n.DEFAULT_ANSI_COLORS[12]),v.ansi[13]=b(S.brightMagenta,n.DEFAULT_ANSI_COLORS[13]),v.ansi[14]=b(S.brightCyan,n.DEFAULT_ANSI_COLORS[14]),v.ansi[15]=b(S.brightWhite,n.DEFAULT_ANSI_COLORS[15]),S.extendedAnsi){let y=Math.min(v.ansi.length-16,S.extendedAnsi.length);for(let M=0;M<y;M++)v.ansi[M+16]=b(S.extendedAnsi[M],n.DEFAULT_ANSI_COLORS[M+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(S){this._restoreColor(S),this._onChangeColors.fire(this.colors)}_restoreColor(S){if(S!==void 0)switch(S){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[S]=this._restoreColors.ansi[S]}else for(let v=0;v<this._restoreColors.ansi.length;++v)this._colors.ansi[v]=this._restoreColors.ansi[v]}modifyColors(S){S(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function b(S,v){if(S!==void 0)try{return p.css.toColor(S)}catch{}return v}n.ThemeService=C=f([s(0,l.IOptionsService)],C)},6349:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CircularList=void 0;let f=u(8460),s=u(844);class i extends s.Disposable{constructor(m){super(),this._maxLength=m,this.onDeleteEmitter=this.register(new f.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new f.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new f.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(m){if(this._maxLength===m)return;let g=new Array(m);for(let l=0;l<Math.min(m,this.length);l++)g[l]=this._array[this._getCyclicIndex(l)];this._array=g,this._maxLength=m,this._startIndex=0}get length(){return this._length}set length(m){if(m>this._length)for(let g=this._length;g<m;g++)this._array[g]=void 0;this._length=m}get(m){return this._array[this._getCyclicIndex(m)]}set(m,g){this._array[this._getCyclicIndex(m)]=g}push(m){this._array[this._getCyclicIndex(this._length)]=m,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(m,g,...l){if(g){for(let r=m;r<this._length-g;r++)this._array[this._getCyclicIndex(r)]=this._array[this._getCyclicIndex(r+g)];this._length-=g,this.onDeleteEmitter.fire({index:m,amount:g})}for(let r=this._length-1;r>=m;r--)this._array[this._getCyclicIndex(r+l.length)]=this._array[this._getCyclicIndex(r)];for(let r=0;r<l.length;r++)this._array[this._getCyclicIndex(m+r)]=l[r];if(l.length&&this.onInsertEmitter.fire({index:m,amount:l.length}),this._length+l.length>this._maxLength){let r=this._length+l.length-this._maxLength;this._startIndex+=r,this._length=this._maxLength,this.onTrimEmitter.fire(r)}else this._length+=l.length}trimStart(m){m>this._length&&(m=this._length),this._startIndex+=m,this._length-=m,this.onTrimEmitter.fire(m)}shiftElements(m,g,l){if(!(g<=0)){if(m<0||m>=this._length)throw new Error("start argument out of range");if(m+l<0)throw new Error("Cannot shift elements in list beyond index 0");if(l>0){for(let o=g-1;o>=0;o--)this.set(m+o+l,this.get(m+o));let r=m+g+l-this._length;if(r>0)for(this._length+=r;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let r=0;r<g;r++)this.set(m+r+l,this.get(m+r))}}_getCyclicIndex(m){return(this._startIndex+m)%this._maxLength}}n.CircularList=i},1439:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.clone=void 0,n.clone=function u(f,s=5){if(typeof f!="object")return f;let i=Array.isArray(f)?[]:{};for(let p in f)i[p]=s<=1?f[p]:f[p]&&u(f[p],s-1);return i}},8055:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.contrastRatio=n.toPaddedHex=n.rgba=n.rgb=n.css=n.color=n.channels=n.NULL_COLOR=void 0;let f=u(6114),s=0,i=0,p=0,m=0;var g,l,r,o,c;function _(C){let b=C.toString(16);return b.length<2?"0"+b:b}function D(C,b){return C<b?(b+.05)/(C+.05):(C+.05)/(b+.05)}n.NULL_COLOR={css:"#00000000",rgba:0},function(C){C.toCss=function(b,S,v,y){return y!==void 0?`#${_(b)}${_(S)}${_(v)}${_(y)}`:`#${_(b)}${_(S)}${_(v)}`},C.toRgba=function(b,S,v,y=255){return(b<<24|S<<16|v<<8|y)>>>0}}(g||(n.channels=g={})),function(C){function b(S,v){return m=Math.round(255*v),[s,i,p]=c.toChannels(S.rgba),{css:g.toCss(s,i,p,m),rgba:g.toRgba(s,i,p,m)}}C.blend=function(S,v){if(m=(255&v.rgba)/255,m===1)return{css:v.css,rgba:v.rgba};let y=v.rgba>>24&255,M=v.rgba>>16&255,T=v.rgba>>8&255,w=S.rgba>>24&255,x=S.rgba>>16&255,I=S.rgba>>8&255;return s=w+Math.round((y-w)*m),i=x+Math.round((M-x)*m),p=I+Math.round((T-I)*m),{css:g.toCss(s,i,p),rgba:g.toRgba(s,i,p)}},C.isOpaque=function(S){return(255&S.rgba)==255},C.ensureContrastRatio=function(S,v,y){let M=c.ensureContrastRatio(S.rgba,v.rgba,y);if(M)return c.toColor(M>>24&255,M>>16&255,M>>8&255)},C.opaque=function(S){let v=(255|S.rgba)>>>0;return[s,i,p]=c.toChannels(v),{css:g.toCss(s,i,p),rgba:v}},C.opacity=b,C.multiplyOpacity=function(S,v){return m=255&S.rgba,b(S,m*v/255)},C.toColorRGB=function(S){return[S.rgba>>24&255,S.rgba>>16&255,S.rgba>>8&255]}}(l||(n.color=l={})),function(C){let b,S;if(!f.isNode){let v=document.createElement("canvas");v.width=1,v.height=1;let y=v.getContext("2d",{willReadFrequently:!0});y&&(b=y,b.globalCompositeOperation="copy",S=b.createLinearGradient(0,0,1,1))}C.toColor=function(v){if(v.match(/#[\da-f]{3,8}/i))switch(v.length){case 4:return s=parseInt(v.slice(1,2).repeat(2),16),i=parseInt(v.slice(2,3).repeat(2),16),p=parseInt(v.slice(3,4).repeat(2),16),c.toColor(s,i,p);case 5:return s=parseInt(v.slice(1,2).repeat(2),16),i=parseInt(v.slice(2,3).repeat(2),16),p=parseInt(v.slice(3,4).repeat(2),16),m=parseInt(v.slice(4,5).repeat(2),16),c.toColor(s,i,p,m);case 7:return{css:v,rgba:(parseInt(v.slice(1),16)<<8|255)>>>0};case 9:return{css:v,rgba:parseInt(v.slice(1),16)>>>0}}let y=v.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(y)return s=parseInt(y[1]),i=parseInt(y[2]),p=parseInt(y[3]),m=Math.round(255*(y[5]===void 0?1:parseFloat(y[5]))),c.toColor(s,i,p,m);if(!b||!S)throw new Error("css.toColor: Unsupported css format");if(b.fillStyle=S,b.fillStyle=v,typeof b.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(b.fillRect(0,0,1,1),[s,i,p,m]=b.getImageData(0,0,1,1).data,m!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:g.toRgba(s,i,p,m),css:v}}}(r||(n.css=r={})),function(C){function b(S,v,y){let M=S/255,T=v/255,w=y/255;return .2126*(M<=.03928?M/12.92:Math.pow((M+.055)/1.055,2.4))+.7152*(T<=.03928?T/12.92:Math.pow((T+.055)/1.055,2.4))+.0722*(w<=.03928?w/12.92:Math.pow((w+.055)/1.055,2.4))}C.relativeLuminance=function(S){return b(S>>16&255,S>>8&255,255&S)},C.relativeLuminance2=b}(o||(n.rgb=o={})),function(C){function b(v,y,M){let T=v>>24&255,w=v>>16&255,x=v>>8&255,I=y>>24&255,R=y>>16&255,H=y>>8&255,W=D(o.relativeLuminance2(I,R,H),o.relativeLuminance2(T,w,x));for(;W<M&&(I>0||R>0||H>0);)I-=Math.max(0,Math.ceil(.1*I)),R-=Math.max(0,Math.ceil(.1*R)),H-=Math.max(0,Math.ceil(.1*H)),W=D(o.relativeLuminance2(I,R,H),o.relativeLuminance2(T,w,x));return(I<<24|R<<16|H<<8|255)>>>0}function S(v,y,M){let T=v>>24&255,w=v>>16&255,x=v>>8&255,I=y>>24&255,R=y>>16&255,H=y>>8&255,W=D(o.relativeLuminance2(I,R,H),o.relativeLuminance2(T,w,x));for(;W<M&&(I<255||R<255||H<255);)I=Math.min(255,I+Math.ceil(.1*(255-I))),R=Math.min(255,R+Math.ceil(.1*(255-R))),H=Math.min(255,H+Math.ceil(.1*(255-H))),W=D(o.relativeLuminance2(I,R,H),o.relativeLuminance2(T,w,x));return(I<<24|R<<16|H<<8|255)>>>0}C.ensureContrastRatio=function(v,y,M){let T=o.relativeLuminance(v>>8),w=o.relativeLuminance(y>>8);if(D(T,w)<M){if(w<T){let R=b(v,y,M),H=D(T,o.relativeLuminance(R>>8));if(H<M){let W=S(v,y,M);return H>D(T,o.relativeLuminance(W>>8))?R:W}return R}let x=S(v,y,M),I=D(T,o.relativeLuminance(x>>8));if(I<M){let R=b(v,y,M);return I>D(T,o.relativeLuminance(R>>8))?x:R}return x}},C.reduceLuminance=b,C.increaseLuminance=S,C.toChannels=function(v){return[v>>24&255,v>>16&255,v>>8&255,255&v]},C.toColor=function(v,y,M,T){return{css:g.toCss(v,y,M,T),rgba:g.toRgba(v,y,M,T)}}}(c||(n.rgba=c={})),n.toPaddedHex=_,n.contrastRatio=D},8969:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CoreTerminal=void 0;let f=u(844),s=u(2585),i=u(4348),p=u(7866),m=u(744),g=u(7302),l=u(6975),r=u(8460),o=u(1753),c=u(1480),_=u(7994),D=u(9282),C=u(5435),b=u(5981),S=u(2660),v=!1;class y extends f.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new r.EventEmitter),this._onScroll.event(T=>{var w;(w=this._onScrollApi)===null||w===void 0||w.fire(T.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(T){for(let w in T)this.optionsService.options[w]=T[w]}constructor(T){super(),this._windowsWrappingHeuristics=this.register(new f.MutableDisposable),this._onBinary=this.register(new r.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new r.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new r.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new r.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new r.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new r.EventEmitter),this._instantiationService=new i.InstantiationService,this.optionsService=this.register(new g.OptionsService(T)),this._instantiationService.setService(s.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(m.BufferService)),this._instantiationService.setService(s.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(p.LogService)),this._instantiationService.setService(s.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(l.CoreService)),this._instantiationService.setService(s.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(o.CoreMouseService)),this._instantiationService.setService(s.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(c.UnicodeService)),this._instantiationService.setService(s.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(_.CharsetService),this._instantiationService.setService(s.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(S.OscLinkService),this._instantiationService.setService(s.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new C.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,r.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,r.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,r.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,r.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(w=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(w=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new b.WriteBuffer((w,x)=>this._inputHandler.parse(w,x))),this.register((0,r.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(T,w){this._writeBuffer.write(T,w)}writeSync(T,w){this._logService.logLevel<=s.LogLevelEnum.WARN&&!v&&(this._logService.warn("writeSync is unreliable and will be removed soon."),v=!0),this._writeBuffer.writeSync(T,w)}resize(T,w){isNaN(T)||isNaN(w)||(T=Math.max(T,m.MINIMUM_COLS),w=Math.max(w,m.MINIMUM_ROWS),this._bufferService.resize(T,w))}scroll(T,w=!1){this._bufferService.scroll(T,w)}scrollLines(T,w,x){this._bufferService.scrollLines(T,w,x)}scrollPages(T){this.scrollLines(T*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(T){let w=T-this._bufferService.buffer.ydisp;w!==0&&this.scrollLines(w)}registerEscHandler(T,w){return this._inputHandler.registerEscHandler(T,w)}registerDcsHandler(T,w){return this._inputHandler.registerDcsHandler(T,w)}registerCsiHandler(T,w){return this._inputHandler.registerCsiHandler(T,w)}registerOscHandler(T,w){return this._inputHandler.registerOscHandler(T,w)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let T=!1,w=this.optionsService.rawOptions.windowsPty;w&&w.buildNumber!==void 0&&w.buildNumber!==void 0?T=w.backend==="conpty"&&w.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(T=!0),T?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){let T=[];T.push(this.onLineFeed(D.updateWindowsModeWrappedState.bind(null,this._bufferService))),T.push(this.registerCsiHandler({final:"H"},()=>((0,D.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,f.toDisposable)(()=>{for(let w of T)w.dispose()})}}}n.CoreTerminal=y},8460:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.forwardEvent=n.EventEmitter=void 0,n.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=u=>(this._listeners.push(u),{dispose:()=>{if(!this._disposed){for(let f=0;f<this._listeners.length;f++)if(this._listeners[f]===u)return void this._listeners.splice(f,1)}}})),this._event}fire(u,f){let s=[];for(let i=0;i<this._listeners.length;i++)s.push(this._listeners[i]);for(let i=0;i<s.length;i++)s[i].call(void 0,u,f)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},n.forwardEvent=function(u,f){return u(s=>f.fire(s))}},5435:function(h,n,u){var f=this&&this.__decorate||function(W,E,L,A){var O,U=arguments.length,Y=U<3?E:A===null?A=Object.getOwnPropertyDescriptor(E,L):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Y=Reflect.decorate(W,E,L,A);else for(var ae=W.length-1;ae>=0;ae--)(O=W[ae])&&(Y=(U<3?O(Y):U>3?O(E,L,Y):O(E,L))||Y);return U>3&&Y&&Object.defineProperty(E,L,Y),Y},s=this&&this.__param||function(W,E){return function(L,A){E(L,A,W)}};Object.defineProperty(n,"__esModule",{value:!0}),n.InputHandler=n.WindowsOptionsReportType=void 0;let i=u(2584),p=u(7116),m=u(2015),g=u(844),l=u(482),r=u(8437),o=u(8460),c=u(643),_=u(511),D=u(3734),C=u(2585),b=u(6242),S=u(6351),v=u(5941),y={"(":0,")":1,"*":2,"+":3,"-":1,".":2},M=131072;function T(W,E){if(W>24)return E.setWinLines||!1;switch(W){case 1:return!!E.restoreWin;case 2:return!!E.minimizeWin;case 3:return!!E.setWinPosition;case 4:return!!E.setWinSizePixels;case 5:return!!E.raiseWin;case 6:return!!E.lowerWin;case 7:return!!E.refreshWin;case 8:return!!E.setWinSizeChars;case 9:return!!E.maximizeWin;case 10:return!!E.fullscreenWin;case 11:return!!E.getWinState;case 13:return!!E.getWinPosition;case 14:return!!E.getWinSizePixels;case 15:return!!E.getScreenSizePixels;case 16:return!!E.getCellSizePixels;case 18:return!!E.getWinSizeChars;case 19:return!!E.getScreenSizeChars;case 20:return!!E.getIconTitle;case 21:return!!E.getWinTitle;case 22:return!!E.pushTitle;case 23:return!!E.popTitle;case 24:return!!E.setWinLines}return!1}var w;(function(W){W[W.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",W[W.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(w||(n.WindowsOptionsReportType=w={}));let x=0;class I extends g.Disposable{getAttrData(){return this._curAttrData}constructor(E,L,A,O,U,Y,ae,z,fe=new m.EscapeSequenceParser){super(),this._bufferService=E,this._charsetService=L,this._coreService=A,this._logService=O,this._optionsService=U,this._oscLinkService=Y,this._coreMouseService=ae,this._unicodeService=z,this._parser=fe,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new l.StringToUtf32,this._utf8Decoder=new l.Utf8ToUtf32,this._workCell=new _.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=r.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=r.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new o.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new o.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new o.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new o.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new o.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new o.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new o.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new o.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new o.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new o.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new o.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new o.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new o.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new R(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(F=>this._activeBuffer=F.activeBuffer)),this._parser.setCsiHandlerFallback((F,N)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(F),params:N.toArray()})}),this._parser.setEscHandlerFallback(F=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(F)})}),this._parser.setExecuteHandlerFallback(F=>{this._logService.debug("Unknown EXECUTE code: ",{code:F})}),this._parser.setOscHandlerFallback((F,N,B)=>{this._logService.debug("Unknown OSC code: ",{identifier:F,action:N,data:B})}),this._parser.setDcsHandlerFallback((F,N,B)=>{N==="HOOK"&&(B=B.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(F),action:N,payload:B})}),this._parser.setPrintHandler((F,N,B)=>this.print(F,N,B)),this._parser.registerCsiHandler({final:"@"},F=>this.insertChars(F)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},F=>this.scrollLeft(F)),this._parser.registerCsiHandler({final:"A"},F=>this.cursorUp(F)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},F=>this.scrollRight(F)),this._parser.registerCsiHandler({final:"B"},F=>this.cursorDown(F)),this._parser.registerCsiHandler({final:"C"},F=>this.cursorForward(F)),this._parser.registerCsiHandler({final:"D"},F=>this.cursorBackward(F)),this._parser.registerCsiHandler({final:"E"},F=>this.cursorNextLine(F)),this._parser.registerCsiHandler({final:"F"},F=>this.cursorPrecedingLine(F)),this._parser.registerCsiHandler({final:"G"},F=>this.cursorCharAbsolute(F)),this._parser.registerCsiHandler({final:"H"},F=>this.cursorPosition(F)),this._parser.registerCsiHandler({final:"I"},F=>this.cursorForwardTab(F)),this._parser.registerCsiHandler({final:"J"},F=>this.eraseInDisplay(F,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},F=>this.eraseInDisplay(F,!0)),this._parser.registerCsiHandler({final:"K"},F=>this.eraseInLine(F,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},F=>this.eraseInLine(F,!0)),this._parser.registerCsiHandler({final:"L"},F=>this.insertLines(F)),this._parser.registerCsiHandler({final:"M"},F=>this.deleteLines(F)),this._parser.registerCsiHandler({final:"P"},F=>this.deleteChars(F)),this._parser.registerCsiHandler({final:"S"},F=>this.scrollUp(F)),this._parser.registerCsiHandler({final:"T"},F=>this.scrollDown(F)),this._parser.registerCsiHandler({final:"X"},F=>this.eraseChars(F)),this._parser.registerCsiHandler({final:"Z"},F=>this.cursorBackwardTab(F)),this._parser.registerCsiHandler({final:"`"},F=>this.charPosAbsolute(F)),this._parser.registerCsiHandler({final:"a"},F=>this.hPositionRelative(F)),this._parser.registerCsiHandler({final:"b"},F=>this.repeatPrecedingCharacter(F)),this._parser.registerCsiHandler({final:"c"},F=>this.sendDeviceAttributesPrimary(F)),this._parser.registerCsiHandler({prefix:">",final:"c"},F=>this.sendDeviceAttributesSecondary(F)),this._parser.registerCsiHandler({final:"d"},F=>this.linePosAbsolute(F)),this._parser.registerCsiHandler({final:"e"},F=>this.vPositionRelative(F)),this._parser.registerCsiHandler({final:"f"},F=>this.hVPosition(F)),this._parser.registerCsiHandler({final:"g"},F=>this.tabClear(F)),this._parser.registerCsiHandler({final:"h"},F=>this.setMode(F)),this._parser.registerCsiHandler({prefix:"?",final:"h"},F=>this.setModePrivate(F)),this._parser.registerCsiHandler({final:"l"},F=>this.resetMode(F)),this._parser.registerCsiHandler({prefix:"?",final:"l"},F=>this.resetModePrivate(F)),this._parser.registerCsiHandler({final:"m"},F=>this.charAttributes(F)),this._parser.registerCsiHandler({final:"n"},F=>this.deviceStatus(F)),this._parser.registerCsiHandler({prefix:"?",final:"n"},F=>this.deviceStatusPrivate(F)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},F=>this.softReset(F)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},F=>this.setCursorStyle(F)),this._parser.registerCsiHandler({final:"r"},F=>this.setScrollRegion(F)),this._parser.registerCsiHandler({final:"s"},F=>this.saveCursor(F)),this._parser.registerCsiHandler({final:"t"},F=>this.windowOptions(F)),this._parser.registerCsiHandler({final:"u"},F=>this.restoreCursor(F)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},F=>this.insertColumns(F)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},F=>this.deleteColumns(F)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},F=>this.selectProtected(F)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},F=>this.requestMode(F,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},F=>this.requestMode(F,!1)),this._parser.setExecuteHandler(i.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(i.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(i.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(i.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(i.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(i.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(i.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(i.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(i.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(i.C1.IND,()=>this.index()),this._parser.setExecuteHandler(i.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(i.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new b.OscHandler(F=>(this.setTitle(F),this.setIconName(F),!0))),this._parser.registerOscHandler(1,new b.OscHandler(F=>this.setIconName(F))),this._parser.registerOscHandler(2,new b.OscHandler(F=>this.setTitle(F))),this._parser.registerOscHandler(4,new b.OscHandler(F=>this.setOrReportIndexedColor(F))),this._parser.registerOscHandler(8,new b.OscHandler(F=>this.setHyperlink(F))),this._parser.registerOscHandler(10,new b.OscHandler(F=>this.setOrReportFgColor(F))),this._parser.registerOscHandler(11,new b.OscHandler(F=>this.setOrReportBgColor(F))),this._parser.registerOscHandler(12,new b.OscHandler(F=>this.setOrReportCursorColor(F))),this._parser.registerOscHandler(104,new b.OscHandler(F=>this.restoreIndexedColor(F))),this._parser.registerOscHandler(110,new b.OscHandler(F=>this.restoreFgColor(F))),this._parser.registerOscHandler(111,new b.OscHandler(F=>this.restoreBgColor(F))),this._parser.registerOscHandler(112,new b.OscHandler(F=>this.restoreCursorColor(F))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(let F in p.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:F},()=>this.selectCharset("("+F)),this._parser.registerEscHandler({intermediates:")",final:F},()=>this.selectCharset(")"+F)),this._parser.registerEscHandler({intermediates:"*",final:F},()=>this.selectCharset("*"+F)),this._parser.registerEscHandler({intermediates:"+",final:F},()=>this.selectCharset("+"+F)),this._parser.registerEscHandler({intermediates:"-",final:F},()=>this.selectCharset("-"+F)),this._parser.registerEscHandler({intermediates:".",final:F},()=>this.selectCharset("."+F)),this._parser.registerEscHandler({intermediates:"/",final:F},()=>this.selectCharset("/"+F));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(F=>(this._logService.error("Parsing error: ",F),F)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new S.DcsHandler((F,N)=>this.requestStatusString(F,N)))}_preserveStack(E,L,A,O){this._parseStack.paused=!0,this._parseStack.cursorStartX=E,this._parseStack.cursorStartY=L,this._parseStack.decodedLength=A,this._parseStack.position=O}_logSlowResolvingAsync(E){this._logService.logLevel<=C.LogLevelEnum.WARN&&Promise.race([E,new Promise((L,A)=>setTimeout(()=>A("#SLOW_TIMEOUT"),5e3))]).catch(L=>{if(L!=="#SLOW_TIMEOUT")throw L;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(E,L){let A,O=this._activeBuffer.x,U=this._activeBuffer.y,Y=0,ae=this._parseStack.paused;if(ae){if(A=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,L))return this._logSlowResolvingAsync(A),A;O=this._parseStack.cursorStartX,U=this._parseStack.cursorStartY,this._parseStack.paused=!1,E.length>M&&(Y=this._parseStack.position+M)}if(this._logService.logLevel<=C.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof E=="string"?` "${E}"`:` "${Array.prototype.map.call(E,z=>String.fromCharCode(z)).join("")}"`),typeof E=="string"?E.split("").map(z=>z.charCodeAt(0)):E),this._parseBuffer.length<E.length&&this._parseBuffer.length<M&&(this._parseBuffer=new Uint32Array(Math.min(E.length,M))),ae||this._dirtyRowTracker.clearRange(),E.length>M)for(let z=Y;z<E.length;z+=M){let fe=z+M<E.length?z+M:E.length,F=typeof E=="string"?this._stringDecoder.decode(E.substring(z,fe),this._parseBuffer):this._utf8Decoder.decode(E.subarray(z,fe),this._parseBuffer);if(A=this._parser.parse(this._parseBuffer,F))return this._preserveStack(O,U,F,z),this._logSlowResolvingAsync(A),A}else if(!ae){let z=typeof E=="string"?this._stringDecoder.decode(E,this._parseBuffer):this._utf8Decoder.decode(E,this._parseBuffer);if(A=this._parser.parse(this._parseBuffer,z))return this._preserveStack(O,U,z,0),this._logSlowResolvingAsync(A),A}this._activeBuffer.x===O&&this._activeBuffer.y===U||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(E,L,A){let O,U,Y=this._charsetService.charset,ae=this._optionsService.rawOptions.screenReaderMode,z=this._bufferService.cols,fe=this._coreService.decPrivateModes.wraparound,F=this._coreService.modes.insertMode,N=this._curAttrData,B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&A-L>0&&B.getWidth(this._activeBuffer.x-1)===2&&B.setCellFromCodePoint(this._activeBuffer.x-1,0,1,N.fg,N.bg,N.extended);for(let P=L;P<A;++P){if(O=E[P],U=this._unicodeService.wcwidth(O),O<127&&Y){let le=Y[String.fromCharCode(O)];le&&(O=le.charCodeAt(0))}if(ae&&this._onA11yChar.fire((0,l.stringFromCodePoint)(O)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),U||!this._activeBuffer.x){if(this._activeBuffer.x+U-1>=z){if(fe){for(;this._activeBuffer.x<z;)B.setCellFromCodePoint(this._activeBuffer.x++,0,1,N.fg,N.bg,N.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=z-1,U===2)continue}if(F&&(B.insertCells(this._activeBuffer.x,U,this._activeBuffer.getNullCell(N),N),B.getWidth(z-1)===2&&B.setCellFromCodePoint(z-1,c.NULL_CELL_CODE,c.NULL_CELL_WIDTH,N.fg,N.bg,N.extended)),B.setCellFromCodePoint(this._activeBuffer.x++,O,U,N.fg,N.bg,N.extended),U>0)for(;--U;)B.setCellFromCodePoint(this._activeBuffer.x++,0,0,N.fg,N.bg,N.extended)}else B.getWidth(this._activeBuffer.x-1)?B.addCodepointToCell(this._activeBuffer.x-1,O):B.addCodepointToCell(this._activeBuffer.x-2,O)}A-L>0&&(B.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<z&&A-L>0&&B.getWidth(this._activeBuffer.x)===0&&!B.hasContent(this._activeBuffer.x)&&B.setCellFromCodePoint(this._activeBuffer.x,0,1,N.fg,N.bg,N.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(E,L){return E.final!=="t"||E.prefix||E.intermediates?this._parser.registerCsiHandler(E,L):this._parser.registerCsiHandler(E,A=>!T(A.params[0],this._optionsService.rawOptions.windowOptions)||L(A))}registerDcsHandler(E,L){return this._parser.registerDcsHandler(E,new S.DcsHandler(L))}registerEscHandler(E,L){return this._parser.registerEscHandler(E,L)}registerOscHandler(E,L){return this._parser.registerOscHandler(E,new b.OscHandler(L))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var E;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||E===void 0)&&E.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;let L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);L.hasWidth(this._activeBuffer.x)&&!L.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let E=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-E),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(E=this._bufferService.cols-1){this._activeBuffer.x=Math.min(E,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(E,L){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=E,this._activeBuffer.y=this._activeBuffer.scrollTop+L):(this._activeBuffer.x=E,this._activeBuffer.y=L),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(E,L){this._restrictCursor(),this._setCursor(this._activeBuffer.x+E,this._activeBuffer.y+L)}cursorUp(E){let L=this._activeBuffer.y-this._activeBuffer.scrollTop;return L>=0?this._moveCursor(0,-Math.min(L,E.params[0]||1)):this._moveCursor(0,-(E.params[0]||1)),!0}cursorDown(E){let L=this._activeBuffer.scrollBottom-this._activeBuffer.y;return L>=0?this._moveCursor(0,Math.min(L,E.params[0]||1)):this._moveCursor(0,E.params[0]||1),!0}cursorForward(E){return this._moveCursor(E.params[0]||1,0),!0}cursorBackward(E){return this._moveCursor(-(E.params[0]||1),0),!0}cursorNextLine(E){return this.cursorDown(E),this._activeBuffer.x=0,!0}cursorPrecedingLine(E){return this.cursorUp(E),this._activeBuffer.x=0,!0}cursorCharAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(E){return this._setCursor(E.length>=2?(E.params[1]||1)-1:0,(E.params[0]||1)-1),!0}charPosAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(E){return this._moveCursor(E.params[0]||1,0),!0}linePosAbsolute(E){return this._setCursor(this._activeBuffer.x,(E.params[0]||1)-1),!0}vPositionRelative(E){return this._moveCursor(0,E.params[0]||1),!0}hVPosition(E){return this.cursorPosition(E),!0}tabClear(E){let L=E.params[0];return L===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:L===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let L=E.params[0]||1;for(;L--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let L=E.params[0]||1;for(;L--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(E){let L=E.params[0];return L===1&&(this._curAttrData.bg|=536870912),L!==2&&L!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(E,L,A,O=!1,U=!1){let Y=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);Y.replaceCells(L,A,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),U),O&&(Y.isWrapped=!1)}_resetBufferLine(E,L=!1){let A=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);A&&(A.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),L),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+E),A.isWrapped=!1)}eraseInDisplay(E,L=!1){let A;switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:for(A=this._activeBuffer.y,this._dirtyRowTracker.markDirty(A),this._eraseInBufferLine(A++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,L);A<this._bufferService.rows;A++)this._resetBufferLine(A,L);this._dirtyRowTracker.markDirty(A);break;case 1:for(A=this._activeBuffer.y,this._dirtyRowTracker.markDirty(A),this._eraseInBufferLine(A,0,this._activeBuffer.x+1,!0,L),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(A+1).isWrapped=!1);A--;)this._resetBufferLine(A,L);this._dirtyRowTracker.markDirty(0);break;case 2:for(A=this._bufferService.rows,this._dirtyRowTracker.markDirty(A-1);A--;)this._resetBufferLine(A,L);this._dirtyRowTracker.markDirty(0);break;case 3:let O=this._activeBuffer.lines.length-this._bufferService.rows;O>0&&(this._activeBuffer.lines.trimStart(O),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-O,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-O,0),this._onScroll.fire(0))}return!0}eraseInLine(E,L=!1){switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,L);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,L);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,L)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(E){this._restrictCursor();let L=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let A=this._activeBuffer.ybase+this._activeBuffer.y,O=this._bufferService.rows-1-this._activeBuffer.scrollBottom,U=this._bufferService.rows-1+this._activeBuffer.ybase-O+1;for(;L--;)this._activeBuffer.lines.splice(U-1,1),this._activeBuffer.lines.splice(A,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(E){this._restrictCursor();let L=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let A=this._activeBuffer.ybase+this._activeBuffer.y,O;for(O=this._bufferService.rows-1-this._activeBuffer.scrollBottom,O=this._bufferService.rows-1+this._activeBuffer.ybase-O;L--;)this._activeBuffer.lines.splice(A,1),this._activeBuffer.lines.splice(O,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(E){this._restrictCursor();let L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.insertCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(E){this._restrictCursor();let L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.deleteCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(E){let L=E.params[0]||1;for(;L--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(E){let L=E.params[0]||1;for(;L--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(r.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let L=E.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){let O=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);O.deleteCells(0,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let L=E.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){let O=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);O.insertCells(0,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let L=E.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){let O=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);O.insertCells(this._activeBuffer.x,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let L=E.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){let O=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);O.deleteCells(this._activeBuffer.x,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(E){this._restrictCursor();let L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(E.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(E){if(!this._parser.precedingCodepoint)return!0;let L=E.params[0]||1,A=new Uint32Array(L);for(let O=0;O<L;++O)A[O]=this._parser.precedingCodepoint;return this.print(A,0,A.length),!0}sendDeviceAttributesPrimary(E){return E.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(i.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(i.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(E){return E.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(i.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(i.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(E.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(i.C0.ESC+"[>83;40003;0c")),!0}_is(E){return(this._optionsService.rawOptions.termName+"").indexOf(E)===0}setMode(E){for(let L=0;L<E.length;L++)switch(E.params[L]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(E){for(let L=0;L<E.length;L++)switch(E.params[L]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,p.DEFAULT_CHARSET),this._charsetService.setgCharset(1,p.DEFAULT_CHARSET),this._charsetService.setgCharset(2,p.DEFAULT_CHARSET),this._charsetService.setgCharset(3,p.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(E){for(let L=0;L<E.length;L++)switch(E.params[L]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(E){for(let L=0;L<E.length;L++)switch(E.params[L]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),E.params[L]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(E,L){let A=this._coreService.decPrivateModes,{activeProtocol:O,activeEncoding:U}=this._coreMouseService,Y=this._coreService,{buffers:ae,cols:z}=this._bufferService,{active:fe,alt:F}=ae,N=this._optionsService.rawOptions,B=Fe=>Fe?1:2,P=E.params[0];return le=P,j=L?P===2?4:P===4?B(Y.modes.insertMode):P===12?3:P===20?B(N.convertEol):0:P===1?B(A.applicationCursorKeys):P===3?N.windowOptions.setWinLines?z===80?2:z===132?1:0:0:P===6?B(A.origin):P===7?B(A.wraparound):P===8?3:P===9?B(O==="X10"):P===12?B(N.cursorBlink):P===25?B(!Y.isCursorHidden):P===45?B(A.reverseWraparound):P===66?B(A.applicationKeypad):P===67?4:P===1e3?B(O==="VT200"):P===1002?B(O==="DRAG"):P===1003?B(O==="ANY"):P===1004?B(A.sendFocus):P===1005?4:P===1006?B(U==="SGR"):P===1015?4:P===1016?B(U==="SGR_PIXELS"):P===1048?1:P===47||P===1047||P===1049?B(fe===F):P===2004?B(A.bracketedPasteMode):0,Y.triggerDataEvent(`${i.C0.ESC}[${L?"":"?"}${le};${j}$y`),!0;var le,j}_updateAttrColor(E,L,A,O,U){return L===2?(E|=50331648,E&=-16777216,E|=D.AttributeData.fromColorRGB([A,O,U])):L===5&&(E&=-50331904,E|=33554432|255&A),E}_extractColor(E,L,A){let O=[0,0,-1,0,0,0],U=0,Y=0;do{if(O[Y+U]=E.params[L+Y],E.hasSubParams(L+Y)){let ae=E.getSubParams(L+Y),z=0;do O[1]===5&&(U=1),O[Y+z+1+U]=ae[z];while(++z<ae.length&&z+Y+1+U<O.length);break}if(O[1]===5&&Y+U>=2||O[1]===2&&Y+U>=5)break;O[1]&&(U=1)}while(++Y+L<E.length&&Y+U<O.length);for(let ae=2;ae<O.length;++ae)O[ae]===-1&&(O[ae]=0);switch(O[0]){case 38:A.fg=this._updateAttrColor(A.fg,O[1],O[3],O[4],O[5]);break;case 48:A.bg=this._updateAttrColor(A.bg,O[1],O[3],O[4],O[5]);break;case 58:A.extended=A.extended.clone(),A.extended.underlineColor=this._updateAttrColor(A.extended.underlineColor,O[1],O[3],O[4],O[5])}return Y}_processUnderline(E,L){L.extended=L.extended.clone(),(!~E||E>5)&&(E=1),L.extended.underlineStyle=E,L.fg|=268435456,E===0&&(L.fg&=-268435457),L.updateExtended()}_processSGR0(E){E.fg=r.DEFAULT_ATTR_DATA.fg,E.bg=r.DEFAULT_ATTR_DATA.bg,E.extended=E.extended.clone(),E.extended.underlineStyle=0,E.extended.underlineColor&=-67108864,E.updateExtended()}charAttributes(E){if(E.length===1&&E.params[0]===0)return this._processSGR0(this._curAttrData),!0;let L=E.length,A,O=this._curAttrData;for(let U=0;U<L;U++)A=E.params[U],A>=30&&A<=37?(O.fg&=-50331904,O.fg|=16777216|A-30):A>=40&&A<=47?(O.bg&=-50331904,O.bg|=16777216|A-40):A>=90&&A<=97?(O.fg&=-50331904,O.fg|=16777224|A-90):A>=100&&A<=107?(O.bg&=-50331904,O.bg|=16777224|A-100):A===0?this._processSGR0(O):A===1?O.fg|=134217728:A===3?O.bg|=67108864:A===4?(O.fg|=268435456,this._processUnderline(E.hasSubParams(U)?E.getSubParams(U)[0]:1,O)):A===5?O.fg|=536870912:A===7?O.fg|=67108864:A===8?O.fg|=1073741824:A===9?O.fg|=2147483648:A===2?O.bg|=134217728:A===21?this._processUnderline(2,O):A===22?(O.fg&=-134217729,O.bg&=-134217729):A===23?O.bg&=-67108865:A===24?(O.fg&=-268435457,this._processUnderline(0,O)):A===25?O.fg&=-536870913:A===27?O.fg&=-67108865:A===28?O.fg&=-1073741825:A===29?O.fg&=2147483647:A===39?(O.fg&=-67108864,O.fg|=16777215&r.DEFAULT_ATTR_DATA.fg):A===49?(O.bg&=-67108864,O.bg|=16777215&r.DEFAULT_ATTR_DATA.bg):A===38||A===48||A===58?U+=this._extractColor(E,U,O):A===53?O.bg|=1073741824:A===55?O.bg&=-1073741825:A===59?(O.extended=O.extended.clone(),O.extended.underlineColor=-1,O.updateExtended()):A===100?(O.fg&=-67108864,O.fg|=16777215&r.DEFAULT_ATTR_DATA.fg,O.bg&=-67108864,O.bg|=16777215&r.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",A);return!0}deviceStatus(E){switch(E.params[0]){case 5:this._coreService.triggerDataEvent(`${i.C0.ESC}[0n`);break;case 6:let L=this._activeBuffer.y+1,A=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${i.C0.ESC}[${L};${A}R`)}return!0}deviceStatusPrivate(E){if(E.params[0]===6){let L=this._activeBuffer.y+1,A=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${i.C0.ESC}[?${L};${A}R`)}return!0}softReset(E){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=r.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(E){let L=E.params[0]||1;switch(L){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}let A=L%2==1;return this._optionsService.options.cursorBlink=A,!0}setScrollRegion(E){let L=E.params[0]||1,A;return(E.length<2||(A=E.params[1])>this._bufferService.rows||A===0)&&(A=this._bufferService.rows),A>L&&(this._activeBuffer.scrollTop=L-1,this._activeBuffer.scrollBottom=A-1,this._setCursor(0,0)),!0}windowOptions(E){if(!T(E.params[0],this._optionsService.rawOptions.windowOptions))return!0;let L=E.length>1?E.params[1]:0;switch(E.params[0]){case 14:L!==2&&this._onRequestWindowsOptionsReport.fire(w.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(w.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${i.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:L!==0&&L!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),L!==0&&L!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:L!==0&&L!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),L!==0&&L!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(E){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(E){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(E){return this._windowTitle=E,this._onTitleChange.fire(E),!0}setIconName(E){return this._iconName=E,!0}setOrReportIndexedColor(E){let L=[],A=E.split(";");for(;A.length>1;){let O=A.shift(),U=A.shift();if(/^\d+$/.exec(O)){let Y=parseInt(O);if(H(Y))if(U==="?")L.push({type:0,index:Y});else{let ae=(0,v.parseColor)(U);ae&&L.push({type:1,index:Y,color:ae})}}}return L.length&&this._onColor.fire(L),!0}setHyperlink(E){let L=E.split(";");return!(L.length<2)&&(L[1]?this._createHyperlink(L[0],L[1]):!L[0]&&this._finishHyperlink())}_createHyperlink(E,L){this._getCurrentLinkId()&&this._finishHyperlink();let A=E.split(":"),O,U=A.findIndex(Y=>Y.startsWith("id="));return U!==-1&&(O=A[U].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:O,uri:L}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(E,L){let A=E.split(";");for(let O=0;O<A.length&&!(L>=this._specialColors.length);++O,++L)if(A[O]==="?")this._onColor.fire([{type:0,index:this._specialColors[L]}]);else{let U=(0,v.parseColor)(A[O]);U&&this._onColor.fire([{type:1,index:this._specialColors[L],color:U}])}return!0}setOrReportFgColor(E){return this._setOrReportSpecialColor(E,0)}setOrReportBgColor(E){return this._setOrReportSpecialColor(E,1)}setOrReportCursorColor(E){return this._setOrReportSpecialColor(E,2)}restoreIndexedColor(E){if(!E)return this._onColor.fire([{type:2}]),!0;let L=[],A=E.split(";");for(let O=0;O<A.length;++O)if(/^\d+$/.exec(A[O])){let U=parseInt(A[O]);H(U)&&L.push({type:2,index:U})}return L.length&&this._onColor.fire(L),!0}restoreFgColor(E){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(E){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(E){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,p.DEFAULT_CHARSET),!0}selectCharset(E){return E.length!==2?(this.selectDefaultCharset(),!0):(E[0]==="/"||this._charsetService.setgCharset(y[E[0]],p.CHARSETS[E[1]]||p.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){let E=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,E,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=r.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=r.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(E){return this._charsetService.setgLevel(E),!0}screenAlignmentPattern(){let E=new _.CellData;E.content=4194304|"E".charCodeAt(0),E.fg=this._curAttrData.fg,E.bg=this._curAttrData.bg,this._setCursor(0,0);for(let L=0;L<this._bufferService.rows;++L){let A=this._activeBuffer.ybase+this._activeBuffer.y+L,O=this._activeBuffer.lines.get(A);O&&(O.fill(E),O.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(E,L){let A=this._bufferService.buffer,O=this._optionsService.rawOptions;return(U=>(this._coreService.triggerDataEvent(`${i.C0.ESC}${U}${i.C0.ESC}\\`),!0))(E==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:E==='"p'?'P1$r61;1"p':E==="r"?`P1$r${A.scrollTop+1};${A.scrollBottom+1}r`:E==="m"?"P1$r0m":E===" q"?`P1$r${{block:2,underline:4,bar:6}[O.cursorStyle]-(O.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(E,L){this._dirtyRowTracker.markRangeDirty(E,L)}}n.InputHandler=I;let R=class{constructor(W){this._bufferService=W,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(W){W<this.start?this.start=W:W>this.end&&(this.end=W)}markRangeDirty(W,E){W>E&&(x=W,W=E,E=x),W<this.start&&(this.start=W),E>this.end&&(this.end=E)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function H(W){return 0<=W&&W<256}R=f([s(0,C.IBufferService)],R)},844:(h,n)=>{function u(f){for(let s of f)s.dispose();f.length=0}Object.defineProperty(n,"__esModule",{value:!0}),n.getDisposeArrayDisposable=n.disposeArray=n.toDisposable=n.MutableDisposable=n.Disposable=void 0,n.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let f of this._disposables)f.dispose();this._disposables.length=0}register(f){return this._disposables.push(f),f}unregister(f){let s=this._disposables.indexOf(f);s!==-1&&this._disposables.splice(s,1)}},n.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(f){var s;this._isDisposed||f===this._value||((s=this._value)===null||s===void 0||s.dispose(),this._value=f)}clear(){this.value=void 0}dispose(){var f;this._isDisposed=!0,(f=this._value)===null||f===void 0||f.dispose(),this._value=void 0}},n.toDisposable=function(f){return{dispose:f}},n.disposeArray=u,n.getDisposeArrayDisposable=function(f){return{dispose:()=>u(f)}}},1505:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FourKeyMap=n.TwoKeyMap=void 0;class u{constructor(){this._data={}}set(s,i,p){this._data[s]||(this._data[s]={}),this._data[s][i]=p}get(s,i){return this._data[s]?this._data[s][i]:void 0}clear(){this._data={}}}n.TwoKeyMap=u,n.FourKeyMap=class{constructor(){this._data=new u}set(f,s,i,p,m){this._data.get(f,s)||this._data.set(f,s,new u),this._data.get(f,s).set(i,p,m)}get(f,s,i,p){var m;return(m=this._data.get(f,s))===null||m===void 0?void 0:m.get(i,p)}clear(){this._data.clear()}}},6114:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isChromeOS=n.isLinux=n.isWindows=n.isIphone=n.isIpad=n.isMac=n.getSafariVersion=n.isSafari=n.isLegacyEdge=n.isFirefox=n.isNode=void 0,n.isNode=typeof navigator>"u";let u=n.isNode?"node":navigator.userAgent,f=n.isNode?"node":navigator.platform;n.isFirefox=u.includes("Firefox"),n.isLegacyEdge=u.includes("Edge"),n.isSafari=/^((?!chrome|android).)*safari/i.test(u),n.getSafariVersion=function(){if(!n.isSafari)return 0;let s=u.match(/Version\/(\d+)/);return s===null||s.length<2?0:parseInt(s[1])},n.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(f),n.isIpad=f==="iPad",n.isIphone=f==="iPhone",n.isWindows=["Windows","Win16","Win32","WinCE"].includes(f),n.isLinux=f.indexOf("Linux")>=0,n.isChromeOS=/\bCrOS\b/.test(u)},6106:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SortedList=void 0;let u=0;n.SortedList=class{constructor(f){this._getKey=f,this._array=[]}clear(){this._array.length=0}insert(f){this._array.length!==0?(u=this._search(this._getKey(f)),this._array.splice(u,0,f)):this._array.push(f)}delete(f){if(this._array.length===0)return!1;let s=this._getKey(f);if(s===void 0||(u=this._search(s),u===-1)||this._getKey(this._array[u])!==s)return!1;do if(this._array[u]===f)return this._array.splice(u,1),!0;while(++u<this._array.length&&this._getKey(this._array[u])===s);return!1}*getKeyIterator(f){if(this._array.length!==0&&(u=this._search(f),!(u<0||u>=this._array.length)&&this._getKey(this._array[u])===f))do yield this._array[u];while(++u<this._array.length&&this._getKey(this._array[u])===f)}forEachByKey(f,s){if(this._array.length!==0&&(u=this._search(f),!(u<0||u>=this._array.length)&&this._getKey(this._array[u])===f))do s(this._array[u]);while(++u<this._array.length&&this._getKey(this._array[u])===f)}values(){return[...this._array].values()}_search(f){let s=0,i=this._array.length-1;for(;i>=s;){let p=s+i>>1,m=this._getKey(this._array[p]);if(m>f)i=p-1;else{if(!(m<f)){for(;p>0&&this._getKey(this._array[p-1])===f;)p--;return p}s=p+1}}return s}}},7226:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DebouncedIdleTask=n.IdleTaskQueue=n.PriorityTaskQueue=void 0;let f=u(6114);class s{constructor(){this._tasks=[],this._i=0}enqueue(m){this._tasks.push(m),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(m){this._idleCallback=void 0;let g=0,l=0,r=m.timeRemaining(),o=0;for(;this._i<this._tasks.length;){if(g=Date.now(),this._tasks[this._i]()||this._i++,g=Math.max(1,Date.now()-g),l=Math.max(g,l),o=m.timeRemaining(),1.5*l>o)return r-g<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(r-g))}ms`),void this._start();r=o}this.clear()}}class i extends s{_requestCallback(m){return setTimeout(()=>m(this._createDeadline(16)))}_cancelCallback(m){clearTimeout(m)}_createDeadline(m){let g=Date.now()+m;return{timeRemaining:()=>Math.max(0,g-Date.now())}}}n.PriorityTaskQueue=i,n.IdleTaskQueue=!f.isNode&&"requestIdleCallback"in window?class extends s{_requestCallback(p){return requestIdleCallback(p)}_cancelCallback(p){cancelIdleCallback(p)}}:i,n.DebouncedIdleTask=class{constructor(){this._queue=new n.IdleTaskQueue}set(p){this._queue.clear(),this._queue.enqueue(p)}flush(){this._queue.flush()}}},9282:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.updateWindowsModeWrappedState=void 0;let f=u(643);n.updateWindowsModeWrappedState=function(s){let i=s.buffer.lines.get(s.buffer.ybase+s.buffer.y-1),p=i?.get(s.cols-1),m=s.buffer.lines.get(s.buffer.ybase+s.buffer.y);m&&p&&(m.isWrapped=p[f.CHAR_DATA_CODE_INDEX]!==f.NULL_CELL_CODE&&p[f.CHAR_DATA_CODE_INDEX]!==f.WHITESPACE_CELL_CODE)}},3734:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ExtendedAttrs=n.AttributeData=void 0;class u{constructor(){this.fg=0,this.bg=0,this.extended=new f}static toColorRGB(i){return[i>>>16&255,i>>>8&255,255&i]}static fromColorRGB(i){return(255&i[0])<<16|(255&i[1])<<8|255&i[2]}clone(){let i=new u;return i.fg=this.fg,i.bg=this.bg,i.extended=this.extended.clone(),i}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}n.AttributeData=u;class f{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(i){this._ext=i}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(i){this._ext&=-469762049,this._ext|=i<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(i){this._ext&=-67108864,this._ext|=67108863&i}get urlId(){return this._urlId}set urlId(i){this._urlId=i}constructor(i=0,p=0){this._ext=0,this._urlId=0,this._ext=i,this._urlId=p}clone(){return new f(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}n.ExtendedAttrs=f},9092:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Buffer=n.MAX_BUFFER_SIZE=void 0;let f=u(6349),s=u(7226),i=u(3734),p=u(8437),m=u(4634),g=u(511),l=u(643),r=u(4863),o=u(7116);n.MAX_BUFFER_SIZE=4294967295,n.Buffer=class{constructor(c,_,D){this._hasScrollback=c,this._optionsService=_,this._bufferService=D,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=p.DEFAULT_ATTR_DATA.clone(),this.savedCharset=o.DEFAULT_CHARSET,this.markers=[],this._nullCell=g.CellData.fromCharData([0,l.NULL_CELL_CHAR,l.NULL_CELL_WIDTH,l.NULL_CELL_CODE]),this._whitespaceCell=g.CellData.fromCharData([0,l.WHITESPACE_CELL_CHAR,l.WHITESPACE_CELL_WIDTH,l.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new s.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new f.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(c){return c?(this._nullCell.fg=c.fg,this._nullCell.bg=c.bg,this._nullCell.extended=c.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new i.ExtendedAttrs),this._nullCell}getWhitespaceCell(c){return c?(this._whitespaceCell.fg=c.fg,this._whitespaceCell.bg=c.bg,this._whitespaceCell.extended=c.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new i.ExtendedAttrs),this._whitespaceCell}getBlankLine(c,_){return new p.BufferLine(this._bufferService.cols,this.getNullCell(c),_)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){let c=this.ybase+this.y-this.ydisp;return c>=0&&c<this._rows}_getCorrectBufferLength(c){if(!this._hasScrollback)return c;let _=c+this._optionsService.rawOptions.scrollback;return _>n.MAX_BUFFER_SIZE?n.MAX_BUFFER_SIZE:_}fillViewportRows(c){if(this.lines.length===0){c===void 0&&(c=p.DEFAULT_ATTR_DATA);let _=this._rows;for(;_--;)this.lines.push(this.getBlankLine(c))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new f.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(c,_){let D=this.getNullCell(p.DEFAULT_ATTR_DATA),C=0,b=this._getCorrectBufferLength(_);if(b>this.lines.maxLength&&(this.lines.maxLength=b),this.lines.length>0){if(this._cols<c)for(let v=0;v<this.lines.length;v++)C+=+this.lines.get(v).resize(c,D);let S=0;if(this._rows<_)for(let v=this._rows;v<_;v++)this.lines.length<_+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new p.BufferLine(c,D)):this.ybase>0&&this.lines.length<=this.ybase+this.y+S+1?(this.ybase--,S++,this.ydisp>0&&this.ydisp--):this.lines.push(new p.BufferLine(c,D)));else for(let v=this._rows;v>_;v--)this.lines.length>_+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(b<this.lines.maxLength){let v=this.lines.length-b;v>0&&(this.lines.trimStart(v),this.ybase=Math.max(this.ybase-v,0),this.ydisp=Math.max(this.ydisp-v,0),this.savedY=Math.max(this.savedY-v,0)),this.lines.maxLength=b}this.x=Math.min(this.x,c-1),this.y=Math.min(this.y,_-1),S&&(this.y+=S),this.savedX=Math.min(this.savedX,c-1),this.scrollTop=0}if(this.scrollBottom=_-1,this._isReflowEnabled&&(this._reflow(c,_),this._cols>c))for(let S=0;S<this.lines.length;S++)C+=+this.lines.get(S).resize(c,D);this._cols=c,this._rows=_,this._memoryCleanupQueue.clear(),C>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let c=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,c=!1);let _=0;for(;this._memoryCleanupPosition<this.lines.length;)if(_+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),_>100)return!0;return c}get _isReflowEnabled(){let c=this._optionsService.rawOptions.windowsPty;return c&&c.buildNumber?this._hasScrollback&&c.backend==="conpty"&&c.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(c,_){this._cols!==c&&(c>this._cols?this._reflowLarger(c,_):this._reflowSmaller(c,_))}_reflowLarger(c,_){let D=(0,m.reflowLargerGetLinesToRemove)(this.lines,this._cols,c,this.ybase+this.y,this.getNullCell(p.DEFAULT_ATTR_DATA));if(D.length>0){let C=(0,m.reflowLargerCreateNewLayout)(this.lines,D);(0,m.reflowLargerApplyNewLayout)(this.lines,C.layout),this._reflowLargerAdjustViewport(c,_,C.countRemoved)}}_reflowLargerAdjustViewport(c,_,D){let C=this.getNullCell(p.DEFAULT_ATTR_DATA),b=D;for(;b-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<_&&this.lines.push(new p.BufferLine(c,C))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-D,0)}_reflowSmaller(c,_){let D=this.getNullCell(p.DEFAULT_ATTR_DATA),C=[],b=0;for(let S=this.lines.length-1;S>=0;S--){let v=this.lines.get(S);if(!v||!v.isWrapped&&v.getTrimmedLength()<=c)continue;let y=[v];for(;v.isWrapped&&S>0;)v=this.lines.get(--S),y.unshift(v);let M=this.ybase+this.y;if(M>=S&&M<S+y.length)continue;let T=y[y.length-1].getTrimmedLength(),w=(0,m.reflowSmallerGetNewLineLengths)(y,this._cols,c),x=w.length-y.length,I;I=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+x):Math.max(0,this.lines.length-this.lines.maxLength+x);let R=[];for(let O=0;O<x;O++){let U=this.getBlankLine(p.DEFAULT_ATTR_DATA,!0);R.push(U)}R.length>0&&(C.push({start:S+y.length+b,newLines:R}),b+=R.length),y.push(...R);let H=w.length-1,W=w[H];W===0&&(H--,W=w[H]);let E=y.length-x-1,L=T;for(;E>=0;){let O=Math.min(L,W);if(y[H]===void 0)break;if(y[H].copyCellsFrom(y[E],L-O,W-O,O,!0),W-=O,W===0&&(H--,W=w[H]),L-=O,L===0){E--;let U=Math.max(E,0);L=(0,m.getWrappedLineTrimmedLength)(y,U,this._cols)}}for(let O=0;O<y.length;O++)w[O]<c&&y[O].setCell(w[O],D);let A=x-I;for(;A-- >0;)this.ybase===0?this.y<_-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+b)-_&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+x,this.ybase+_-1)}if(C.length>0){let S=[],v=[];for(let H=0;H<this.lines.length;H++)v.push(this.lines.get(H));let y=this.lines.length,M=y-1,T=0,w=C[T];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+b);let x=0;for(let H=Math.min(this.lines.maxLength-1,y+b-1);H>=0;H--)if(w&&w.start>M+x){for(let W=w.newLines.length-1;W>=0;W--)this.lines.set(H--,w.newLines[W]);H++,S.push({index:M+1,amount:w.newLines.length}),x+=w.newLines.length,w=C[++T]}else this.lines.set(H,v[M--]);let I=0;for(let H=S.length-1;H>=0;H--)S[H].index+=I,this.lines.onInsertEmitter.fire(S[H]),I+=S[H].amount;let R=Math.max(0,y+b-this.lines.maxLength);R>0&&this.lines.onTrimEmitter.fire(R)}}translateBufferLineToString(c,_,D=0,C){let b=this.lines.get(c);return b?b.translateToString(_,D,C):""}getWrappedRangeForLine(c){let _=c,D=c;for(;_>0&&this.lines.get(_).isWrapped;)_--;for(;D+1<this.lines.length&&this.lines.get(D+1).isWrapped;)D++;return{first:_,last:D}}setupTabStops(c){for(c!=null?this.tabs[c]||(c=this.prevStop(c)):(this.tabs={},c=0);c<this._cols;c+=this._optionsService.rawOptions.tabStopWidth)this.tabs[c]=!0}prevStop(c){for(c==null&&(c=this.x);!this.tabs[--c]&&c>0;);return c>=this._cols?this._cols-1:c<0?0:c}nextStop(c){for(c==null&&(c=this.x);!this.tabs[++c]&&c<this._cols;);return c>=this._cols?this._cols-1:c<0?0:c}clearMarkers(c){this._isClearing=!0;for(let _=0;_<this.markers.length;_++)this.markers[_].line===c&&(this.markers[_].dispose(),this.markers.splice(_--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let c=0;c<this.markers.length;c++)this.markers[c].dispose(),this.markers.splice(c--,1);this._isClearing=!1}addMarker(c){let _=new r.Marker(c);return this.markers.push(_),_.register(this.lines.onTrim(D=>{_.line-=D,_.line<0&&_.dispose()})),_.register(this.lines.onInsert(D=>{_.line>=D.index&&(_.line+=D.amount)})),_.register(this.lines.onDelete(D=>{_.line>=D.index&&_.line<D.index+D.amount&&_.dispose(),_.line>D.index&&(_.line-=D.amount)})),_.register(_.onDispose(()=>this._removeMarker(_))),_}_removeMarker(c){this._isClearing||this.markers.splice(this.markers.indexOf(c),1)}}},8437:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferLine=n.DEFAULT_ATTR_DATA=void 0;let f=u(3734),s=u(511),i=u(643),p=u(482);n.DEFAULT_ATTR_DATA=Object.freeze(new f.AttributeData);let m=0;class g{constructor(r,o,c=!1){this.isWrapped=c,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*r);let _=o||s.CellData.fromCharData([0,i.NULL_CELL_CHAR,i.NULL_CELL_WIDTH,i.NULL_CELL_CODE]);for(let D=0;D<r;++D)this.setCell(D,_);this.length=r}get(r){let o=this._data[3*r+0],c=2097151&o;return[this._data[3*r+1],2097152&o?this._combined[r]:c?(0,p.stringFromCodePoint)(c):"",o>>22,2097152&o?this._combined[r].charCodeAt(this._combined[r].length-1):c]}set(r,o){this._data[3*r+1]=o[i.CHAR_DATA_ATTR_INDEX],o[i.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[r]=o[1],this._data[3*r+0]=2097152|r|o[i.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*r+0]=o[i.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|o[i.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(r){return this._data[3*r+0]>>22}hasWidth(r){return 12582912&this._data[3*r+0]}getFg(r){return this._data[3*r+1]}getBg(r){return this._data[3*r+2]}hasContent(r){return 4194303&this._data[3*r+0]}getCodePoint(r){let o=this._data[3*r+0];return 2097152&o?this._combined[r].charCodeAt(this._combined[r].length-1):2097151&o}isCombined(r){return 2097152&this._data[3*r+0]}getString(r){let o=this._data[3*r+0];return 2097152&o?this._combined[r]:2097151&o?(0,p.stringFromCodePoint)(2097151&o):""}isProtected(r){return 536870912&this._data[3*r+2]}loadCell(r,o){return m=3*r,o.content=this._data[m+0],o.fg=this._data[m+1],o.bg=this._data[m+2],2097152&o.content&&(o.combinedData=this._combined[r]),268435456&o.bg&&(o.extended=this._extendedAttrs[r]),o}setCell(r,o){2097152&o.content&&(this._combined[r]=o.combinedData),268435456&o.bg&&(this._extendedAttrs[r]=o.extended),this._data[3*r+0]=o.content,this._data[3*r+1]=o.fg,this._data[3*r+2]=o.bg}setCellFromCodePoint(r,o,c,_,D,C){268435456&D&&(this._extendedAttrs[r]=C),this._data[3*r+0]=o|c<<22,this._data[3*r+1]=_,this._data[3*r+2]=D}addCodepointToCell(r,o){let c=this._data[3*r+0];2097152&c?this._combined[r]+=(0,p.stringFromCodePoint)(o):(2097151&c?(this._combined[r]=(0,p.stringFromCodePoint)(2097151&c)+(0,p.stringFromCodePoint)(o),c&=-2097152,c|=2097152):c=o|4194304,this._data[3*r+0]=c)}insertCells(r,o,c,_){if((r%=this.length)&&this.getWidth(r-1)===2&&this.setCellFromCodePoint(r-1,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs),o<this.length-r){let D=new s.CellData;for(let C=this.length-r-o-1;C>=0;--C)this.setCell(r+o+C,this.loadCell(r+C,D));for(let C=0;C<o;++C)this.setCell(r+C,c)}else for(let D=r;D<this.length;++D)this.setCell(D,c);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs)}deleteCells(r,o,c,_){if(r%=this.length,o<this.length-r){let D=new s.CellData;for(let C=0;C<this.length-r-o;++C)this.setCell(r+C,this.loadCell(r+o+C,D));for(let C=this.length-o;C<this.length;++C)this.setCell(C,c)}else for(let D=r;D<this.length;++D)this.setCell(D,c);r&&this.getWidth(r-1)===2&&this.setCellFromCodePoint(r-1,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs),this.getWidth(r)!==0||this.hasContent(r)||this.setCellFromCodePoint(r,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs)}replaceCells(r,o,c,_,D=!1){if(D)for(r&&this.getWidth(r-1)===2&&!this.isProtected(r-1)&&this.setCellFromCodePoint(r-1,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs),o<this.length&&this.getWidth(o-1)===2&&!this.isProtected(o)&&this.setCellFromCodePoint(o,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs);r<o&&r<this.length;)this.isProtected(r)||this.setCell(r,c),r++;else for(r&&this.getWidth(r-1)===2&&this.setCellFromCodePoint(r-1,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs),o<this.length&&this.getWidth(o-1)===2&&this.setCellFromCodePoint(o,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs);r<o&&r<this.length;)this.setCell(r++,c)}resize(r,o){if(r===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;let c=3*r;if(r>this.length){if(this._data.buffer.byteLength>=4*c)this._data=new Uint32Array(this._data.buffer,0,c);else{let _=new Uint32Array(c);_.set(this._data),this._data=_}for(let _=this.length;_<r;++_)this.setCell(_,o)}else{this._data=this._data.subarray(0,c);let _=Object.keys(this._combined);for(let C=0;C<_.length;C++){let b=parseInt(_[C],10);b>=r&&delete this._combined[b]}let D=Object.keys(this._extendedAttrs);for(let C=0;C<D.length;C++){let b=parseInt(D[C],10);b>=r&&delete this._extendedAttrs[b]}}return this.length=r,4*c*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){let r=new Uint32Array(this._data.length);return r.set(this._data),this._data=r,1}return 0}fill(r,o=!1){if(o)for(let c=0;c<this.length;++c)this.isProtected(c)||this.setCell(c,r);else{this._combined={},this._extendedAttrs={};for(let c=0;c<this.length;++c)this.setCell(c,r)}}copyFrom(r){this.length!==r.length?this._data=new Uint32Array(r._data):this._data.set(r._data),this.length=r.length,this._combined={};for(let o in r._combined)this._combined[o]=r._combined[o];this._extendedAttrs={};for(let o in r._extendedAttrs)this._extendedAttrs[o]=r._extendedAttrs[o];this.isWrapped=r.isWrapped}clone(){let r=new g(0);r._data=new Uint32Array(this._data),r.length=this.length;for(let o in this._combined)r._combined[o]=this._combined[o];for(let o in this._extendedAttrs)r._extendedAttrs[o]=this._extendedAttrs[o];return r.isWrapped=this.isWrapped,r}getTrimmedLength(){for(let r=this.length-1;r>=0;--r)if(4194303&this._data[3*r+0])return r+(this._data[3*r+0]>>22);return 0}getNoBgTrimmedLength(){for(let r=this.length-1;r>=0;--r)if(4194303&this._data[3*r+0]||50331648&this._data[3*r+2])return r+(this._data[3*r+0]>>22);return 0}copyCellsFrom(r,o,c,_,D){let C=r._data;if(D)for(let S=_-1;S>=0;S--){for(let v=0;v<3;v++)this._data[3*(c+S)+v]=C[3*(o+S)+v];268435456&C[3*(o+S)+2]&&(this._extendedAttrs[c+S]=r._extendedAttrs[o+S])}else for(let S=0;S<_;S++){for(let v=0;v<3;v++)this._data[3*(c+S)+v]=C[3*(o+S)+v];268435456&C[3*(o+S)+2]&&(this._extendedAttrs[c+S]=r._extendedAttrs[o+S])}let b=Object.keys(r._combined);for(let S=0;S<b.length;S++){let v=parseInt(b[S],10);v>=o&&(this._combined[v-o+c]=r._combined[v])}}translateToString(r=!1,o=0,c=this.length){r&&(c=Math.min(c,this.getTrimmedLength()));let _="";for(;o<c;){let D=this._data[3*o+0],C=2097151&D;_+=2097152&D?this._combined[o]:C?(0,p.stringFromCodePoint)(C):i.WHITESPACE_CELL_CHAR,o+=D>>22||1}return _}}n.BufferLine=g},4841:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getRangeLength=void 0,n.getRangeLength=function(u,f){if(u.start.y>u.end.y)throw new Error(`Buffer range end (${u.end.x}, ${u.end.y}) cannot be before start (${u.start.x}, ${u.start.y})`);return f*(u.end.y-u.start.y)+(u.end.x-u.start.x+1)}},4634:(h,n)=>{function u(f,s,i){if(s===f.length-1)return f[s].getTrimmedLength();let p=!f[s].hasContent(i-1)&&f[s].getWidth(i-1)===1,m=f[s+1].getWidth(0)===2;return p&&m?i-1:i}Object.defineProperty(n,"__esModule",{value:!0}),n.getWrappedLineTrimmedLength=n.reflowSmallerGetNewLineLengths=n.reflowLargerApplyNewLayout=n.reflowLargerCreateNewLayout=n.reflowLargerGetLinesToRemove=void 0,n.reflowLargerGetLinesToRemove=function(f,s,i,p,m){let g=[];for(let l=0;l<f.length-1;l++){let r=l,o=f.get(++r);if(!o.isWrapped)continue;let c=[f.get(l)];for(;r<f.length&&o.isWrapped;)c.push(o),o=f.get(++r);if(p>=l&&p<r){l+=c.length-1;continue}let _=0,D=u(c,_,s),C=1,b=0;for(;C<c.length;){let v=u(c,C,s),y=v-b,M=i-D,T=Math.min(y,M);c[_].copyCellsFrom(c[C],b,D,T,!1),D+=T,D===i&&(_++,D=0),b+=T,b===v&&(C++,b=0),D===0&&_!==0&&c[_-1].getWidth(i-1)===2&&(c[_].copyCellsFrom(c[_-1],i-1,D++,1,!1),c[_-1].setCell(i-1,m))}c[_].replaceCells(D,i,m);let S=0;for(let v=c.length-1;v>0&&(v>_||c[v].getTrimmedLength()===0);v--)S++;S>0&&(g.push(l+c.length-S),g.push(S)),l+=c.length-1}return g},n.reflowLargerCreateNewLayout=function(f,s){let i=[],p=0,m=s[p],g=0;for(let l=0;l<f.length;l++)if(m===l){let r=s[++p];f.onDeleteEmitter.fire({index:l-g,amount:r}),l+=r-1,g+=r,m=s[++p]}else i.push(l);return{layout:i,countRemoved:g}},n.reflowLargerApplyNewLayout=function(f,s){let i=[];for(let p=0;p<s.length;p++)i.push(f.get(s[p]));for(let p=0;p<i.length;p++)f.set(p,i[p]);f.length=s.length},n.reflowSmallerGetNewLineLengths=function(f,s,i){let p=[],m=f.map((o,c)=>u(f,c,s)).reduce((o,c)=>o+c),g=0,l=0,r=0;for(;r<m;){if(m-r<i){p.push(m-r);break}g+=i;let o=u(f,l,s);g>o&&(g-=o,l++);let c=f[l].getWidth(g-1)===2;c&&g--;let _=c?i-1:i;p.push(_),r+=_}return p},n.getWrappedLineTrimmedLength=u},5295:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferSet=void 0;let f=u(8460),s=u(844),i=u(9092);class p extends s.Disposable{constructor(g,l){super(),this._optionsService=g,this._bufferService=l,this._onBufferActivate=this.register(new f.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new i.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new i.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(g){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(g),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(g,l){this._normal.resize(g,l),this._alt.resize(g,l),this.setupTabStops(g)}setupTabStops(g){this._normal.setupTabStops(g),this._alt.setupTabStops(g)}}n.BufferSet=p},511:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CellData=void 0;let f=u(482),s=u(643),i=u(3734);class p extends i.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new i.ExtendedAttrs,this.combinedData=""}static fromCharData(g){let l=new p;return l.setFromCharData(g),l}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,f.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(g){this.fg=g[s.CHAR_DATA_ATTR_INDEX],this.bg=0;let l=!1;if(g[s.CHAR_DATA_CHAR_INDEX].length>2)l=!0;else if(g[s.CHAR_DATA_CHAR_INDEX].length===2){let r=g[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=r&&r<=56319){let o=g[s.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=o&&o<=57343?this.content=1024*(r-55296)+o-56320+65536|g[s.CHAR_DATA_WIDTH_INDEX]<<22:l=!0}else l=!0}else this.content=g[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|g[s.CHAR_DATA_WIDTH_INDEX]<<22;l&&(this.combinedData=g[s.CHAR_DATA_CHAR_INDEX],this.content=2097152|g[s.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}n.CellData=p},643:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WHITESPACE_CELL_CODE=n.WHITESPACE_CELL_WIDTH=n.WHITESPACE_CELL_CHAR=n.NULL_CELL_CODE=n.NULL_CELL_WIDTH=n.NULL_CELL_CHAR=n.CHAR_DATA_CODE_INDEX=n.CHAR_DATA_WIDTH_INDEX=n.CHAR_DATA_CHAR_INDEX=n.CHAR_DATA_ATTR_INDEX=n.DEFAULT_EXT=n.DEFAULT_ATTR=n.DEFAULT_COLOR=void 0,n.DEFAULT_COLOR=0,n.DEFAULT_ATTR=256|n.DEFAULT_COLOR<<9,n.DEFAULT_EXT=0,n.CHAR_DATA_ATTR_INDEX=0,n.CHAR_DATA_CHAR_INDEX=1,n.CHAR_DATA_WIDTH_INDEX=2,n.CHAR_DATA_CODE_INDEX=3,n.NULL_CELL_CHAR="",n.NULL_CELL_WIDTH=1,n.NULL_CELL_CODE=0,n.WHITESPACE_CELL_CHAR=" ",n.WHITESPACE_CELL_WIDTH=1,n.WHITESPACE_CELL_CODE=32},4863:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Marker=void 0;let f=u(8460),s=u(844);class i{get id(){return this._id}constructor(m){this.line=m,this.isDisposed=!1,this._disposables=[],this._id=i._nextId++,this._onDispose=this.register(new f.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,s.disposeArray)(this._disposables),this._disposables.length=0)}register(m){return this._disposables.push(m),m}}n.Marker=i,i._nextId=1},7116:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_CHARSET=n.CHARSETS=void 0,n.CHARSETS={},n.DEFAULT_CHARSET=n.CHARSETS.B,n.CHARSETS[0]={"`":"\u25C6",a:"\u2592",b:"\u2409",c:"\u240C",d:"\u240D",e:"\u240A",f:"\xB0",g:"\xB1",h:"\u2424",i:"\u240B",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"},n.CHARSETS.A={"#":"\xA3"},n.CHARSETS.B=void 0,n.CHARSETS[4]={"#":"\xA3","@":"\xBE","[":"ij","\\":"\xBD","]":"|","{":"\xA8","|":"f","}":"\xBC","~":"\xB4"},n.CHARSETS.C=n.CHARSETS[5]={"[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},n.CHARSETS.R={"#":"\xA3","@":"\xE0","[":"\xB0","\\":"\xE7","]":"\xA7","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xA8"},n.CHARSETS.Q={"@":"\xE0","[":"\xE2","\\":"\xE7","]":"\xEA","^":"\xEE","`":"\xF4","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xFB"},n.CHARSETS.K={"@":"\xA7","[":"\xC4","\\":"\xD6","]":"\xDC","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xDF"},n.CHARSETS.Y={"#":"\xA3","@":"\xA7","[":"\xB0","\\":"\xE7","]":"\xE9","`":"\xF9","{":"\xE0","|":"\xF2","}":"\xE8","~":"\xEC"},n.CHARSETS.E=n.CHARSETS[6]={"@":"\xC4","[":"\xC6","\\":"\xD8","]":"\xC5","^":"\xDC","`":"\xE4","{":"\xE6","|":"\xF8","}":"\xE5","~":"\xFC"},n.CHARSETS.Z={"#":"\xA3","@":"\xA7","[":"\xA1","\\":"\xD1","]":"\xBF","{":"\xB0","|":"\xF1","}":"\xE7"},n.CHARSETS.H=n.CHARSETS[7]={"@":"\xC9","[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},n.CHARSETS["="]={"#":"\xF9","@":"\xE0","[":"\xE9","\\":"\xE7","]":"\xEA","^":"\xEE",_:"\xE8","`":"\xF4","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xFB"}},2584:(h,n)=>{var u,f,s;Object.defineProperty(n,"__esModule",{value:!0}),n.C1_ESCAPED=n.C1=n.C0=void 0,function(i){i.NUL="\0",i.SOH="",i.STX="",i.ETX="",i.EOT="",i.ENQ="",i.ACK="",i.BEL="\x07",i.BS="\b",i.HT="	",i.LF=`
`,i.VT="\v",i.FF="\f",i.CR="\r",i.SO="",i.SI="",i.DLE="",i.DC1="",i.DC2="",i.DC3="",i.DC4="",i.NAK="",i.SYN="",i.ETB="",i.CAN="",i.EM="",i.SUB="",i.ESC="\x1B",i.FS="",i.GS="",i.RS="",i.US="",i.SP=" ",i.DEL="\x7F"}(u||(n.C0=u={})),function(i){i.PAD="\x80",i.HOP="\x81",i.BPH="\x82",i.NBH="\x83",i.IND="\x84",i.NEL="\x85",i.SSA="\x86",i.ESA="\x87",i.HTS="\x88",i.HTJ="\x89",i.VTS="\x8A",i.PLD="\x8B",i.PLU="\x8C",i.RI="\x8D",i.SS2="\x8E",i.SS3="\x8F",i.DCS="\x90",i.PU1="\x91",i.PU2="\x92",i.STS="\x93",i.CCH="\x94",i.MW="\x95",i.SPA="\x96",i.EPA="\x97",i.SOS="\x98",i.SGCI="\x99",i.SCI="\x9A",i.CSI="\x9B",i.ST="\x9C",i.OSC="\x9D",i.PM="\x9E",i.APC="\x9F"}(f||(n.C1=f={})),function(i){i.ST=`${u.ESC}\\`}(s||(n.C1_ESCAPED=s={}))},7399:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.evaluateKeyboardEvent=void 0;let f=u(2584),s={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};n.evaluateKeyboardEvent=function(i,p,m,g){let l={type:0,cancel:!1,key:void 0},r=(i.shiftKey?1:0)|(i.altKey?2:0)|(i.ctrlKey?4:0)|(i.metaKey?8:0);switch(i.keyCode){case 0:i.key==="UIKeyInputUpArrow"?l.key=p?f.C0.ESC+"OA":f.C0.ESC+"[A":i.key==="UIKeyInputLeftArrow"?l.key=p?f.C0.ESC+"OD":f.C0.ESC+"[D":i.key==="UIKeyInputRightArrow"?l.key=p?f.C0.ESC+"OC":f.C0.ESC+"[C":i.key==="UIKeyInputDownArrow"&&(l.key=p?f.C0.ESC+"OB":f.C0.ESC+"[B");break;case 8:if(i.altKey){l.key=f.C0.ESC+f.C0.DEL;break}l.key=f.C0.DEL;break;case 9:if(i.shiftKey){l.key=f.C0.ESC+"[Z";break}l.key=f.C0.HT,l.cancel=!0;break;case 13:l.key=i.altKey?f.C0.ESC+f.C0.CR:f.C0.CR,l.cancel=!0;break;case 27:l.key=f.C0.ESC,i.altKey&&(l.key=f.C0.ESC+f.C0.ESC),l.cancel=!0;break;case 37:if(i.metaKey)break;r?(l.key=f.C0.ESC+"[1;"+(r+1)+"D",l.key===f.C0.ESC+"[1;3D"&&(l.key=f.C0.ESC+(m?"b":"[1;5D"))):l.key=p?f.C0.ESC+"OD":f.C0.ESC+"[D";break;case 39:if(i.metaKey)break;r?(l.key=f.C0.ESC+"[1;"+(r+1)+"C",l.key===f.C0.ESC+"[1;3C"&&(l.key=f.C0.ESC+(m?"f":"[1;5C"))):l.key=p?f.C0.ESC+"OC":f.C0.ESC+"[C";break;case 38:if(i.metaKey)break;r?(l.key=f.C0.ESC+"[1;"+(r+1)+"A",m||l.key!==f.C0.ESC+"[1;3A"||(l.key=f.C0.ESC+"[1;5A")):l.key=p?f.C0.ESC+"OA":f.C0.ESC+"[A";break;case 40:if(i.metaKey)break;r?(l.key=f.C0.ESC+"[1;"+(r+1)+"B",m||l.key!==f.C0.ESC+"[1;3B"||(l.key=f.C0.ESC+"[1;5B")):l.key=p?f.C0.ESC+"OB":f.C0.ESC+"[B";break;case 45:i.shiftKey||i.ctrlKey||(l.key=f.C0.ESC+"[2~");break;case 46:l.key=r?f.C0.ESC+"[3;"+(r+1)+"~":f.C0.ESC+"[3~";break;case 36:l.key=r?f.C0.ESC+"[1;"+(r+1)+"H":p?f.C0.ESC+"OH":f.C0.ESC+"[H";break;case 35:l.key=r?f.C0.ESC+"[1;"+(r+1)+"F":p?f.C0.ESC+"OF":f.C0.ESC+"[F";break;case 33:i.shiftKey?l.type=2:i.ctrlKey?l.key=f.C0.ESC+"[5;"+(r+1)+"~":l.key=f.C0.ESC+"[5~";break;case 34:i.shiftKey?l.type=3:i.ctrlKey?l.key=f.C0.ESC+"[6;"+(r+1)+"~":l.key=f.C0.ESC+"[6~";break;case 112:l.key=r?f.C0.ESC+"[1;"+(r+1)+"P":f.C0.ESC+"OP";break;case 113:l.key=r?f.C0.ESC+"[1;"+(r+1)+"Q":f.C0.ESC+"OQ";break;case 114:l.key=r?f.C0.ESC+"[1;"+(r+1)+"R":f.C0.ESC+"OR";break;case 115:l.key=r?f.C0.ESC+"[1;"+(r+1)+"S":f.C0.ESC+"OS";break;case 116:l.key=r?f.C0.ESC+"[15;"+(r+1)+"~":f.C0.ESC+"[15~";break;case 117:l.key=r?f.C0.ESC+"[17;"+(r+1)+"~":f.C0.ESC+"[17~";break;case 118:l.key=r?f.C0.ESC+"[18;"+(r+1)+"~":f.C0.ESC+"[18~";break;case 119:l.key=r?f.C0.ESC+"[19;"+(r+1)+"~":f.C0.ESC+"[19~";break;case 120:l.key=r?f.C0.ESC+"[20;"+(r+1)+"~":f.C0.ESC+"[20~";break;case 121:l.key=r?f.C0.ESC+"[21;"+(r+1)+"~":f.C0.ESC+"[21~";break;case 122:l.key=r?f.C0.ESC+"[23;"+(r+1)+"~":f.C0.ESC+"[23~";break;case 123:l.key=r?f.C0.ESC+"[24;"+(r+1)+"~":f.C0.ESC+"[24~";break;default:if(!i.ctrlKey||i.shiftKey||i.altKey||i.metaKey)if(m&&!g||!i.altKey||i.metaKey)!m||i.altKey||i.ctrlKey||i.shiftKey||!i.metaKey?i.key&&!i.ctrlKey&&!i.altKey&&!i.metaKey&&i.keyCode>=48&&i.key.length===1?l.key=i.key:i.key&&i.ctrlKey&&(i.key==="_"&&(l.key=f.C0.US),i.key==="@"&&(l.key=f.C0.NUL)):i.keyCode===65&&(l.type=1);else{let o=s[i.keyCode],c=o?.[i.shiftKey?1:0];if(c)l.key=f.C0.ESC+c;else if(i.keyCode>=65&&i.keyCode<=90){let _=i.ctrlKey?i.keyCode-64:i.keyCode+32,D=String.fromCharCode(_);i.shiftKey&&(D=D.toUpperCase()),l.key=f.C0.ESC+D}else if(i.keyCode===32)l.key=f.C0.ESC+(i.ctrlKey?f.C0.NUL:" ");else if(i.key==="Dead"&&i.code.startsWith("Key")){let _=i.code.slice(3,4);i.shiftKey||(_=_.toLowerCase()),l.key=f.C0.ESC+_,l.cancel=!0}}else i.keyCode>=65&&i.keyCode<=90?l.key=String.fromCharCode(i.keyCode-64):i.keyCode===32?l.key=f.C0.NUL:i.keyCode>=51&&i.keyCode<=55?l.key=String.fromCharCode(i.keyCode-51+27):i.keyCode===56?l.key=f.C0.DEL:i.keyCode===219?l.key=f.C0.ESC:i.keyCode===220?l.key=f.C0.FS:i.keyCode===221&&(l.key=f.C0.GS)}return l}},482:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Utf8ToUtf32=n.StringToUtf32=n.utf32ToString=n.stringFromCodePoint=void 0,n.stringFromCodePoint=function(u){return u>65535?(u-=65536,String.fromCharCode(55296+(u>>10))+String.fromCharCode(u%1024+56320)):String.fromCharCode(u)},n.utf32ToString=function(u,f=0,s=u.length){let i="";for(let p=f;p<s;++p){let m=u[p];m>65535?(m-=65536,i+=String.fromCharCode(55296+(m>>10))+String.fromCharCode(m%1024+56320)):i+=String.fromCharCode(m)}return i},n.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(u,f){let s=u.length;if(!s)return 0;let i=0,p=0;if(this._interim){let m=u.charCodeAt(p++);56320<=m&&m<=57343?f[i++]=1024*(this._interim-55296)+m-56320+65536:(f[i++]=this._interim,f[i++]=m),this._interim=0}for(let m=p;m<s;++m){let g=u.charCodeAt(m);if(55296<=g&&g<=56319){if(++m>=s)return this._interim=g,i;let l=u.charCodeAt(m);56320<=l&&l<=57343?f[i++]=1024*(g-55296)+l-56320+65536:(f[i++]=g,f[i++]=l)}else g!==65279&&(f[i++]=g)}return i}},n.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(u,f){let s=u.length;if(!s)return 0;let i,p,m,g,l=0,r=0,o=0;if(this.interim[0]){let D=!1,C=this.interim[0];C&=(224&C)==192?31:(240&C)==224?15:7;let b,S=0;for(;(b=63&this.interim[++S])&&S<4;)C<<=6,C|=b;let v=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,y=v-S;for(;o<y;){if(o>=s)return 0;if(b=u[o++],(192&b)!=128){o--,D=!0;break}this.interim[S++]=b,C<<=6,C|=63&b}D||(v===2?C<128?o--:f[l++]=C:v===3?C<2048||C>=55296&&C<=57343||C===65279||(f[l++]=C):C<65536||C>1114111||(f[l++]=C)),this.interim.fill(0)}let c=s-4,_=o;for(;_<s;){for(;!(!(_<c)||128&(i=u[_])||128&(p=u[_+1])||128&(m=u[_+2])||128&(g=u[_+3]));)f[l++]=i,f[l++]=p,f[l++]=m,f[l++]=g,_+=4;if(i=u[_++],i<128)f[l++]=i;else if((224&i)==192){if(_>=s)return this.interim[0]=i,l;if(p=u[_++],(192&p)!=128){_--;continue}if(r=(31&i)<<6|63&p,r<128){_--;continue}f[l++]=r}else if((240&i)==224){if(_>=s)return this.interim[0]=i,l;if(p=u[_++],(192&p)!=128){_--;continue}if(_>=s)return this.interim[0]=i,this.interim[1]=p,l;if(m=u[_++],(192&m)!=128){_--;continue}if(r=(15&i)<<12|(63&p)<<6|63&m,r<2048||r>=55296&&r<=57343||r===65279)continue;f[l++]=r}else if((248&i)==240){if(_>=s)return this.interim[0]=i,l;if(p=u[_++],(192&p)!=128){_--;continue}if(_>=s)return this.interim[0]=i,this.interim[1]=p,l;if(m=u[_++],(192&m)!=128){_--;continue}if(_>=s)return this.interim[0]=i,this.interim[1]=p,this.interim[2]=m,l;if(g=u[_++],(192&g)!=128){_--;continue}if(r=(7&i)<<18|(63&p)<<12|(63&m)<<6|63&g,r<65536||r>1114111)continue;f[l++]=r}}return l}}},225:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeV6=void 0;let u=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],f=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],s;n.UnicodeV6=class{constructor(){if(this.version="6",!s){s=new Uint8Array(65536),s.fill(1),s[0]=0,s.fill(0,1,32),s.fill(0,127,160),s.fill(2,4352,4448),s[9001]=2,s[9002]=2,s.fill(2,11904,42192),s[12351]=1,s.fill(2,44032,55204),s.fill(2,63744,64256),s.fill(2,65040,65050),s.fill(2,65072,65136),s.fill(2,65280,65377),s.fill(2,65504,65511);for(let i=0;i<u.length;++i)s.fill(0,u[i][0],u[i][1]+1)}}wcwidth(i){return i<32?0:i<127?1:i<65536?s[i]:function(p,m){let g,l=0,r=m.length-1;if(p<m[0][0]||p>m[r][1])return!1;for(;r>=l;)if(g=l+r>>1,p>m[g][1])l=g+1;else{if(!(p<m[g][0]))return!0;r=g-1}return!1}(i,f)?0:i>=131072&&i<=196605||i>=196608&&i<=262141?2:1}}},5981:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WriteBuffer=void 0;let f=u(8460),s=u(844);class i extends s.Disposable{constructor(m){super(),this._action=m,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new f.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(m,g){if(g!==void 0&&this._syncCalls>g)return void(this._syncCalls=0);if(this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let l;for(this._isSyncWriting=!0;l=this._writeBuffer.shift();){this._action(l);let r=this._callbacks.shift();r&&r()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(m,g){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(g),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(g)}_innerWrite(m=0,g=!0){let l=m||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){let r=this._writeBuffer[this._bufferOffset],o=this._action(r,g);if(o){let _=D=>Date.now()-l>=12?setTimeout(()=>this._innerWrite(0,D)):this._innerWrite(l,D);return void o.catch(D=>(queueMicrotask(()=>{throw D}),Promise.resolve(!1))).then(_)}let c=this._callbacks[this._bufferOffset];if(c&&c(),this._bufferOffset++,this._pendingData-=r.length,Date.now()-l>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}n.WriteBuffer=i},5941:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.toRgbString=n.parseColor=void 0;let u=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,f=/^[\da-f]+$/;function s(i,p){let m=i.toString(16),g=m.length<2?"0"+m:m;switch(p){case 4:return m[0];case 8:return g;case 12:return(g+g).slice(0,3);default:return g+g}}n.parseColor=function(i){if(!i)return;let p=i.toLowerCase();if(p.indexOf("rgb:")===0){p=p.slice(4);let m=u.exec(p);if(m){let g=m[1]?15:m[4]?255:m[7]?4095:65535;return[Math.round(parseInt(m[1]||m[4]||m[7]||m[10],16)/g*255),Math.round(parseInt(m[2]||m[5]||m[8]||m[11],16)/g*255),Math.round(parseInt(m[3]||m[6]||m[9]||m[12],16)/g*255)]}}else if(p.indexOf("#")===0&&(p=p.slice(1),f.exec(p)&&[3,6,9,12].includes(p.length))){let m=p.length/3,g=[0,0,0];for(let l=0;l<3;++l){let r=parseInt(p.slice(m*l,m*l+m),16);g[l]=m===1?r<<4:m===2?r:m===3?r>>4:r>>8}return g}},n.toRgbString=function(i,p=16){let[m,g,l]=i;return`rgb:${s(m,p)}/${s(g,p)}/${s(l,p)}`}},5770:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PAYLOAD_LIMIT=void 0,n.PAYLOAD_LIMIT=1e7},6351:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DcsHandler=n.DcsParser=void 0;let f=u(482),s=u(8742),i=u(5770),p=[];n.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=p,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=p}registerHandler(g,l){this._handlers[g]===void 0&&(this._handlers[g]=[]);let r=this._handlers[g];return r.push(l),{dispose:()=>{let o=r.indexOf(l);o!==-1&&r.splice(o,1)}}}clearHandler(g){this._handlers[g]&&delete this._handlers[g]}setHandlerFallback(g){this._handlerFb=g}reset(){if(this._active.length)for(let g=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;g>=0;--g)this._active[g].unhook(!1);this._stack.paused=!1,this._active=p,this._ident=0}hook(g,l){if(this.reset(),this._ident=g,this._active=this._handlers[g]||p,this._active.length)for(let r=this._active.length-1;r>=0;r--)this._active[r].hook(l);else this._handlerFb(this._ident,"HOOK",l)}put(g,l,r){if(this._active.length)for(let o=this._active.length-1;o>=0;o--)this._active[o].put(g,l,r);else this._handlerFb(this._ident,"PUT",(0,f.utf32ToString)(g,l,r))}unhook(g,l=!0){if(this._active.length){let r=!1,o=this._active.length-1,c=!1;if(this._stack.paused&&(o=this._stack.loopPosition-1,r=l,c=this._stack.fallThrough,this._stack.paused=!1),!c&&r===!1){for(;o>=0&&(r=this._active[o].unhook(g),r!==!0);o--)if(r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!1,r;o--}for(;o>=0;o--)if(r=this._active[o].unhook(!1),r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!0,r}else this._handlerFb(this._ident,"UNHOOK",g);this._active=p,this._ident=0}};let m=new s.Params;m.addParam(0),n.DcsHandler=class{constructor(g){this._handler=g,this._data="",this._params=m,this._hitLimit=!1}hook(g){this._params=g.length>1||g.params[0]?g.clone():m,this._data="",this._hitLimit=!1}put(g,l,r){this._hitLimit||(this._data+=(0,f.utf32ToString)(g,l,r),this._data.length>i.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(g){let l=!1;if(this._hitLimit)l=!1;else if(g&&(l=this._handler(this._data,this._params),l instanceof Promise))return l.then(r=>(this._params=m,this._data="",this._hitLimit=!1,r));return this._params=m,this._data="",this._hitLimit=!1,l}}},2015:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.EscapeSequenceParser=n.VT500_TRANSITION_TABLE=n.TransitionTable=void 0;let f=u(844),s=u(8742),i=u(6242),p=u(6351);class m{constructor(o){this.table=new Uint8Array(o)}setDefault(o,c){this.table.fill(o<<4|c)}add(o,c,_,D){this.table[c<<8|o]=_<<4|D}addMany(o,c,_,D){for(let C=0;C<o.length;C++)this.table[c<<8|o[C]]=_<<4|D}}n.TransitionTable=m;let g=160;n.VT500_TRANSITION_TABLE=function(){let r=new m(4095),o=Array.apply(null,Array(256)).map((S,v)=>v),c=(S,v)=>o.slice(S,v),_=c(32,127),D=c(0,24);D.push(25),D.push.apply(D,c(28,32));let C=c(0,14),b;for(b in r.setDefault(1,0),r.addMany(_,0,2,0),C)r.addMany([24,26,153,154],b,3,0),r.addMany(c(128,144),b,3,0),r.addMany(c(144,152),b,3,0),r.add(156,b,0,0),r.add(27,b,11,1),r.add(157,b,4,8),r.addMany([152,158,159],b,0,7),r.add(155,b,11,3),r.add(144,b,11,9);return r.addMany(D,0,3,0),r.addMany(D,1,3,1),r.add(127,1,0,1),r.addMany(D,8,0,8),r.addMany(D,3,3,3),r.add(127,3,0,3),r.addMany(D,4,3,4),r.add(127,4,0,4),r.addMany(D,6,3,6),r.addMany(D,5,3,5),r.add(127,5,0,5),r.addMany(D,2,3,2),r.add(127,2,0,2),r.add(93,1,4,8),r.addMany(_,8,5,8),r.add(127,8,5,8),r.addMany([156,27,24,26,7],8,6,0),r.addMany(c(28,32),8,0,8),r.addMany([88,94,95],1,0,7),r.addMany(_,7,0,7),r.addMany(D,7,0,7),r.add(156,7,0,0),r.add(127,7,0,7),r.add(91,1,11,3),r.addMany(c(64,127),3,7,0),r.addMany(c(48,60),3,8,4),r.addMany([60,61,62,63],3,9,4),r.addMany(c(48,60),4,8,4),r.addMany(c(64,127),4,7,0),r.addMany([60,61,62,63],4,0,6),r.addMany(c(32,64),6,0,6),r.add(127,6,0,6),r.addMany(c(64,127),6,0,0),r.addMany(c(32,48),3,9,5),r.addMany(c(32,48),5,9,5),r.addMany(c(48,64),5,0,6),r.addMany(c(64,127),5,7,0),r.addMany(c(32,48),4,9,5),r.addMany(c(32,48),1,9,2),r.addMany(c(32,48),2,9,2),r.addMany(c(48,127),2,10,0),r.addMany(c(48,80),1,10,0),r.addMany(c(81,88),1,10,0),r.addMany([89,90,92],1,10,0),r.addMany(c(96,127),1,10,0),r.add(80,1,11,9),r.addMany(D,9,0,9),r.add(127,9,0,9),r.addMany(c(28,32),9,0,9),r.addMany(c(32,48),9,9,12),r.addMany(c(48,60),9,8,10),r.addMany([60,61,62,63],9,9,10),r.addMany(D,11,0,11),r.addMany(c(32,128),11,0,11),r.addMany(c(28,32),11,0,11),r.addMany(D,10,0,10),r.add(127,10,0,10),r.addMany(c(28,32),10,0,10),r.addMany(c(48,60),10,8,10),r.addMany([60,61,62,63],10,0,11),r.addMany(c(32,48),10,9,12),r.addMany(D,12,0,12),r.add(127,12,0,12),r.addMany(c(28,32),12,0,12),r.addMany(c(32,48),12,9,12),r.addMany(c(48,64),12,0,11),r.addMany(c(64,127),12,12,13),r.addMany(c(64,127),10,12,13),r.addMany(c(64,127),9,12,13),r.addMany(D,13,13,13),r.addMany(_,13,13,13),r.add(127,13,0,13),r.addMany([27,156,24,26],13,14,0),r.add(g,0,2,0),r.add(g,8,5,8),r.add(g,6,0,6),r.add(g,11,0,11),r.add(g,13,13,13),r}();class l extends f.Disposable{constructor(o=n.VT500_TRANSITION_TABLE){super(),this._transitions=o,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new s.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(c,_,D)=>{},this._executeHandlerFb=c=>{},this._csiHandlerFb=(c,_)=>{},this._escHandlerFb=c=>{},this._errorHandlerFb=c=>c,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,f.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new i.OscParser),this._dcsParser=this.register(new p.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(o,c=[64,126]){let _=0;if(o.prefix){if(o.prefix.length>1)throw new Error("only one byte as prefix supported");if(_=o.prefix.charCodeAt(0),_&&60>_||_>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(o.intermediates){if(o.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let C=0;C<o.intermediates.length;++C){let b=o.intermediates.charCodeAt(C);if(32>b||b>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");_<<=8,_|=b}}if(o.final.length!==1)throw new Error("final must be a single byte");let D=o.final.charCodeAt(0);if(c[0]>D||D>c[1])throw new Error(`final must be in range ${c[0]} .. ${c[1]}`);return _<<=8,_|=D,_}identToString(o){let c=[];for(;o;)c.push(String.fromCharCode(255&o)),o>>=8;return c.reverse().join("")}setPrintHandler(o){this._printHandler=o}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(o,c){let _=this._identifier(o,[48,126]);this._escHandlers[_]===void 0&&(this._escHandlers[_]=[]);let D=this._escHandlers[_];return D.push(c),{dispose:()=>{let C=D.indexOf(c);C!==-1&&D.splice(C,1)}}}clearEscHandler(o){this._escHandlers[this._identifier(o,[48,126])]&&delete this._escHandlers[this._identifier(o,[48,126])]}setEscHandlerFallback(o){this._escHandlerFb=o}setExecuteHandler(o,c){this._executeHandlers[o.charCodeAt(0)]=c}clearExecuteHandler(o){this._executeHandlers[o.charCodeAt(0)]&&delete this._executeHandlers[o.charCodeAt(0)]}setExecuteHandlerFallback(o){this._executeHandlerFb=o}registerCsiHandler(o,c){let _=this._identifier(o);this._csiHandlers[_]===void 0&&(this._csiHandlers[_]=[]);let D=this._csiHandlers[_];return D.push(c),{dispose:()=>{let C=D.indexOf(c);C!==-1&&D.splice(C,1)}}}clearCsiHandler(o){this._csiHandlers[this._identifier(o)]&&delete this._csiHandlers[this._identifier(o)]}setCsiHandlerFallback(o){this._csiHandlerFb=o}registerDcsHandler(o,c){return this._dcsParser.registerHandler(this._identifier(o),c)}clearDcsHandler(o){this._dcsParser.clearHandler(this._identifier(o))}setDcsHandlerFallback(o){this._dcsParser.setHandlerFallback(o)}registerOscHandler(o,c){return this._oscParser.registerHandler(o,c)}clearOscHandler(o){this._oscParser.clearHandler(o)}setOscHandlerFallback(o){this._oscParser.setHandlerFallback(o)}setErrorHandler(o){this._errorHandler=o}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(o,c,_,D,C){this._parseStack.state=o,this._parseStack.handlers=c,this._parseStack.handlerPos=_,this._parseStack.transition=D,this._parseStack.chunkPos=C}parse(o,c,_){let D,C=0,b=0,S=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,S=this._parseStack.chunkPos+1;else{if(_===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");let v=this._parseStack.handlers,y=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(_===!1&&y>-1){for(;y>=0&&(D=v[y](this._params),D!==!0);y--)if(D instanceof Promise)return this._parseStack.handlerPos=y,D}this._parseStack.handlers=[];break;case 4:if(_===!1&&y>-1){for(;y>=0&&(D=v[y](),D!==!0);y--)if(D instanceof Promise)return this._parseStack.handlerPos=y,D}this._parseStack.handlers=[];break;case 6:if(C=o[this._parseStack.chunkPos],D=this._dcsParser.unhook(C!==24&&C!==26,_),D)return D;C===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(C=o[this._parseStack.chunkPos],D=this._oscParser.end(C!==24&&C!==26,_),D)return D;C===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,S=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let v=S;v<c;++v){switch(C=o[v],b=this._transitions.table[this.currentState<<8|(C<160?C:g)],b>>4){case 2:for(let x=v+1;;++x){if(x>=c||(C=o[x])<32||C>126&&C<g){this._printHandler(o,v,x),v=x-1;break}if(++x>=c||(C=o[x])<32||C>126&&C<g){this._printHandler(o,v,x),v=x-1;break}if(++x>=c||(C=o[x])<32||C>126&&C<g){this._printHandler(o,v,x),v=x-1;break}if(++x>=c||(C=o[x])<32||C>126&&C<g){this._printHandler(o,v,x),v=x-1;break}}break;case 3:this._executeHandlers[C]?this._executeHandlers[C]():this._executeHandlerFb(C),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:v,code:C,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:let y=this._csiHandlers[this._collect<<8|C],M=y?y.length-1:-1;for(;M>=0&&(D=y[M](this._params),D!==!0);M--)if(D instanceof Promise)return this._preserveStack(3,y,M,b,v),D;M<0&&this._csiHandlerFb(this._collect<<8|C,this._params),this.precedingCodepoint=0;break;case 8:do switch(C){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(C-48)}while(++v<c&&(C=o[v])>47&&C<60);v--;break;case 9:this._collect<<=8,this._collect|=C;break;case 10:let T=this._escHandlers[this._collect<<8|C],w=T?T.length-1:-1;for(;w>=0&&(D=T[w](),D!==!0);w--)if(D instanceof Promise)return this._preserveStack(4,T,w,b,v),D;w<0&&this._escHandlerFb(this._collect<<8|C),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|C,this._params);break;case 13:for(let x=v+1;;++x)if(x>=c||(C=o[x])===24||C===26||C===27||C>127&&C<g){this._dcsParser.put(o,v,x),v=x-1;break}break;case 14:if(D=this._dcsParser.unhook(C!==24&&C!==26),D)return this._preserveStack(6,[],0,b,v),D;C===27&&(b|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let x=v+1;;x++)if(x>=c||(C=o[x])<32||C>127&&C<g){this._oscParser.put(o,v,x),v=x-1;break}break;case 6:if(D=this._oscParser.end(C!==24&&C!==26),D)return this._preserveStack(5,[],0,b,v),D;C===27&&(b|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&b}}}n.EscapeSequenceParser=l},6242:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OscHandler=n.OscParser=void 0;let f=u(5770),s=u(482),i=[];n.OscParser=class{constructor(){this._state=0,this._active=i,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(p,m){this._handlers[p]===void 0&&(this._handlers[p]=[]);let g=this._handlers[p];return g.push(m),{dispose:()=>{let l=g.indexOf(m);l!==-1&&g.splice(l,1)}}}clearHandler(p){this._handlers[p]&&delete this._handlers[p]}setHandlerFallback(p){this._handlerFb=p}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=i}reset(){if(this._state===2)for(let p=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;p>=0;--p)this._active[p].end(!1);this._stack.paused=!1,this._active=i,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||i,this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].start();else this._handlerFb(this._id,"START")}_put(p,m,g){if(this._active.length)for(let l=this._active.length-1;l>=0;l--)this._active[l].put(p,m,g);else this._handlerFb(this._id,"PUT",(0,s.utf32ToString)(p,m,g))}start(){this.reset(),this._state=1}put(p,m,g){if(this._state!==3){if(this._state===1)for(;m<g;){let l=p[m++];if(l===59){this._state=2,this._start();break}if(l<48||57<l)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+l-48}this._state===2&&g-m>0&&this._put(p,m,g)}}end(p,m=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let g=!1,l=this._active.length-1,r=!1;if(this._stack.paused&&(l=this._stack.loopPosition-1,g=m,r=this._stack.fallThrough,this._stack.paused=!1),!r&&g===!1){for(;l>=0&&(g=this._active[l].end(p),g!==!0);l--)if(g instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=l,this._stack.fallThrough=!1,g;l--}for(;l>=0;l--)if(g=this._active[l].end(!1),g instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=l,this._stack.fallThrough=!0,g}else this._handlerFb(this._id,"END",p);this._active=i,this._id=-1,this._state=0}}},n.OscHandler=class{constructor(p){this._handler=p,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(p,m,g){this._hitLimit||(this._data+=(0,s.utf32ToString)(p,m,g),this._data.length>f.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(p){let m=!1;if(this._hitLimit)m=!1;else if(p&&(m=this._handler(this._data),m instanceof Promise))return m.then(g=>(this._data="",this._hitLimit=!1,g));return this._data="",this._hitLimit=!1,m}}},8742:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Params=void 0;let u=2147483647;class f{static fromArray(i){let p=new f;if(!i.length)return p;for(let m=Array.isArray(i[0])?1:0;m<i.length;++m){let g=i[m];if(Array.isArray(g))for(let l=0;l<g.length;++l)p.addSubParam(g[l]);else p.addParam(g)}return p}constructor(i=32,p=32){if(this.maxLength=i,this.maxSubParamsLength=p,p>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(i),this.length=0,this._subParams=new Int32Array(p),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(i),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){let i=new f(this.maxLength,this.maxSubParamsLength);return i.params.set(this.params),i.length=this.length,i._subParams.set(this._subParams),i._subParamsLength=this._subParamsLength,i._subParamsIdx.set(this._subParamsIdx),i._rejectDigits=this._rejectDigits,i._rejectSubDigits=this._rejectSubDigits,i._digitIsSub=this._digitIsSub,i}toArray(){let i=[];for(let p=0;p<this.length;++p){i.push(this.params[p]);let m=this._subParamsIdx[p]>>8,g=255&this._subParamsIdx[p];g-m>0&&i.push(Array.prototype.slice.call(this._subParams,m,g))}return i}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(i){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(i<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=i>u?u:i}}addSubParam(i){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(i<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=i>u?u:i,this._subParamsIdx[this.length-1]++}}hasSubParams(i){return(255&this._subParamsIdx[i])-(this._subParamsIdx[i]>>8)>0}getSubParams(i){let p=this._subParamsIdx[i]>>8,m=255&this._subParamsIdx[i];return m-p>0?this._subParams.subarray(p,m):null}getSubParamsAll(){let i={};for(let p=0;p<this.length;++p){let m=this._subParamsIdx[p]>>8,g=255&this._subParamsIdx[p];g-m>0&&(i[p]=this._subParams.slice(m,g))}return i}addDigit(i){let p;if(this._rejectDigits||!(p=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;let m=this._digitIsSub?this._subParams:this.params,g=m[p-1];m[p-1]=~g?Math.min(10*g+i,u):i}}n.Params=f},5741:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AddonManager=void 0,n.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let u=this._addons.length-1;u>=0;u--)this._addons[u].instance.dispose()}loadAddon(u,f){let s={instance:f,dispose:f.dispose,isDisposed:!1};this._addons.push(s),f.dispose=()=>this._wrappedAddonDispose(s),f.activate(u)}_wrappedAddonDispose(u){if(u.isDisposed)return;let f=-1;for(let s=0;s<this._addons.length;s++)if(this._addons[s]===u){f=s;break}if(f===-1)throw new Error("Could not dispose an addon that has not been loaded");u.isDisposed=!0,u.dispose.apply(u.instance),this._addons.splice(f,1)}}},8771:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferApiView=void 0;let f=u(3785),s=u(511);n.BufferApiView=class{constructor(i,p){this._buffer=i,this.type=p}init(i){return this._buffer=i,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(i){let p=this._buffer.lines.get(i);if(p)return new f.BufferLineApiView(p)}getNullCell(){return new s.CellData}}},3785:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferLineApiView=void 0;let f=u(511);n.BufferLineApiView=class{constructor(s){this._line=s}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(s,i){if(!(s<0||s>=this._line.length))return i?(this._line.loadCell(s,i),i):this._line.loadCell(s,new f.CellData)}translateToString(s,i,p){return this._line.translateToString(s,i,p)}}},8285:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferNamespaceApi=void 0;let f=u(8771),s=u(8460),i=u(844);class p extends i.Disposable{constructor(g){super(),this._core=g,this._onBufferChange=this.register(new s.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new f.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new f.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}n.BufferNamespaceApi=p},7975:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ParserApi=void 0,n.ParserApi=class{constructor(u){this._core=u}registerCsiHandler(u,f){return this._core.registerCsiHandler(u,s=>f(s.toArray()))}addCsiHandler(u,f){return this.registerCsiHandler(u,f)}registerDcsHandler(u,f){return this._core.registerDcsHandler(u,(s,i)=>f(s,i.toArray()))}addDcsHandler(u,f){return this.registerDcsHandler(u,f)}registerEscHandler(u,f){return this._core.registerEscHandler(u,f)}addEscHandler(u,f){return this.registerEscHandler(u,f)}registerOscHandler(u,f){return this._core.registerOscHandler(u,f)}addOscHandler(u,f){return this.registerOscHandler(u,f)}}},7090:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeApi=void 0,n.UnicodeApi=class{constructor(u){this._core=u}register(u){this._core.unicodeService.register(u)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(u){this._core.unicodeService.activeVersion=u}}},744:function(h,n,u){var f=this&&this.__decorate||function(r,o,c,_){var D,C=arguments.length,b=C<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,c):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,o,c,_);else for(var S=r.length-1;S>=0;S--)(D=r[S])&&(b=(C<3?D(b):C>3?D(o,c,b):D(o,c))||b);return C>3&&b&&Object.defineProperty(o,c,b),b},s=this&&this.__param||function(r,o){return function(c,_){o(c,_,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.BufferService=n.MINIMUM_ROWS=n.MINIMUM_COLS=void 0;let i=u(8460),p=u(844),m=u(5295),g=u(2585);n.MINIMUM_COLS=2,n.MINIMUM_ROWS=1;let l=n.BufferService=class extends p.Disposable{get buffer(){return this.buffers.active}constructor(r){super(),this.isUserScrolling=!1,this._onResize=this.register(new i.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new i.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(r.rawOptions.cols||0,n.MINIMUM_COLS),this.rows=Math.max(r.rawOptions.rows||0,n.MINIMUM_ROWS),this.buffers=this.register(new m.BufferSet(r,this))}resize(r,o){this.cols=r,this.rows=o,this.buffers.resize(r,o),this._onResize.fire({cols:r,rows:o})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(r,o=!1){let c=this.buffer,_;_=this._cachedBlankLine,_&&_.length===this.cols&&_.getFg(0)===r.fg&&_.getBg(0)===r.bg||(_=c.getBlankLine(r,o),this._cachedBlankLine=_),_.isWrapped=o;let D=c.ybase+c.scrollTop,C=c.ybase+c.scrollBottom;if(c.scrollTop===0){let b=c.lines.isFull;C===c.lines.length-1?b?c.lines.recycle().copyFrom(_):c.lines.push(_.clone()):c.lines.splice(C+1,0,_.clone()),b?this.isUserScrolling&&(c.ydisp=Math.max(c.ydisp-1,0)):(c.ybase++,this.isUserScrolling||c.ydisp++)}else{let b=C-D+1;c.lines.shiftElements(D+1,b-1,-1),c.lines.set(C,_.clone())}this.isUserScrolling||(c.ydisp=c.ybase),this._onScroll.fire(c.ydisp)}scrollLines(r,o,c){let _=this.buffer;if(r<0){if(_.ydisp===0)return;this.isUserScrolling=!0}else r+_.ydisp>=_.ybase&&(this.isUserScrolling=!1);let D=_.ydisp;_.ydisp=Math.max(Math.min(_.ydisp+r,_.ybase),0),D!==_.ydisp&&(o||this._onScroll.fire(_.ydisp))}};n.BufferService=l=f([s(0,g.IOptionsService)],l)},7994:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CharsetService=void 0,n.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(u){this.glevel=u,this.charset=this._charsets[u]}setgCharset(u,f){this._charsets[u]=f,this.glevel===u&&(this.charset=f)}}},1753:function(h,n,u){var f=this&&this.__decorate||function(_,D,C,b){var S,v=arguments.length,y=v<3?D:b===null?b=Object.getOwnPropertyDescriptor(D,C):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(_,D,C,b);else for(var M=_.length-1;M>=0;M--)(S=_[M])&&(y=(v<3?S(y):v>3?S(D,C,y):S(D,C))||y);return v>3&&y&&Object.defineProperty(D,C,y),y},s=this&&this.__param||function(_,D){return function(C,b){D(C,b,_)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CoreMouseService=void 0;let i=u(2585),p=u(8460),m=u(844),g={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:_=>_.button!==4&&_.action===1&&(_.ctrl=!1,_.alt=!1,_.shift=!1,!0)},VT200:{events:19,restrict:_=>_.action!==32},DRAG:{events:23,restrict:_=>_.action!==32||_.button!==3},ANY:{events:31,restrict:_=>!0}};function l(_,D){let C=(_.ctrl?16:0)|(_.shift?4:0)|(_.alt?8:0);return _.button===4?(C|=64,C|=_.action):(C|=3&_.button,4&_.button&&(C|=64),8&_.button&&(C|=128),_.action===32?C|=32:_.action!==0||D||(C|=3)),C}let r=String.fromCharCode,o={DEFAULT:_=>{let D=[l(_,!1)+32,_.col+32,_.row+32];return D[0]>255||D[1]>255||D[2]>255?"":`\x1B[M${r(D[0])}${r(D[1])}${r(D[2])}`},SGR:_=>{let D=_.action===0&&_.button!==4?"m":"M";return`\x1B[<${l(_,!0)};${_.col};${_.row}${D}`},SGR_PIXELS:_=>{let D=_.action===0&&_.button!==4?"m":"M";return`\x1B[<${l(_,!0)};${_.x};${_.y}${D}`}},c=n.CoreMouseService=class extends m.Disposable{constructor(_,D){super(),this._bufferService=_,this._coreService=D,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new p.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(let C of Object.keys(g))this.addProtocol(C,g[C]);for(let C of Object.keys(o))this.addEncoding(C,o[C]);this.reset()}addProtocol(_,D){this._protocols[_]=D}addEncoding(_,D){this._encodings[_]=D}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(_){if(!this._protocols[_])throw new Error(`unknown protocol "${_}"`);this._activeProtocol=_,this._onProtocolChange.fire(this._protocols[_].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(_){if(!this._encodings[_])throw new Error(`unknown encoding "${_}"`);this._activeEncoding=_}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(_){if(_.col<0||_.col>=this._bufferService.cols||_.row<0||_.row>=this._bufferService.rows||_.button===4&&_.action===32||_.button===3&&_.action!==32||_.button!==4&&(_.action===2||_.action===3)||(_.col++,_.row++,_.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,_,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(_))return!1;let D=this._encodings[this._activeEncoding](_);return D&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(D):this._coreService.triggerDataEvent(D,!0)),this._lastEvent=_,!0}explainEvents(_){return{down:!!(1&_),up:!!(2&_),drag:!!(4&_),move:!!(8&_),wheel:!!(16&_)}}_equalEvents(_,D,C){if(C){if(_.x!==D.x||_.y!==D.y)return!1}else if(_.col!==D.col||_.row!==D.row)return!1;return _.button===D.button&&_.action===D.action&&_.ctrl===D.ctrl&&_.alt===D.alt&&_.shift===D.shift}};n.CoreMouseService=c=f([s(0,i.IBufferService),s(1,i.ICoreService)],c)},6975:function(h,n,u){var f=this&&this.__decorate||function(c,_,D,C){var b,S=arguments.length,v=S<3?_:C===null?C=Object.getOwnPropertyDescriptor(_,D):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(c,_,D,C);else for(var y=c.length-1;y>=0;y--)(b=c[y])&&(v=(S<3?b(v):S>3?b(_,D,v):b(_,D))||v);return S>3&&v&&Object.defineProperty(_,D,v),v},s=this&&this.__param||function(c,_){return function(D,C){_(D,C,c)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CoreService=void 0;let i=u(1439),p=u(8460),m=u(844),g=u(2585),l=Object.freeze({insertMode:!1}),r=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),o=n.CoreService=class extends m.Disposable{constructor(c,_,D){super(),this._bufferService=c,this._logService=_,this._optionsService=D,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new p.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new p.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new p.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new p.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,i.clone)(l),this.decPrivateModes=(0,i.clone)(r)}reset(){this.modes=(0,i.clone)(l),this.decPrivateModes=(0,i.clone)(r)}triggerDataEvent(c,_=!1){if(this._optionsService.rawOptions.disableStdin)return;let D=this._bufferService.buffer;_&&this._optionsService.rawOptions.scrollOnUserInput&&D.ybase!==D.ydisp&&this._onRequestScrollToBottom.fire(),_&&this._onUserInput.fire(),this._logService.debug(`sending data "${c}"`,()=>c.split("").map(C=>C.charCodeAt(0))),this._onData.fire(c)}triggerBinaryEvent(c){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${c}"`,()=>c.split("").map(_=>_.charCodeAt(0))),this._onBinary.fire(c))}};n.CoreService=o=f([s(0,g.IBufferService),s(1,g.ILogService),s(2,g.IOptionsService)],o)},9074:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DecorationService=void 0;let f=u(8055),s=u(8460),i=u(844),p=u(6106),m=0,g=0;class l extends i.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new p.SortedList(c=>c?.marker.line),this._onDecorationRegistered=this.register(new s.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new s.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,i.toDisposable)(()=>this.reset()))}registerDecoration(c){if(c.marker.isDisposed)return;let _=new r(c);if(_){let D=_.marker.onDispose(()=>_.dispose());_.onDispose(()=>{_&&(this._decorations.delete(_)&&this._onDecorationRemoved.fire(_),D.dispose())}),this._decorations.insert(_),this._onDecorationRegistered.fire(_)}return _}reset(){for(let c of this._decorations.values())c.dispose();this._decorations.clear()}*getDecorationsAtCell(c,_,D){var C,b,S;let v=0,y=0;for(let M of this._decorations.getKeyIterator(_))v=(C=M.options.x)!==null&&C!==void 0?C:0,y=v+((b=M.options.width)!==null&&b!==void 0?b:1),c>=v&&c<y&&(!D||((S=M.options.layer)!==null&&S!==void 0?S:"bottom")===D)&&(yield M)}forEachDecorationAtCell(c,_,D,C){this._decorations.forEachByKey(_,b=>{var S,v,y;m=(S=b.options.x)!==null&&S!==void 0?S:0,g=m+((v=b.options.width)!==null&&v!==void 0?v:1),c>=m&&c<g&&(!D||((y=b.options.layer)!==null&&y!==void 0?y:"bottom")===D)&&C(b)})}}n.DecorationService=l;class r extends i.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=f.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=f.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(c){super(),this.options=c,this.onRenderEmitter=this.register(new s.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new s.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=c.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.InstantiationService=n.ServiceCollection=void 0;let f=u(2585),s=u(8343);class i{constructor(...m){this._entries=new Map;for(let[g,l]of m)this.set(g,l)}set(m,g){let l=this._entries.get(m);return this._entries.set(m,g),l}forEach(m){for(let[g,l]of this._entries.entries())m(g,l)}has(m){return this._entries.has(m)}get(m){return this._entries.get(m)}}n.ServiceCollection=i,n.InstantiationService=class{constructor(){this._services=new i,this._services.set(f.IInstantiationService,this)}setService(p,m){this._services.set(p,m)}getService(p){return this._services.get(p)}createInstance(p,...m){let g=(0,s.getServiceDependencies)(p).sort((o,c)=>o.index-c.index),l=[];for(let o of g){let c=this._services.get(o.id);if(!c)throw new Error(`[createInstance] ${p.name} depends on UNKNOWN service ${o.id}.`);l.push(c)}let r=g.length>0?g[0].index:m.length;if(m.length!==r)throw new Error(`[createInstance] First service dependency of ${p.name} at position ${r+1} conflicts with ${m.length} static arguments`);return new p(...m,...l)}}},7866:function(h,n,u){var f=this&&this.__decorate||function(r,o,c,_){var D,C=arguments.length,b=C<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,c):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,o,c,_);else for(var S=r.length-1;S>=0;S--)(D=r[S])&&(b=(C<3?D(b):C>3?D(o,c,b):D(o,c))||b);return C>3&&b&&Object.defineProperty(o,c,b),b},s=this&&this.__param||function(r,o){return function(c,_){o(c,_,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.traceCall=n.setTraceLogger=n.LogService=void 0;let i=u(844),p=u(2585),m={trace:p.LogLevelEnum.TRACE,debug:p.LogLevelEnum.DEBUG,info:p.LogLevelEnum.INFO,warn:p.LogLevelEnum.WARN,error:p.LogLevelEnum.ERROR,off:p.LogLevelEnum.OFF},g,l=n.LogService=class extends i.Disposable{get logLevel(){return this._logLevel}constructor(r){super(),this._optionsService=r,this._logLevel=p.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),g=this}_updateLogLevel(){this._logLevel=m[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(r){for(let o=0;o<r.length;o++)typeof r[o]=="function"&&(r[o]=r[o]())}_log(r,o,c){this._evalLazyOptionalParams(c),r.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+o,...c)}trace(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.TRACE&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.trace.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.log,r,o)}debug(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.DEBUG&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.debug.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.log,r,o)}info(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.INFO&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.info.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.info,r,o)}warn(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.WARN&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.warn.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.warn,r,o)}error(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.ERROR&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.error.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.error,r,o)}};n.LogService=l=f([s(0,p.IOptionsService)],l),n.setTraceLogger=function(r){g=r},n.traceCall=function(r,o,c){if(typeof c.value!="function")throw new Error("not supported");let _=c.value;c.value=function(...D){if(g.logLevel!==p.LogLevelEnum.TRACE)return _.apply(this,D);g.trace(`GlyphRenderer#${_.name}(${D.map(b=>JSON.stringify(b)).join(", ")})`);let C=_.apply(this,D);return g.trace(`GlyphRenderer#${_.name} return`,C),C}}},7302:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OptionsService=n.DEFAULT_OPTIONS=void 0;let f=u(8460),s=u(844),i=u(6114);n.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:i.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};let p=["normal","bold","100","200","300","400","500","600","700","800","900"];class m extends s.Disposable{constructor(l){super(),this._onOptionChange=this.register(new f.EventEmitter),this.onOptionChange=this._onOptionChange.event;let r=Object.assign({},n.DEFAULT_OPTIONS);for(let o in l)if(o in r)try{let c=l[o];r[o]=this._sanitizeAndValidateOption(o,c)}catch(c){console.error(c)}this.rawOptions=r,this.options=Object.assign({},r),this._setupOptions()}onSpecificOptionChange(l,r){return this.onOptionChange(o=>{o===l&&r(this.rawOptions[l])})}onMultipleOptionChange(l,r){return this.onOptionChange(o=>{l.indexOf(o)!==-1&&r()})}_setupOptions(){let l=o=>{if(!(o in n.DEFAULT_OPTIONS))throw new Error(`No option with key "${o}"`);return this.rawOptions[o]},r=(o,c)=>{if(!(o in n.DEFAULT_OPTIONS))throw new Error(`No option with key "${o}"`);c=this._sanitizeAndValidateOption(o,c),this.rawOptions[o]!==c&&(this.rawOptions[o]=c,this._onOptionChange.fire(o))};for(let o in this.rawOptions){let c={get:l.bind(this,o),set:r.bind(this,o)};Object.defineProperty(this.options,o,c)}}_sanitizeAndValidateOption(l,r){switch(l){case"cursorStyle":if(r||(r=n.DEFAULT_OPTIONS[l]),!function(o){return o==="block"||o==="underline"||o==="bar"}(r))throw new Error(`"${r}" is not a valid value for ${l}`);break;case"wordSeparator":r||(r=n.DEFAULT_OPTIONS[l]);break;case"fontWeight":case"fontWeightBold":if(typeof r=="number"&&1<=r&&r<=1e3)break;r=p.includes(r)?r:n.DEFAULT_OPTIONS[l];break;case"cursorWidth":r=Math.floor(r);case"lineHeight":case"tabStopWidth":if(r<1)throw new Error(`${l} cannot be less than 1, value: ${r}`);break;case"minimumContrastRatio":r=Math.max(1,Math.min(21,Math.round(10*r)/10));break;case"scrollback":if((r=Math.min(r,4294967295))<0)throw new Error(`${l} cannot be less than 0, value: ${r}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(r<=0)throw new Error(`${l} cannot be less than or equal to 0, value: ${r}`);break;case"rows":case"cols":if(!r&&r!==0)throw new Error(`${l} must be numeric, value: ${r}`);break;case"windowsPty":r=r??{}}return r}}n.OptionsService=m},2660:function(h,n,u){var f=this&&this.__decorate||function(m,g,l,r){var o,c=arguments.length,_=c<3?g:r===null?r=Object.getOwnPropertyDescriptor(g,l):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(m,g,l,r);else for(var D=m.length-1;D>=0;D--)(o=m[D])&&(_=(c<3?o(_):c>3?o(g,l,_):o(g,l))||_);return c>3&&_&&Object.defineProperty(g,l,_),_},s=this&&this.__param||function(m,g){return function(l,r){g(l,r,m)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OscLinkService=void 0;let i=u(2585),p=n.OscLinkService=class{constructor(m){this._bufferService=m,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(m){let g=this._bufferService.buffer;if(m.id===void 0){let D=g.addMarker(g.ybase+g.y),C={data:m,id:this._nextId++,lines:[D]};return D.onDispose(()=>this._removeMarkerFromLink(C,D)),this._dataByLinkId.set(C.id,C),C.id}let l=m,r=this._getEntryIdKey(l),o=this._entriesWithId.get(r);if(o)return this.addLineToLink(o.id,g.ybase+g.y),o.id;let c=g.addMarker(g.ybase+g.y),_={id:this._nextId++,key:this._getEntryIdKey(l),data:l,lines:[c]};return c.onDispose(()=>this._removeMarkerFromLink(_,c)),this._entriesWithId.set(_.key,_),this._dataByLinkId.set(_.id,_),_.id}addLineToLink(m,g){let l=this._dataByLinkId.get(m);if(l&&l.lines.every(r=>r.line!==g)){let r=this._bufferService.buffer.addMarker(g);l.lines.push(r),r.onDispose(()=>this._removeMarkerFromLink(l,r))}}getLinkData(m){var g;return(g=this._dataByLinkId.get(m))===null||g===void 0?void 0:g.data}_getEntryIdKey(m){return`${m.id};;${m.uri}`}_removeMarkerFromLink(m,g){let l=m.lines.indexOf(g);l!==-1&&(m.lines.splice(l,1),m.lines.length===0&&(m.data.id!==void 0&&this._entriesWithId.delete(m.key),this._dataByLinkId.delete(m.id)))}};n.OscLinkService=p=f([s(0,i.IBufferService)],p)},8343:(h,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createDecorator=n.getServiceDependencies=n.serviceRegistry=void 0;let u="di$target",f="di$dependencies";n.serviceRegistry=new Map,n.getServiceDependencies=function(s){return s[f]||[]},n.createDecorator=function(s){if(n.serviceRegistry.has(s))return n.serviceRegistry.get(s);let i=function(p,m,g){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(l,r,o){r[u]===r?r[f].push({id:l,index:o}):(r[f]=[{id:l,index:o}],r[u]=r)})(i,p,g)};return i.toString=()=>s,n.serviceRegistry.set(s,i),i}},2585:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IDecorationService=n.IUnicodeService=n.IOscLinkService=n.IOptionsService=n.ILogService=n.LogLevelEnum=n.IInstantiationService=n.ICharsetService=n.ICoreService=n.ICoreMouseService=n.IBufferService=void 0;let f=u(8343);var s;n.IBufferService=(0,f.createDecorator)("BufferService"),n.ICoreMouseService=(0,f.createDecorator)("CoreMouseService"),n.ICoreService=(0,f.createDecorator)("CoreService"),n.ICharsetService=(0,f.createDecorator)("CharsetService"),n.IInstantiationService=(0,f.createDecorator)("InstantiationService"),function(i){i[i.TRACE=0]="TRACE",i[i.DEBUG=1]="DEBUG",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.OFF=5]="OFF"}(s||(n.LogLevelEnum=s={})),n.ILogService=(0,f.createDecorator)("LogService"),n.IOptionsService=(0,f.createDecorator)("OptionsService"),n.IOscLinkService=(0,f.createDecorator)("OscLinkService"),n.IUnicodeService=(0,f.createDecorator)("UnicodeService"),n.IDecorationService=(0,f.createDecorator)("DecorationService")},1480:(h,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeService=void 0;let f=u(8460),s=u(225);n.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new f.EventEmitter,this.onChange=this._onChange.event;let i=new s.UnicodeV6;this.register(i),this._active=i.version,this._activeProvider=i}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(i){if(!this._providers[i])throw new Error(`unknown Unicode version "${i}"`);this._active=i,this._activeProvider=this._providers[i],this._onChange.fire(i)}register(i){this._providers[i.version]=i}wcwidth(i){return this._activeProvider.wcwidth(i)}getStringCellWidth(i){let p=0,m=i.length;for(let g=0;g<m;++g){let l=i.charCodeAt(g);if(55296<=l&&l<=56319){if(++g>=m)return p+this.wcwidth(l);let r=i.charCodeAt(g);56320<=r&&r<=57343?l=1024*(l-55296)+r-56320+65536:p+=this.wcwidth(r)}p+=this.wcwidth(l)}return p}}}},t={};function a(h){var n=t[h];if(n!==void 0)return n.exports;var u=t[h]={exports:{}};return e[h].call(u.exports,u,u.exports,a),u.exports}var d={};return(()=>{var h=d;Object.defineProperty(h,"__esModule",{value:!0}),h.Terminal=void 0;let n=a(9042),u=a(3236),f=a(844),s=a(5741),i=a(8285),p=a(7975),m=a(7090),g=["cols","rows"];class l extends f.Disposable{constructor(o){super(),this._core=this.register(new u.Terminal(o)),this._addonManager=this.register(new s.AddonManager),this._publicOptions=Object.assign({},this._core.options);let c=D=>this._core.options[D],_=(D,C)=>{this._checkReadonlyOptions(D),this._core.options[D]=C};for(let D in this._core.options){let C={get:c.bind(this,D),set:_.bind(this,D)};Object.defineProperty(this._publicOptions,D,C)}}_checkReadonlyOptions(o){if(g.includes(o))throw new Error(`Option "${o}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new p.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new m.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new i.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){let o=this._core.coreService.decPrivateModes,c="none";switch(this._core.coreMouseService.activeProtocol){case"X10":c="x10";break;case"VT200":c="vt200";break;case"DRAG":c="drag";break;case"ANY":c="any"}return{applicationCursorKeysMode:o.applicationCursorKeys,applicationKeypadMode:o.applicationKeypad,bracketedPasteMode:o.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:c,originMode:o.origin,reverseWraparoundMode:o.reverseWraparound,sendFocusMode:o.sendFocus,wraparoundMode:o.wraparound}}get options(){return this._publicOptions}set options(o){for(let c in o)this._publicOptions[c]=o[c]}blur(){this._core.blur()}focus(){this._core.focus()}resize(o,c){this._verifyIntegers(o,c),this._core.resize(o,c)}open(o){this._core.open(o)}attachCustomKeyEventHandler(o){this._core.attachCustomKeyEventHandler(o)}registerLinkProvider(o){return this._core.registerLinkProvider(o)}registerCharacterJoiner(o){return this._checkProposedApi(),this._core.registerCharacterJoiner(o)}deregisterCharacterJoiner(o){this._checkProposedApi(),this._core.deregisterCharacterJoiner(o)}registerMarker(o=0){return this._verifyIntegers(o),this._core.registerMarker(o)}registerDecoration(o){var c,_,D;return this._checkProposedApi(),this._verifyPositiveIntegers((c=o.x)!==null&&c!==void 0?c:0,(_=o.width)!==null&&_!==void 0?_:0,(D=o.height)!==null&&D!==void 0?D:0),this._core.registerDecoration(o)}hasSelection(){return this._core.hasSelection()}select(o,c,_){this._verifyIntegers(o,c,_),this._core.select(o,c,_)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(o,c){this._verifyIntegers(o,c),this._core.selectLines(o,c)}dispose(){super.dispose()}scrollLines(o){this._verifyIntegers(o),this._core.scrollLines(o)}scrollPages(o){this._verifyIntegers(o),this._core.scrollPages(o)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(o){this._verifyIntegers(o),this._core.scrollToLine(o)}clear(){this._core.clear()}write(o,c){this._core.write(o,c)}writeln(o,c){this._core.write(o),this._core.write(`\r
`,c)}paste(o){this._core.paste(o)}refresh(o,c){this._verifyIntegers(o,c),this._core.refresh(o,c)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(o){this._addonManager.loadAddon(this,o)}static get strings(){return n}_verifyIntegers(...o){for(let c of o)if(c===1/0||isNaN(c)||c%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...o){for(let c of o)if(c&&(c===1/0||isNaN(c)||c%1!=0||c<0))throw new Error("This API only accepts positive integers")}}h.Terminal=l})(),d})())});var hh=function(e){return function(t){for(var a=e.length,d=t.length,h=new Array(a*d),n=0,u=0;u<a;u++)for(var f=e[u],s=0;s<d;s++)h[n++]=f(t[s]);return h}};var bs={compose:function(e){return function(t){return function(a){return e(t(a))}}}};var _e=function(e){return e.identity},de={identity:function(e){return e},Semigroupoid0:function(){return bs}};var ar=!0;var Ge=function(e){return function(t){return function(a){return e(a)(t)}}},ye=function(e){return function(t){return e}};var gh=function(e){return function(t){for(var a=t.length,d=new Array(a),h=0;h<a;h++)d[h]=e(t[h]);return d}};var or=function(){function e(){}return e.value=new e,e}();var $=function(e){return e.map};var Dt=function(e){return $(e)(ye(void 0))},Hi=function(e){var t=$(e);return function(a){return function(d){return t(ye(d))(a)}}};var Ct={map:gh};var ww=_e(de);var ko={apply:hh,Functor0:function(){return Ct}},Xe=function(e){return e.apply};var la=function(e){var t=Xe(e),a=$(e.Functor0());return function(d){return function(h){return t(a(ye(ww))(d))(h)}}};var Dh=function(e){return function(t){for(var a=[],d=0,h=e.length;d<h;d++)Array.prototype.push.apply(a,t(e[d]));return a}};var K=function(e){return e.pure},Au=function(e){var t=K(e);return function(a){return function(d){if(!a)return d;if(a)return t(void 0);throw new Error("Failed pattern match at Control.Applicative (line 68, column 1 - line 68, column 65): "+[a.constructor.name,d.constructor.name])}}},tn=function(e){var t=K(e);return function(a){return function(d){if(a)return d;if(!a)return t(void 0);throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[a.constructor.name,d.constructor.name])}}},Iu=function(e){var t=Xe(e.Apply0()),a=K(e);return function(d){return function(h){return t(a(d))(h)}}};var Pi={pure:function(e){return[e]},Apply0:function(){return ko}};var xt=function(e){return e.discard};var Wo={bind:Dh,Apply0:function(){return ko}},se=function(e){return e.bind},zt=function(e){return Ge(se(e))},Ts=function(e){var t=zt(e);return function(a){return function(d){return function(h){return t(a)(d(h))}}}};var At={discard:function(e){return se(e)}};var yh=function(e){var t=se(e.Bind1()),a=Au(e.Applicative0());return function(d){return function(h){return t(d)(function(n){return a(n)(h)})}}};var bh=function(e){var t=se(e.Bind1()),a=K(e.Applicative0());return function(d){return function(h){return t(h)(function(n){return a(d(n))})}}},Lr=function(e){var t=se(e.Bind1()),a=K(e.Applicative0());return function(d){return function(h){return t(d)(function(n){return t(h)(function(u){return a(n(u))})})}}};var Sh=function(e){return function(t){return e+t}},Th=function(e){return function(t){return e.length===0?t:t.length===0?e:e.concat(t)}};var Ar=function(e){return e.reflectSymbol};var ki={append:Sh};var wt={append:Th};var oe=function(e){return e.append};var L_={alt:oe(wt),Functor0:function(){return Ct}},ir=function(e){return e.alt};var Eh=String.fromCharCode(65535),Mh=String.fromCharCode(0),xw=Number.POSITIVE_INFINITY,Aw=Number.NEGATIVE_INFINITY;var ws=function(e){return function(t){return function(a){return function(d){return function(h){return d<h?e:d===h?t:a}}}}};var Fh=ws,Lh=ws,xh=ws,Ah=ws,Ih=function(e){return function(t){return function(a){for(var d=0,h=t.length,n=a.length;d<h&&d<n;){var u=t[d],f=a[d],s=e(u)(f);if(s!==0)return s;d++}return h===n?0:h>n?-1:1}}};var Es=function(e){return function(t){return e===t}};var Rh=Es,Oh=Es,Hh=Es,Ph=Es,Nh=function(e){return function(t){return function(a){if(t.length!==a.length)return!1;for(var d=0;d<t.length;d++)if(!e(t[d])(a[d]))return!1;return!0}}};var x_={eq:function(e){return function(t){return!0}}},Br={eq:Ph};var Ru={eq:Oh},Wi={eq:Rh},kh={eq:Hh};var xe=function(e){return e.eq};var Bn=function(e){return{eq:Nh(xe(e))}};var X=function(){function e(){}return e.value=new e,e}(),te=function(){function e(){}return e.value=new e,e}(),De=function(){function e(){}return e.value=new e,e}();var Wh=function(e){return function(t){return e+t|0}},Bh=function(e){return function(t){return e*t|0}};var Bi={add:Wh,zero:0,mul:Bh,one:1};var bn=function(e){return e.one};var $r=function(e){return e.add};var qi={compare:function(e){return function(t){return De.value}},Eq0:function(){return x_}},It=function(){return{compare:xh(X.value)(De.value)(te.value),Eq0:function(){return Br}}}();var Ui=function(){return{compare:Lh(X.value)(De.value)(te.value),Eq0:function(){return Ru}}}(),ur=function(){return{compare:Fh(X.value)(De.value)(te.value),Eq0:function(){return Wi}}}(),Fs=function(){return{compare:Ah(X.value)(De.value)(te.value),Eq0:function(){return kh}}}();var he=function(e){return e.compare},Ww=he(ur);var Ls=function(e){var t=he(e);return function(a){return function(d){var h=t(a)(d);if(h instanceof X)return d;if(h instanceof De||h instanceof te)return a;throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[h.constructor.name])}}},A_=function(e){var t=he(e);return function(a){return function(d){var h=t(a)(d);if(h instanceof X||h instanceof De)return a;if(h instanceof te)return d;throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[h.constructor.name])}}},qa=function(e){var t=he(e),a=Bn(e.Eq0());return{compare:function(){var d=function(h){return function(n){var u=t(h)(n);if(u instanceof De)return 0;if(u instanceof X)return 1;if(u instanceof te)return-1;throw new Error("Failed pattern match at Data.Ord (line 79, column 7 - line 82, column 17): "+[u.constructor.name])}};return function(h){return function(n){return Ww(0)(Ih(d)(h)(n))}}}(),Eq0:function(){return a}}};var Gh=function(e){var t=A_(e),a=Ls(e);return function(d){return function(h){return function(n){return t(h)(a(d)(n))}}}};var $n=function(e){return e.top};var xs={top:2147483647,bottom:-2147483648,Ord0:function(){return ur}},Ou={top:Eh,bottom:Mh,Ord0:function(){return Fs}};var va=function(e){return e.bottom};var jh=function(e){return e.toString()},Jh=function(e){var t=e.toString();return isNaN(t+".0")?t:t+".0"};var Qh=function(e){var t=e.length;return'"'+e.replace(/[\0-\x1F\x7F"\\]/g,function(a,d){switch(a){case'"':case"\\":return"\\"+a;case"\x07":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case`
`:return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\v":return"\\v"}var h=d+1,n=h<t&&e[h]>="0"&&e[h]<="9"?"\\&":"";return"\\"+a.charCodeAt(0).toString(10)+n})+'"'};var zi={show:Qh};var Un={show:Jh},$o={show:jh};var Kh={show:function(e){if(e)return"true";if(!e)return"false";throw new Error("Failed pattern match at Data.Show (line 29, column 1 - line 31, column 23): "+[e.constructor.name])}},Ee=function(e){return e.show};var Gw=_e(de),q=function(){function e(){}return e.value=new e,e}(),k=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}();var O_=function(e){var t=oe(e);return{append:function(a){return function(d){if(a instanceof q)return d;if(d instanceof q)return a;if(a instanceof k&&d instanceof k)return new k(t(a.value0)(d.value0));throw new Error("Failed pattern match at Data.Maybe (line 182, column 1 - line 185, column 43): "+[a.constructor.name,d.constructor.name])}}}};var Xh=function(e){var t=O_(e);return{mempty:q.value,Semigroup0:function(){return t}}};var je=function(e){return function(t){return function(a){if(a instanceof q)return e;if(a instanceof k)return t(a.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[e.constructor.name,t.constructor.name,a.constructor.name])}}},ha=je(!0)(ye(!1)),Vi=je(!1)(ye(!0));var pt={map:function(e){return function(t){return t instanceof k?new k(e(t.value0)):q.value}}},jw=$(pt);var rr=function(e){return je(e)(Gw)},Sn=function(){return function(e){if(e instanceof k)return e.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[e.constructor.name])}};var As={apply:function(e){return function(t){if(e instanceof k)return jw(e.value0)(t);if(e instanceof q)return q.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[e.constructor.name,t.constructor.name])}},Functor0:function(){return pt}};var qr={bind:function(e){return function(t){if(e instanceof k)return t(e.value0);if(e instanceof q)return q.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[e.constructor.name,t.constructor.name])}},Apply0:function(){return As}};var Ye=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Qe=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}();var lr=function(e){return function(t){return function(a){if(a instanceof Ye)return e(a.value0);if(a instanceof Qe)return t(a.value0);throw new Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): "+[e.constructor.name,t.constructor.name,a.constructor.name])}}},Is=function(){return lr(ye(q.value))(k.create)}();var Yh=lr(ye(!1))(ye(!0));var ga=function(e){return e};var qo={map:function(e){return function(t){return e(t)}}};var Rs={apply:function(e){return function(t){return e(t)}},Functor0:function(){return qo}},H_={bind:function(e){return function(t){return t(e)}},Apply0:function(){return Rs}},Os={pure:ga,Apply0:function(){return Rs}},Hs={Applicative0:function(){return Os},Bind1:function(){return H_}};var za={mempty:"",Semigroup0:function(){return ki}};var Pu={mempty:[],Semigroup0:function(){return wt}};var Ze=function(e){return e.mempty};var tg=function(e){return function(){return e}},rg=function(e){return function(t){return function(){return t(e())()}}};var ng=function(e,t,a){var d=0,h;return function(n){if(d===2)return h;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,h=a(),d=2,h}},zn={Applicative0:function(){return Rt},Bind1:function(){return rn}},rn={bind:rg,Apply0:function(){return og(0)}},Rt={pure:tg,Apply0:function(){return og(0)}},ag=ng("functorEffect","Effect",function(){return{map:Iu(Rt)}}),og=ng("applyEffect","Effect",function(){return{apply:Lr(zn),Functor0:function(){return ag(0)}}}),Oe=ag(20);var ig=function(e){return function(){return{value:e}}};var He=function(e){return function(){return e.value}},ug=function(e){return function(t){return function(){var a=e(t.value);return t.value=a.state,a.value}}},vt=function(e){return function(t){return function(){t.value=e}}};var t1=Dt(Oe),Ot=ig,k_=ug,cg=function(e){return k_(function(t){var a=e(t);return{state:a,value:a}})},nn=function(e){return function(t){return t1(cg(e)(t))}};var o1=zt(rn),i1=$(Oe),Jt=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Wt=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Sr=function(e){return e.tailRecM};var Ns={tailRecM:function(e){return function(t){var a=function(d){if(d instanceof Wt)return d.value0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 137, column 30 - line 137, column 44): "+[d.constructor.name])};return function(){var h=o1(Ot)(e(t))();return function(){for(;!function(){var u=He(h)();if(u instanceof Jt){var f=e(u.value0)();return vt(f)(h)(),!1}if(u instanceof Wt)return!0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 128, column 22 - line 133, column 28): "+[u.constructor.name])}(););return{}}(),i1(a)(He(h))()}}},Monad0:function(){return zn}};var sg=function(e){return function(t){return function(a){for(var d=t,h=a.length,n=h-1;n>=0;n--)d=e(a[n])(d);return d}}},fg=function(e){return function(t){return function(a){for(var d=t,h=a.length,n=0;n<h;n++)d=e(d)(a[n]);return d}}};var lg={empty:[],Alt0:function(){return L_}},Ur=function(e){return e.empty};var pg=function(e){return function(t){return e&&t}},dg=function(e){return function(t){return e||t}},vg=function(e){return!e};var ku=function(e){return e.tt};var Vn=function(e){return e.not};var U_=function(e){return e.implies};var Wu=function(e){return e.ff};var Uo=function(e){return e.disj},dn={ff:!1,tt:!0,implies:function(e){return function(t){return Uo(dn)(Vn(dn)(e))(t)}},conj:pg,disj:dg,not:vg};var Gi=function(e){return e.conj},Bu=function(e){var t=Wu(e),a=ku(e),d=U_(e),h=Gi(e),n=Uo(e),u=Vn(e);return{ff:function(f){return t},tt:function(f){return a},implies:function(f){return function(s){return function(i){return d(f(i))(s(i))}}},conj:function(f){return function(s){return function(i){return h(f(i))(s(i))}}},disj:function(f){return function(s){return function(i){return n(f(i))(s(i))}}},not:function(f){return function(s){return u(f(s))}}}};var J=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Da=function(e){return function(t){return e(t.value0)(t.value1)}};var Vt=function(e){return e.value1};var Ca={map:function(e){return function(t){return new J(t.value0,e(t.value1))}}};var _r=function(e){return e.value0};var Ws=function(e){var t=xe(e);return function(a){var d=xe(a);return{eq:function(h){return function(n){return t(h.value0)(n.value0)&&d(h.value1)(n.value1)}}}}},zo=function(e){var t=he(e),a=Ws(e.Eq0());return function(d){var h=he(d),n=a(d.Eq0());return{compare:function(u){return function(f){var s=t(u.value0)(f.value0);return s instanceof X?X.value:s instanceof te?te.value:h(u.value1)(f.value1)}},Eq0:function(){return n}}}};var on=function(e){return e.bimap};var m1={append:function(e){return function(t){return e instanceof k?e:t}}};var hg=function(){return{mempty:q.value,Semigroup0:function(){return m1}}}();var V=function(e){return e};var Us=function(){return V};var h1=Us();var Qt=function(){return h1};var g1=_e(de);var D1=Qt();var yt=function(e){return e.foldr};var Et=function(e){var t=la(e.Apply0()),a=K(e);return function(d){var h=yt(d);return function(n){return h(function(u){return t(n(u))})(a(void 0))}}},zs=function(e){var t=Et(e);return function(a){return Ge(t(a))}};var mt=function(e){return e.foldl};var Gn=function(e){var t=mt(e);return function(a){var d=oe(a.Semigroup0()),h=Ze(a);return function(n){return function(u){var f=function(s){return function(i){return s.init?{init:!1,acc:i}:{init:!1,acc:d(s.acc)(d(n)(i))}}};return t(f)({init:!0,acc:h})(u).acc}}}};var Xt={foldr:function(e){return function(t){return function(a){if(a instanceof q)return t;if(a instanceof k)return e(a.value0)(t);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[e.constructor.name,t.constructor.name,a.constructor.name])}}},foldl:function(e){return function(t){return function(a){if(a instanceof q)return t;if(a instanceof k)return e(t)(a.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[e.constructor.name,t.constructor.name,a.constructor.name])}}},foldMap:function(e){var t=Ze(e);return function(a){return function(d){if(d instanceof q)return t;if(d instanceof k)return a(d.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[a.constructor.name,d.constructor.name])}}}};var Sg=function(e){var t=yt(e);return function(a){var d=oe(a.Semigroup0()),h=Ze(a);return function(n){return t(function(u){return function(f){return d(n(u))(f)}})(h)}}},Ft={foldr:sg,foldl:fg,foldMap:function(e){return Sg(Ft)(e)}};var Mt=function(e){return e.foldMap};var Vs=function(e){var t=Mt(e)(hg);return function(a){var d=xe(a);return function(h){var n=t(function(u){var f=d(h)(u.value0);return f?new k(u.value1):q.value});return function(u){return D1(n(u))}}}};var Go=function(e){var t=Mt(e);return function(a){return t(a)(g1)}};var Js=function(e){return e.foldl1};var V1=function(){function e(h){return[h]}function t(h){return function(n){return[h,n]}}function a(h){return function(n){return function(u){return[h,n,u]}}}function d(h){return function(n){return h.concat(n)}}return function(h){return function(n){return function(u){return function(f){return function(s){function i(p,m){switch(m-p){case 0:return u([]);case 1:return n(e)(f(s[p]));case 2:return h(n(t)(f(s[p])))(f(s[p+1]));case 3:return h(h(n(a)(f(s[p])))(f(s[p+1])))(f(s[p+2]));default:var g=p+Math.floor((m-p)/4)*2;return h(n(d)(i(p,g)))(i(g,m))}}return i(0,s.length)}}}}}}();var wr=function(e){return e.traverse};var ap={traverse:function(e){var t=K(e),a=$(e.Apply0().Functor0());return function(d){return function(h){if(h instanceof q)return t(q.value);if(h instanceof k)return a(k.create)(d(h.value0));throw new Error("Failed pattern match at Data.Traversable (line 115, column 1 - line 119, column 33): "+[d.constructor.name,h.constructor.name])}}},sequence:function(e){var t=K(e),a=$(e.Apply0().Functor0());return function(d){if(d instanceof q)return t(q.value);if(d instanceof k)return a(k.create)(d.value0);throw new Error("Failed pattern match at Data.Traversable (line 115, column 1 - line 119, column 33): "+[d.constructor.name])}},Functor0:function(){return pt},Foldable1:function(){return Xt}};var Pg=function(e){return function(t){return function(a){return function(d){return function(h){return function(n){for(var u=[],f=n;;){var s=h(f);if(e(s))return u;var i=t(s);u.push(a(i)),f=d(i)}}}}}}};var Ng=function(e){return function(t){return function(a){return function(d){return function(h){return function(n){for(var u=[],f=n;;){var s=h(f);u.push(a(s));var i=d(s);if(e(i))return u;f=t(i)}}}}}}};var fE=Sn();var ip={unfoldr1:Ng(ha)(fE)(_r)(Vt)};var _E=Sn(),wn=function(e){return e.unfoldr};var Xi={unfoldr:Pg(ha)(_E)(_r)(Vt),Unfoldable10:function(){return ip}};var Rr=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var Ys=function(e){var t=Ur(e);return function(a){return new Rr(a,t)}};var Zs=function(e){var t=ir(e.Plus1().Alt0()),a=K(e.Applicative0());return function(d){return t(a(d.value0))(d.value1)}};var Yi=function(e){var t=$(e);return{map:function(a){return function(d){return new Rr(a(d.value0),t(a)(d.value1))}}}};var Ku=function(e){var t=Mt(e),a=mt(e),d=yt(e);return{foldMap:function(h){var n=oe(h.Semigroup0()),u=t(h);return function(f){return function(s){return n(f(s.value0))(u(f)(s.value1))}}},foldl:function(h){return function(n){return function(u){return a(h)(h(n)(u.value0))(u.value1)}}},foldr:function(h){return function(n){return function(u){return h(u.value0)(d(h)(n)(u.value1))}}}}};var fp=function(e){var t=mt(e),a=yt(e),d=Ku(e);return{foldMap1:function(h){var n=oe(h);return function(u){return function(f){return t(function(s){return function(i){return n(s)(u(i))}})(u(f.value0))(f.value1)}}},foldr1:function(h){return function(n){return je(n.value0)(h(n.value0))(a(function(u){var f=je(u)(h(u));return function(s){return k.create(f(s))}})(q.value)(n.value1))}},foldl1:function(h){return function(n){return t(h)(n.value0)(n.value1)}},Foldable0:function(){return d}}};var Pe=function(){function e(){}return e.value=new e,e}(),pe=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),lp=function(e){return e};var DE=function(e){var t=function(a){return function(d){var h=a,n=!1,u;function f(s,i){if(i instanceof pe&&i.value1 instanceof pe&&i.value1.value1 instanceof pe){h=new pe(i,s),d=i.value1.value1.value1;return}var p=function(g){return g instanceof pe&&g.value1 instanceof pe&&g.value1.value1 instanceof Pe?new pe(e(g.value0),new pe(e(g.value1.value0),Pe.value)):g instanceof pe&&g.value1 instanceof Pe?new pe(e(g.value0),Pe.value):Pe.value},m=function(g){return function(l){var r=g,o=!1,c;function _(D,C){if(D instanceof pe&&D.value0 instanceof pe&&D.value0.value1 instanceof pe&&D.value0.value1.value1 instanceof pe){r=D.value1,l=new pe(e(D.value0.value0),new pe(e(D.value0.value1.value0),new pe(e(D.value0.value1.value1.value0),C)));return}return o=!0,C}for(;!o;)c=_(r,l);return c}};return n=!0,m(s)(p(i))}for(;!n;)u=f(h,d);return u}};return t(Pe.value)},_p={map:DE};var Mn={foldr:function(e){return function(t){var a=function(){var h=function(n){return function(u){var f=n,s=!1,i;function p(m,g){if(g instanceof Pe)return s=!0,m;if(g instanceof pe){f=new pe(g.value0,m),u=g.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[m.constructor.name,g.constructor.name])}for(;!s;)i=p(f,u);return i}};return h(Pe.value)}(),d=mt(Mn)(Ge(e))(t);return function(h){return d(a(h))}}},foldl:function(e){var t=function(a){return function(d){var h=a,n=!1,u;function f(s,i){if(i instanceof Pe)return n=!0,s;if(i instanceof pe){h=e(s)(i.value0),d=i.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[i.constructor.name])}for(;!n;)u=f(h,d);return u}};return t},foldMap:function(e){var t=oe(e.Semigroup0()),a=Ze(e);return function(d){return mt(Mn)(function(h){var n=t(h);return function(u){return n(d(u))}})(a)}}};var CE=yt(Mn);var ef={append:function(e){return function(t){return CE(pe.create)(t)(e)}}},yE=oe(ef);var bE={alt:yE,Functor0:function(){return _p}},$g=function(){return{empty:Pe.value,Alt0:function(){return bE}}}();var jo=function(){var e=function(t){return function(a){var d=t,h=!1,n;function u(f,s){if(s instanceof Pe)return h=!0,f;if(s instanceof pe){d=new pe(s.value0,f),a=s.value1;return}throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[f.constructor.name,s.constructor.name])}for(;!h;)n=u(d,a);return n}};return e(Pe.value)}();var Gg=function(e){return e instanceof Pe};var rf=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var Jg=function(e){var t=!1,a;function d(h){if(h.value0 instanceof Pe&&h.value1 instanceof Pe)return t=!0,q.value;if(h.value0 instanceof Pe){e=new rf(jo(h.value1),Pe.value);return}if(h.value0 instanceof pe)return t=!0,new k(new J(h.value0.value0,new rf(h.value0.value1,h.value1)));throw new Error("Failed pattern match at Data.CatQueue (line 82, column 1 - line 82, column 63): "+[h.constructor.name])}for(;!t;)a=d(e);return a},Qg=function(e){return function(t){return new rf(e.value0,new pe(t,e.value1))}};var Kg=function(e){return e.value0 instanceof Pe&&e.value1 instanceof Pe};var Xg=function(){return new rf(Pe.value,Pe.value)}();var Zi=function(){function e(){}return e.value=new e,e}(),nf=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var Yg=function(e){return function(t){if(e instanceof Zi)return t;if(t instanceof Zi)return e;if(e instanceof nf)return new nf(e.value0,Qg(e.value1)(t));throw new Error("Failed pattern match at Data.CatList (line 108, column 1 - line 108, column 54): "+[e.constructor.name,t.constructor.name])}},FE=function(e){return function(t){return function(a){var d=function(n){return function(u){return function(f){var s=n,i=u,p=!1,m;function g(l,r,o){if(o instanceof Pe)return p=!0,r;if(o instanceof pe){s=l,i=l(r)(o.value0),f=o.value1;return}throw new Error("Failed pattern match at Data.CatList (line 124, column 3 - line 124, column 59): "+[l.constructor.name,r.constructor.name,o.constructor.name])}for(;!p;)m=g(s,i,f);return m}}},h=function(n){return function(u){var f=n,s=!1,i;function p(m,g){var l=Jg(m);if(l instanceof q)return s=!0,d(function(r){return function(o){return o(r)}})(t)(g);if(l instanceof k){f=l.value0.value1,u=new pe(e(l.value0.value0),g);return}throw new Error("Failed pattern match at Data.CatList (line 120, column 14 - line 122, column 67): "+[l.constructor.name])}for(;!s;)i=p(f,u);return i}};return h(a)(Pe.value)}}},Zg=function(e){if(e instanceof Zi)return q.value;if(e instanceof nf)return new k(new J(e.value0,function(){var t=Kg(e.value1);return t?Zi.value:FE(Yg)(Zi.value)(e.value1)}()));throw new Error("Failed pattern match at Data.CatList (line 99, column 1 - line 99, column 61): "+[e.constructor.name])};var eD=function(){return Zi.value}(),tD=Yg;var rD={append:tD};var nD=function(e){return function(t){return tD(e)(new nf(t,Xg))}};var xE=function(e,t,a){var d=0,h;return function(n){if(d===2)return h;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,h=a(),d=2,h}},AE=oe(rD);var dp=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Xu=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Yu=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),aD=function(e){var t=!1,a;function d(h){var n=function(s){return s},u=function(s){return function(i){return new dp(s.value0,AE(s.value1)(i))}};if(h.value0 instanceof Xu){var f=Zg(h.value1);if(f instanceof q)return t=!0,new Xu(h.value0.value0);if(f instanceof k){e=u(n(f.value0.value0)(h.value0.value0))(f.value0.value1);return}throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): "+[f.constructor.name])}if(h.value0 instanceof Yu)return t=!0,new Yu(h.value0.value0,function(s){return u(h.value0.value1(s))(h.value1)});throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): "+[h.value0.constructor.name])}for(;!t;)a=d(e);return a},Xa=function(e){var t=$(e);return function(a){var d=a.Monad0(),h=$(d.Bind1().Apply0().Functor0()),n=K(d.Applicative0()),u=Sr(a);return function(f){var s=function(i){var p=aD(i);if(p instanceof Xu)return h(Wt.create)(n(p.value0));if(p instanceof Yu)return h(Jt.create)(f(t(p.value1)(p.value0)));throw new Error("Failed pattern match at Control.Monad.Free (line 194, column 10 - line 196, column 37): "+[p.constructor.name])};return u(s)}}};var oD=function(e){return new dp(e,eD)};var Zu={Applicative0:function(){return un},Bind1:function(){return Or}},Jo={map:function(e){return function(t){return zt(Or)(function(){var a=K(un);return function(d){return a(e(d))}}())(t)}}},Or={bind:function(e){return function(t){return new dp(e.value0,nD(e.value1)(t))}},Apply0:function(){return vp(0)}},un={pure:function(e){return oD(Xu.create(e))},Apply0:function(){return vp(0)}},vp=xE("freeApply","Control.Monad.Free",function(){return{apply:Lr(Zu),Functor0:function(){return Jo}}}),mp=vp(77);var IE=K(un);var st=function(e){return oD(new Yu(e,function(t){return IE(t)}))};var iD=function(e){var t=e.Monad0(),a=$(t.Bind1().Apply0().Functor0()),d=K(t.Applicative0()),h=Sr(e);return function(n){var u=function(f){var s=aD(f);if(s instanceof Xu)return a(Wt.create)(d(s.value0));if(s instanceof Yu)return a(function(i){return Jt.create(s.value1(i))})(n(s.value0));throw new Error("Failed pattern match at Control.Monad.Free (line 158, column 10 - line 160, column 37): "+[s.constructor.name])};return h(u)}};var RE=function(e){return function(t){if(e<1)return[];var a=new Array(e);return a.fill(t)}},OE=function(e){return function(t){for(var a=[],d=0,h=0;h<e;h++)a[d++]=t;return a}},uD=typeof Array.prototype.fill=="function"?RE:OE,cD=function(){function e(h,n){this.head=h,this.tail=n}var t={};function a(h){return function(n){return new e(h,n)}}function d(h){for(var n=[],u=0,f=h;f!==t;)n[u++]=f.head,f=f.tail;return n}return function(h){return function(n){return d(h(a)(t)(n))}}}(),mn=function(e){return e.length},hp=function(e){return function(t){return function(a){return a.length===0?e({}):t(a[0])(a.slice(1))}}},sD=function(e){return function(t){return function(a){return function(d){return d<0||d>=a.length?t:e(a[d])}}}};var fD=function(e){return function(t){return function(a){return function(d){for(var h=0,n=d.length;h<n;h++)if(a(d[h]))return e(h);return t}}}};var lD=function(e){return function(t){return function(a){return function(d){if(a<0||a>=d.length)return t;var h=d.slice();return h.splice(a,1),e(h)}}}};var ec=function(e){return function(t){return t.filter(e)}};var _D=function(){function e(t,a,d,h,n,u){var f,s,i,p,m,g,l;for(f=n+(u-n>>1),f-n>1&&e(t,a,h,d,n,f),u-f>1&&e(t,a,h,d,f,u),s=n,i=f,p=n;s<f&&i<u;)m=h[s],g=h[i],l=a(t(m)(g)),l>0?(d[p++]=g,++i):(d[p++]=m,++s);for(;s<f;)d[p++]=h[s++];for(;i<u;)d[p++]=h[i++]}return function(t){return function(a){return function(d){var h;return d.length<2?d:(h=d.slice(0),e(t,a,h,d.slice(0),0,d.length),h)}}}}(),af=function(e){return function(t){return function(a){return a.slice(e,t)}}};var pD=function(e){return function(t){return function(){return e(t())}}};var of=function(e){return function(t){return function(){for(var a=0,d=e.length;a<d;a++)t(e[a])()}}};var uf={map:pD};var WE=function(){function e(t,a,d,h,n,u){var f,s,i,p,m,g,l;for(f=n+(u-n>>1),f-n>1&&e(t,a,h,d,n,f),u-f>1&&e(t,a,h,d,f,u),s=n,i=f,p=n;s<f&&i<u;)m=h[s],g=h[i],l=a(t(m)(g)),l>0?(d[p++]=g,++i):(d[p++]=m,++s);for(;s<f;)d[p++]=h[s++];for(;i<u;)d[p++]=h[i++]}return function(t){return function(a){return function(d){return function(){return d.length<2||e(t,a,d,d.slice(0),0,d.length),d}}}}}();var nM=Sn();var aM=oe(wt);var gp=function(){return hp(ye(q.value))(function(e){return function(t){return new k({head:e,tail:t})}})}();var Dp=function(){return hp(ye(q.value))(function(e){return function(t){return new k(t)}})}();var SD=function(e){return _D(e)(function(t){if(t instanceof te)return 1;if(t instanceof De)return 0;if(t instanceof X)return-1;throw new Error("Failed pattern match at Data.Array (line 870, column 31 - line 873, column 11): "+[t.constructor.name])})};var Cp=function(e){var t=he(e);return function(a){return SD(t)(a)}};var rc=function(e){return[e]},TD=function(e){return mn(e)===0};var wD=function(){return sD(k.create)(q.value)}();var yp=function(e){return wD(e)(0)};var bp=function(e){return cD(yt(e))};var ED=function(){return fD(k.create)(q.value)}();var Sp=function(e){return function(t){var a=e<1;return a?t:af(e)(mn(t))(t)}};var MD=function(){return lD(k.create)(q.value)}(),Tp=function(e){return function(t){return function(a){return a.length===0?[]:je(a)(function(d){return nM(MD(d)(a))})(ED(e(t))(a))}}};var Er=function(e){return function(t){return aM([e])(t)}};var FD=Ge(se(Wo)),ba=function(e){return FD(function(){var t=je([])(rc);return function(a){return t(e(a))}}())};var Fn=function(e){return e.state},nc=function(e){var t=Fn(e);return function(a){return t(function(d){return new J(void 0,a)})}},Ya=function(e){var t=Fn(e);return function(a){return t(function(d){return new J(void 0,a(d))})}},eu=function(e){var t=Fn(e);return function(a){return t(function(d){var h=a(d);return new J(h,h)})}};var Qo=function(e){return Fn(e)(function(t){return new J(t,t)})};var iM={dimap:function(e){return function(t){return function(a){return function(d){return a(e(d))}}}}},Ko={first:function(e){return function(t){return e(_r(t))}},second:function(e){return function(t){return e(Vt(t))}},Profunctor0:function(){return iM}};var cf={dimap:function(e){return function(t){return function(a){return function(d){return t(a(e(d)))}}}}},Xo=function(e){return e.dimap};var Ln={first:function(e){return function(t){return new J(e(t.value0),t.value1)}},second:$(Ca),Profunctor0:function(){return cf}},Yo=function(e){return e.second},tu=function(e){return e.first};var hM=Qt(),gM=_e(de);var DM=function(e){return hM(e(gM))},Hr=function(e){return function(t){return DM(t)(e)}};var Lp=function(e){return function(t){var a=Xo(t.Profunctor0()),d=tu(t);return function(h){return a(e)(function(n){return n.value1(n.value0)})(d(h))}}};var lf=function(e){return e},Xn=function(e){return function(t){return lf(e)(ye(t))}};var $D=function(e){return e()};var qD=function(e){throw new Error(e)};var UD=function(){return qD};var HM=UD(),PM=$D,eo=function(e){return PM(function(){return HM(e)})};var Me=function(){function e(){}return e.value=new e,e}(),We=function(){function e(t,a,d,h){this.value0=t,this.value1=a,this.value2=d,this.value3=h}return e.create=function(t){return function(a){return function(d){return function(h){return new e(t,a,d,h)}}}},e}(),at=function(){function e(t,a,d,h,n,u,f){this.value0=t,this.value1=a,this.value2=d,this.value3=h,this.value4=n,this.value5=u,this.value6=f}return e.create=function(t){return function(a){return function(d){return function(h){return function(n){return function(u){return function(f){return new e(t,a,d,h,n,u,f)}}}}}}},e}(),to=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),Sa=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),ro=function(){function e(t,a,d,h,n,u){this.value0=t,this.value1=a,this.value2=d,this.value3=h,this.value4=n,this.value5=u}return e.create=function(t){return function(a){return function(d){return function(h){return function(n){return function(u){return new e(t,a,d,h,n,u)}}}}}},e}(),Yn=function(){function e(t,a,d,h,n,u){this.value0=t,this.value1=a,this.value2=d,this.value3=h,this.value4=n,this.value5=u}return e.create=function(t){return function(a){return function(d){return function(h){return function(n){return function(u){return new e(t,a,d,h,n,u)}}}}}},e}(),no=function(){function e(t,a,d,h,n,u){this.value0=t,this.value1=a,this.value2=d,this.value3=h,this.value4=n,this.value5=u}return e.create=function(t){return function(a){return function(d){return function(h){return function(n){return function(u){return new e(t,a,d,h,n,u)}}}}}},e}(),_f=function(){function e(t,a,d,h){this.value0=t,this.value1=a,this.value2=d,this.value3=h}return e.create=function(t){return function(a){return function(d){return function(h){return new e(t,a,d,h)}}}},e}();var pf=function(e){return function(t){return new We(Me.value,e,t,Me.value)}},VD=function(e){var t=wn(e);return function(a){var d=function(h){var n=!1,u;function f(s){if(s instanceof Pe)return n=!0,q.value;if(s instanceof pe){if(s.value0 instanceof Me){h=s.value1;return}if(s.value0 instanceof We&&s.value0.value0 instanceof Me&&s.value0.value3 instanceof Me)return n=!0,new k(new J(new J(s.value0.value1,s.value0.value2),s.value1));if(s.value0 instanceof We&&s.value0.value0 instanceof Me)return n=!0,new k(new J(new J(s.value0.value1,s.value0.value2),new pe(s.value0.value3,s.value1)));if(s.value0 instanceof We){h=new pe(s.value0.value0,new pe(pf(s.value0.value1)(s.value0.value2),new pe(s.value0.value3,s.value1)));return}if(s.value0 instanceof at){h=new pe(s.value0.value0,new pe(pf(s.value0.value1)(s.value0.value2),new pe(s.value0.value3,new pe(pf(s.value0.value4)(s.value0.value5),new pe(s.value0.value6,s.value1)))));return}throw new Error("Failed pattern match at Data.Map.Internal (line 624, column 18 - line 633, column 71): "+[s.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 623, column 3 - line 623, column 19): "+[s.constructor.name])}for(;!n;)u=f(h);return u};return t(d)(new pe(a,Pe.value))}};var Ta=function(e){var t=he(e);return function(a){var d=function(h){var n=!1,u;function f(s){if(s instanceof Me)return n=!0,q.value;if(s instanceof We){var i=t(a)(s.value1);if(i instanceof De)return n=!0,new k(s.value2);if(i instanceof X){h=s.value0;return}h=s.value3;return}if(s instanceof at){var p=t(a)(s.value1);if(p instanceof De)return n=!0,new k(s.value2);var m=t(a)(s.value4);if(m instanceof De)return n=!0,new k(s.value5);if(p instanceof X){h=s.value0;return}if(m instanceof te){h=s.value6;return}h=s.value3;return}throw new Error("Failed pattern match at Data.Map.Internal (line 241, column 5 - line 241, column 22): "+[s.constructor.name])}for(;!n;)u=f(h);return u};return d}};var GD=function(e){return function(t){return function(a){var d=e,h=t,n=!1,u;function f(s,i,p){if(i instanceof Pe)return n=!0,p;if(i instanceof pe){if(i.value0 instanceof to){d=s,h=i.value1,a=new We(p,i.value0.value0,i.value0.value1,i.value0.value2);return}if(i.value0 instanceof Sa){d=s,h=i.value1,a=new We(i.value0.value0,i.value0.value1,i.value0.value2,p);return}if(i.value0 instanceof ro){d=s,h=i.value1,a=new at(p,i.value0.value0,i.value0.value1,i.value0.value2,i.value0.value3,i.value0.value4,i.value0.value5);return}if(i.value0 instanceof Yn){d=s,h=i.value1,a=new at(i.value0.value0,i.value0.value1,i.value0.value2,p,i.value0.value3,i.value0.value4,i.value0.value5);return}if(i.value0 instanceof no){d=s,h=i.value1,a=new at(i.value0.value0,i.value0.value1,i.value0.value2,i.value0.value3,i.value0.value4,i.value0.value5,p);return}throw new Error("Failed pattern match at Data.Map.Internal (line 462, column 3 - line 467, column 88): "+[i.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 459, column 1 - line 459, column 80): "+[i.constructor.name,p.constructor.name])}for(;!n;)u=f(d,h,a);return u}}},hn=function(e){var t=GD(e),a=he(e);return function(d){return function(h){var n=function(f){return function(s){var i=f,p=!1,m;function g(l,r){if(l instanceof Pe)return p=!0,new We(r.value0,r.value1,r.value2,r.value3);if(l instanceof pe){if(l.value0 instanceof to)return p=!0,t(l.value1)(new at(r.value0,r.value1,r.value2,r.value3,l.value0.value0,l.value0.value1,l.value0.value2));if(l.value0 instanceof Sa)return p=!0,t(l.value1)(new at(l.value0.value0,l.value0.value1,l.value0.value2,r.value0,r.value1,r.value2,r.value3));if(l.value0 instanceof ro){i=l.value1,s=new _f(new We(r.value0,r.value1,r.value2,r.value3),l.value0.value0,l.value0.value1,new We(l.value0.value2,l.value0.value3,l.value0.value4,l.value0.value5));return}if(l.value0 instanceof Yn){i=l.value1,s=new _f(new We(l.value0.value0,l.value0.value1,l.value0.value2,r.value0),r.value1,r.value2,new We(r.value3,l.value0.value3,l.value0.value4,l.value0.value5));return}if(l.value0 instanceof no){i=l.value1,s=new _f(new We(l.value0.value0,l.value0.value1,l.value0.value2,l.value0.value3),l.value0.value4,l.value0.value5,new We(r.value0,r.value1,r.value2,r.value3));return}throw new Error("Failed pattern match at Data.Map.Internal (line 498, column 5 - line 503, column 108): "+[l.value0.constructor.name,r.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 495, column 3 - line 495, column 56): "+[l.constructor.name,r.constructor.name])}for(;!p;)m=g(i,s);return m}},u=function(f){return function(s){var i=f,p=!1,m;function g(l,r){if(r instanceof Me)return p=!0,n(l)(new _f(Me.value,d,h,Me.value));if(r instanceof We){var o=a(d)(r.value1);if(o instanceof De)return p=!0,t(l)(new We(r.value0,d,h,r.value3));if(o instanceof X){i=new pe(new to(r.value1,r.value2,r.value3),l),s=r.value0;return}i=new pe(new Sa(r.value0,r.value1,r.value2),l),s=r.value3;return}if(r instanceof at){var o=a(d)(r.value1);if(o instanceof De)return p=!0,t(l)(new at(r.value0,d,h,r.value3,r.value4,r.value5,r.value6));var c=a(d)(r.value4);if(c instanceof De)return p=!0,t(l)(new at(r.value0,r.value1,r.value2,r.value3,d,h,r.value6));if(o instanceof X){i=new pe(new ro(r.value1,r.value2,r.value3,r.value4,r.value5,r.value6),l),s=r.value0;return}if(o instanceof te&&c instanceof X){i=new pe(new Yn(r.value0,r.value1,r.value2,r.value4,r.value5,r.value6),l),s=r.value3;return}i=new pe(new no(r.value0,r.value1,r.value2,r.value3,r.value4,r.value5),l),s=r.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 478, column 3 - line 478, column 55): "+[l.constructor.name,r.constructor.name])}for(;!p;)m=g(i,s);return m}};return u(Pe.value)}}},Rp=function(e){var t=GD(e),a=he(e);return function(d){var h=function(s){return function(i){var p=s,m=!1,g;function l(r,o){if(r instanceof Pe)return m=!0,o;if(r instanceof pe){if(r.value0 instanceof to&&r.value0.value2 instanceof Me&&o instanceof Me)return m=!0,t(r.value1)(new We(Me.value,r.value0.value0,r.value0.value1,Me.value));if(r.value0 instanceof Sa&&r.value0.value0 instanceof Me&&o instanceof Me)return m=!0,t(r.value1)(new We(Me.value,r.value0.value1,r.value0.value2,Me.value));if(r.value0 instanceof to&&r.value0.value2 instanceof We){p=r.value1,i=new at(o,r.value0.value0,r.value0.value1,r.value0.value2.value0,r.value0.value2.value1,r.value0.value2.value2,r.value0.value2.value3);return}if(r.value0 instanceof Sa&&r.value0.value0 instanceof We){p=r.value1,i=new at(r.value0.value0.value0,r.value0.value0.value1,r.value0.value0.value2,r.value0.value0.value3,r.value0.value1,r.value0.value2,o);return}return r.value0 instanceof to&&r.value0.value2 instanceof at?(m=!0,t(r.value1)(new We(new We(o,r.value0.value0,r.value0.value1,r.value0.value2.value0),r.value0.value2.value1,r.value0.value2.value2,new We(r.value0.value2.value3,r.value0.value2.value4,r.value0.value2.value5,r.value0.value2.value6)))):r.value0 instanceof Sa&&r.value0.value0 instanceof at?(m=!0,t(r.value1)(new We(new We(r.value0.value0.value0,r.value0.value0.value1,r.value0.value0.value2,r.value0.value0.value3),r.value0.value0.value4,r.value0.value0.value5,new We(r.value0.value0.value6,r.value0.value1,r.value0.value2,o)))):r.value0 instanceof ro&&r.value0.value2 instanceof Me&&r.value0.value5 instanceof Me&&o instanceof Me?(m=!0,t(r.value1)(new at(Me.value,r.value0.value0,r.value0.value1,Me.value,r.value0.value3,r.value0.value4,Me.value))):r.value0 instanceof Yn&&r.value0.value0 instanceof Me&&r.value0.value5 instanceof Me&&o instanceof Me?(m=!0,t(r.value1)(new at(Me.value,r.value0.value1,r.value0.value2,Me.value,r.value0.value3,r.value0.value4,Me.value))):r.value0 instanceof no&&r.value0.value0 instanceof Me&&r.value0.value3 instanceof Me&&o instanceof Me?(m=!0,t(r.value1)(new at(Me.value,r.value0.value1,r.value0.value2,Me.value,r.value0.value4,r.value0.value5,Me.value))):r.value0 instanceof ro&&r.value0.value2 instanceof We?(m=!0,t(r.value1)(new We(new at(o,r.value0.value0,r.value0.value1,r.value0.value2.value0,r.value0.value2.value1,r.value0.value2.value2,r.value0.value2.value3),r.value0.value3,r.value0.value4,r.value0.value5))):r.value0 instanceof Yn&&r.value0.value0 instanceof We?(m=!0,t(r.value1)(new We(new at(r.value0.value0.value0,r.value0.value0.value1,r.value0.value0.value2,r.value0.value0.value3,r.value0.value1,r.value0.value2,o),r.value0.value3,r.value0.value4,r.value0.value5))):r.value0 instanceof Yn&&r.value0.value5 instanceof We?(m=!0,t(r.value1)(new We(r.value0.value0,r.value0.value1,r.value0.value2,new at(o,r.value0.value3,r.value0.value4,r.value0.value5.value0,r.value0.value5.value1,r.value0.value5.value2,r.value0.value5.value3)))):r.value0 instanceof no&&r.value0.value3 instanceof We?(m=!0,t(r.value1)(new We(r.value0.value0,r.value0.value1,r.value0.value2,new at(r.value0.value3.value0,r.value0.value3.value1,r.value0.value3.value2,r.value0.value3.value3,r.value0.value4,r.value0.value5,o)))):r.value0 instanceof ro&&r.value0.value2 instanceof at?(m=!0,t(r.value1)(new at(new We(o,r.value0.value0,r.value0.value1,r.value0.value2.value0),r.value0.value2.value1,r.value0.value2.value2,new We(r.value0.value2.value3,r.value0.value2.value4,r.value0.value2.value5,r.value0.value2.value6),r.value0.value3,r.value0.value4,r.value0.value5))):r.value0 instanceof Yn&&r.value0.value0 instanceof at?(m=!0,t(r.value1)(new at(new We(r.value0.value0.value0,r.value0.value0.value1,r.value0.value0.value2,r.value0.value0.value3),r.value0.value0.value4,r.value0.value0.value5,new We(r.value0.value0.value6,r.value0.value1,r.value0.value2,o),r.value0.value3,r.value0.value4,r.value0.value5))):r.value0 instanceof Yn&&r.value0.value5 instanceof at?(m=!0,t(r.value1)(new at(r.value0.value0,r.value0.value1,r.value0.value2,new We(o,r.value0.value3,r.value0.value4,r.value0.value5.value0),r.value0.value5.value1,r.value0.value5.value2,new We(r.value0.value5.value3,r.value0.value5.value4,r.value0.value5.value5,r.value0.value5.value6)))):r.value0 instanceof no&&r.value0.value3 instanceof at?(m=!0,t(r.value1)(new at(r.value0.value0,r.value0.value1,r.value0.value2,new We(r.value0.value3.value0,r.value0.value3.value1,r.value0.value3.value2,r.value0.value3.value3),r.value0.value3.value4,r.value0.value3.value5,new We(r.value0.value3.value6,r.value0.value4,r.value0.value5,o)))):(m=!0,eo("The impossible happened in partial function `up`."))}throw new Error("Failed pattern match at Data.Map.Internal (line 552, column 5 - line 573, column 86): "+[r.constructor.name])}for(;!m;)g=l(p,i);return g}},n=function(s){return function(i){var p=s,m=!1,g;function l(r,o){if(o instanceof We&&o.value0 instanceof Me&&o.value3 instanceof Me)return m=!0,h(r)(Me.value);if(o instanceof We){p=new pe(new Sa(o.value0,o.value1,o.value2),r),i=o.value3;return}if(o instanceof at&&o.value0 instanceof Me&&o.value3 instanceof Me&&o.value6 instanceof Me)return m=!0,h(new pe(new Sa(Me.value,o.value1,o.value2),r))(Me.value);if(o instanceof at){p=new pe(new no(o.value0,o.value1,o.value2,o.value3,o.value4,o.value5),r),i=o.value6;return}return m=!0,eo("The impossible happened in partial function `removeMaxNode`.")}for(;!m;)g=l(p,i);return g}},u=function(s){var i=!1,p;function m(g){if(g instanceof We&&g.value3 instanceof Me)return i=!0,{key:g.value1,value:g.value2};if(g instanceof We){s=g.value3;return}if(g instanceof at&&g.value6 instanceof Me)return i=!0,{key:g.value4,value:g.value5};if(g instanceof at){s=g.value6;return}return i=!0,eo("The impossible happened in partial function `maxNode`.")}for(;!i;)p=m(s);return p},f=function(s){return function(i){var p=s,m=!1,g;function l(r,o){if(o instanceof Me)return m=!0,q.value;if(o instanceof We){var c=a(d)(o.value1);if(o.value3 instanceof Me&&c instanceof De)return m=!0,new k(new J(o.value2,h(r)(Me.value)));if(c instanceof De){var _=u(o.value0);return m=!0,new k(new J(o.value2,n(new pe(new to(_.key,_.value,o.value3),r))(o.value0)))}if(c instanceof X){p=new pe(new to(o.value1,o.value2,o.value3),r),i=o.value0;return}p=new pe(new Sa(o.value0,o.value1,o.value2),r),i=o.value3;return}if(o instanceof at){var D=function(){return o.value0 instanceof Me&&o.value3 instanceof Me&&o.value6 instanceof Me}(),c=a(d)(o.value4),C=a(d)(o.value1);if(D&&C instanceof De)return m=!0,new k(new J(o.value2,t(r)(new We(Me.value,o.value4,o.value5,Me.value))));if(D&&c instanceof De)return m=!0,new k(new J(o.value5,t(r)(new We(Me.value,o.value1,o.value2,Me.value))));if(C instanceof De){var _=u(o.value0);return m=!0,new k(new J(o.value2,n(new pe(new ro(_.key,_.value,o.value3,o.value4,o.value5,o.value6),r))(o.value0)))}if(c instanceof De){var _=u(o.value3);return m=!0,new k(new J(o.value5,n(new pe(new Yn(o.value0,o.value1,o.value2,_.key,_.value,o.value6),r))(o.value3)))}if(C instanceof X){p=new pe(new ro(o.value1,o.value2,o.value3,o.value4,o.value5,o.value6),r),i=o.value0;return}if(C instanceof te&&c instanceof X){p=new pe(new Yn(o.value0,o.value1,o.value2,o.value4,o.value5,o.value6),r),i=o.value3;return}p=new pe(new no(o.value0,o.value1,o.value2,o.value3,o.value4,o.value5),r),i=o.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 525, column 16 - line 548, column 80): "+[o.constructor.name])}for(;!m;)g=l(p,i);return g}};return f(Pe.value)}},cr={foldr:function(e){return function(t){return function(a){if(a instanceof Me)return t;if(a instanceof We)return yt(cr)(e)(e(a.value2)(yt(cr)(e)(t)(a.value3)))(a.value0);if(a instanceof at)return yt(cr)(e)(e(a.value2)(yt(cr)(e)(e(a.value5)(yt(cr)(e)(t)(a.value6)))(a.value3)))(a.value0);throw new Error("Failed pattern match at Data.Map.Internal (line 133, column 17 - line 136, column 85): "+[a.constructor.name])}}},foldl:function(e){return function(t){return function(a){if(a instanceof Me)return t;if(a instanceof We)return mt(cr)(e)(e(mt(cr)(e)(t)(a.value0))(a.value2))(a.value3);if(a instanceof at)return mt(cr)(e)(e(mt(cr)(e)(e(mt(cr)(e)(t)(a.value0))(a.value2))(a.value3))(a.value5))(a.value6);throw new Error("Failed pattern match at Data.Map.Internal (line 137, column 17 - line 140, column 85): "+[a.constructor.name])}}},foldMap:function(e){var t=Ze(e),a=oe(e.Semigroup0());return function(d){return function(h){if(h instanceof Me)return t;if(h instanceof We)return a(Mt(cr)(e)(d)(h.value0))(a(d(h.value2))(Mt(cr)(e)(d)(h.value3)));if(h instanceof at)return a(Mt(cr)(e)(d)(h.value0))(a(d(h.value2))(a(Mt(cr)(e)(d)(h.value3))(a(d(h.value5))(Mt(cr)(e)(d)(h.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 141, column 17 - line 144, column 93): "+[h.constructor.name])}}}};var jD=function(){var e=function(t){return function(a){var d=t,h=!1,n;function u(f,s){if(s instanceof Me)return h=!0,f;if(s instanceof We){d=new k({key:s.value1,value:s.value2}),a=s.value3;return}if(s instanceof at){d=new k({key:s.value4,value:s.value5}),a=s.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 330, column 5 - line 330, column 22): "+[f.constructor.name,s.constructor.name])}for(;!h;)n=u(d,a);return n}};return e(q.value)}();var gn=function(){return Me.value}(),JD=function(e){var t=hn(e);return function(a){return mt(a)(function(d){return function(h){return t(h.value0)(h.value1)(d)}})(gn)}};var oc=function(e){var t=Rp(e);return function(a){return function(d){return je(d)(Vt)(t(a)(d))}}};var QD=function(e){var t=Ta(e),a=oc(e),d=hn(e);return function(h){return function(n){return function(u){var f=h(t(n)(u));if(f instanceof q)return a(n)(u);if(f instanceof k)return d(n)(f.value0)(u);throw new Error("Failed pattern match at Data.Map.Internal (line 596, column 15 - line 598, column 25): "+[f.constructor.name])}}}};var Op=function(e){return function(t){return t.split(e)}};var xn=function(e){return function(t){return t.join(e)}};var Hp=function(e){return e===""};var pr=function(){var e={},t="Pure",a="Throw",d="Catch",h="Sync",n="Async",u="Bind",f="Bracket",s="Fork",i="Sequential",p="Map",m="Apply",g="Alt",l="Cons",r="Resume",o="Release",c="Finalizer",_="Finalized",D="Forked",C="Fiber",b="Thunk";function S(z,fe,F,N){this.tag=z,this._1=fe,this._2=F,this._3=N}function v(z){var fe=function(F,N,B){return new S(z,F,N,B)};return fe.tag=z,fe}function y(z){return new S(t,void 0)}function M(z){try{z()}catch(fe){setTimeout(function(){throw fe},0)}}function T(z,fe,F){try{return fe(F())}catch(N){return z(N)}}function w(z,fe,F){try{return fe(F)()}catch(N){return F(z(N))(),y}}var x=function(){var z=1024,fe=0,F=0,N=new Array(z),B=!1;function P(){var le;for(B=!0;fe!==0;)fe--,le=N[F],N[F]=void 0,F=(F+1)%z,le();B=!1}return{isDraining:function(){return B},enqueue:function(le){var j,Fe;fe===z&&(Fe=B,P(),B=Fe),N[(F+fe)%z]=le,fe++,B||P()}}}();function I(z){var fe={},F=0,N=0;return{register:function(B){var P=F++;B.onComplete({rethrow:!0,handler:function(le){return function(){N--,delete fe[P]}}})(),fe[P]=B,N++},isEmpty:function(){return N===0},killAll:function(B,P){return function(){if(N===0)return P();var le=0,j={};function Fe(Be){j[Be]=fe[Be].kill(B,function(Re){return function(){delete j[Be],le--,z.isLeft(Re)&&z.fromLeft(Re)&&setTimeout(function(){throw z.fromLeft(Re)},0),le===0&&P()}})()}for(var rt in fe)fe.hasOwnProperty(rt)&&(le++,Fe(rt));return fe={},F=0,N=0,function(Be){return new S(h,function(){for(var Re in j)j.hasOwnProperty(Re)&&j[Re]()})}}}}}var R=0,H=1,W=2,E=3,L=4,A=5,O=6;function U(z,fe,F){var N=0,B=R,P=F,le=null,j=null,Fe=null,rt=null,Be=null,Re=0,qe=0,kt=null,sr=!0;function dr(re){for(var Q,me,$e;;)switch(Q=null,me=null,$e=null,B){case W:B=H;try{P=Fe(P),rt===null?Fe=null:(Fe=rt._1,rt=rt._2)}catch(Tt){B=A,le=z.left(Tt),P=null}break;case E:z.isLeft(P)?(B=A,le=P,P=null):Fe===null?B=A:(B=W,P=z.fromRight(P));break;case H:switch(P.tag){case u:Fe&&(rt=new S(l,Fe,rt)),Fe=P._2,B=H,P=P._1;break;case t:Fe===null?(B=A,P=z.right(P._1)):(B=W,P=P._1);break;case h:B=E,P=T(z.left,z.right,P._1);break;case n:B=L,P=w(z.left,P._1,function(Tt){return function(){N===re&&(N++,x.enqueue(function(){N===re+1&&(B=E,P=Tt,dr(N))}))}});return;case a:B=A,le=z.left(P._1),P=null;break;case d:Fe===null?Be=new S(l,P,Be,j):Be=new S(l,P,new S(l,new S(r,Fe,rt),Be,j),j),Fe=null,rt=null,B=H,P=P._1;break;case f:Re++,Fe===null?Be=new S(l,P,Be,j):Be=new S(l,P,new S(l,new S(r,Fe,rt),Be,j),j),Fe=null,rt=null,B=H,P=P._1;break;case s:B=E,Q=U(z,fe,P._2),fe&&fe.register(Q),P._1&&Q.run(),P=z.right(Q);break;case i:B=H,P=ae(z,fe,P._1);break}break;case A:if(Fe=null,rt=null,Be===null)B=O,P=j||le||P;else switch(Q=Be._3,$e=Be._1,Be=Be._2,$e.tag){case d:j&&j!==Q&&Re===0?B=A:le&&(B=H,P=$e._2(z.fromLeft(le)),le=null);break;case r:j&&j!==Q&&Re===0||le?B=A:(Fe=$e._1,rt=$e._2,B=W,P=z.fromRight(P));break;case f:Re--,le===null&&(me=z.fromRight(P),Be=new S(l,new S(o,$e._2,me),Be,Q),(j===Q||Re>0)&&(B=H,P=$e._3(me)));break;case o:Be=new S(l,new S(_,P,le),Be,j),B=H,j&&j!==Q&&Re===0?P=$e._1.killed(z.fromLeft(j))($e._2):le?P=$e._1.failed(z.fromLeft(le))($e._2):P=$e._1.completed(z.fromRight(P))($e._2),le=null,Re++;break;case c:Re++,Be=new S(l,new S(_,P,le),Be,j),B=H,P=$e._1;break;case _:Re--,B=A,P=$e._1,le=$e._2;break}break;case O:for(var ze in kt)kt.hasOwnProperty(ze)&&(sr=sr&&kt[ze].rethrow,M(kt[ze].handler(P)));kt=null,j&&le?setTimeout(function(){throw z.fromLeft(le)},0):z.isLeft(P)&&sr&&setTimeout(function(){if(sr)throw z.fromLeft(P)},0);return;case R:B=H;break;case L:return}}function dt(re){return function(){if(B===O)return sr=sr&&re.rethrow,re.handler(P)(),function(){};var Q=qe++;return kt=kt||{},kt[Q]=re,function(){kt!==null&&delete kt[Q]}}}function ce(re,Q){return function(){if(B===O)return Q(z.right(void 0))(),function(){};var me=dt({rethrow:!1,handler:function(){return Q(z.right(void 0))}})();switch(B){case R:j=z.left(re),B=O,P=j,dr(N);break;case L:j===null&&(j=z.left(re)),Re===0&&(B===L&&(Be=new S(l,new S(c,P(re)),Be,j)),B=A,P=null,le=null,dr(++N));break;default:j===null&&(j=z.left(re)),Re===0&&(B=A,P=null,le=null)}return me}}function ue(re){return function(){var Q=dt({rethrow:!1,handler:re})();return B===R&&dr(N),Q}}return{kill:ce,join:ue,onComplete:dt,isSuspended:function(){return B===R},run:function(){B===R&&(x.isDraining()?dr(N):x.enqueue(function(){dr(N)}))}}}function Y(z,fe,F,N){var B=0,P={},le=0,j={},Fe=new Error("[ParAff] Early exit"),rt=null,Be=e;function Re(dt,ce,ue){var re=ce,Q=null,me=null,$e=0,ze={},Tt,tr;e:for(;;)switch(Tt=null,re.tag){case D:if(re._3===e&&(Tt=P[re._1],ze[$e++]=Tt.kill(dt,function(nr){return function(){$e--,$e===0&&ue(nr)()}})),Q===null)break e;re=Q._2,me===null?Q=null:(Q=me._1,me=me._2);break;case p:re=re._2;break;case m:case g:Q&&(me=new S(l,Q,me)),Q=re,re=re._1;break}if($e===0)ue(z.right(void 0))();else for(tr=0,Tt=$e;tr<Tt;tr++)ze[tr]=ze[tr]();return ze}function qe(dt,ce,ue){var re,Q,me,$e,ze,Tt;z.isLeft(dt)?(re=dt,Q=null):(Q=dt,re=null);e:for(;;){if(me=null,$e=null,ze=null,Tt=null,rt!==null)return;if(ce===null){N(re||Q)();return}if(ce._3!==e)return;switch(ce.tag){case p:re===null?(ce._3=z.right(ce._1(z.fromRight(Q))),Q=ce._3):ce._3=re;break;case m:if(me=ce._1._3,$e=ce._2._3,re){if(ce._3=re,ze=!0,Tt=le++,j[Tt]=Re(Fe,re===me?ce._2:ce._1,function(){return function(){delete j[Tt],ze?ze=!1:ue===null?qe(re,null,null):qe(re,ue._1,ue._2)}}),ze){ze=!1;return}}else{if(me===e||$e===e)return;Q=z.right(z.fromRight(me)(z.fromRight($e))),ce._3=Q}break;case g:if(me=ce._1._3,$e=ce._2._3,me===e&&z.isLeft($e)||$e===e&&z.isLeft(me))return;if(me!==e&&z.isLeft(me)&&$e!==e&&z.isLeft($e))re=Q===me?$e:me,Q=null,ce._3=re;else if(ce._3=Q,ze=!0,Tt=le++,j[Tt]=Re(Fe,Q===me?ce._2:ce._1,function(){return function(){delete j[Tt],ze?ze=!1:ue===null?qe(Q,null,null):qe(Q,ue._1,ue._2)}}),ze){ze=!1;return}break}ue===null?ce=null:(ce=ue._1,ue=ue._2)}}function kt(dt){return function(ce){return function(){delete P[dt._1],dt._3=ce,qe(ce,dt._2._1,dt._2._2)}}}function sr(){var dt=H,ce=F,ue=null,re=null,Q,me;e:for(;;)switch(Q=null,me=null,dt){case H:switch(ce.tag){case p:ue&&(re=new S(l,ue,re)),ue=new S(p,ce._1,e,e),ce=ce._2;break;case m:ue&&(re=new S(l,ue,re)),ue=new S(m,e,ce._2,e),ce=ce._1;break;case g:ue&&(re=new S(l,ue,re)),ue=new S(g,e,ce._2,e),ce=ce._1;break;default:me=B++,dt=A,Q=ce,ce=new S(D,me,new S(l,ue,re),e),Q=U(z,fe,Q),Q.onComplete({rethrow:!1,handler:kt(ce)})(),P[me]=Q,fe&&fe.register(Q)}break;case A:if(ue===null)break e;ue._1===e?(ue._1=ce,dt=H,ce=ue._2,ue._2=e):(ue._2=ce,ce=ue,re===null?ue=null:(ue=re._1,re=re._2))}for(Be=ce,me=0;me<B;me++)P[me].run()}function dr(dt,ce){rt=z.left(dt);var ue;for(var re in j)if(j.hasOwnProperty(re)){ue=j[re];for(re in ue)ue.hasOwnProperty(re)&&ue[re]()}j=null;var Q=Re(dt,Be,ce);return function(me){return new S(n,function($e){return function(){for(var ze in Q)Q.hasOwnProperty(ze)&&Q[ze]();return y}})}}return sr(),function(dt){return new S(n,function(ce){return function(){return dr(dt,ce)}})}}function ae(z,fe,F){return new S(n,function(N){return function(){return Y(z,fe,F,N)}})}return S.EMPTY=e,S.Pure=v(t),S.Throw=v(a),S.Catch=v(d),S.Sync=v(h),S.Async=v(n),S.Bind=v(u),S.Bracket=v(f),S.Fork=v(s),S.Seq=v(i),S.ParMap=v(p),S.ParApply=v(m),S.ParAlt=v(g),S.Fiber=U,S.Supervisor=I,S.Scheduler=x,S.nonCanceler=y,S}(),KD=pr.Pure,XD=pr.Throw;function YD(e){return function(t){return pr.Catch(e,t)}}function ZD(e){return function(t){return t.tag===pr.Pure.tag?pr.Pure(e(t._1)):pr.Bind(t,function(a){return pr.Pure(e(a))})}}function e0(e){return function(t){return pr.Bind(e,t)}}function Pp(e){return function(t){return pr.Fork(e,t)}}var t0=pr.Sync;function r0(e){return function(t){return pr.ParMap(e,t)}}function n0(e){return function(t){return pr.ParApply(e,t)}}var wa=pr.Async;function df(e){return function(t){return function(a){return pr.Bracket(e,t,a)}}}function a0(e,t){return function(){return pr.Fiber(e,null,t)}}var VM=function(){function e(a,d){return a===0&&typeof setImmediate<"u"?setImmediate(d):setTimeout(d,a)}function t(a,d){return a===0&&typeof clearImmediate<"u"?clearImmediate(d):clearTimeout(d)}return function(a,d){return pr.Async(function(h){return function(){var n=e(d,h(a()));return function(){return pr.Sync(function(){return a(t(d,n))})}}})}}(),o0=pr.Seq;function An(e){return new Error(e)}function Ea(e){return function(){throw e}}function vf(e){return function(t){return function(){try{return t()}catch(a){return a instanceof Error||Object.prototype.toString.call(a)==="[object Error]"?e(a)():e(new Error(a.toString()))()}}}}var i0=function(e){return Ea(An(e))};var zr=function(e){return e.throwError};var QM={throwError:Ea,Monad0:function(){return zn}};var u0={catchError:Ge(vf),MonadThrow0:function(){return QM}};var ea=function(e){return e.catchError};var uc=function(e){var t=ea(e),a=e.MonadThrow0().Monad0(),d=$(a.Bind1().Apply0().Functor0()),h=K(a.Applicative0());return function(n){return t(d(Qe.create)(n))(function(u){return h(Ye.create(u))})}};var cn=function(e){return e.ask};var ht=function(e){return e.lift};var mf={liftEffect:_e(de),Monad0:function(){return zn}},Ke=function(e){return e.liftEffect};var Fa=function(e){return e.tell};var ZM=$(pt);var Np=function(e){return e},s0=function(e){return e};var hf={lift:function(e){var t=bh(e)(k.create);return function(a){return Np(t(a))}}},eF=ht(hf);var tF=function(e){var t=$(e);return{map:function(a){return function(d){return t(ZM(a))(d)}}}},gf=function(e){return{Applicative0:function(){return Wp(e)},Bind1:function(){return kp(e)}}},kp=function(e){var t=se(e.Bind1()),a=K(e.Applicative0());return{bind:function(d){return function(h){return t(d)(function(n){if(n instanceof q)return a(q.value);if(n instanceof k){var u=h(n.value0);return u}throw new Error("Failed pattern match at Control.Monad.Maybe.Trans (line 54, column 11 - line 56, column 42): "+[n.constructor.name])})}},Apply0:function(){return f0(e)}}},f0=function(e){var t=tF(e.Bind1().Apply0().Functor0());return{apply:Lr(gf(e)),Functor0:function(){return t}}},Wp=function(e){return{pure:function(){var t=K(e.Applicative0());return function(a){return Np(t(k.create(a)))}}(),Apply0:function(){return f0(e)}}};var l0=function(e){var t=Sr(e),a=e.Monad0(),d=se(a.Bind1()),h=K(a.Applicative0()),n=gf(a);return{tailRecM:function(u){var f=t(function(s){var i=u(s);return d(i)(function(p){return h(function(){if(p instanceof q)return new Wt(q.value);if(p instanceof k&&p.value0 instanceof Jt)return new Jt(p.value0.value0);if(p instanceof k&&p.value0 instanceof Wt)return new Wt(new k(p.value0.value0));throw new Error("Failed pattern match at Control.Monad.Maybe.Trans (line 82, column 16 - line 85, column 43): "+[p.constructor.name])}())})});return function(s){return Np(f(s))}},Monad0:function(){return n}}},_0=function(e){var t=e.Monad0(),a=eF(t),d=Fn(e),h=gf(t);return{state:function(n){return a(d(n))},Monad0:function(){return h}}};var p0=function(e){return e};var ao=function(e){return e};var Df={lift:function(e){return function(t){return p0(ye(t))}}},rF=ht(Df),d0=function(e){return function(t){return function(a){return e(t(a))}}},nF=function(e){return{map:function(){var t=$(e);return function(a){return d0(t(a))}}()}};var v0=function(e){var t=Xe(e),a=nF(e.Functor0());return{apply:function(d){return function(h){return function(n){return t(d(n))(h(n))}}},Functor0:function(){return a}}},ei=function(e){var t=se(e),a=v0(e.Apply0());return{bind:function(d){return function(h){return function(n){return t(d(n))(function(u){var f=h(u);return f(n)})}}},Apply0:function(){return a}}};var Cf=function(e){var t=v0(e.Apply0());return{pure:function(){var a=K(e);return function(d){return p0(ye(a(d)))}}(),Apply0:function(){return t}}},pc=function(e){var t=Cf(e.Applicative0()),a=ei(e.Bind1());return{Applicative0:function(){return t},Bind1:function(){return a}}},au=function(e){var t=pc(e);return{ask:K(e.Applicative0()),Monad0:function(){return t}}};var oo=function(e){var t=e.Monad0(),a=pc(t);return{liftEffect:function(){var d=rF(t),h=Ke(e);return function(n){return d(h(n))}}(),Monad0:function(){return a}}},ou=function(e){var t=e.Monad0(),a=zt(t.Bind1()),d=K(t.Applicative0()),h=Sr(e),n=pc(t);return{tailRecM:function(u){return function(f){var s=function(i){return function(p){var m=u(p);return a(d)(m(i))}};return function(i){return h(s(i))(f)}}},Monad0:function(){return n}}};var $p=function(e){return e},qp=function(e){return e};var yf=function(e){return function(t){return e(t)}},Up=function(e){var t=$(e);return{map:function(a){return yf(t(function(d){return new J(a(d.value0),d.value1)}))}}};var bf=function(e){var t=oe(e);return function(a){var d=Xe(a),h=a.Functor0(),n=$(h),u=Up(h);return{apply:function(f){return function(s){var i=function(p){return function(m){return new J(p.value0(m.value0),t(p.value1)(m.value1))}};return d(n(i)(f))(s)}},Functor0:function(){return u}}}},zp=function(e){var t=oe(e),a=bf(e);return function(d){var h=se(d),n=d.Apply0(),u=$(n.Functor0()),f=a(n);return{bind:function(s){return function(i){return h(s)(function(p){var m=i(p.value0);return u(function(g){return new J(g.value0,t(p.value1)(g.value1))})(m)})}},Apply0:function(){return f}}}};var Vp=function(e){var t=Ze(e),a=bf(e.Semigroup0());return function(d){var h=K(d),n=a(d.Apply0());return{pure:function(u){return h(new J(u,t))},Apply0:function(){return n}}}},m0=function(e){var t=Vp(e),a=zp(e.Semigroup0());return function(d){var h=t(d.Applicative0()),n=a(d.Bind1());return{Applicative0:function(){return h},Bind1:function(){return n}}}};var h0=function(e){var t=e.Semigroup0(),a=m0(e);return function(d){var h=a(d);return{tell:function(){var n=K(d.Applicative0()),u=J.create(void 0);return function(f){return $p(n(u(f)))}}(),Semigroup0:function(){return t},Monad1:function(){return h}}}};var iu=function(e){return e.sequential},io=function(e){return e.parallel};var cF=_e(de),sF=function(e){var t=iu(e),a=Et(e.Applicative1()),d=io(e);return function(h){var n=a(h);return function(u){var f=n(function(s){return d(u(s))});return function(s){return t(f(s))}}}};var dc=function(e){var t=sF(e);return function(a){return t(a)(cF)}};var vc=function(e){return e()};var C0=function(e,t,a){var d=0,h;return function(n){if(d===2)return h;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,h=a(),d=2,h}},lF=K(Rt),Qp=Dt(Oe),y0=$(Oe);var _F=function(e){return e},b0=Pp(!1);var pF={map:r0},uo={map:ZD},dF=$(uo),S0=Pp(!0),vF=function(){var e=function(d){if(d instanceof Qe)return d.value0;if(d instanceof Ye)return eo("unsafeFromRight: Left");throw new Error("Failed pattern match at Effect.Aff (line 412, column 21 - line 414, column 54): "+[d.constructor.name])},t=function(d){if(d instanceof Ye)return d.value0;if(d instanceof Qe)return eo("unsafeFromLeft: Right");throw new Error("Failed pattern match at Effect.Aff (line 407, column 20 - line 409, column 55): "+[d.constructor.name])},a=function(d){if(d instanceof Ye)return!0;if(d instanceof Qe)return!1;throw new Error("Failed pattern match at Effect.Aff (line 402, column 12 - line 404, column 21): "+[d.constructor.name])};return{isLeft:a,fromLeft:t,fromRight:e,left:Ye.create,right:Qe.create}}(),T0=function(e){return a0(vF,e)},w0=function(e){return function(){var a=T0(e)();return a.run(),a}},Kp=function(e){return Qp(w0(e))};var mF=function(e){return function(t){return df(e)({killed:ye(t),failed:ye(t),completed:ye(t)})}},hF={apply:n0,Functor0:function(){return pF}};var ri={Applicative0:function(){return ta},Bind1:function(){return Mr}},Mr={bind:e0,Apply0:function(){return E0(0)}},ta={pure:KD,Apply0:function(){return E0(0)}},E0=C0("applyAff","Effect.Aff",function(){return{apply:Lr(ri),Functor0:function(){return uo}}});var wf=K(ta),M0=se(Mr);var gF=zt(Mr);var F0=function(e){return function(t){return mF(wf(void 0))(ye(e))(ye(t))}};var Fr={liftEffect:t0,Monad0:function(){return ri}},Tf=Ke(Fr),ni=function(e){return _F(ye(Tf(e)))},mc=function(e){return wa(function(t){return y0(ni)(e.join(t))})},L0={map:function(e){return function(t){return vc(T0(dF(e)(mc(t))))}}};var hc=function(e){return function(t){return M0(Tf(t.isSuspended))(function(a){return a?Tf(Qp(t.kill(e,ye(lF(void 0))))):wa(function(d){return y0(ni)(t.kill(e,d))})})}};var Ef={throwError:XD,Monad0:function(){return ri}},x0={catchError:YD,MonadThrow0:function(){return Ef}},DF=uc(x0);var CF=function(e){return function(t){return w0(gF(function(a){return Tf(e(a))})(DF(t)))}},Mf=function(e){return function(t){return Qp(CF(e)(t))}};var ai={parallel:V,sequential:o0,Monad0:function(){return ri},Applicative1:function(){return A0(0)}},A0=C0("applicativeParAff","Effect.Aff",function(){return{pure:function(){var e=io(ai);return function(t){return e(wf(t))}}(),Apply0:function(){return hF}}}),Xp=A0(136);var uu={tailRecM:function(e){var t=function(a){return M0(e(a))(function(d){if(d instanceof Wt)return wf(d.value0);if(d instanceof Jt)return t(d.value0);throw new Error("Failed pattern match at Effect.Aff (line 104, column 7 - line 106, column 23): "+[d.constructor.name])})};return t},Monad0:function(){return ri}};var I0=ye(wf(void 0));var co=function(){function e(){this.head=null,this.last=null,this.size=0}function t(p,m){this.queue=p,this.value=m,this.next=null,this.prev=null}function a(p){this.draining=!1,this.error=null,this.value=p,this.takes=new e,this.reads=new e,this.puts=new e}var d={};function h(p){try{p()}catch(m){setTimeout(function(){throw m},0)}}function n(p,m){var g=new t(p,m);switch(p.size){case 0:p.head=g;break;case 1:g.prev=p.head,p.head.next=g,p.last=g;break;default:g.prev=p.last,p.last.next=g,p.last=g}return p.size++,g}function u(p){var m;switch(p.size){case 0:return null;case 1:m=p.head,p.head=null;break;case 2:m=p.last,p.head.next=null,p.last=null;break;default:m=p.last,p.last=m.prev,p.last.next=null}return m.prev=null,m.queue=null,p.size--,m.value}function f(p){var m;switch(p.size){case 0:return null;case 1:m=p.head,p.head=null;break;case 2:m=p.head,p.last.prev=null,p.head=p.last,p.last=null;break;default:m=p.head,p.head=m.next,p.head.prev=null}return m.next=null,m.queue=null,p.size--,m.value}function s(p){if(p.queue!==null){if(p.queue.last===p){u(p.queue);return}if(p.queue.head===p){f(p.queue);return}p.prev&&(p.prev.next=p.next),p.next&&(p.next.prev=p.prev),p.queue.size--,p.queue=null,p.value=null,p.next=null,p.prev=null}}function i(p,m){if(!m.draining){var g=m.puts,l=m.takes,r=m.reads,o,c,_,D,C;for(m.draining=!0;;){if(o=null,c=null,_=null,D=m.value,C=r.size,m.error!==null){for(D=p.left(m.error);o=f(g);)h(o.cb(D));for(;c=f(r);)h(c(D));for(;_=f(l);)h(_(D));break}if(D===d&&(o=f(g))&&(m.value=D=o.value),D!==d){for(_=f(l);C--&&(c=f(r));)h(c(p.right(D)));_!==null&&(m.value=d,h(_(p.right(D))))}if(o!==null&&h(o.cb(p.right(void 0))),m.value===d&&g.size===0||m.value!==d&&l.size===0)break}m.draining=!1}}return a.EMPTY=d,a.putLast=n,a.takeLast=u,a.takeHead=f,a.deleteCell=s,a.drainVar=i,a}();function Yp(){return new co(co.EMPTY)}function R0(e,t,a,d){return function(){var h=co.putLast(a.puts,{cb:d,value:t});return co.drainVar(e,a),function(){co.deleteCell(h)}}}function O0(e,t,a){return function(){var d=co.putLast(t.takes,a);return co.drainVar(e,t),function(){co.deleteCell(d)}}}var H0=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),P0=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),N0=function(){function e(){}return e.value=new e,e}();var k0=function(){return{left:Ye.create,right:Qe.create,nothing:q.value,just:k.create,killed:H0.create,filled:P0.create,empty:N0.value}}();var W0=function(e){return function(t){return function(a){return R0(k0,e,t,a)}}};var B0=function(e){return function(t){return O0(k0,e,t)}};var SF=Ke(Fr);var Zp=function(e){return wa(function(t){return function(){var d=B0(e)(t)();return ni(d)}})};var gc=function(e){return function(t){return wa(function(a){return function(){var h=W0(e)(t)(a)();return ni(h)}})}};var Dc=SF(Yp);var MF=ht(Df);var Cc={liftAff:_e(de),MonadEffect0:function(){return Fr}},na=function(e){return e.liftAff};var q0=function(e){var t=e.MonadEffect0(),a=oo(t);return{liftAff:function(){var d=MF(t.Monad0()),h=na(e);return function(n){return d(h(n))}}(),MonadEffect0:function(){return a}}};var aa=V,ed=V;var FF=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var V0=function(e){return function(t){return aa(function(a){return e(a.value0)(a.value1)})(t)}};var G0=function(e){return function(t){return ed(new FF(e,t))}},td={map:function(e){return function(t){return aa(function(a){return G0(function(d){return e(a.value0(d))})(a.value1)})(t)}}};var j0=G0(_e(de));var xF=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}();var Ff=function(e){return xF.create(xe(e.Eq0()))(he(e))},AF={eq:function(e){return function(t){return e.value0(e.value2)(t.value2)}}},J0={compare:function(e){return function(t){return e.value1(e.value2)(t.value2)}},Eq0:function(){return AF}};var nd=zo(It)(J0);var RF=Rp(nd),OF=Ta(nd),HF=hn(nd);var Q0=function(){return function(e){var t=Ar(e);return function(a){var d=Ff(a);return function(h){return function(n){return function(u){return RF(new J(t(h),d(n)))(u)}}}}}},Lf=function(){return function(e){var t=Ar(e);return function(a){var d=Ff(a);return function(h){return function(n){return function(u){return OF(new J(t(h),d(n)))(u)}}}}}},K0=function(){return function(e){var t=Ar(e);return function(a){var d=Ff(a);return function(h){return function(n){return function(u){return function(f){return HF(new J(t(h),d(n)))(u)(f)}}}}}}},X0=function(e){var t=Et(e)(cr);return function(a){return function(d){return t(function(h){return d(h)})(a)}}},cu=gn;var Af=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),oi=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}();function Y0(e,t,a){return e==null?t:a(e)}function ad(e){return e}var La=je(null)(ad),Lt=function(e){return Y0(e,q.value,k.create)};var qt=function(){function e(t,a,d,h){this.value0=t,this.value1=a,this.value2=d,this.value3=h}return e.create=function(t){return function(a){return function(d){return function(h){return new e(t,a,d,h)}}}},e}(),Tc=V,Vr=function(e,t){return e.value2(e.value1,t)},Ut=V,Gr=function(e){return e.value3(e.value1)},hr=Tc(function(e){return e.value0});var Z0=$(Ct),eL=$(Ca);var so=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),xa=function(){function e(t,a,d,h){this.value0=t,this.value1=a,this.value2=d,this.value3=h}return e.create=function(t){return function(a){return function(d){return function(h){return new e(t,a,d,h)}}}},e}(),fo=function(){function e(t,a,d,h){this.value0=t,this.value1=a,this.value2=d,this.value3=h}return e.create=function(t){return function(a){return function(d){return function(h){return new e(t,a,d,h)}}}},e}(),lo=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Aa=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),tL=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),eC=function(e){return function(t){return e(t)}};var rL=V;var nL={bimap:function(e){return function(t){return eC(function(a){return rL(new tL(function(d){return e(a.value0(d))},function(d){return t(a.value1(d))},a.value2))})}}},aL=on(nL);var ii=eC(function(e){var t=function(a){if(a instanceof so)return new so(a.value0);if(a instanceof xa)return new xa(a.value0,a.value1,e.value0(a.value2),Z0(t)(a.value3));if(a instanceof fo)return new fo(a.value0,a.value1,e.value0(a.value2),Z0(eL(t))(a.value3));if(a instanceof lo)return new lo(e.value1(a.value0));if(a instanceof Aa)return new Aa(aL(e.value0)(e.value1)(a.value0));throw new Error("Failed pattern match at Halogen.VDom.Types (line 86, column 7 - line 86, column 27): "+[a.constructor.name])};return t(e.value2)});function ui(e,t){return t[e]}function id(e,t){return t.hasOwnProperty(e)}function Ia(e,t,a){a[e]=t}function ud(e,t){for(var a=[],d=0;d<e.length;d++)a.push(t(d,e[d]));return a}function cd(e,t){for(var a=0;a<e.length;a++)t(e[a])}function sd(e,t){for(var a=Object.keys(e),d=0;d<a.length;d++){var h=a[d];t(h,e[h])}}function fd(e,t,a,d,h){for(var n=[],u=e.length,f=t.length,s=0;;){if(s<u)s<f?n.push(a(s,e[s],t[s])):d(s,e[s]);else if(s<f)n.push(h(s,t[s]));else break;s++}return n}function wc(e,t,a){for(var d={},h=0;h<e.length;h++){var n=e[h],u=t(n);d[u]=a(u,h,n)}return d}function Ec(e,t,a,d,h,n){for(var u={},f=0;f<t.length;f++){var s=t[f],i=a(s);e.hasOwnProperty(i)?u[i]=d(i,f,e[i],s):u[i]=n(i,f,s)}for(var i in e)i in u||h(i,e[i]);return u}function ci(e,t){return e===t}function ld(e,t){return t.createTextNode(e)}function _d(e,t){t.textContent=e}function Rf(e,t,a){return e!=null?a.createElementNS(e,t):a.createElement(t)}function _o(e,t,a){var d=a.childNodes.item(e)||null;d!==t&&a.insertBefore(t,d)}function Mc(e,t){t&&e.parentNode===t&&t.removeChild(e)}function Fc(e){return e.parentNode}function Of(e,t,a,d){e!=null?d.setAttributeNS(e,t,a):d.setAttribute(t,a)}function Hf(e,t,a){e!=null?a.removeAttributeNS(e,t):a.removeAttribute(t)}function pd(e,t,a){return e!=null?a.hasAttributeNS(e,t):a.hasAttribute(t)}function dd(e,t,a){a.addEventListener(e,t,!1)}function vd(e,t,a){a.removeEventListener(e,t,!1)}var md=void 0;var Lc=function(){return{}};function hd(e){return function(t){return function(a){return function(){return a[e]=t,a}}}}var gd=ui,Dd=V,Cd=Ia,yd=Lc;var Pf=function(e){return function(t){return t[e]}},sL=Pf("namespaceURI"),fL=Pf("prefix"),lL=Pf("localName"),_L=Pf("tagName");var Nf=function(e){return function(t){return function(){return t[e]}}},dL=Nf("children"),vL=Nf("firstElementChild"),mL=Nf("lastElementChild"),hL=Nf("childElementCount");function rC(e){return function(t){return function(){return t.querySelector(e)}}}var DL=$(Oe);var nC=function(e){var t=DL(Lt),a=rC(e);return function(d){return t(a(d))}};var Sd=V;var xc=function(e,t,a){var d=0,h;return function(n){if(d===2)return h;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,h=a(),d=2,h}};var Td=function(e){return Gr(e.widget)},wd=xc("patchWidget","Halogen.VDom.DOM",function(){return function(e,t){if(t instanceof Aa)return wd(291)(e,ii(t.value0));if(t instanceof lo){var a=Vr(e.widget,t.value0),d=Tc(function(h){return Ut(new qt(h.value0,{build:e.build,widget:a},wd(296),Td))})(a);return d}return Td(e),e.build(t)}}),wL=wd(286),kf=function(e){var t=Fc(e.node);return Mc(e.node,t)},Wf=xc("patchText","Halogen.VDom.DOM",function(){return function(e,t){if(t instanceof Aa)return Wf(82)(e,ii(t.value0));if(t instanceof so){if(e.value===t.value0)return Ut(new qt(e.node,e,Wf(85),kf));if(ar){var a={build:e.build,node:e.node,value:t.value0};return _d(t.value0,e.node),Ut(new qt(e.node,a,Wf(89),kf))}}return kf(e),e.build(t)}}),EL=Wf(77),Bf=function(e){var t=Fc(e.node);return Mc(e.node,t),sd(e.children,function(a,d){return Gr(d)}),Gr(e.attrs)},$f=function(e){var t=Fc(e.node);return Mc(e.node,t),cd(e.children,Gr),Gr(e.attrs)},aC=function(e,t,a,d){var h=t===d;return h?e instanceof k&&a instanceof k&&e.value0===a.value0||e instanceof q&&a instanceof q:!1},qf=xc("patchElem","Halogen.VDom.DOM",function(){return function(e,t){if(t instanceof Aa)return qf(135)(e,ii(t.value0));if(t instanceof xa&&aC(e.ns,e.name,t.value0,t.value1)){var a=mn(t.value3),d=mn(e.children);if(d===0&&a===0){var s=Vr(e.attrs,t.value2),i={build:e.build,node:e.node,attrs:s,ns:t.value0,name:t.value1,children:e.children};return Ut(new qt(e.node,i,qf(149),$f))}var h=function(p,m){return Gr(m)},n=function(p,m,g){var l=Vr(m,g);return _o(p,hr(l),e.node),l},u=function(p,m){var g=e.build(m);return _o(p,hr(g),e.node),g},f=fd(e.children,t.value3,n,h,u),s=Vr(e.attrs,t.value2),i={build:e.build,node:e.node,attrs:s,ns:t.value0,name:t.value1,children:f};return Ut(new qt(e.node,i,qf(172),$f))}return $f(e),e.build(t)}}),ML=qf(130),Uf=xc("patchKeyed","Halogen.VDom.DOM",function(){return function(e,t){if(t instanceof Aa)return Uf(222)(e,ii(t.value0));if(t instanceof fo&&aC(e.ns,e.name,t.value0,t.value1)){var a=mn(t.value3);if(e.length===0&&a===0){var f=Vr(e.attrs,t.value2),s={build:e.build,node:e.node,attrs:f,ns:t.value0,name:t.value1,children:e.children,length:0};return Ut(new qt(e.node,s,Uf(237),Bf))}var d=function(i,p){return Gr(p)},h=function(i,p,m,g){var l=Vr(m,g.value1);return _o(p,hr(l),e.node),l},n=function(i,p,m){var g=e.build(m.value1);return _o(p,hr(g),e.node),g},u=Ec(e.children,t.value3,_r,h,d,n),f=Vr(e.attrs,t.value2),s={build:e.build,node:e.node,attrs:f,ns:t.value0,name:t.value1,children:u,length:a};return Ut(new qt(e.node,s,Uf(261),Bf))}return Bf(e),e.build(t)}}),FL=Uf(217),LL=function(e,t,a){var d=e.buildWidget(e)(a),h=Tc(function(n){return Ut(new qt(n.value0,{build:t,widget:d},wL,Td))})(d);return h},xL=function(e,t,a){var d=ld(a,e.document),h={build:t,node:d,value:a};return Ut(new qt(d,h,EL,kf))},AL=function(e,t,a,d,h,n){var u=Rf(La(a),d,e.document),f=Sd(u),s=function(g,l,r){var o=t(r.value1);return _o(l,hr(o),f),o},i=wc(n,_r,s),p=e.buildAttributes(u)(h),m={build:t,node:f,attrs:p,ns:a,name:d,children:i,length:mn(n)};return Ut(new qt(f,m,FL,Bf))},IL=function(e,t,a,d,h,n){var u=Rf(La(a),d,e.document),f=Sd(u),s=function(g,l){var r=t(l);return _o(g,hr(r),f),r},i=ud(n,s),p=e.buildAttributes(u)(h),m={build:t,node:f,attrs:p,ns:a,name:d,children:i};return Ut(new qt(f,m,ML,$f))},Ac=function(e){var t=xc("build","Halogen.VDom.DOM",function(){return function(d){if(d instanceof so)return xL(e,t(59),d.value0);if(d instanceof xa)return IL(e,t(60),d.value0,d.value1,d.value2,d.value3);if(d instanceof fo)return AL(e,t(61),d.value0,d.value1,d.value2,d.value3);if(d instanceof lo)return LL(e,t(62),d.value0);if(d instanceof Aa)return t(63)(ii(d.value0));throw new Error("Failed pattern match at Halogen.VDom.DOM (line 58, column 27 - line 63, column 52): "+[d.constructor.name])}}),a=t(58);return a};function zf(e){return typeof e}function Ic(e){return e===void 0}var iC=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};var uC=function(e){return function(t){return function(a){return(a|0)===a?e(a):t}}},su=function(e){return e};var Vf=isFinite;var Fd=Math.round;var sC=$n(xs),fC=va(xs);var _C=function(){return uC(k.create)(q.value)}(),GL=function(e){if(!Vf(e))return 0;if(e>=su(sC))return sC;if(e<=su(fC))return fC;if(ar)return rr(0)(_C(e));throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[e.constructor.name])},pC=function(e){return GL(Fd(e))};var xd=function(){var e=Ys($g);return function(t){return lp(e(t))}}();var dC=function(e){return function(t){return new Rr(e,new pe(t.value0,t.value1))}};var si=function(e){return e.length};var Gf=function(e){return function(t){return t.substr(0,e)}},fu=function(e){return function(t){return t.substring(e)}};var po=function(e){return function(t){if(e>=0&&e<t.length)return t.charAt(e);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var hC=function(e){return function(t){return fu(si(t)-e|0)(t)}};var jf=function(e){return function(t){return Gf(si(t)-e|0)(t)}};var fi=V,Ad=V;function Id(e){return e()}function CC(e,t,a,d){return a in d?t(d[a]):e}function Rd(e){return function(t){var a=[];for(var d in t)hasOwnProperty.call(t,d)&&a.push(e(d)(t[d]));return a}}var ex=Object.keys||Rd(function(e){return function(){return e}});var Od=function(e){return function(t){return function(a){return function(d){return function(h){return e(t,a,d,h)}}}}};var ux=Dt(uf);var bC=function(){return Od(CC)(q.value)(k.create)}();var Hd=function(e){var t=bp(e);return function(a){return Id(function(){var h=Lc();return of(t(a))(function(n){return ux(hd(n.value0)(n.value1)(h))})(),h})}};function Rc(e){return function(){return function(t){return e(t)()}}}function Nd(e){return function(t){return function(a){return function(d){return function(){return d.addEventListener(e,t,a)}}}}}function kd(e){return function(t){return function(a){return function(d){return function(){return d.removeEventListener(e,t,a)}}}}}var cx=function(e,t,a){var d=0,h;return function(n){if(d===2)return h;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,h=a(),d=2,h}};var Bd=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),$d=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),mo=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),ho=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),go=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),li=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),sx=ui,Wd=Ia,fx=function(e,t){var a=pd(null,e,t);if(a)return Hf(null,e,t);var d=zf(ui(e,t));return d==="string"?Ia(e,"",t):e==="rowSpan"?Ia(e,1,t):e==="colSpan"?Ia(e,1,t):Ia(e,md,t)},TC=function(e){if(e instanceof mo&&e.value0 instanceof k)return"attr/"+(e.value0.value0+(":"+e.value1));if(e instanceof mo)return"attr/:"+e.value1;if(e instanceof ho)return"prop/"+e.value0;if(e instanceof go)return"handler/"+e.value0;if(e instanceof li)return"ref";throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 182, column 16 - line 187, column 16): "+[e.constructor.name])},wC=V;var EC=function(e){return function(t){var a=function(p){return function(m,g){if(g instanceof mo)return Hf(La(g.value0),g.value1,t);if(g instanceof ho)return fx(g.value0,t);if(g instanceof go){var l=gd(g.value0,p);return vd(g.value0,_r(l),t)}if(g instanceof li)return void 0;throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 169, column 5 - line 179, column 18): "+[g.constructor.name])}},d=function(p){return p instanceof k?e(p.value0)():void 0},h=function(p){var m=bC("ref")(p.props);return m instanceof k&&m.value0 instanceof li?d(m.value0.value0(new $d(t))):void 0},n=function(p,m){return function(g,l,r,o){if(r instanceof mo&&o instanceof mo){var c=r.value2===o.value2;return c||Of(La(o.value0),o.value1,o.value2,t),o}if(r instanceof ho&&o instanceof ho){var _=ci(r.value1,o.value1);if(_)return o;if(o.value0==="value"){var D=sx("value",t),C=ci(D,o.value1);return C||Wd(o.value0,o.value1,t),o}return Wd(o.value0,o.value1,t),o}if(r instanceof go&&o instanceof go){var b=gd(o.value0,p);return vt(o.value1)(Vt(b))(),Cd(o.value0,b,m),o}return o}},u=function(p){return function(m,g,l){if(l instanceof mo)return Of(La(l.value0),l.value1,l.value2,t),l;if(l instanceof ho)return Wd(l.value0,l.value1,t),l;if(l instanceof go){var r=ui(l.value0,p);if(id(l.value0,p))return vt(l.value1)(Vt(r))(),l;var o=Ot(l.value1)(),c=Rc(function(_){return function(){var C=He(o)();return d(C(_))}})();return Cd(l.value0,new J(c,o),p),dd(l.value0,c,t),l}if(l instanceof li)return d(l.value0(new Bd(t))),l;throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 113, column 5 - line 135, column 15): "+[l.constructor.name])}},f=cx("patchProp","Halogen.VDom.DOM.Prop",function(){return function(p,m){var g=yd(),l=a(p.events),r=n(p.events,g),o=u(g),c=Ec(p.props,m,TC,r,l,o),_={events:Dd(g),props:c};return Ut(new qt(void 0,_,f(100),h))}}),s=f(87),i=function(p){var m=yd(),g=wc(p,TC,u(m)),l={events:Dd(m),props:g};return Ut(new qt(void 0,l,s,h))};return i}};var Ud=function(e){return e},xC=function(e){return Ud(lo.create(e))},px=function(e){return e.toPropValue},Oc=function(e){return Ud(so.create(e))},AC=function(e){return new li(function(t){return e(function(a){if(a instanceof Bd)return new k(a.value0);if(a instanceof $d)return q.value;throw new Error("Failed pattern match at Halogen.HTML.Core (line 109, column 21 - line 111, column 23): "+[a.constructor.name])}(t))})},IC=function(e){var t=px(e);return function(a){var d=ho.create(a);return function(h){return d(t(h))}}};var zd={toPropValue:function(){var e=Qt();return function(t){return wC(e(t))}}()};var Vd=function(){return go.create}(),RC=function(e){return function(t){return function(a){return function(d){return new xa(e,t,a,d)}}}};var dx=_e(de);var Qf=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Gd=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),jd=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),OC=function(e){return function(t){return new jd(e,t)}},HC=function(){return Gd.create}(),PC=function(e){var t=K(e);return function(a){return function(d){return function(h){return function(n){return function(u){if(n instanceof Qf)return new J(new pe({func:t(n.value0),count:u},a),d);if(n instanceof Gd)return new J(new pe({func:h(n.value0),count:u},a),d);if(n instanceof jd)return PC(e)(a)(dC(n.value1)(d))(h)(n.value0)(u+1|0);throw new Error("Failed pattern match at Control.Applicative.Free (line 102, column 41 - line 105, column 81): "+[n.constructor.name])}}}}}},NC=function(e){var t=Xe(e.Apply0());return function(a){return function(d){return function(h){if(a instanceof Pe)return new Ye(h);if(a instanceof pe){var n=t(a.value0.func)(h),u=a.value0.count===1;if(u)return a.value1 instanceof Pe?new Ye(n):NC(e)(a.value1)(d)(n);if(d instanceof Pe)return new Ye(n);if(d instanceof pe)return new Qe(new J(new pe({func:n,count:a.value0.count-1|0},a.value1),new Rr(d.value0,d.value1)));throw new Error("Failed pattern match at Control.Applicative.Free (line 83, column 11 - line 88, column 50): "+[d.constructor.name])}throw new Error("Failed pattern match at Control.Applicative.Free (line 72, column 3 - line 88, column 50): "+[a.constructor.name])}}}},kC={map:function(e){return function(t){return OC(new Qf(e))(t)}}},WC=function(e){var t=NC(e),a=K(e),d=PC(e);return function(h){return function(n){var u=function(f){var s=!1,i;function p(m){if(m.value1.value0 instanceof Qf){var g=t(m.value0)(m.value1.value1)(a(m.value1.value0.value0));if(g instanceof Ye)return s=!0,g.value0;if(g instanceof Qe){f=g.value0;return}throw new Error("Failed pattern match at Control.Applicative.Free (line 54, column 17 - line 56, column 24): "+[g.constructor.name])}if(m.value1.value0 instanceof Gd){var g=t(m.value0)(m.value1.value1)(h(m.value1.value0.value0));if(g instanceof Ye)return s=!0,g.value0;if(g instanceof Qe){f=g.value0;return}throw new Error("Failed pattern match at Control.Applicative.Free (line 57, column 17 - line 59, column 24): "+[g.constructor.name])}if(m.value1.value0 instanceof jd){var l=new Rr(m.value1.value0.value1,m.value1.value1);f=d(m.value0)(l)(h)(m.value1.value0.value0)(1);return}throw new Error("Failed pattern match at Control.Applicative.Free (line 53, column 5 - line 62, column 47): "+[m.value1.value0.constructor.name])}for(;!s;)i=p(f);return i};return u(new J(Pe.value,xd(n)))}}},BC=function(e){return WC(e)(dx)},$C={apply:function(e){return function(t){return OC(e)(t)}},Functor0:function(){return kC}},qC=function(){return{pure:Qf.create,Apply0:function(){return $C}}}(),vx=WC(qC),Jd=function(e){return vx(function(t){return HC(e(t))})};var zC=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),VC=V,GC=V;function Qd(e){return function(t){return e===t}}var lu=Qd;var Dx=Dt(Oe);var Cx=se(rn);var yx=oe(wt),bx=Et(Rt),Sx=bx(Ft);var Kf=function(e){return e},JC=function(e){return function(t){return e(function(a){return Dx(t(a))})}};var jr=function(e){return function(t){return e(t)}};var Jr=function(){var t=Ot([])();return{emitter:function(a){return function(){return nn(function(h){return yx(h)([a])})(t)(),nn(Tp(lu)(a))(t)}},listener:function(a){return Cx(He(t))(Sx(function(d){return d(a)}))}}};var Xd=_e(de);var Tx=Lf();var QC=function(e){return e},KC=function(e){return e},Hc=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Pc=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Yf=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),pi=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Nc=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),kc=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Zf=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),el=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),tl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),rl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Wc=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var _u=function(e){return e};var Qr=function(e){return st(new Pc(function(t){return e},Xd))};var Do=function(e){return st(new kc(e,void 0))};var pu=function(){return function(e){var t=Tx(e);return function(a){var d=t(a);return function(h){return function(n){return function(u){return st(new Nc(GC(new zC(function(f){var s=K(f);return function(i){var p=je(s(q.value))(i),m=d(h)(n);return function(g){return p(m(g))}}},u,Xd))))}}}}}},Yd=ur,nl=ur;var XC={lift:function(e){return function(t){return _u(st(pi.create(t)))}}},di=Zu,Ra={state:function(e){return _u(st(Hc.create(e)))},Monad0:function(){return di}};var vi=function(e){return{liftEffect:function(){var t=Ke(e);return function(a){return _u(st(pi.create(t(a))))}}(),Monad0:function(){return di}}};var YC=function(e){var t=vi(e.MonadEffect0());return{liftAff:function(){var a=na(e);return function(d){return _u(st(pi.create(a(d))))}}(),MonadEffect0:function(){return t}}};var Bc=function(e){return st(new Wc(e,Xd))},Co=Jo;var Oa=Or,wx=se(Oa);var yo=un,Ex=K(yo),Zd={tailRecM:function(e){return function(t){return wx(e(t))(function(a){if(a instanceof Jt)return Sr(Zd)(e)(a.value0);if(a instanceof Wt)return Ex(a.value0);throw new Error("Failed pattern match at Halogen.Query.HalogenM (line 105, column 26 - line 107, column 21): "+[a.constructor.name])})}},Monad0:function(){return di}};var vu=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),mu=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),hu=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),gu=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Du=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var Mx=function(e,t,a){var d=0,h;return function(n){if(d===2)return h;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,h=a(),d=2,h}};var Fx=function(e,t){return ci(e.value0,t.value0)&&ci(e.value1,t.value1)&&e.value1(e.value3,t.value3)};var ZC=function(e){return e.value2(e.value3)};var ey=function(e){var t=function(n){return Gr(n.vdom)},a=Mx("patchThunk","Halogen.VDom.Thunk",function(){return function(n,u){var f=Fx(n.thunk,u);if(f)return Ut(new qt(hr(n.vdom),n,a(112),t));var s=Vr(n.vdom,e(ZC(u)));return Ut(new qt(hr(s),{vdom:s,thunk:u},a(115),t))}}),d=a(108),h=function(n){return function(u){var f=Ac(n)(e(ZC(u)));return Ut(new qt(hr(f),{thunk:u,vdom:f},d,t))}};return h};var al=Hi(Co),rv=Et(yo)(Xt),Lx=$(Co);var ty=K(yo),xx=Lf(),Ax=Q0(),Ix=K0(),$c=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),ol=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),nv=V,av=V,mi=function(e){return function(t){if(t instanceof vu)return al(rv(e.handleAction)(e.initialize))(t.value0);if(t instanceof mu)return al(rv(e.handleAction)(e.finalize))(t.value0);if(t instanceof hu)return al(rv(e.handleAction)(e.receive(t.value0)))(t.value1);if(t instanceof gu)return al(e.handleAction(t.value0))(t.value1);if(t instanceof Du)return V0(function(a){var d=Lx(je(t.value1(void 0))(a));return function(h){return d(e.handleQuery(h))}})(t.value0);throw new Error("Failed pattern match at Halogen.Component (line 182, column 15 - line 192, column 71): "+[t.constructor.name])}},Rx=V,hi=V;var oa=function(){return{handleAction:ye(ty(void 0)),handleQuery:ye(ty(q.value)),receive:ye(q.value),initialize:q.value,finalize:q.value}}(),ov=function(){return function(e){var t=xx(e),a=Ax(e),d=Ix(e);return function(h){var n=t(h),u=a(h),f=d(h);return function(s){return function(i){return function(p){return function(m){return function(g){return Rx({get:n(s)(i),pop:u(s)(i),set:f(s)(i),component:p,input:m,output:g})}}}}}}}};var il=function(){return RC(q.value)}();var iv=il("style");var ul=il("div"),yu=ul([]);var uv=il("button");function cv(e){return function(){return e.stopPropagation()}}function bo(e){return e.charCodeAt(0)}function ry(e){return String.fromCharCode(e)}var qc={Applicative0:function(){return Pi},Plus1:function(){return lg}};var ny=va(Ou),ay=$n(Ou);var oy=function(e){return e.fromEnum};var gi=function(e){return function(t){return function(a){return e(t(a)+1|0)}}},Di=function(e){return function(t){return function(a){return e(t(a)-1|0)}}};var sv=function(e){return e>=bo(ny)&&e<=bo(ay)?new k(ry(e)):q.value},zx={succ:gi(sv)(bo),pred:Di(sv)(bo),Ord0:function(){return Fs}};var iy=function(){return{cardinality:bo(ay)-bo(ny)|0,toEnum:sv,fromEnum:bo,Bounded0:function(){return Ou},Enum1:function(){return zx}}}();var fv="DOMContentLoaded";var fy="click";var rA=V;var nA=function(e){return function(t){return Vd(e)(function(a){return new k(new oi(t(a)))})}};var ly=function(){var e=nA(fy);return function(t){return e(rA(t))}}();var oA=$(Jo),_y=_e(de),py=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var zc=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Vc=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Gc=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),jc=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Jc=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),fl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Qc=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),Kc=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Xc=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),dy=function(e){return e};var lv=Bi,Yc=ur,iA={lift:function(e){return function(t){return dy(st(Vc.create(t)))}}},uA=ht(iA),cA=Zu;var _v=function(e){return{liftEffect:function(){var t=uA(e.Monad0()),a=Ke(e);return function(d){return t(a(d))}}(),Monad0:function(){return cA}}};var vy=function(e){var t=$(e);return{map:function(a){return function(d){if(d instanceof zc)return new zc(oA(a)(d.value0));if(d instanceof Vc)return new Vc(t(a)(d.value0));if(d instanceof Gc)return new Gc(function(h){return a(d.value0(h))});if(d instanceof jc)return new jc(d.value0,a(d.value1));if(d instanceof Jc)return new Jc(d.value0,a(d.value1));if(d instanceof fl)return new fl(d.value0,a(d.value1));if(d instanceof Qc)return new Qc(d.value0,d.value1,function(h){return a(d.value2(h))});if(d instanceof Kc)return new Kc(d.value0,a(d.value1));if(d instanceof Xc)return new Xc(d.value0,d.value1,a(d.value2));throw new Error("Failed pattern match at Halogen.Shell.Free (line 34, column 1 - line 43, column 38): "+[a.constructor.name,d.constructor.name])}}}};var Ci=Or,sA=se(Ci),my=mp,bu=un,Pt=function(e){return dy(st(zc.create(e)))},hy=function(e){return function(t){return st(new Xc(e,t,void 0))}},fA=function(e){return st(new jc(e,void 0))};var gy=function(e){return st(new Kc(e,void 0))},ll=function(e){return st(new Jc(e,void 0))},sn=function(){return st(new Gc(_y))}(),Kr=function(e){return sA(sn)(function(t){return fA(e(t))})},Dy=function(e){return function(t){return st(new Qc(e,t,_y))}};var Cy=e=>()=>e.type,pv=e=>()=>e.cursorY,dv=e=>()=>e.cursorX,vv=e=>()=>e.viewportY,mv=e=>()=>e.baseY,hv=e=>()=>e.length,yy=e=>t=>()=>e.getLine(t),gv=e=>()=>e.getNullCell();var Su=function(e){return Ic(e)?q.value:new k(Ad(e))};var _A=$(Oe),pA=function(){function e(){}return e.value=new e,e}(),dA=function(){function e(){}return e.value=new e,e}(),by=function(e){return function(t){return _A(Su)(yy(e)(t))}},Sy=function(e){return function(){var a=Cy(e)();return a==="normal"?pA.value:dA.value}};var Cv=e=>()=>e.isWrapped,yv=e=>()=>e.length;var hl=_e(de),ua=$(Oe),bv=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),pl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Sv=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Tv=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),wv=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),dl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),vl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Ev=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),ml=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Mv=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),gA={map:function(e){return function(t){if(t instanceof bv)return new bv(function(a){return e(t.value0(a))});if(t instanceof pl)return new pl(function(a){return e(t.value0(a))});if(t instanceof Sv)return new Sv(function(a){return e(t.value0(a))});if(t instanceof Tv)return new Tv(function(a){return e(t.value0(a))});if(t instanceof wv)return new wv(function(a){return e(t.value0(a))});if(t instanceof dl)return new dl(function(a){return e(t.value0(a))});if(t instanceof vl)return new vl(t.value0,function(a){return e(t.value1(a))});if(t instanceof Ev)return new Ev(t.value0,function(a){return e(t.value1(a))});if(t instanceof ml)return new ml(t.value0,function(a){return e(t.value1(a))});if(t instanceof Mv)return new Mv(function(a){return e(t.value0(a))});throw new Error("Failed pattern match at Halogen.Buffer.Free (line 62, column 1 - line 72, column 48): "+[e.constructor.name,t.constructor.name])}}},DA=Xa(gA);var Ty=function(e){var t=e.Monad0(),a=se(ei(t.Bind1())),d=cn(au(t)),h=Ke(oo(e));return function(n){var u=function(f){if(f instanceof bv)return a(d)(function(s){return h(ua(f.value0)(Sy(s)))});if(f instanceof pl)return a(d)(function(s){return h(ua(f.value0)(dv(s)))});if(f instanceof Sv)return a(d)(function(s){return h(ua(f.value0)(pv(s)))});if(f instanceof Tv)return a(d)(function(s){return h(ua(f.value0)(vv(s)))});if(f instanceof wv)return a(d)(function(s){return h(ua(f.value0)(mv(s)))});if(f instanceof dl)return a(d)(function(s){return h(ua(f.value0)(hv(s)))});if(f instanceof vl)return a(d)(function(s){return h(ua(f.value1)(by(s)(f.value0)))});if(f instanceof Ev)return h(ua(f.value1)(Cv(f.value0)));if(f instanceof ml)return h(ua(f.value1)(yv(f.value0)));if(f instanceof Mv)return a(d)(function(s){return h(ua(f.value0)(gv(s)))});throw new Error("Failed pattern match at Halogen.Buffer.Free (line 19, column 5 - line 21, column 40): "+[f.constructor.name])};return DA(ou(n))(u)}},wy=function(e){return st(new ml(e,hl))};var Ey=function(e){return st(new vl(e,hl))};var My=function(){return st(new pl(hl))}();var Fy=function(){return st(new dl(hl))}();var Fv=e=>()=>e.cursorBlink,Lv=e=>t=>()=>e.cursorBlink=t,xv=e=>()=>e.fontFamily,Av=e=>t=>()=>e.fontFamily=t;var xy={fromString:_e(de)},gt=function(e){return e.fromString};var CA=function(){function e(u){this.fn=u}var t={},a=function(u,f){this.head=u,this.tail=f};function d(u){return new a(u,t)}function h(u){return function(f){return new a(u,f)}}function n(u){for(var f=[],s=u;s!==t;)f.push(s.head),s=s.tail;return f}return function(u){return function(f){return function(s){var i=function(m,g){return u(f(h)(s(m)))(g)},p=function(m,g,l){if(g===0)return m;var r=l[g-1];return new e(function(){var o=p(i(r,m),g-1,l);return o})};return function(m){for(var g=f(d)(s(m[m.length-1])),l=p(g,m.length-1,m);l instanceof e;)l=l.fn();return f(n)(l)}}}}}();var wA=typeof Array.from=="function",dG=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",vG=typeof String.prototype.fromCodePoint=="function",EA=typeof String.prototype.codePointAt=="function",Ay=function(e){return EA?function(t){return t.codePointAt(0)}:e};var Iy=function(e){return function(t){return wA?function(a){return Array.from(a,t)}:e}};var Zc=oy(iy),xA=$(pt),AA=wn(Xi);var Ry=function(e){return function(t){return(((e-55296|0)*1024|0)+(t-56320|0)|0)+65536|0}};var Oy=function(e){return 56320<=e&&e<=57343},Hy=function(e){return 55296<=e&&e<=56319},IA=function(e){var t=si(e);if(t===0)return q.value;if(t===1)return new k({head:Zc(po(0)(e)),tail:""});var a=Zc(po(1)(e)),d=Zc(po(0)(e)),h=Hy(d)&&Oy(a);return h?new k({head:Ry(d)(a),tail:fu(2)(e)}):new k({head:d,tail:fu(1)(e)})},RA=function(e){return xA(function(t){return new J(t.head,t.tail)})(IA(e))},OA=function(e){return AA(RA)(e)},HA=function(e){var t=Zc(po(0)(e)),a=Hy(t)&&si(e)>1;if(a){var d=Zc(po(1)(e)),h=Oy(d);return h?Ry(t)(d):t}return t},PA=Ay(HA),NA=Iy(OA)(PA),gl=function(e){return mn(NA(e))};var Rv=Gh(Ui);var Py=Ee(Un);var $A=function(){function e(t,a,d,h){this.value0=t,this.value1=a,this.value2=d,this.value3=h}return e.create=function(t){return function(a){return function(d){return function(h){return new e(t,a,d,h)}}}},e}();var qA=function(e){return function(t){return function(a){return function(d){var h=Rv(0)(1)(t),n=Rv(0)(1)(a),u=Rv(0)(1)(d);return new $A(e,h,n,u)}}}};var Ny=function(e){return function(t){return function(a){return qA(e)(t)(a)(1)}}},ky=Ny(0)(0)(1);var Wy=function(e){var t=function(f){return Py(su(pC(100*f))/100)},a=t(e.value1*100)+"%",d=t(e.value2*100)+"%",h=t(e.value0),n=Py(e.value3),u=e.value3===1;return u?"hsl("+(h+(", "+(a+(", "+(d+")"))))):"hsla("+(h+(", "+(a+(", "+(d+(", "+(n+")")))))))};var Ov=Ny(0)(0)(0);var By=$(Ct),$y=Yo(Ln),UA=oe(wt),zA=Vs(Ft)(Br);var Pr=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Nr=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),VA=function(e){return e};var GA=function(e){return e},Ha=function(e){return e.value};var Tu={append:function(e){return function(t){if(e instanceof Nr&&t instanceof Nr)return new Nr(e.value0+t.value0);if(e instanceof Nr&&t instanceof Pr)return new Pr(By($y(function(a){return e.value0+a}))(t.value0));if(e instanceof Pr&&t instanceof Nr)return new Pr(By($y(function(a){return t.value0+a}))(e.value0));if(e instanceof Pr&&t instanceof Pr)return new Pr(UA(e.value0)(t.value0));throw new Error("Failed pattern match at CSS.Property (line 23, column 1 - line 27, column 59): "+[e.constructor.name,t.constructor.name])}}},jA=oe(Tu),Hv={append:function(e){return function(t){return jA(e)(t)}}},qy=oe(Hv);var es=function(e){if(e instanceof Pr)return rr("")(zA("")(e.value0));if(e instanceof Nr)return e.value0;throw new Error("Failed pattern match at CSS.Property (line 32, column 1 - line 32, column 28): "+[e.constructor.name])};var Cl=function(){return{fromString:Nr.create}}(),Uy=gt(Cl),kr={fromString:function(e){return VA(Uy(e))}},yl=gt(kr);var ts={value:function(e){return yl(Wy(e))}};var yi={value:function(){var e=Ee(Un);return function(t){return yl(e(t))}}()},So={value:yl},rs=function(e){var t=Ha(e);return function(a){var d=Ha(a);return{value:function(h){return qy(t(h.value0))(qy(yl(" "))(d(h.value1)))}}}};var gr={fromString:function(e){return GA(Uy(e))}};var zy=function(e){return e};var bl=function(e){return e};var JA=Hd(Ft);var Vy=wt,ns=function(e){return fi(JA(e))};var Gy=Pu;var QA=function(e){return function(t){return[new J(e,fi(t))]}},bi=function(e){return bl(QA(e))},Nv=Qt();var jy=bi("fontFamily");var Jy=bi("cursorBlink");var Ky=$(Oe),rI=xt(At),Xy=_e(de),Sl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Tl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),wl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),kv=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),nI={map:function(e){return function(t){if(t instanceof Sl)return new Sl(function(a){return e(t.value0(a))});if(t instanceof Tl)return new Tl(t.value0,e(t.value1));if(t instanceof wl)return new wl(function(a){return e(t.value0(a))});if(t instanceof kv)return new kv(t.value0,e(t.value1));throw new Error("Failed pattern match at Halogen.Terminal.Free.Options (line 43, column 1 - line 47, column 52): "+[e.constructor.name,t.constructor.name])}}},aI=Xa(nI);var as=function(e){return st(new Tl(e,void 0))},Yy=function(e){var t=e.Monad0(),a=ei(t.Bind1()),d=se(a),h=cn(au(t)),n=Ke(oo(e)),u=rI(a),f=K(Cf(t.Applicative0()));return function(s){var i=function(p){if(p instanceof Sl)return d(h)(function(m){return n(Ky(p.value0)(Fv(m)))});if(p instanceof Tl)return d(h)(function(m){return u(n(Lv(m)(p.value0)))(function(){return f(p.value1)})});if(p instanceof wl)return d(h)(function(m){return n(Ky(p.value0)(xv(m)))});if(p instanceof kv)return d(h)(function(m){return u(n(Av(m)(p.value0)))(function(){return f(p.value1)})});throw new Error("Failed pattern match at Halogen.Terminal.Free.Options (line 19, column 5 - line 21, column 49): "+[p.constructor.name])};return aI(ou(s))(i)}},Zy=function(){return st(new wl(Xy))}(),eb=function(){return st(new Sl(Xy))}();var nb=ys(rb(),1),Ml=()=>new nb.FitAddon;var ob=ys(ab(),1),Ll=()=>new ob.WebglAddon;var ub=ys(ib(),1),Al=()=>new ub.WebLinksAddon;var cb={addon:V},sb={addon:V},fb={addon:_e(de)};var Il=function(e){return e.addon};var qv=e=>e.active,Uv=e=>e.normal,zv=e=>e.alternate;var db=ys(pb(),1),vb=e=>t=>()=>new db.Terminal(e,t),mb=e=>()=>e.element,hb=e=>()=>e.textarea,Gv=e=>()=>e.rows,jv=e=>()=>e.cols,os=e=>e.buffer,Jv=e=>()=>e.markers;var Qv=e=>e.options,Kv=e=>t=>()=>e.onBell(t),Xv=e=>t=>()=>e.onBinary(a=>t(a)());var Yv=e=>t=>()=>e.onData(a=>t(a)()),Zv=e=>t=>()=>e.onKey(a=>t(a)()),em=e=>t=>()=>e.onLineFeed(t),tm=e=>t=>()=>e.onRender(a=>t(a)()),rm=e=>t=>()=>e.onWriteParsed(t),nm=e=>t=>()=>e.onResize(a=>t(a)()),am=e=>t=>()=>e.onScroll(a=>t(a)()),om=e=>t=>()=>e.onSelectionChange(t),im=e=>t=>()=>e.onTitleChange(a=>t(a)());var um=e=>t=>()=>e.open(t);var cm=e=>t=>a=>()=>e.write(t,a),sm=e=>t=>a=>()=>e.writeln(t,a);var gb=e=>t=>()=>e.loadAddon(t);var Db=$(Oe);var Cb=function(){var e=Db(Su);return function(t){return e(hb(t))}}();var yb=function(e){return function(t){return vb(ns(e))(ns(t))}},bb=function(e){var t=Il(e);return function(a){return function(d){return gb(a)(t(d))}}};var Sb=function(){var e=Db(Su);return function(t){return e(mb(t))}}();var Ol=$(Jo),Vl=_e(de),Pa=$(Oe),lm=Ty(mf)(Ns),Tb=xt(At),Hl=uc(u0),CI=bb(fb),Pl=se(Or),_m=Tb(Or),wu=tn(un),Nl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),pm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),dm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),kl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),vm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Wl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),mm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),hm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),gm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Bl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),$l=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Dm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),ql=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Ul=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),zl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),yI={map:function(e){return function(t){if(t instanceof Nl)return new Nl(Ol(e)(t.value0));if(t instanceof pm)return new pm(function(a){return e(t.value0(a))});if(t instanceof dm)return new dm(function(a){return e(t.value0(a))});if(t instanceof kl)return new kl(function(a){return e(t.value0(a))});if(t instanceof vm)return new vm(function(a){return e(t.value0(a))});if(t instanceof Wl)return new Wl(Ol(e)(t.value0));if(t instanceof mm)return new mm(Ol(e)(t.value0));if(t instanceof hm)return new hm(Ol(e)(t.value0));if(t instanceof gm)return new gm(function(a){return e(t.value0(a))});if(t instanceof Bl)return new Bl(t.value0,e(t.value1));if(t instanceof $l)return new $l(t.value0,e(t.value1));if(t instanceof Dm)return new Dm(function(a){return e(t.value0(a))});if(t instanceof ql)return new ql(function(a){return e(t.value0(a))});if(t instanceof Ul)return new Ul(function(a){return e(t.value0(a))});if(t instanceof zl)return new zl(t.value0,function(a){return e(t.value1(a))});throw new Error("Failed pattern match at Halogen.Terminal.Free (line 96, column 1 - line 111, column 48): "+[e.constructor.name,t.constructor.name])}}},bI=Xa(yI),Yr=function(e){return st(new $l(e,void 0))},Nt=function(e){return st(new Bl(e,void 0))};var Cm=function(e){return st(new Wl(e))},SI=function(){return st(new ql(Vl))}(),TI=function(){return st(new Ul(Vl))}();var wb=function(e){var t=e.MonadEffect0(),a=t.Monad0(),d=ei(a.Bind1()),h=se(d),n=cn(au(a)),u=oo(t),f=Yy(u),s=Ke(u),i=na(q0(e)),p=Tb(d);return function(m){var g=ou(m),l=f(g),r=function(o){if(o instanceof Nl)return h(n)(function(c){return ao(l(o.value0))(Qv(c))});if(o instanceof pm)return h(n)(function(c){return s(Pa(o.value0)(Sb(c)))});if(o instanceof dm)return h(n)(function(c){return s(Pa(o.value0)(Cb(c)))});if(o instanceof kl)return h(n)(function(c){return s(Pa(o.value0)(Gv(c)))});if(o instanceof vm)return h(n)(function(c){return s(Pa(o.value0)(jv(c)))});if(o instanceof Wl)return h(n)(function(c){return s(ao(lm(o.value0))(qv(os(c))))});if(o instanceof mm)return h(n)(function(c){return s(ao(lm(o.value0))(Uv(os(c))))});if(o instanceof hm)return h(n)(function(c){return s(ao(lm(o.value0))(zv(os(c))))});if(o instanceof gm)return h(n)(function(c){return s(Pa(o.value0)(Jv(c)))});if(o instanceof Bl)return h(n)(function(c){return h(i(Dc))(function(_){return p(s(cm(c)(o.value0)(Kp(gc(o.value1)(_)))))(function(){return i(Zp(_))})})});if(o instanceof $l)return h(n)(function(c){return h(i(Dc))(function(_){return p(s(sm(c)(o.value0)(Kp(gc(o.value1)(_)))))(function(){return i(Zp(_))})})});if(o instanceof Dm)return s(Pa(function(c){return o.value0(Is(c))})(Hl(Ml)));if(o instanceof ql)return s(Pa(function(c){return o.value0(Is(c))})(Hl(Al)));if(o instanceof Ul)return s(Pa(function(c){return o.value0(Is(c))})(Hl(Ll)));if(o instanceof zl)return h(n)(function(c){return s(Pa(function(_){return o.value1(Yh(_))})(Hl(CI(c)(o.value0))))});throw new Error("Failed pattern match at Halogen.Terminal.Free (line 32, column 5 - line 34, column 55): "+[o.constructor.name])};return bI(g)(r)}},ym=function(){return st(new kl(Vl))}(),Ti=function(e){return st(Nl.create(e))};var Eb=function(e){var t=Il(e);return function(a){return st(new zl(t(a),Vl))}},wI=Eb(sb),EI=Eb(cb),Mb=function(e){return Pl(TI)(function(t){return _m(function(){if(t instanceof q)return wu(e)(Yr("WebGL Addon unavailable"));if(t instanceof k)return _m(wu(e)(Nt("Loading WebGL ")))(function(){return Pl(wI(t.value0))(function(a){return wu(e)(function(){return Yr(a?"OK":"FAILED")}())})});throw new Error("Failed pattern match at Halogen.Terminal.Free (line 164, column 3 - line 169, column 67): "+[t.constructor.name])}())(function(){return Pl(SI)(function(a){if(a instanceof q)return wu(e)(Yr("WebLinks Addon unavailable"));if(a instanceof k)return _m(wu(e)(Nt("Loading WebLinks ")))(function(){return Pl(EI(a.value0))(function(d){return wu(e)(function(){return Yr(d?"OK":"FAILED")}())})});throw new Error("Failed pattern match at Halogen.Terminal.Free (line 171, column 3 - line 176, column 67): "+[a.constructor.name])})})})};var Fb=V;var Lb=xt(At)(Oa),LI=nc(Ra),xI=K(yo),AI=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),II=function(e){return function(t){return uv([ly(function(a){return AI.create(Fb(a))})])([Oc(t)])}},RI=function(e){return function(t){return Lb(LI(t.value0))(function(){return xI(new k(t.value1))})}},OI=function(e){var t=Ke(vi(e.MonadEffect0()));return function(a){return Lb(t(cv(a.value0)))(function(){return Do(Pt(Nt(`click!\r
`)))})}},xb=function(e){return hi({initialState:xn(" "),render:II(e),eval:mi({handleAction:OI(e),handleQuery:RI(e),receive:oa.receive,initialize:oa.initialize,finalize:oa.finalize})})};var wi=function(){return window};function Ab(e){return e.readyState}var is=function(){function e(){}return e.value=new e,e}(),WI=function(){function e(){}return e.value=new e,e}(),BI=function(){function e(){}return e.value=new e,e}();var Ib=function(e){return e==="loading"?new k(is.value):e==="interactive"?new k(WI.value):e==="complete"?new k(BI.value):q.value};var qI=$(Oe);var Ob=V;var Hb=V;var Pb=function(e){return qI(function(){var t=rr(is.value);return function(a){return t(Ib(a))}}())(function(){return Ab(e)})};function kb(e,t,a){var d=Object.prototype.toString.call(a);return d.indexOf("[object HTML")===0&&d.indexOf("Element]")===d.length-8?t(a):e}var Wb=V;var bm=function(e){return kb(q.value,k.create,e)};function Eu(e){return function(){return e.document}}var qb=V;var Vb=se(Mr),OR=Ke(Fr),Tm=zt(rn),HR=Ts(rn),Gb=K(ta),PR=zt(qr),NR=K(Rt),kR=$(Oe),WR=xt(At),BR=zr(Ef),$R=function(e){return Vb(OR(Tm(HR(function(){var t=nC(e);return function(a){return t(Ob(a))}}())(Eu))(wi)))(function(t){return Gb(PR(bm)(t))})},jb=Mf(lr(Ea)(ye(NR(void 0)))),qR=wa(function(e){return function(){var a=Tm(Pb)(Tm(Eu)(wi))();if(a instanceof is){var d=kR(qb)(wi)(),h=Rc(function(n){return e(new Qe(void 0))})();return Nd(fv)(h)(!1)(d)(),ni(kd(fv)(h)(!1)(d))}return e(new Qe(void 0))(),I0}}),Jb=WR(Mr)(qR)(function(){return Vb($R("body"))(function(e){return je(BR(An("Could not find body")))(Gb)(e)})});var Qb=function(){var e=function(t){return function(a){return new k(new Af(t,a))}};return function(t){return AC(e(t))}}(),Kb=function(e){return IC(e)};var Xb=function(e){return Kb(e)("type")};var VR=ov();var Zb=function(){return function(e){var t=VR(e);return function(a){var d=t(a);return function(h){return function(n){return function(u){return function(f){return function(s){return xC(new $c(d(h)(n)(u)(f)(function(i){return k.create(s(i))})))}}}}}}}};var ZR=Dt(Co);var e2=pu();var wm=function(){return function(e){var t=e2(e);return function(a){var d=t(a);return function(h){return function(n){return function(u){return ZR(d(h)(n)(u(void 0)))}}}}}};var To=function(e){return function(){console.log(e)}},jl=function(e){return function(){console.warn(e)}};var i2=oe(wt),tS=K(Pi),u2=xe(Bn(Br)),Dr=he(It),c2=he(qa(It)),wo=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Na=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Eo=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Mo=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Fo=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Lo=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),xo=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Ao=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Io=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),ka=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Mu=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),rS=function(e){return e},Ql=function(){function e(){}return e.value=new e,e}(),Em=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Mm=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Fm=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),nS=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),aS=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),us=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Je=function(e){return function(t){return new us(i2(e.value0)(t),e.value1)}},_t=function(){return new us([],Ql.value)}(),oS=function(e){return rS(tS(ka.create(e)))};var s2={eq:function(e){return function(t){return e instanceof wo&&t instanceof wo||e instanceof Na&&t instanceof Na||e instanceof Eo&&t instanceof Eo?e.value0===t.value0:e instanceof Mo&&t instanceof Mo||e instanceof Fo&&t instanceof Fo||e instanceof Lo&&t instanceof Lo||e instanceof xo&&t instanceof xo||e instanceof Ao&&t instanceof Ao||e instanceof Io&&t instanceof Io?e.value0===t.value0&&e.value1===t.value1:e instanceof ka&&t instanceof ka?e.value0===t.value0:e instanceof Mu&&t instanceof Mu?e.value0===t.value0&&u2(e.value1)(t.value1):!1}}};var iS={compare:function(e){return function(t){if(e instanceof wo&&t instanceof wo)return Dr(e.value0)(t.value0);if(e instanceof wo)return X.value;if(t instanceof wo)return te.value;if(e instanceof Na&&t instanceof Na)return Dr(e.value0)(t.value0);if(e instanceof Na)return X.value;if(t instanceof Na)return te.value;if(e instanceof Eo&&t instanceof Eo)return Dr(e.value0)(t.value0);if(e instanceof Eo)return X.value;if(t instanceof Eo)return te.value;if(e instanceof Mo&&t instanceof Mo){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:Dr(e.value1)(t.value1)}if(e instanceof Mo)return X.value;if(t instanceof Mo)return te.value;if(e instanceof Fo&&t instanceof Fo){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:Dr(e.value1)(t.value1)}if(e instanceof Fo)return X.value;if(t instanceof Fo)return te.value;if(e instanceof Lo&&t instanceof Lo){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:Dr(e.value1)(t.value1)}if(e instanceof Lo)return X.value;if(t instanceof Lo)return te.value;if(e instanceof xo&&t instanceof xo){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:Dr(e.value1)(t.value1)}if(e instanceof xo)return X.value;if(t instanceof xo)return te.value;if(e instanceof Ao&&t instanceof Ao){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:Dr(e.value1)(t.value1)}if(e instanceof Ao)return X.value;if(t instanceof Ao)return te.value;if(e instanceof Io&&t instanceof Io){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:Dr(e.value1)(t.value1)}if(e instanceof Io)return X.value;if(t instanceof Io)return te.value;if(e instanceof ka&&t instanceof ka)return Dr(e.value0)(t.value0);if(e instanceof ka)return X.value;if(t instanceof ka)return te.value;if(e instanceof Mu&&t instanceof Mu){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:c2(e.value1)(t.value1)}throw new Error("Failed pattern match at CSS.Selector (line 0, column 0 - line 0, column 0): "+[e.constructor.name,t.constructor.name])}},Eq0:function(){return s2}};var Kl=function(e){return new us([],new Em(e))},Zt=function(e){return function(t){return new us([],new Fm(e,t))}},uS=function(e){return function(t){return new us([],new Mm(e,t))}};var tt=function(e){return rS(tS(Na.create(e)))};var f2=Qt();var l2=function(e){return f2(qp(e))};var cS=function(e){return Vt(l2(e))};var p2=$(Up(qo));var d2=Xe(bf(wt)(Rs)),v2=se(zp(wt)(H_));var sS=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),fS=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),lS=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),_S=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),xm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Xl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Am=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),pS=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),dS=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),vS=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),mS=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}();var m2=function(e){return e},Yl=function(e){return cS(e)},hS=function(){var e=Fa(h0(Pu)(Hs));return function(t){return m2(e(rc(t)))}}(),it=function(e){return function(t){return hS(new Am(new xm(e),Yl(t)))}};var Gt=function(e){var t=Ha(e);return function(a){return function(d){return hS(new Xl(zy(a),t(d)))}}},Im=function(e){var t=Gt(e);return function(a){return t(a)}};var h2={map:function(e){return function(t){return p2(e)(t)}}};var g2={apply:function(e){return function(t){return d2(e)(t)}},Functor0:function(){return h2}},gS={bind:function(e){return function(t){return v2(e)(function(a){return function(d){return d}(t(a))})}},Apply0:function(){return g2}};var ca=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Zr=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Wr=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var CS=function(e){return e instanceof Wr?new k(e.value1):e instanceof Zr?new k(e.value0):q.value},yS=function(e){return e instanceof Wr?new k(e.value0):e instanceof ca?new k(e.value0):q.value};var bS=function(e){var t=oe(e);return function(a){var d=oe(a);return{append:function(h){return function(n){if(h instanceof ca&&n instanceof ca)return new ca(t(h.value0)(n.value0));if(h instanceof ca&&n instanceof Zr)return new Wr(h.value0,n.value0);if(h instanceof ca&&n instanceof Wr)return new Wr(t(h.value0)(n.value0),n.value1);if(h instanceof Zr&&n instanceof ca)return new Wr(n.value0,h.value0);if(h instanceof Zr&&n instanceof Zr)return new Zr(d(h.value0)(n.value0));if(h instanceof Zr&&n instanceof Wr)return new Wr(n.value0,d(h.value0)(n.value1));if(h instanceof Wr&&n instanceof ca)return new Wr(t(h.value0)(n.value0),h.value1);if(h instanceof Wr&&n instanceof Zr)return new Wr(h.value0,d(h.value1)(n.value0));if(h instanceof Wr&&n instanceof Wr)return new Wr(t(h.value0)(n.value0),d(h.value1)(n.value1));throw new Error("Failed pattern match at Data.These (line 23, column 1 - line 32, column 56): "+[h.constructor.name,n.constructor.name])}}}}};var F2=oe(ki),L2=Ze(za),TS=Go(Ft),wS=TS(za),e_=Gn(Ft)(za),sa=$(Ct),Om=Xe(ko),x2=oe(wt),ES=Mt(Ft),A2=ES(za),I2=Cp(iS),t_=$(pt),R2=gt(xy),MS=se(qr),O2=Js(fp(Ft)),FS=$(Yi(Ct));var H2=Vs(Ft)(Br),P2=se(Wo),N2=Zs(qc),k2=Vn(Bu(dn)),W2=Gn(Ku(Ft))(za),B2=Ee(Un),r_=function(e){return e},$2=function(e){return e},Hm=function(e){return function(t){return function(a){return t+(e+a)}}},q2={append:function(e){return function(t){return e+t}}},U2={append:function(e){return function(t){return e+t}}},LS=bS(q2)(U2),xS=Xh(LS),Zl=ES(xS),z2=TS(xS),cs=oe(O_(LS)),SS=function(e){var t=lr(function(a){return L2})(function(a){return wS([a.value0,": ",a.value1])});return e_("; ")(sa(t)(e))},V2=function(e){if(e instanceof wo)return"#"+e.value0;if(e instanceof Na)return"."+e.value0;if(e instanceof Eo)return"["+(e.value0+"]");if(e instanceof Mo)return"["+(e.value0+("='"+(e.value1+"']")));if(e instanceof Fo)return"["+(e.value0+("^='"+(e.value1+"']")));if(e instanceof Lo)return"["+(e.value0+("$='"+(e.value1+"']")));if(e instanceof xo)return"["+(e.value0+("*='"+(e.value1+"']")));if(e instanceof Ao)return"["+(e.value0+("~='"+(e.value1+"']")));if(e instanceof Io)return"["+(e.value0+("|='"+(e.value1+"']")));if(e instanceof ka)return":"+e.value0;if(e instanceof Mu)return":"+(e.value0+("("+(e_(",")(e.value1)+")")));throw new Error("Failed pattern match at CSS.Render (line 178, column 1 - line 178, column 33): "+[e.constructor.name])},G2=function(e){return function(t){if(e.length===0&&t instanceof Ql)return["*"];if(t instanceof Ql)return[""];if(t instanceof Em)return[t.value0];if(t instanceof Mm)return Om(sa(Hm(" > "))(Wa(t.value0)))(Wa(t.value1));if(t instanceof Fm)return Om(sa(Hm(" "))(Wa(t.value0)))(Wa(t.value1));if(t instanceof nS)return Om(sa(Hm(" + "))(Wa(t.value0)))(Wa(t.value1));if(t instanceof aS)return x2(Wa(t.value0))(Wa(t.value1));throw new Error("Failed pattern match at CSS.Render (line 143, column 1 - line 143, column 63): "+[e.constructor.name,t.constructor.name])}},Wa=function(e){return sa(function(t){return t+A2(V2)(I2(e.value0))})(G2(e.value0)(e.value1))},j2=function(){var e=e_(", ");return function(t){return e(Wa(t))}}(),Fi=function(e){return e.length===0?q.value:t_(function(t){return new Rr(t.head,t.tail)})(gp(e))};var Fu=function(e){if(e.value0 instanceof _S)return je(e.value0.value0)(function(t){return uS(Fu(t))(e.value0.value0)})(Fi(e.value1));if(e.value0 instanceof xm)return je(e.value0.value0)(function(t){return Zt(Fu(t))(e.value0.value0)})(Fi(e.value1));if(e.value0 instanceof fS)return je(e.value0.value0)(function(t){return Zt(e.value0.value0)(Fu(t))})(Fi(e.value1));if(e.value0 instanceof lS)return je(Kl("TODO"))(Fu)(Fi(Sp(e.value0.value0)(Er(e.value0)(e.value1))));if(e.value0 instanceof sS)return je(Je(_t)(e.value0.value0))(function(t){return Je(Fu(t))(e.value0.value0)})(Fi(e.value1));throw new Error("Failed pattern match at CSS.Render (line 171, column 3 - line 176, column 102): "+[e.value0.constructor.name])},J2=function(e){return es(e)},Q2=function(e){return k.create(Zr.create(r_(R2("@import url("+(e+`);
`)))))},K2=function(e){return e},Pm=function(e){return MS(e)(function(){var t=t_(K2);return function(a){return t(CS(a))}}())},X2=function(e){return e},AS=function(e){return MS(e)(function(){var t=t_(X2);return function(a){return t(yS(a))}}())},Y2=function(e){return je(e.value0)(function(t){return"("+(e.value0+(": "+(es(t)+")")))})(e.value1)},Z2=function(e){return"@media "+(J2(e.value1)+O2(F2)(FS(function(t){return function(a){return" and "+a}(Y2(t))})(e.value2)))};var e5=function(e){return function(t){if(e instanceof Nr&&t instanceof Nr)return[new Qe(new J(e.value0,t.value0))];if(e instanceof Pr&&t instanceof Nr)return sa(function(a){return new Qe(new J(a.value0+a.value1,t.value0))})(e.value0);if(e instanceof Nr&&t instanceof Pr)return sa(function(a){return new Qe(new J(e.value0,a.value0+a.value1))})(t.value0);if(e instanceof Pr&&t instanceof Pr)return sa(function(a){return je(new Ye(a.value0+a.value1))(function(){var d=J.create(a.value0+a.value1);return function(h){return Qe.create(d(function(n){return a.value0+n}(h)))}}())(H2(a.value0)(t.value0))})(e.value0);throw new Error("Failed pattern match at CSS.Render (line 158, column 1 - line 158, column 80): "+[e.constructor.name,t.constructor.name])}},IS=function(e){return e5(e.value0)(e.value1)},t5=function(e){return function(t){var a=P2(t)(IS),d=t_(function(n){return ca.create($2(SS(N2(n))))})(Fi(a)),h=function(n){return k.create(Zr.create(r_(e_(" ")([j2(Fu(n)),"{",SS(a),`}
`]))))};return je(d)(h)(Fi(e))}},ss=function(e){return function(t){var a=function(o){return o instanceof pS?new k(new J(o.value0,o.value1)):q.value},d=Zl(Da(Ge(r5)(e)))(ba(a)(t)),h=function(o){return o instanceof Xl?new k(new J(o.value0,o.value1)):q.value},n=function(){var o=ba(h)(t),c=k2(TD)(o);return c?t5(e)(o):q.value}(),u=function(o){return ss(Er(o)(e))},f=function(o){return o instanceof Am?new k(new J(o.value0,o.value1)):q.value},s=z2(sa(Da(u))(ba(f)(t))),i=function(o){return o instanceof vS?new k(o.value0):q.value},p=Zl(n5)(ba(i)(t)),m=function(o){return o instanceof mS?new k(o.value0):q.value},g=Zl(Q2)(ba(m)(t)),l=function(o){return o instanceof dS?new k(o.value0):q.value},r=Zl(o5)(ba(l)(t));return cs(n)(cs(g)(cs(p)(cs(r)(cs(s)(d)))))}},r5=function(e){return function(t){return function(a){return k.create(Zr.create(r_(Z2(e)+(" { "+(rr("")(Pm(ss(t)(a)))+` }
`)))))}}},n5=function(e){var t=" "+(e.value0+(" { "+(W2(" ")(FS(Da(a5))(e.value1))+` }
`))),a=["@keyframes","@-webkit-keyframes","@-moz-keyframes","@-o-keyframes"],d=wS(sa(function(h){return h+t})(a));return new k(new Zr(d))},a5=function(e){return function(t){var a=rr("")(AS(ss([])(t)));return B2(e)+("% "+("{ "+(a+" }")))}},o5=function(e){return k.create(Zr.create(r_("@font-face { "+(rr("")(AS(ss([])(e)))+` }
`))))},RS=function(){var e=ss([]);return function(t){return e(Yl(t))}}();var u5=Xb(zd);var OS=function(e){var t=rr("")(Pm(RS(e)));return iv([u5("text/css")])([Oc(t)])};var fs=function(){return new Pr([new J("-webkit-",""),new J("-moz-",""),new J("-ms-",""),new J("-o-",""),new J("","")])}();var PS=oe(Hv),NS=Ha(yi),kS=gt(kr),HS=Ee(Un),s5=oe(Tu);var n_=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),f5=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),l5=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),_5=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),p5=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var Li=function(e){if(e instanceof n_)return es(e.value0);if(e instanceof f5)return aa(function(t){return aa(function(a){return"("+(Li(t)+(" + "+(Li(a)+")")))})(e.value1)})(e.value0);if(e instanceof l5)return aa(function(t){return aa(function(a){return"("+(Li(t)+(" - "+(Li(a)+")")))})(e.value1)})(e.value0);if(e instanceof _5)return aa(function(t){return"("+(HS(e.value0)+(" * "+(Li(t)+")")))})(e.value1);if(e instanceof p5)return aa(function(t){return"("+(Li(t)+(" / "+(HS(e.value0)+")")))})(e.value1);throw new Error("Failed pattern match at CSS.Size (line 29, column 1 - line 29, column 43): "+[e.constructor.name])},Ro={value:function(e){return e instanceof n_?e.value0:s5(fs)(new Nr("calc"+Li(e)))}};var bt=function(e){return new n_(PS(NS(e))(kS("px")))};var Nm=function(e){return new n_(PS(NS(e))(kS("em")))};var m5=gt(gr),h5=Gt(ts);var km=h5(m5("background-color"));var lt=gt(kr),BS=function(){function e(){}return e.value=new e,e}(),D5=function(){function e(){}return e.value=new e,e}(),$S=function(){function e(){}return e.value=new e,e}(),C5=function(){function e(){}return e.value=new e,e}(),y5=function(){function e(){}return e.value=new e,e}(),b5=function(){function e(){}return e.value=new e,e}(),qS=function(){function e(){}return e.value=new e,e}(),Wm=function(){function e(){}return e.value=new e,e}(),S5=function(){function e(){}return e.value=new e,e}(),T5=function(){function e(){}return e.value=new e,e}(),w5=function(){function e(){}return e.value=new e,e}(),E5=function(){function e(){}return e.value=new e,e}(),M5=function(){function e(){}return e.value=new e,e}(),F5=function(){function e(){}return e.value=new e,e}(),L5=function(){function e(){}return e.value=new e,e}(),x5=function(){function e(){}return e.value=new e,e}(),A5=function(){function e(){}return e.value=new e,e}(),I5=function(){function e(){}return e.value=new e,e}(),R5=function(){function e(){}return e.value=new e,e}(),O5=function(){function e(){}return e.value=new e,e}(),H5=function(){function e(){}return e.value=new e,e}(),P5=function(){function e(){}return e.value=new e,e}(),N5=function(){function e(){}return e.value=new e,e}(),k5=function(){function e(){}return e.value=new e,e}(),W5=function(){function e(){}return e.value=new e,e}(),B5=function(){function e(){}return e.value=new e,e}(),$5=function(){function e(){}return e.value=new e,e}(),q5=function(){function e(){}return e.value=new e,e}(),U5=function(){function e(){}return e.value=new e,e}(),z5=function(){function e(){}return e.value=new e,e}(),V5=function(){function e(){}return e.value=new e,e}(),G5=function(){function e(){}return e.value=new e,e}(),j5=function(){function e(){}return e.value=new e,e}();var J5={value:function(e){if(e instanceof BS)return lt("default");if(e instanceof D5)return lt("help");if(e instanceof $S)return lt("pointer");if(e instanceof C5)return lt("progress");if(e instanceof y5)return lt("wait");if(e instanceof b5)return lt("cell");if(e instanceof qS)return lt("crosshair");if(e instanceof Wm)return lt("text");if(e instanceof S5)return lt("vertical-text");if(e instanceof T5)return lt("alias");if(e instanceof w5)return lt("copy");if(e instanceof E5)return lt("move");if(e instanceof M5)return lt("no-drop");if(e instanceof F5)return lt("not-allowed");if(e instanceof L5)return lt("grab");if(e instanceof x5)return lt("grabbing");if(e instanceof A5)return lt("all-scroll");if(e instanceof I5)return lt("col-resize");if(e instanceof R5)return lt("row-resize");if(e instanceof O5)return lt("n-resize");if(e instanceof H5)return lt("e-resize");if(e instanceof P5)return lt("s-resize");if(e instanceof N5)return lt("w-resize");if(e instanceof k5)return lt("ne-resize");if(e instanceof W5)return lt("nw-resize");if(e instanceof B5)return lt("se-resize");if(e instanceof $5)return lt("sw-resize");if(e instanceof q5)return lt("ew-resize");if(e instanceof U5)return lt("ns-resize");if(e instanceof z5)return lt("nesw-resize");if(e instanceof V5)return lt("nwse-resize");if(e instanceof G5)return lt("zoom-in");if(e instanceof j5)return lt("zoom-out");throw new Error("Failed pattern match at CSS.Cursor (line 47, column 1 - line 80, column 40): "+[e.constructor.name])}};var Bm=function(){return $S.value}();var $m=function(){return BS.value}(),xi=Gt(J5)(gt(gr)("cursor")),US=function(){return qS.value}();var a_=gt(gr),_s=gt(kr);var Ba=function(){var e=Gt(So)(a_("z-index")),t=Ee($o);return function(a){return e(t(a))}}();var K5={value:function(e){return e}};var X5={value:function(e){return e}};var o_=_s("relative"),en=Gt(K5)(a_("position")),zS=Gt(yi)(a_("opacity"));var VS=_s("inline-block");var GS=_s("none");var i_=Gt(X5)(a_("display"));var jS=_s("block"),On=_s("absolute");var Z5=gt(gr);var JS=Gt(ts)(Z5("color"));var xu=Gt(Ro),Oo=gt(gr),QS=rs(Ro)(Ro),KS=Gt(rs(QS)(QS)),qm=xu(Oo("width")),Ho=xu(Oo("top")),u_=xu(Oo("right"));var XS=function(e){return function(t){return function(a){return function(d){return KS(Oo("padding"))(new J(new J(e,t),new J(a,d)))}}}};var YS=function(e){return function(t){return function(a){return function(d){return KS(Oo("margin"))(new J(new J(e,t),new J(a,d)))}}}};var Ai=xu(Oo("left")),Um=xu(Oo("height")),zm=xu(Oo("bottom"));var ZS=gt(kr),eT=gt(gr);var rO={value:function(e){return e}},tT=Gt(rO),rT=ZS("scroll"),nT=tT(eT("overflow-y"));var Vm=tT(eT("overflow")),Gm=ZS("hidden");var jm=gt(kr),aO=gt(gr);var oO={value:function(e){return e}},aT=jm("underline"),c_=Gt(oO)(aO("text-decoration")),oT=jm("overline");var iT=jm("line-through");var ie=xt(At)(gS),er=Gt(So),Kt=gt(gr),uO=Im(So),cO=oe(Tu),sO=gt(Cl),fO=Gt(yi),uT=function(){var e=Je(_t)(tt("xterm")),t=Je(_t)(tt("xterm-viewport")),a=ie(it(Je(_t)(tt("xterm-underline-1")))(c_(aT)))(function(){return ie(it(Je(_t)(tt("xterm-underline-2")))(er(Kt("text-decoration"))("double underline")))(function(){return ie(it(Je(_t)(tt("xterm-underline-3")))(er(Kt("text-decoration"))("wavy underline")))(function(){return ie(it(Je(_t)(tt("xterm-underline-4")))(er(Kt("text-decoration"))("dotted underline")))(function(){return it(Je(_t)(tt("xterm-underline-5")))(er(Kt("text-decoration"))("dashed underline"))})})})}),d=Je(_t)(tt("xterm-scroll-area")),h=Je(_t)(tt("xterm-screen")),n=Je(_t)(tt("xterm-decoration-overview-ruler")),u=ie(it(Je(_t)(tt("xterm-overline")))(c_(oT)))(function(){return ie(it(Je(Je(_t)(tt("xterm-underline-1")))(tt("xterm-overline")))(er(Kt("text-decoration"))("overline underline")))(function(){return ie(it(Je(Je(_t)(tt("xterm-underline-2")))(tt("xterm-overline")))(er(Kt("text-decoration"))("overline double underline")))(function(){return ie(it(Je(Je(_t)(tt("xterm-underline-3")))(tt("xterm-overline")))(er(Kt("text-decoration"))("overline wavy underline")))(function(){return ie(it(Je(Je(_t)(tt("xterm-underline-4")))(tt("xterm-overline")))(er(Kt("text-decoration"))("overline dotted underline")))(function(){return it(Je(Je(_t)(tt("xterm-underline-5")))(tt("xterm-overline")))(er(Kt("text-decoration"))("overline dashed underline"))})})})})}),f=Je(_t)(tt("xterm-message")),s=Je(_t)(tt("live-region")),i=Je(_t)(tt("xterm-helper-textarea")),p=Je(_t)(tt("xterm-helpers")),m=Je(_t)(tt("xterm-dim")),g=Je(_t)(tt("xterm-decoration-top")),l=Je(_t)(tt("xterm-decoration-container")),r=Je(_t)(tt("xterm-decoration")),o=Je(_t)(tt("composition-view")),c=Je(_t)(tt("xterm-char-measure-element")),_=ie(en(On))(function(){return ie(Ai(bt(0)))(function(){return ie(Ho(bt(0)))(function(){return ie(zm(bt(0)))(function(){return ie(u_(bt(0)))(function(){return ie(Ba(10))(function(){return ie(er(Kt("color"))("transparent"))(function(){return er(Kt("pointer-events"))("none")})})})})})})}),D=Je(_t)(tt("xterm-accessibility"));return ie(it(e)(ie(xi(Wm.value))(function(){return ie(en(o_))(function(){return uO(cO(fs)(sO("user-select")))("none")})})))(function(){return ie(it(Je(e)(tt("focus")))(er(Kt("outline"))("none")))(function(){return ie(it(Je(e)(oS("focus")))(er(Kt("outline"))("none")))(function(){return ie(it(Zt(e)(p))(ie(en(On))(function(){return ie(Ho(bt(0)))(function(){return Ba(5)})})))(function(){return ie(it(Zt(e)(i))(ie(XS(bt(0))(bt(0))(bt(0))(bt(0)))(function(){return ie(fO(Kt("border"))(0))(function(){return ie(YS(bt(0))(bt(0))(bt(0))(bt(0)))(function(){return ie(en(On))(function(){return ie(zS(0))(function(){return ie(Ai(Nm(-9999)))(function(){return ie(Ho(bt(0)))(function(){return ie(qm(bt(0)))(function(){return ie(Um(bt(0)))(function(){return ie(Ba(-5))(function(){return ie(er(Kt("whitespace"))("nowrap"))(function(){return ie(Vm(Gm))(function(){return er(Kt("resize"))("none")})})})})})})})})})})})})))(function(){return ie(it(Zt(e)(o))(ie(km(Ov))(function(){return ie(JS(ky))(function(){return ie(i_(GS))(function(){return ie(en(On))(function(){return ie(er(Kt("white-space"))("nowrap"))(function(){return Ba(1)})})})})})))(function(){return ie(it(Zt(e)(Je(o)(tt("active"))))(i_(jS)))(function(){return ie(it(Zt(e)(t))(ie(km(Ov))(function(){return ie(nT(rT))(function(){return ie(xi($m))(function(){return ie(en(On))(function(){return ie(u_(bt(0)))(function(){return ie(Ai(bt(0)))(function(){return ie(Ho(bt(0)))(function(){return zm(bt(0))})})})})})})})))(function(){return ie(it(Zt(e)(h))(en(o_)))(function(){return ie(it(Zt(e)(Zt(h)(Kl("canvas"))))(ie(en(On))(function(){return ie(Ai(bt(0)))(function(){return Ho(bt(0))})})))(function(){return ie(it(Zt(e)(d))(er(Kt("visibility"))("hidden")))(function(){return ie(it(c)(ie(i_(VS))(function(){return ie(er(Kt("visibility"))("hidden"))(function(){return ie(en(On))(function(){return ie(Ho(bt(0)))(function(){return ie(Ai(Nm(-9999)))(function(){return er(Kt("line-height"))("normal")})})})})})))(function(){return ie(it(Je(e)(tt("enable-mouse-events")))(xi($m)))(function(){return ie(it(Je(e)(tt("xterm-cursor-pointer")))(xi(Bm)))(function(){return ie(it(Zt(e)(Je(_t)(tt("xterm-cursor-pointer"))))(xi(Bm)))(function(){return ie(it(Je(Je(e)(tt("column-select")))(tt("focus")))(xi(US)))(function(){return ie(it(Zt(e)(D))(_))(function(){return ie(it(Zt(e)(f))(_))(function(){return ie(it(Zt(e)(s))(ie(en(On))(function(){return ie(Ai(bt(-9999)))(function(){return ie(qm(bt(1)))(function(){return ie(Um(bt(1)))(function(){return Vm(Gm)})})})})))(function(){return ie(it(m)(er(Kt("opacity"))("1 !important")))(function(){return ie(a)(function(){return ie(u)(function(){return ie(it(Je(_t)(tt("xterm-strikethrough")))(c_(iT)))(function(){return ie(it(Zt(Zt(h)(l))(r))(ie(Ba(6))(function(){return en(On)})))(function(){return ie(it(Zt(Zt(h)(l))(Je(r)(tt("xterm-decoration-top-layer"))))(Ba(7)))(function(){return ie(it(n)(ie(Ba(8))(function(){return ie(en(On))(function(){return ie(Ho(bt(0)))(function(){return ie(u_(bt(0)))(function(){return er(Kt("pointer-events"))("none")})})})})))(function(){return it(g)(ie(Ba(2))(function(){return en(o_)}))})})})})})})})})})})})})})})})})})})})})})})})})})})}();var cT=e=>()=>e.dispose();var sT={toDisposable:_e(de)},pO=function(e){return e.toDisposable},fT=function(e){return{dispose:function(){var t=pO(e);return function(a){return cT(t(a))}}()}},lT=function(e){return e.dispose};var ut=se(Oa),Jm=Qo(Ra),vO=$(uo),mO=wb(Cc)(uu),Hn=Ya(Ra),Pn=xt(At)(Oa),hO=Et(Rt)(Ft),gO=lT(fT(sT)),Qm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),DO=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),CO=function(){function e(){}return e.value=new e,e}(),yO=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Km=function(){function e(){}return e.value=new e,e}(),bO=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),SO=function(){function e(){}return e.value=new e,e}(),TO=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),wO=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),EO=function(){function e(){}return e.value=new e,e}(),MO=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),_T=function(){function e(){}return e.value=new e,e}(),pT=function(){function e(){}return e.value=new e,e}(),Cn=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),FO=function(e){return function(t){return yu([OS(uT),ul([Qb("terminal")])([])])}},LO=function(e){var t=na(YC(e));return function(a){return ut(Jm)(function(d){return t(vO(k.create)(ao(mO(a))(d.terminal)))})}},xO=function(e){var t=Ke(vi(e.MonadEffect0())),a=function(l){return ut(t(Jr))(function(r){return ut(t(rm(l)(jr(r.listener)(new Cn(SO.value)))))(function(o){return ut(Qr(r.emitter))(function(){return Hn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},d=function(l){return ut(t(Jr))(function(r){return ut(t(im(l)(function(){var o=jr(r.listener);return function(c){return o(Cn.create(MO.create(c)))}}())))(function(o){return ut(Qr(r.emitter))(function(){return Hn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},h=function(l){return ut(t(Jr))(function(r){return ut(t(om(l)(jr(r.listener)(new Cn(EO.value)))))(function(o){return ut(Qr(r.emitter))(function(){return Hn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},n=function(l){return ut(t(Jr))(function(r){return ut(t(am(l)(function(){var o=jr(r.listener);return function(c){return o(Cn.create(wO.create(c)))}}())))(function(o){return ut(Qr(r.emitter))(function(){return Hn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},u=function(l){return ut(t(Jr))(function(r){return ut(t(nm(l)(function(){var o=jr(r.listener);return function(c){return o(Cn.create(TO.create(c)))}}())))(function(o){return ut(Qr(r.emitter))(function(){return Hn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},f=function(l){return ut(t(Jr))(function(r){return ut(t(tm(l)(function(){var o=jr(r.listener);return function(c){return o(Cn.create(bO.create(c)))}}())))(function(o){return ut(Qr(r.emitter))(function(){return Hn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},s=function(l){return ut(t(Jr))(function(r){return ut(t(em(l)(jr(r.listener)(new Cn(Km.value)))))(function(o){return ut(Qr(r.emitter))(function(){return Hn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},i=function(l){return ut(t(Jr))(function(r){return ut(t(Zv(l)(function(){var o=jr(r.listener);return function(c){return o(Cn.create(yO.create(c)))}}())))(function(o){return ut(Qr(r.emitter))(function(){return Hn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},p=function(l){return ut(t(Jr))(function(r){return ut(t(Yv(l)(function(){var o=jr(r.listener);return function(c){return o(Cn.create(Qm.create(c)))}}())))(function(o){return ut(Qr(r.emitter))(function(){return Hn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},m=function(l){return ut(t(Jr))(function(r){return ut(t(Xv(l)(function(){var o=jr(r.listener);return function(c){return o(Cn.create(DO.create(c)))}}())))(function(o){return ut(Qr(r.emitter))(function(){return Hn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},g=function(l){return ut(t(Jr))(function(r){return ut(t(Kv(l)(jr(r.listener)(new Cn(CO.value)))))(function(o){return ut(Qr(r.emitter))(function(){return Hn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})};return function(l){if(l instanceof _T)return ut(Bc("terminal"))(function(r){if(r instanceof q)return t(To("no terminal element"));if(r instanceof k)return ut(Jm)(function(o){return Pn(t(um(o.terminal)(r.value0)))(function(){return Pn(g(o.terminal))(function(){return Pn(m(o.terminal))(function(){return Pn(i(o.terminal))(function(){return Pn(s(o.terminal))(function(){return Pn(f(o.terminal))(function(){return Pn(a(o.terminal))(function(){return Pn(u(o.terminal))(function(){return Pn(n(o.terminal))(function(){return Pn(h(o.terminal))(function(){return Pn(d(o.terminal))(function(){return p(o.terminal)})})})})})})})})})})})});throw new Error("Failed pattern match at Halogen.Terminal (line 73, column 5 - line 88, column 28): "+[r.constructor.name])});if(l instanceof pT)return ut(Jm)(function(r){return t(hO(gO)(r.disposables))});if(l instanceof Cn)return Do(l.value0);throw new Error("Failed pattern match at Halogen.Terminal (line 70, column 16 - line 92, column 23): "+[l.constructor.name])}},dT=function(e){return hi({initialState:function(t){return{terminal:t,disposables:[]}},render:FO(e),eval:mi({handleAction:xO(e),handleQuery:LO(e),receive:oa.receive,initialize:new k(_T.value),finalize:new k(pT.value)})})};var AO=oe(wt),mT=Zb(),hT={reflectSymbol:function(){return"terminal"}},IO=mT(hT)(qi),RO=$(Ct),gT={reflectSymbol:function(){return"process"}},OO=mT(gT)(Yc),HO=VD(Xi),DT=kp(di),Xm=se(DT),s_=ht(hf)(di),PO=pu()(hT)(qi),CT=K(yo),NO=$(Co),kO=ht(XC),f_=Qo(Ra),Ii=K(Wp(di)),yT=xt(At),ps=yT(DT),bT=_0(Ra),Ym=Ya(bT),WO=eu(bT),BO=hn(Yc),$O=$r(lv),qO=bn(lv),UO=oc(Yc),zO=wm()(gT)(Yc),VO=l0(Zd),ds=se(Oa),GO=oe(Vy),jO=Ze(Gy),JO=yT(Oa),QO=Ya(Ra),Zm=Dt(Co),KO=$(pt),XO=K(bu);var ST=function(){function e(){}return e.value=new e,e}(),TT=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),wT=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),ET=function(){return or.value}(),MT=function(){return or.value}(),YO=function(e){var t=dT(e);return function(a){return yu(AO([function(){if(a.terminal instanceof q)return yu([]);if(a.terminal instanceof k)return IO(ET)(void 0)(t)(a.terminal.value0)(TT.create);throw new Error("Failed pattern match at Halogen.Shell (line 69, column 8 - line 71, column 80): "+[a.terminal.constructor.name])}()])(RO(function(d){return OO(MT)(d.value0)(d.value1.value0)(d.value1.value1)(wT.create)})(HO(a.processes))))}},FT=function(e){var t=e.MonadEffect0().Monad0(),a=kO(t),d=Xa(vy(t.Bind1().Apply0().Functor0()))(VO);return function(h){var n=function(u){if(u instanceof zc)return Xm(s_(PO(ET)(void 0)(u.value0)))(function(s){return CT(s)});if(u instanceof Vc)return NO(k.create)(a(u.value0));if(u instanceof Gc)return Xm(s_(f_))(function(s){return Ii(u.value0(s.shell.shell))});if(u instanceof jc)return ps(Ym(function(s){var i={};for(var p in s)({}).hasOwnProperty.call(s,p)&&(i[p]=s[p]);return i.shell=function(){var m={};for(var g in s.shell)({}).hasOwnProperty.call(s.shell,g)&&(m[g]=s.shell[g]);return m.shell=u.value0,m}(),i}))(function(){return Ii(u.value1)});if(u instanceof Jc)return ps(Ym(function(s){var i={};for(var p in s)({}).hasOwnProperty.call(s,p)&&(i[p]=s[p]);return i.interpreter=u.value0,i}))(function(){return Ii(u.value1)});if(u instanceof fl)return ps(s_(Do(u.value0)))(function(){return Ii(u.value1)});if(u instanceof Qc){var f=function(s){return je(0)(function(i){return i.key})(jD(s))};return Xm(WO(function(s){var i={};for(var p in s)({}).hasOwnProperty.call(s,p)&&(i[p]=s[p]);return i.processes=BO($O(qO)(f(s.processes)))(new J(u.value0,u.value1))(s.processes),i}))(function(s){return Ii(u.value2(f(s.processes)))})}if(u instanceof Kc)return ps(Ym(function(s){var i={};for(var p in s)({}).hasOwnProperty.call(s,p)&&(i[p]=s[p]);return i.processes=UO(u.value0)(s.processes),i}))(function(){return Ii(u.value1)});if(u instanceof Xc)return ps(s_(zO(MT)(u.value0)(py.create(u.value1))))(function(){return Ii(u.value2)});throw new Error("Failed pattern match at Halogen.Shell (line 111, column 5 - line 113, column 22): "+[u.constructor.name])};return s0(d(n)(h))}},ZO=function(e){var t=Ke(vi(e.MonadEffect0())),a=FT(e);return function(d){if(d instanceof ST)return ds(t(yb(GO(Nv(jy)('"Cascadia Code", Menlo, monospace'))(Nv(Jy)(!0)))(jO)))(function(h){return JO(QO(function(n){var u={};for(var f in n)({}).hasOwnProperty.call(n,f)&&(u[f]=n[f]);return u.terminal=new k(h),u}))(function(){return ds(f_)(function(n){return Zm(a(n.shell.init))})})});if(d instanceof TT)return ds(f_)(function(h){return Zm(a(h.interpreter(d.value0)))});if(d instanceof wT)return Zm(a(d.value0));throw new Error("Failed pattern match at Halogen.Shell (line 80, column 16 - line 91, column 51): "+[d.constructor.name])}},eH=function(e){var t=FT(e);return function(a){return ds(f_)(function(d){return ds(t(d.shell.query(a.value0)))(function(h){return CT(KO(a.value1)(h))})})}},LT=function(e){return hi({initialState:function(t){return{shell:t,interpreter:ye(XO(void 0)),terminal:q.value,processes:gn}},render:YO(e),eval:mi({handleAction:ZO(e),handleQuery:eH(e),receive:oa.receive,initialize:new k(ST.value),finalize:oa.finalize})})};var xT=K(bu),AT=se(Ci),IT=xt(At),__=IT(Ci),p_=IT(Or),nH=tn(un),l_=se(Or),aH=wr(ap)(un),oH=Et(un)(Xt);var eh=function(e){var t=Ke(_v(e));return function(a){return function(d){return d instanceof Qm?a(d.value0):d instanceof Km?t(To("line feed")):xT(void 0)}}},d_=function(e){return e.prompt},v_=function(e){return e.cmd};var iH=function(e){return function(t){var a=v_(t),d=a(Ko),h=d_(t)(Ko),n=a(Ln);return AT(sn)(function(u){return __(Pt(l_(Cm(My))(function(f){var s=f===0;return s?p_(Nt("\x1BM"))(function(){return l_(Cm(l_(Fy)(function(i){return l_(Ey(i-1|0))(function(p){return aH(wy)(p)})})))(function(i){return p_(Nt("\x9BK"))(function(){return Ge(oH)(i)(function(p){var m=(gl(Hr(u)(d))-1|0)<=p;return m?p_(Nt(Hr(u)(h)))(function(){return Nt(jf(1)(Hr(u)(d)))}):Nt(jf(1)(hC(p)(Hr(u)(d))))})})})}):nH(gl(Hr(u)(d))>0)(Nt("\b \b"))})))(function(){return Kr(lf(n)(jf(1)))})})}},th=function(e){var t=iH(e),a=Ke(_v(e));return function(d){var h=v_(d)(Ln),n=d_(d)(Ko),u=t(d);return function(f){return function(s){return s===""?__(Kr(Xn(h)("")))(function(){return AT(sn)(function(i){return Pt(p_(Nt("^C"))(function(){return Nt(`\r
`+Hr(i)(n))}))})}):s==="\r"?f:s==="\x7F"?u:s>=" "&&s<="~"||s>="\xA0"?__(Kr(lf(h)(function(i){return i+s})))(function(){return Pt(Nt(s))}):__(a(To("non-printable: "+s)))(function(){return xT(void 0)})}}}};var m_={suspend:b0,fork:S0,join:mc,Monad0:function(){return ri},Functor1:function(){return L0}};var h_=function(e){return e.fork};var OT=V,Nn=V,HT=function(e){var t=Et(e)(Xt);return function(a){return Nn(function(d){return t(a)(d.rendering)})}},cH=V,PT=function(e){return function(t){return Nn(function(a){return cH(t(a.rendering))})}},sH=V,g_=function(e){return function(t){return e(t)}},NT=function(e){return function(t){return function(a){return function(d){return function(){var n=Ot({})(),u=Ot(cu)(),f=Ot(cu)(),s=Ot(a)(),i=Ot(new k(Pe.value))(),p=Ot(new k(Pe.value))(),m=Ot(q.value)(),g=Ot(1)(),l=Ot(new k(gn))(),r=Ot(gn)(),o={component:e,state:e.initialState(t),refs:gn,children:cu,childrenIn:u,childrenOut:f,selfRef:n,handlerRef:s,pendingQueries:i,pendingOuts:p,pendingHandlers:m,rendering:q.value,fresh:g,subscriptions:l,forks:r,lifecycleHandlers:d};return vt(o)(n)(),sH(n)}}}}};var fH=Et(Rt)(Xt),lH=zt(qr),_H=Ta(Yd),jt=se(Mr),St=Ke(Fr),pH=xt(At),kn=pH(Mr),UT=Et(ta),dH=UT(Mn),zT=h_(m_),vH=dc(ai)(Mn),fa=K(ta),mH=$(td),kT=io(ai),hH=$(uo),WT=iu(ai),gH=$(pt),DH=hn(Yd),CH=BC(Xp),yH=oc(nl),bH=yh(zn),SH=hn(nl),BT=UT(Xt),$T=Ta(nl),TH=Ta(It),wH=iD(uu),EH=QD(It),MH=function(e){return function(t){return function(){var d=He(t)(),h=He(d.subscriptions)();return fH(Kf)(lH(_H(e))(h))()}}},D_=function(e){return function(t){return jt(St(He(e)))(function(a){if(a instanceof q)return t;if(a instanceof k)return St(vt(new k(new pe(t,a.value0)))(e));throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 188, column 33 - line 190, column 57): "+[a.constructor.name])})}},C_=function(e){return function(t){return kn(St(vt({initializers:Pe.value,finalizers:Pe.value})(e)))(function(){return jt(St(t))(function(a){return jt(St(He(e)))(function(d){return kn(dH(zT)(d.finalizers))(function(){return kn(vH(d.initializers))(function(){return fa(a)})})})})})}},Ri=Mf(lr(Ea)(ye(K(Rt)(void 0)))),qT=function(e){return function(t){return jt(St(He(t)))(function(a){return St(k_(function(d){return{state:d+1|0,value:e(d)}})(a.fresh))})}},nh=function(e){return function(t){return function(a){return jt(St(He(t)))(function(d){return Po(e)(t)(d.component.eval(new Du(mH(k.create)(j0(a)),ye(q.value))))})}}},Po=function(e){return function(t){return function(a){var d=function(n){return function(u){return jt(St(He(n)))(function(f){return VC(function(s){var i=function(p){return kT(jt(St(He(p)))(function(m){return Nn(function(g){return nh(e)(g.selfRef)(s.value1)})(m)}))};return hH(s.value2)(WT(s.value0(Xp)(i)(f.children)))})(u)})}},h=function(n){return function(u){if(u instanceof Hc)return jt(St(He(n)))(function(f){var s=u.value0(f.state);if(lu(f.state)(s.value1))return fa(s.value0);if(ar)return kn(St(vt({component:f.component,state:s.value1,refs:f.refs,children:f.children,childrenIn:f.childrenIn,childrenOut:f.childrenOut,selfRef:f.selfRef,handlerRef:f.handlerRef,pendingQueries:f.pendingQueries,pendingOuts:f.pendingOuts,pendingHandlers:f.pendingHandlers,rendering:f.rendering,fresh:f.fresh,subscriptions:f.subscriptions,forks:f.forks,lifecycleHandlers:f.lifecycleHandlers})(n)))(function(){return kn(C_(f.lifecycleHandlers)(e(f.lifecycleHandlers)(n)))(function(){return fa(s.value0)})});throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 86, column 7 - line 92, column 21): "+[s.constructor.name])});if(u instanceof Pc)return jt(qT(QC)(n))(function(f){return jt(St(JC(u.value0(f))(function(s){return Ri(ah(e)(n)(new oi(s)))})))(function(s){return jt(St(He(n)))(function(i){return kn(St(nn(gH(DH(f)(s)))(i.subscriptions)))(function(){return fa(u.value1(f))})})})});if(u instanceof Yf)return kn(St(MH(u.value0)(n)))(function(){return fa(u.value1)});if(u instanceof pi)return u.value0;if(u instanceof Nc)return d(n)(u.value0);if(u instanceof kc)return jt(St(He(n)))(function(f){return jt(St(He(f.handlerRef)))(function(s){return kn(D_(f.pendingOuts)(s(u.value0)))(function(){return fa(u.value1)})})});if(u instanceof Zf)return WT(CH(Jd(function(){var f=Po(e)(n);return function(s){return kT(f(s))}}())(u.value0)));if(u instanceof el)return jt(qT(KC)(n))(function(f){return jt(St(He(n)))(function(s){return jt(St(Ot(!1)))(function(i){return jt(zT(F0(St(function(){return nn(yH(f))(s.forks)(),vt(!0)(i)()}))(Po(e)(n)(u.value0))))(function(p){return kn(St(bH(He(i))(nn(SH(f)(p))(s.forks))))(function(){return fa(u.value1(f))})})})})});if(u instanceof tl)return jt(St(He(n)))(function(f){return jt(St(He(f.forks)))(function(s){return kn(BT(mc)($T(u.value0)(s)))(function(){return fa(u.value1)})})});if(u instanceof rl)return jt(St(He(n)))(function(f){return jt(St(He(f.forks)))(function(s){return kn(BT(hc(An("Cancelled")))($T(u.value0)(s)))(function(){return fa(u.value1)})})});if(u instanceof Wc)return jt(St(He(n)))(function(f){return fa(u.value1(TH(u.value0)(f.refs)))});throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 83, column 12 - line 139, column 33): "+[u.constructor.name])}};return wH(h(t))(a)}}},ah=function(e){return function(t){return function(a){if(a instanceof Af)return St(Ge(nn)(t)(g_(function(d){return{component:d.component,state:d.state,refs:EH(ye(a.value1))(a.value0)(d.refs),children:d.children,childrenIn:d.childrenIn,childrenOut:d.childrenOut,selfRef:d.selfRef,handlerRef:d.handlerRef,pendingQueries:d.pendingQueries,pendingOuts:d.pendingOuts,pendingHandlers:d.pendingHandlers,rendering:d.rendering,fresh:d.fresh,subscriptions:d.subscriptions,forks:d.forks,lifecycleHandlers:d.lifecycleHandlers}})));if(a instanceof oi)return jt(St(He(t)))(function(d){return Po(e)(t)(d.component.eval(new gu(a.value0,void 0)))});throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 52, column 20 - line 58, column 62): "+[a.constructor.name])}}};var LH=se(rn),xH=xt(At),XT=zs(Rt)(Xt),YT=Et(ta)(Mn),ZT=h_(m_),ms=zt(rn),ew=Et(Rt),tw=ew(Xt),VT=ew(cr),GT=xH(Mr),AH=dc(ai)(Mn),vs=Ke(Fr),jT=K(Rt),oh=$(Oe),ih=K(ta),uh=tn(Rt),IH=PT(Oe),RH=Dt(uo),JT=X0(Rt),OH=HT(Rt),HH=Sr(Ns),PH=Hi(Oe),ch=se(Mr),NH=Ke(mf),QT=function(){return Ot({initializers:Pe.value,finalizers:Pe.value})}(),KT=function(e){return function(){var a=He(e)();return vt(q.value)(e)(),XT(a)(function(){var d=YT(ZT);return function(h){return Ri(d(jo(h)))}}())()}},kH=function(e){return function(){return ms(tw(VT(Kf)))(He(e.subscriptions))(),vt(q.value)(e.subscriptions)(),ms(VT(function(){var a=hc(An("finalized"));return function(d){return Ri(a(d))}}()))(He(e.forks))(),vt(gn)(e.forks)()}},rw=function(e){return function(t){return function(a){var d=function(p){return function(m){return Nn(function(g){var l=Po(u)(g.selfRef)(g.component.eval(new vu(void 0)));return nn(function(r){return{initializers:new pe(GT(AH(jo(r.initializers)))(function(){return GT(l)(function(){return vs(function(){return KT(g.pendingQueries)(),KT(g.pendingOuts)()})})}),m),finalizers:r.finalizers}})(p)})}},h=function(p){return function(m){return function(g){return av(function(l){return function(){var o=QT(),c=NT(l)(g)(m)(o)(),_=He(p)();return vt({initializers:Pe.value,finalizers:_.finalizers})(p)(),ms(Nn(function(){var D=u(p);return function(C){return D(function(b){return b.selfRef}(C))}}()))(He(c))(),ms(d(p)(_.initializers))(He(c))(),c}})}}},n=function(p){return function(m){return function(g){return function(l){return nv(function(r){return function(){var c=oh(r.pop)(He(g))(),_=function(){if(c instanceof k){vt(c.value0.value1)(g)();var C=He(c.value0.value0)();return Nn(function(b){return function(){return Ge(vt)(b.handlerRef)(function(){var v=je(ih(void 0))(m);return function(y){return v(r.output(y))}}())(),Ri(Po(u)(b.selfRef)(b.component.eval(new hu(r.input,void 0))))()}})(C)(),c.value0.value0}if(c instanceof q)return h(p)(function(){var b=je(ih(void 0))(m);return function(S){return b(r.output(S))}}())(r.input)(r.component)();throw new Error("Failed pattern match at Halogen.Aff.Driver (line 213, column 14 - line 222, column 98): "+[c.constructor.name])}(),D=oh(function(C){return Vi(r.get(C))})(He(l))();return uh(D)(jl("Halogen: Duplicate slot address was detected during rendering, unexpected results may occur"))(),nn(r.set(_))(l)(),LH(He(_))(IH(function(C){if(C instanceof q)return i0("Halogen internal error: child was not initialized in renderChild");if(C instanceof k)return jT(e.renderChild(C.value0));throw new Error("Failed pattern match at Halogen.Aff.Driver (line 227, column 37 - line 229, column 50): "+[C.constructor.name])}))()}})}}}},u=function(p){return function(m){return function(){var l=He(m)(),r=oh(ha)(He(l.pendingHandlers))();uh(r)(vt(new k(Pe.value))(l.pendingHandlers))(),vt(cu)(l.childrenOut)(),vt(l.children)(l.childrenIn)();var o=function(){var b=D_(l.pendingHandlers),S=ah(u)(l.selfRef);return function(v){return b(RH(S(v)))}}(),c=function(){var b=D_(l.pendingQueries);return function(S){return b(o(oi.create(S)))}}(),_=e.render(function(b){return Ri(o(b))})(n(p)(c)(l.childrenIn)(l.childrenOut))(l.component.render(l.state))(l.rendering)(),D=He(l.childrenOut)(),C=He(l.childrenIn)();return JT(C)(function(b){return function(){var v=He(b)();return OH(e.removeChild)(v)(),f(p)(v)()}})(),Ge(nn)(l.selfRef)(g_(function(b){return{component:b.component,state:b.state,refs:b.refs,children:D,childrenIn:b.childrenIn,childrenOut:b.childrenOut,selfRef:b.selfRef,handlerRef:b.handlerRef,pendingQueries:b.pendingQueries,pendingOuts:b.pendingOuts,pendingHandlers:b.pendingHandlers,rendering:new k(_),fresh:b.fresh,subscriptions:b.subscriptions,forks:b.forks,lifecycleHandlers:b.lifecycleHandlers}}))(),uh(r)(Ge(HH)(void 0)(function(b){return function(){var v=He(l.pendingHandlers)();vt(new k(Pe.value))(l.pendingHandlers)(),tw(function(){var T=YT(ZT);return function(w){return Ri(T(jo(w)))}}())(v)();var y=He(l.pendingHandlers)(),M=je(!1)(Gg)(y);return M?PH(vt(q.value)(l.pendingHandlers))(new Wt(void 0))():new Jt(void 0)}}))()}}},f=function(p){return Nn(function(m){return function(){kH(m)();var l=Po(u)(m.selfRef)(m.component.eval(new mu(void 0)));return nn(function(r){return{initializers:r.initializers,finalizers:new pe(l,r.finalizers)}})(p)(),JT(m.children)(function(r){return function(){var c=He(r)();return f(p)(c)()}})()}})},s=function(p){return function(m){return function(g){return ch(vs(He(p)))(function(l){return l?ih(q.value):nh(u)(m)(g)})}}},i=function(p){return function(m){return function(g){return C_(m)(function(){var r=He(p)();return r?void 0:(vt(!0)(p)(),f(m)(g)(),Nn(function(o){return function(){var _=NH(He(o.selfRef))();return XT(_.rendering)(e.dispose)()}})(g)())})}}};return ch(vs(QT))(function(p){return ch(vs(Ot(!1)))(function(m){return C_(p)(function(){var l=Jr(),r=ms(He)(h(p)(function(){var o=jr(l.listener);return function(c){return vs(o(c))}}())(a)(t))();return Nn(function(o){return jT({query:s(m)(o.selfRef),messages:l.emitter,dispose:i(m)(p)(r)})})(r)()})})})}}};var Wn=function(e){return function(t){return function(){return t[e]}}};var BH=Wn("baseURI"),$H=Wn("ownerDocument"),nw=Wn("parentNode"),qH=Wn("parentElement");var UH=Wn("childNodes"),zH=Wn("firstChild"),VH=Wn("lastChild"),GH=Wn("previousSibling"),aw=Wn("nextSibling"),jH=Wn("nodeValue");var JH=Wn("textContent");function sh(e){return function(t){return function(a){return function(){a.insertBefore(e,t)}}}}function y_(e){return function(t){return function(){t.appendChild(e)}}}function fh(e){return function(t){return function(){t.removeChild(e)}}}var ow=$(Oe);var lh=function(){var e=ow(Lt);return function(t){return e(nw(t))}}();var iw=function(){var e=ow(Lt);return function(t){return e(aw(t))}}();var _h=function(e,t,a){var d=0,h;return function(n){if(d===2)return h;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,h=a(),d=2,h}},ph=Dt(Oe),ZH=K(Rt),eP=Et(Rt)(Xt),tP=Qt(),rP=tn(Rt),nP=Vn(Bu(Bu(dn))),aP=_e(de),oP=se(Mr),iP=Ke(Fr),uP=$(Oe),cP=zt(rn);var sP=function(e){return function(t){return function(a){return t instanceof k&&a instanceof k?ph(sh(e)(t.value0)(a.value0)):t instanceof q&&a instanceof k?ph(y_(e)(a.value0)):ZH(void 0)}}},uw=function(e){return function(){var a=lh(e.node)();return eP(function(d){return fh(e.node)(d)})(a)()}},fP=function(e){return function(t){return function(a){var d=OT(function(f){return f.node}),h=function(f){return f instanceof k?Gr(f.value0):void 0},n=function(f){var s=ey(tP)(f),i=_h("patch","Halogen.VDom.Driver",function(){return function(o,c){if(o instanceof k){if(c instanceof $c)return Gr(o.value0),m(100)(c.value0);if(c instanceof ol){var _=Vr(o.value0,c.value0);return Ut(new qt(hr(_),new k(_),i(103),h))}throw new Error("Failed pattern match at Halogen.VDom.Driver (line 97, column 22 - line 103, column 79): "+[c.constructor.name])}return p(104)(c)}}),p=_h("render","Halogen.VDom.Driver",function(){return function(o){if(o instanceof $c)return m(86)(o.value0);if(o instanceof ol){var c=s(o.value0);return Ut(new qt(hr(c),new k(c),i(89),h))}throw new Error("Failed pattern match at Halogen.VDom.Driver (line 84, column 7 - line 89, column 75): "+[o.constructor.name])}}),m=_h("renderComponentSlot","Halogen.VDom.Driver",function(){return function(o){var c=He(t)(),_=c(o)(),D=d(_);return Ut(new qt(D,q.value,i(117),h))}}),g=i(91),l=p(82),r=m(109);return l},u=EC(e);return{buildWidget:n,buildAttributes:u,document:a}}}},lP=function(e){return function(t){var a=function(d){return function(h){return function(n){return function(u){if(u instanceof q)return function(){var s=Ot(h)(),i=fP(d)(s)(e),p=Ac(i)(n),m=hr(p);return ph(y_(m)(Wb(t)))(),{machine:p,node:m,renderChildRef:s}};if(u instanceof k)return function(){vt(h)(u.value0.renderChildRef)();var s=lh(u.value0.node)(),i=iw(u.value0.node)(),p=Vr(u.value0.machine,n),m=hr(p);return rP(nP(lu)(u.value0.node)(m))(sP(m)(i)(s))(),{machine:p,node:m,renderChildRef:u.value0.renderChildRef}};throw new Error("Failed pattern match at Halogen.VDom.Driver (line 157, column 5 - line 173, column 80): "+[u.constructor.name])}}}};return{render:a,renderChild:aP,removeChild:uw,dispose:uw}}},cw=function(e){return function(t){return function(a){return oP(iP(uP(Hb)(cP(Eu)(wi))))(function(d){return rw(lP(d)(a))(e)(t)})}}};var $a=se(Ci),fw=xt(At),Cr=fw(Ci),lw=Et(bu)(Xt),b_=oe(ki),_w=$(Ct),pP=hn(It),dP=JD(It)(Ft),vP=Ta(It),mP=_e(de),hP=la(my),S_=se(Or),sw=Ee($o),gP=Ee(Kh),DP=Ee(zi),T_=fw(Or),dh=se(Mr),CP=eh(Fr),yP=LT(Cc);var w_={cmd:function(e){return Lp(function(t){return new J(t.command,function(a){return{prompt:t.prompt,command:a,foreground:t.foreground}})})(e)},prompt:function(e){return Lp(function(t){return new J(t.prompt,function(a){return{prompt:a,command:t.command,foreground:t.foreground}})})(e)}},pw=v_(w_),dw=pw(Ko),Oi=pw(Ln),hs=d_(w_)(Ko),bP=th(Fr)(w_),SP=function(e){return $a(sn)(function(t){return Cr(Ge(lw)(t.foreground)(function(a){return hy(a)(Hr(t)(dw))}))(function(){return Cr(Pt(Nt(`\r
`)))(function(){return Kr(Xn(Oi)(""))})})})},TP=function(e){var t=`\r
  help\r
    show this help text`,a=function(d){return`\r
  `+(d.name+(`\r
    `+xn(`\r
    `)(d.description)))};return t+xn("")(_w(a)(e))},wP=function(e){return function(t){return function(a){var d=function(h){return Cr(Pt(Yr(TP(a))))(function(){return $a(sn)(function(n){return Cr(Pt(Nt(Hr(n)(hs))))(function(){return Kr(Xn(Oi)(""))})})})};return pP("help")(d)(dP(_w(function(h){return new J(h.name,h.cmd)})(a)))}}},vw=function(e){var t=wP(e);return function(a){var d=t(a)(EP(e)(a));return $a(sn)(function(h){var n=ec(function(s){return!Hp(s)})(Op(" ")(Hr(h)(dw))),u=yp(n);if(u instanceof q)return Cr(Pt(Yr("")))(function(){return $a(sn)(function(s){return Cr(Pt(Nt(Hr(s)(hs))))(function(){return Kr(Xn(Oi)(""))})})});if(u instanceof k){var f=vP(u.value0)(d);if(f instanceof k)return f.value0(je([])(mP)(Dp(n)));if(f instanceof q)return Cr(Pt(Yr(`\r
unrecognised command "`+(u.value0+'" - type "help" to see the available commands'))))(function(){return $a(sn)(function(s){return Cr(Pt(Nt(Hr(s)(hs))))(function(){return Kr(Xn(Oi)(""))})})});throw new Error("Failed pattern match at Example (line 96, column 7 - line 103, column 34): "+[f.constructor.name])}throw new Error("Failed pattern match at Example (line 88, column 3 - line 103, column 34): "+[u.constructor.name])})}},EP=function(e){var t=xb(e);return function(a){var d=$a(sn)(function(n){return Cr(Pt(Nt(`\r
`+Hr(n)(hs))))(function(){return Kr(Xn(Oi)(""))})}),h=function(n){return ye(hP(n)(d))};return[{name:"rows",description:["prints the number of rows in the terminal"],cmd:h(Pt(S_(ym)(function(){var n=b_(`\r
`);return function(u){return Yr(n(sw(u)))}}())))},{name:"cols",description:["prints the number of columns in the terminal"],cmd:h(Pt(S_(ym)(function(){var n=b_(`\r
`);return function(u){return Yr(n(sw(u)))}}())))},{name:"blinking",description:["prints a boolean indicating whether the cursor is blinking"],cmd:h(Pt(S_(Ti(eb))(function(){var n=b_(`\r
`);return function(u){return Yr(n(gP(u)))}}())))},{name:"blinkon",description:["turns on cursor blinking"],cmd:h(Pt(Ti(as(!0))))},{name:"blinkoff",description:["turns off cursor blinking"],cmd:h(Pt(Ti(as(!1))))},{name:"fontFamily",description:["prints the font family of the terminal"],cmd:h(Pt(S_(Ti(Zy))(function(){var n=b_(`\r
`);return function(u){return Yr(n(DP(u)))}}())))},{name:"button",description:["creates a button as a subprocess.","the subprocess can be cancelled with ^C","accepts button text as argument.",'clicking the button prints "click!" to the terminal.'],cmd:function(n){return Cr(Kr(Xn(Oi)("")))(function(){return $a(Dy(t)(n))(function(u){return Cr(Kr(function(f){return{prompt:f.prompt,command:f.command,foreground:new k(u)}}))(function(){return Cr(Pt(T_(Ti(as(!1)))(function(){return Nt(`\r
`)})))(function(){return ll(MP(e)(a))})})})})}}]}},MP=function(e){var t=e.MonadEffect0(),a=eh(t),d=th(t)(w_),h=SP(e);return function(n){return a(function(u){return u===""?$a(sn)(function(f){return Cr(Ge(lw)(f.foreground)(function(s){return gy(s)}))(function(){return Cr(Kr(function(s){return{prompt:s.prompt,command:s.command,foreground:q.value}}))(function(){return Cr(Kr(Xn(Oi)("")))(function(){return $a(sn)(function(s){return Cr(Pt(T_(Ti(as(!0)))(function(){return T_(Nt("^C"))(function(){return Nt(`\r
`+Hr(s)(hs))})})))(function(){return ll(a(d(vw(e)(n))))})})})})})}):d(h)(u)})}},FP=vw(Cc)(uu),mw=jb(dh(Jb)(function(e){return dh(Dc)(function(t){var a={init:Cr(Pt(T_(Mb(!0))(function(){return Nt("> ")})))(function(){return ll(CP(bP(FP)))}),query:function(d){return Pt(Nt(d))},shell:{prompt:"> ",command:"",foreground:q.value}};return dh(cw(yP)(a)(e))(function(d){return gc(d.query)(t)})})}));mw();
</script>
  </body>
</html>
