<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>halogen-xterm example</title>
  </head>
  <body>
   <script>var vw=Object.create;var _h=Object.defineProperty;var mw=Object.getOwnPropertyDescriptor;var hw=Object.getOwnPropertyNames;var gw=Object.getPrototypeOf,Dw=Object.prototype.hasOwnProperty;var ws=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Cw=(e,t,a,d)=>{if(t&&typeof t=="object"||typeof t=="function")for(let g of hw(t))!Dw.call(e,g)&&g!==a&&_h(e,g,{get:()=>t[g],enumerable:!(d=mw(t,g))||d.enumerable});return e};var Es=(e,t,a)=>(a=e!=null?vw(gw(e)):{},Cw(t||!e||!e.__esModule?_h(a,"default",{value:e,enumerable:!0}):a,e));var Yy=ws((Il,Ov)=>{(function(e,t){typeof Il=="object"&&typeof Ov=="object"?Ov.exports=t():typeof define=="function"&&define.amd?define([],t):typeof Il=="object"?Il.FitAddon=t():e.FitAddon=t()})(self,()=>(()=>{"use strict";var e={};return(()=>{var t=e;Object.defineProperty(t,"__esModule",{value:!0}),t.FitAddon=void 0,t.FitAddon=class{activate(a){this._terminal=a}dispose(){}fit(){let a=this.proposeDimensions();if(!a||!this._terminal||isNaN(a.cols)||isNaN(a.rows))return;let d=this._terminal._core;this._terminal.rows===a.rows&&this._terminal.cols===a.cols||(d._renderService.clear(),this._terminal.resize(a.cols,a.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;let a=this._terminal._core,d=a._renderService.dimensions;if(d.css.cell.width===0||d.css.cell.height===0)return;let g=this._terminal.options.scrollback===0?0:a.viewport.scrollBarWidth,n=window.getComputedStyle(this._terminal.element.parentElement),u=parseInt(n.getPropertyValue("height")),f=Math.max(0,parseInt(n.getPropertyValue("width"))),s=window.getComputedStyle(this._terminal.element),i=u-(parseInt(s.getPropertyValue("padding-top"))+parseInt(s.getPropertyValue("padding-bottom"))),p=f-(parseInt(s.getPropertyValue("padding-right"))+parseInt(s.getPropertyValue("padding-left")))-g;return{cols:Math.max(2,Math.floor(p/d.css.cell.width)),rows:Math.max(1,Math.floor(i/d.css.cell.height))}}}})(),e})())});var eb=ws((Ol,Pv)=>{(function(e,t){typeof Ol=="object"&&typeof Pv=="object"?Pv.exports=t():typeof define=="function"&&define.amd?define([],t):typeof Ol=="object"?Ol.WebglAddon=t():e.WebglAddon=t()})(self,()=>(()=>{"use strict";var e={965:function(g,n,u){var f=this&&this.__decorate||function(S,v,y,M){var T,w=arguments.length,A=w<3?v:M===null?M=Object.getOwnPropertyDescriptor(v,y):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(S,v,y,M);else for(var I=S.length-1;I>=0;I--)(T=S[I])&&(A=(w<3?T(A):w>3?T(v,y,A):T(v,y))||A);return w>3&&A&&Object.defineProperty(v,y,A),A};Object.defineProperty(n,"__esModule",{value:!0}),n.GlyphRenderer=void 0;let s=u(374),i=u(509),p=u(855),m=u(859),h=u(776),l=u(381),r=11,o=r*Float32Array.BYTES_PER_ELEMENT,c,_=0,D=0,C=0;class b extends m.Disposable{constructor(v,y,M){super(),this._terminal=v,this._gl=y,this._dimensions=M,this._activeBuffer=0,this._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)]};let T=this._gl;i.TextureAtlas.maxAtlasPages===void 0&&(i.TextureAtlas.maxAtlasPages=Math.min(32,(0,s.throwIfFalsy)(T.getParameter(T.MAX_TEXTURE_IMAGE_UNITS))),i.TextureAtlas.maxTextureSize=(0,s.throwIfFalsy)(T.getParameter(T.MAX_TEXTURE_SIZE))),this._program=(0,s.throwIfFalsy)((0,l.createProgram)(T,`#version 300 es
layout (location = 0) in vec2 a_unitquad;
layout (location = 1) in vec2 a_cellpos;
layout (location = 2) in vec2 a_offset;
layout (location = 3) in vec2 a_size;
layout (location = 4) in float a_texpage;
layout (location = 5) in vec2 a_texcoord;
layout (location = 6) in vec2 a_texsize;

uniform mat4 u_projection;
uniform vec2 u_resolution;

out vec2 v_texcoord;
flat out int v_texpage;

void main() {
  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_texpage = int(a_texpage);
  v_texcoord = a_texcoord + a_unitquad * a_texsize;
}`,function(W){let E="";for(let L=1;L<W;L++)E+=` else if (v_texpage == ${L}) { outColor = texture(u_texture[${L}], v_texcoord); }`;return`#version 300 es
precision lowp float;

in vec2 v_texcoord;
flat in int v_texpage;

uniform sampler2D u_texture[${W}];

out vec4 outColor;

void main() {
  if (v_texpage == 0) {
    outColor = texture(u_texture[0], v_texcoord);
  } ${E}
}`}(i.TextureAtlas.maxAtlasPages))),this.register((0,m.toDisposable)(()=>T.deleteProgram(this._program))),this._projectionLocation=(0,s.throwIfFalsy)(T.getUniformLocation(this._program,"u_projection")),this._resolutionLocation=(0,s.throwIfFalsy)(T.getUniformLocation(this._program,"u_resolution")),this._textureLocation=(0,s.throwIfFalsy)(T.getUniformLocation(this._program,"u_texture")),this._vertexArrayObject=T.createVertexArray(),T.bindVertexArray(this._vertexArrayObject);let w=new Float32Array([0,0,1,0,0,1,1,1]),A=T.createBuffer();this.register((0,m.toDisposable)(()=>T.deleteBuffer(A))),T.bindBuffer(T.ARRAY_BUFFER,A),T.bufferData(T.ARRAY_BUFFER,w,T.STATIC_DRAW),T.enableVertexAttribArray(0),T.vertexAttribPointer(0,2,this._gl.FLOAT,!1,0,0);let I=new Uint8Array([0,1,2,3]),R=T.createBuffer();this.register((0,m.toDisposable)(()=>T.deleteBuffer(R))),T.bindBuffer(T.ELEMENT_ARRAY_BUFFER,R),T.bufferData(T.ELEMENT_ARRAY_BUFFER,I,T.STATIC_DRAW),this._attributesBuffer=(0,s.throwIfFalsy)(T.createBuffer()),this.register((0,m.toDisposable)(()=>T.deleteBuffer(this._attributesBuffer))),T.bindBuffer(T.ARRAY_BUFFER,this._attributesBuffer),T.enableVertexAttribArray(2),T.vertexAttribPointer(2,2,T.FLOAT,!1,o,0),T.vertexAttribDivisor(2,1),T.enableVertexAttribArray(3),T.vertexAttribPointer(3,2,T.FLOAT,!1,o,2*Float32Array.BYTES_PER_ELEMENT),T.vertexAttribDivisor(3,1),T.enableVertexAttribArray(4),T.vertexAttribPointer(4,1,T.FLOAT,!1,o,4*Float32Array.BYTES_PER_ELEMENT),T.vertexAttribDivisor(4,1),T.enableVertexAttribArray(5),T.vertexAttribPointer(5,2,T.FLOAT,!1,o,5*Float32Array.BYTES_PER_ELEMENT),T.vertexAttribDivisor(5,1),T.enableVertexAttribArray(6),T.vertexAttribPointer(6,2,T.FLOAT,!1,o,7*Float32Array.BYTES_PER_ELEMENT),T.vertexAttribDivisor(6,1),T.enableVertexAttribArray(1),T.vertexAttribPointer(1,2,T.FLOAT,!1,o,9*Float32Array.BYTES_PER_ELEMENT),T.vertexAttribDivisor(1,1),T.useProgram(this._program);let P=new Int32Array(i.TextureAtlas.maxAtlasPages);for(let W=0;W<i.TextureAtlas.maxAtlasPages;W++)P[W]=W;T.uniform1iv(this._textureLocation,P),T.uniformMatrix4fv(this._projectionLocation,!1,l.PROJECTION_MATRIX),this._atlasTextures=[];for(let W=0;W<i.TextureAtlas.maxAtlasPages;W++){let E=new l.GLTexture((0,s.throwIfFalsy)(T.createTexture()));this.register((0,m.toDisposable)(()=>T.deleteTexture(E.texture))),T.activeTexture(T.TEXTURE0+W),T.bindTexture(T.TEXTURE_2D,E.texture),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texImage2D(T.TEXTURE_2D,0,T.RGBA,1,1,0,T.RGBA,T.UNSIGNED_BYTE,new Uint8Array([255,0,0,255])),this._atlasTextures[W]=E}T.enable(T.BLEND),T.blendFunc(T.SRC_ALPHA,T.ONE_MINUS_SRC_ALPHA),this.handleResize()}beginFrame(){return!this._atlas||this._atlas.beginFrame()}updateCell(v,y,M,T,w,A,I,R){this._updateCell(this._vertices.attributes,v,y,M,T,w,A,I,R)}_updateCell(v,y,M,T,w,A,I,R,P){_=(M*this._terminal.cols+y)*r,T!==p.NULL_CELL_CODE&&T!==void 0?this._atlas&&(c=R&&R.length>1?this._atlas.getRasterizedGlyphCombinedChar(R,w,A,I,!1):this._atlas.getRasterizedGlyph(T,w,A,I,!1),D=Math.floor((this._dimensions.device.cell.width-this._dimensions.device.char.width)/2),w!==P&&c.offset.x>D?(C=c.offset.x-D,v[_]=-(c.offset.x-C)+this._dimensions.device.char.left,v[_+1]=-c.offset.y+this._dimensions.device.char.top,v[_+2]=(c.size.x-C)/this._dimensions.device.canvas.width,v[_+3]=c.size.y/this._dimensions.device.canvas.height,v[_+4]=c.texturePage,v[_+5]=c.texturePositionClipSpace.x+C/this._atlas.pages[c.texturePage].canvas.width,v[_+6]=c.texturePositionClipSpace.y,v[_+7]=c.sizeClipSpace.x-C/this._atlas.pages[c.texturePage].canvas.width,v[_+8]=c.sizeClipSpace.y):(v[_]=-c.offset.x+this._dimensions.device.char.left,v[_+1]=-c.offset.y+this._dimensions.device.char.top,v[_+2]=c.size.x/this._dimensions.device.canvas.width,v[_+3]=c.size.y/this._dimensions.device.canvas.height,v[_+4]=c.texturePage,v[_+5]=c.texturePositionClipSpace.x,v[_+6]=c.texturePositionClipSpace.y,v[_+7]=c.sizeClipSpace.x,v[_+8]=c.sizeClipSpace.y)):v.fill(0,_,_+r-1-2)}clear(){let v=this._terminal,y=v.cols*v.rows*r;this._vertices.count!==y?this._vertices.attributes=new Float32Array(y):this._vertices.attributes.fill(0);let M=0;for(;M<this._vertices.attributesBuffers.length;M++)this._vertices.count!==y?this._vertices.attributesBuffers[M]=new Float32Array(y):this._vertices.attributesBuffers[M].fill(0);this._vertices.count=y,M=0;for(let T=0;T<v.rows;T++)for(let w=0;w<v.cols;w++)this._vertices.attributes[M+9]=w/v.cols,this._vertices.attributes[M+10]=T/v.rows,M+=r}handleResize(){let v=this._gl;v.useProgram(this._program),v.viewport(0,0,v.canvas.width,v.canvas.height),v.uniform2f(this._resolutionLocation,v.canvas.width,v.canvas.height),this.clear()}render(v){if(!this._atlas)return;let y=this._gl;y.useProgram(this._program),y.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;let M=this._vertices.attributesBuffers[this._activeBuffer],T=0;for(let w=0;w<v.lineLengths.length;w++){let A=w*this._terminal.cols*r,I=this._vertices.attributes.subarray(A,A+v.lineLengths[w]*r);M.set(I,T),T+=I.length}y.bindBuffer(y.ARRAY_BUFFER,this._attributesBuffer),y.bufferData(y.ARRAY_BUFFER,M.subarray(0,T),y.STREAM_DRAW);for(let w=0;w<this._atlas.pages.length;w++)this._atlas.pages[w].version!==this._atlasTextures[w].version&&this._bindAtlasPageTexture(y,this._atlas,w);y.drawElementsInstanced(y.TRIANGLE_STRIP,4,y.UNSIGNED_BYTE,0,T/r)}setAtlas(v){this._atlas=v;for(let y of this._atlasTextures)y.version=-1}_bindAtlasPageTexture(v,y,M){v.activeTexture(v.TEXTURE0+M),v.bindTexture(v.TEXTURE_2D,this._atlasTextures[M].texture),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,y.pages[M].canvas),v.generateMipmap(v.TEXTURE_2D),this._atlasTextures[M].version=y.pages[M].version}setDimensions(v){this._dimensions=v}}n.GlyphRenderer=b,f([h.traceCall],b.prototype,"updateCell",null)},742:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.RectangleRenderer=void 0;let f=u(374),s=u(859),i=u(310),p=u(381),m=8*Float32Array.BYTES_PER_ELEMENT;class h{constructor(){this.attributes=new Float32Array(160),this.count=0}}let l=0,r=0,o=0,c=0,_=0,D=0,C=0;class b extends s.Disposable{constructor(v,y,M,T){super(),this._terminal=v,this._gl=y,this._dimensions=M,this._themeService=T,this._vertices=new h,this._verticesCursor=new h;let w=this._gl;this._program=(0,f.throwIfFalsy)((0,p.createProgram)(w,`#version 300 es
layout (location = 0) in vec2 a_position;
layout (location = 1) in vec2 a_size;
layout (location = 2) in vec4 a_color;
layout (location = 3) in vec2 a_unitquad;

uniform mat4 u_projection;

out vec4 v_color;

void main() {
  vec2 zeroToOne = a_position + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_color = a_color;
}`,`#version 300 es
precision lowp float;

in vec4 v_color;

out vec4 outColor;

void main() {
  outColor = v_color;
}`)),this.register((0,s.toDisposable)(()=>w.deleteProgram(this._program))),this._projectionLocation=(0,f.throwIfFalsy)(w.getUniformLocation(this._program,"u_projection")),this._vertexArrayObject=w.createVertexArray(),w.bindVertexArray(this._vertexArrayObject);let A=new Float32Array([0,0,1,0,0,1,1,1]),I=w.createBuffer();this.register((0,s.toDisposable)(()=>w.deleteBuffer(I))),w.bindBuffer(w.ARRAY_BUFFER,I),w.bufferData(w.ARRAY_BUFFER,A,w.STATIC_DRAW),w.enableVertexAttribArray(3),w.vertexAttribPointer(3,2,this._gl.FLOAT,!1,0,0);let R=new Uint8Array([0,1,2,3]),P=w.createBuffer();this.register((0,s.toDisposable)(()=>w.deleteBuffer(P))),w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,P),w.bufferData(w.ELEMENT_ARRAY_BUFFER,R,w.STATIC_DRAW),this._attributesBuffer=(0,f.throwIfFalsy)(w.createBuffer()),this.register((0,s.toDisposable)(()=>w.deleteBuffer(this._attributesBuffer))),w.bindBuffer(w.ARRAY_BUFFER,this._attributesBuffer),w.enableVertexAttribArray(0),w.vertexAttribPointer(0,2,w.FLOAT,!1,m,0),w.vertexAttribDivisor(0,1),w.enableVertexAttribArray(1),w.vertexAttribPointer(1,2,w.FLOAT,!1,m,2*Float32Array.BYTES_PER_ELEMENT),w.vertexAttribDivisor(1,1),w.enableVertexAttribArray(2),w.vertexAttribPointer(2,4,w.FLOAT,!1,m,4*Float32Array.BYTES_PER_ELEMENT),w.vertexAttribDivisor(2,1),this._updateCachedColors(T.colors),this.register(this._themeService.onChangeColors(W=>{this._updateCachedColors(W),this._updateViewportRectangle()}))}renderBackgrounds(){this._renderVertices(this._vertices)}renderCursor(){this._renderVertices(this._verticesCursor)}_renderVertices(v){let y=this._gl;y.useProgram(this._program),y.bindVertexArray(this._vertexArrayObject),y.uniformMatrix4fv(this._projectionLocation,!1,p.PROJECTION_MATRIX),y.bindBuffer(y.ARRAY_BUFFER,this._attributesBuffer),y.bufferData(y.ARRAY_BUFFER,v.attributes,y.DYNAMIC_DRAW),y.drawElementsInstanced(this._gl.TRIANGLE_STRIP,4,y.UNSIGNED_BYTE,0,v.count)}handleResize(){this._updateViewportRectangle()}setDimensions(v){this._dimensions=v}_updateCachedColors(v){this._bgFloat=this._colorToFloat32Array(v.background),this._cursorFloat=this._colorToFloat32Array(v.cursor)}_updateViewportRectangle(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.device.cell.width,this._terminal.rows*this._dimensions.device.cell.height,this._bgFloat)}updateBackgrounds(v){let y=this._terminal,M=this._vertices,T,w,A,I,R,P,W,E,L,x,O,U=1;for(T=0;T<y.rows;T++){for(A=-1,I=0,R=0,P=!1,w=0;w<y.cols;w++)W=(T*y.cols+w)*i.RENDER_MODEL_INDICIES_PER_CELL,E=v.cells[W+i.RENDER_MODEL_BG_OFFSET],L=v.cells[W+i.RENDER_MODEL_FG_OFFSET],x=!!(67108864&L),(E!==I||L!==R&&(P||x))&&((I!==0||P&&R!==0)&&(O=8*U++,this._updateRectangle(M,O,R,I,A,w,T)),A=w,I=E,R=L,P=x);(I!==0||P&&R!==0)&&(O=8*U++,this._updateRectangle(M,O,R,I,A,y.cols,T))}M.count=U}updateCursor(v){let y=this._verticesCursor,M=v.cursor;if(!M||M.style==="block")return void(y.count=0);let T,w=0;M.style!=="bar"&&M.style!=="outline"||(T=8*w++,this._addRectangleFloat(y.attributes,T,M.x*this._dimensions.device.cell.width,M.y*this._dimensions.device.cell.height,M.style==="bar"?M.dpr*M.cursorWidth:M.dpr,this._dimensions.device.cell.height,this._cursorFloat)),M.style!=="underline"&&M.style!=="outline"||(T=8*w++,this._addRectangleFloat(y.attributes,T,M.x*this._dimensions.device.cell.width,(M.y+1)*this._dimensions.device.cell.height-M.dpr,M.width*this._dimensions.device.cell.width,M.dpr,this._cursorFloat)),M.style==="outline"&&(T=8*w++,this._addRectangleFloat(y.attributes,T,M.x*this._dimensions.device.cell.width,M.y*this._dimensions.device.cell.height,M.width*this._dimensions.device.cell.width,M.dpr,this._cursorFloat),T=8*w++,this._addRectangleFloat(y.attributes,T,(M.x+M.width)*this._dimensions.device.cell.width-M.dpr,M.y*this._dimensions.device.cell.height,M.dpr,this._dimensions.device.cell.height,this._cursorFloat)),y.count=w}_updateRectangle(v,y,M,T,w,A,I){if(67108864&M)switch(50331648&M){case 16777216:case 33554432:l=this._themeService.colors.ansi[255&M].rgba;break;case 50331648:l=(16777215&M)<<8;break;default:l=this._themeService.colors.foreground.rgba}else switch(50331648&T){case 16777216:case 33554432:l=this._themeService.colors.ansi[255&T].rgba;break;case 50331648:l=(16777215&T)<<8;break;default:l=this._themeService.colors.background.rgba}v.attributes.length<y+4&&(v.attributes=(0,p.expandFloat32Array)(v.attributes,this._terminal.rows*this._terminal.cols*8)),r=w*this._dimensions.device.cell.width,o=I*this._dimensions.device.cell.height,c=(l>>24&255)/255,_=(l>>16&255)/255,D=(l>>8&255)/255,C=1,this._addRectangle(v.attributes,y,r,o,(A-w)*this._dimensions.device.cell.width,this._dimensions.device.cell.height,c,_,D,C)}_addRectangle(v,y,M,T,w,A,I,R,P,W){v[y]=M/this._dimensions.device.canvas.width,v[y+1]=T/this._dimensions.device.canvas.height,v[y+2]=w/this._dimensions.device.canvas.width,v[y+3]=A/this._dimensions.device.canvas.height,v[y+4]=I,v[y+5]=R,v[y+6]=P,v[y+7]=W}_addRectangleFloat(v,y,M,T,w,A,I){v[y]=M/this._dimensions.device.canvas.width,v[y+1]=T/this._dimensions.device.canvas.height,v[y+2]=w/this._dimensions.device.canvas.width,v[y+3]=A/this._dimensions.device.canvas.height,v[y+4]=I[0],v[y+5]=I[1],v[y+6]=I[2],v[y+7]=I[3]}_colorToFloat32Array(v){return new Float32Array([(v.rgba>>24&255)/255,(v.rgba>>16&255)/255,(v.rgba>>8&255)/255,(255&v.rgba)/255])}}n.RectangleRenderer=b},310:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.RenderModel=n.COMBINED_CHAR_BIT_MASK=n.RENDER_MODEL_EXT_OFFSET=n.RENDER_MODEL_FG_OFFSET=n.RENDER_MODEL_BG_OFFSET=n.RENDER_MODEL_INDICIES_PER_CELL=void 0;let f=u(296);n.RENDER_MODEL_INDICIES_PER_CELL=4,n.RENDER_MODEL_BG_OFFSET=1,n.RENDER_MODEL_FG_OFFSET=2,n.RENDER_MODEL_EXT_OFFSET=3,n.COMBINED_CHAR_BIT_MASK=2147483648,n.RenderModel=class{constructor(){this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection=(0,f.createSelectionRenderModel)()}resize(s,i){let p=s*i*n.RENDER_MODEL_INDICIES_PER_CELL;p!==this.cells.length&&(this.cells=new Uint32Array(p),this.lineLengths=new Uint32Array(i))}clear(){this.cells.fill(0,0),this.lineLengths.fill(0,0)}}},666:function(g,n,u){var f=this&&this.__decorate||function(A,I,R,P){var W,E=arguments.length,L=E<3?I:P===null?P=Object.getOwnPropertyDescriptor(I,R):P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(A,I,R,P);else for(var x=A.length-1;x>=0;x--)(W=A[x])&&(L=(E<3?W(L):E>3?W(I,R,L):W(I,R))||L);return E>3&&L&&Object.defineProperty(I,R,L),L};Object.defineProperty(n,"__esModule",{value:!0}),n.JoinedCellData=n.WebglRenderer=void 0;let s=u(820),i=u(274),p=u(627),m=u(457),h=u(56),l=u(374),r=u(345),o=u(859),c=u(147),_=u(782),D=u(855),C=u(776),b=u(965),S=u(742),v=u(310),y=u(733);class M extends o.Disposable{constructor(I,R,P,W,E,L,x,O,U){super(),this._terminal=I,this._characterJoinerService=R,this._charSizeService=P,this._coreBrowserService=W,this._coreService=E,this._decorationService=L,this._optionsService=x,this._themeService=O,this._cursorBlinkStateManager=new o.MutableDisposable,this._charAtlasDisposable=this.register(new o.MutableDisposable),this._model=new v.RenderModel,this._workCell=new _.CellData,this._rectangleRenderer=this.register(new o.MutableDisposable),this._glyphRenderer=this.register(new o.MutableDisposable),this._onChangeTextureAtlas=this.register(new r.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new r.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new r.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onRequestRedraw=this.register(new r.EventEmitter),this.onRequestRedraw=this._onRequestRedraw.event,this._onContextLoss=this.register(new r.EventEmitter),this.onContextLoss=this._onContextLoss.event,this.register(this._themeService.onChangeColors(()=>this._handleColorChange())),this._cellColorResolver=new i.CellColorResolver(this._terminal,this._model.selection,this._decorationService,this._coreBrowserService,this._themeService),this._core=this._terminal._core,this._renderLayers=[new y.LinkRenderLayer(this._core.screenElement,2,this._terminal,this._core.linkifier2,this._coreBrowserService,x,this._themeService)],this.dimensions=(0,l.createRenderDimensions)(),this._devicePixelRatio=this._coreBrowserService.dpr,this._updateDimensions(),this._updateCursorBlink(),this.register(x.onOptionChange(()=>this._handleOptionsChanged())),this._canvas=document.createElement("canvas");let Y={antialias:!1,depth:!1,preserveDrawingBuffer:U};if(this._gl=this._canvas.getContext("webgl2",Y),!this._gl)throw new Error("WebGL2 not supported "+this._gl);this.register((0,s.addDisposableDomListener)(this._canvas,"webglcontextlost",ae=>{console.log("webglcontextlost event received"),ae.preventDefault(),this._contextRestorationTimeout=setTimeout(()=>{this._contextRestorationTimeout=void 0,console.warn("webgl context not restored; firing onContextLoss"),this._onContextLoss.fire(ae)},3e3)})),this.register((0,s.addDisposableDomListener)(this._canvas,"webglcontextrestored",ae=>{console.warn("webglcontextrestored event received"),clearTimeout(this._contextRestorationTimeout),this._contextRestorationTimeout=void 0,(0,p.removeTerminalFromCache)(this._terminal),this._initializeWebGLState(),this._requestRedrawViewport()})),this.register((0,h.observeDevicePixelDimensions)(this._canvas,this._coreBrowserService.window,(ae,z)=>this._setCanvasDevicePixelDimensions(ae,z))),this._core.screenElement.appendChild(this._canvas),[this._rectangleRenderer.value,this._glyphRenderer.value]=this._initializeWebGLState(),this._isAttached=this._coreBrowserService.window.document.body.contains(this._core.screenElement),this.register((0,o.toDisposable)(()=>{var ae;for(let z of this._renderLayers)z.dispose();(ae=this._canvas.parentElement)===null||ae===void 0||ae.removeChild(this._canvas),(0,p.removeTerminalFromCache)(this._terminal)}))}get textureAtlas(){var I;return(I=this._charAtlas)===null||I===void 0?void 0:I.pages[0].canvas}_handleColorChange(){this._refreshCharAtlas(),this._clearModel(!0)}handleDevicePixelRatioChange(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._terminal.cols,this._terminal.rows))}handleResize(I,R){var P,W,E,L;this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);for(let x of this._renderLayers)x.resize(this._terminal,this.dimensions);this._canvas.width=this.dimensions.device.canvas.width,this._canvas.height=this.dimensions.device.canvas.height,this._canvas.style.width=`${this.dimensions.css.canvas.width}px`,this._canvas.style.height=`${this.dimensions.css.canvas.height}px`,this._core.screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._core.screenElement.style.height=`${this.dimensions.css.canvas.height}px`,(P=this._rectangleRenderer.value)===null||P===void 0||P.setDimensions(this.dimensions),(W=this._rectangleRenderer.value)===null||W===void 0||W.handleResize(),(E=this._glyphRenderer.value)===null||E===void 0||E.setDimensions(this.dimensions),(L=this._glyphRenderer.value)===null||L===void 0||L.handleResize(),this._refreshCharAtlas(),this._clearModel(!1)}handleCharSizeChanged(){this.handleResize(this._terminal.cols,this._terminal.rows)}handleBlur(){var I;for(let R of this._renderLayers)R.handleBlur(this._terminal);(I=this._cursorBlinkStateManager.value)===null||I===void 0||I.pause(),this._requestRedrawViewport()}handleFocus(){var I;for(let R of this._renderLayers)R.handleFocus(this._terminal);(I=this._cursorBlinkStateManager.value)===null||I===void 0||I.resume(),this._requestRedrawViewport()}handleSelectionChanged(I,R,P){for(let W of this._renderLayers)W.handleSelectionChanged(this._terminal,I,R,P);this._model.selection.update(this._terminal,I,R,P),this._requestRedrawViewport()}handleCursorMove(){var I;for(let R of this._renderLayers)R.handleCursorMove(this._terminal);(I=this._cursorBlinkStateManager.value)===null||I===void 0||I.restartBlinkAnimation()}_handleOptionsChanged(){this._updateDimensions(),this._refreshCharAtlas(),this._updateCursorBlink()}_initializeWebGLState(){return this._rectangleRenderer.value=new S.RectangleRenderer(this._terminal,this._gl,this.dimensions,this._themeService),this._glyphRenderer.value=new b.GlyphRenderer(this._terminal,this._gl,this.dimensions),this.handleCharSizeChanged(),[this._rectangleRenderer.value,this._glyphRenderer.value]}_refreshCharAtlas(){var I;if(this.dimensions.device.char.width<=0&&this.dimensions.device.char.height<=0)return void(this._isAttached=!1);let R=(0,p.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,this._themeService.colors,this.dimensions.device.cell.width,this.dimensions.device.cell.height,this.dimensions.device.char.width,this.dimensions.device.char.height,this._coreBrowserService.dpr);this._charAtlas!==R&&(this._onChangeTextureAtlas.fire(R.pages[0].canvas),this._charAtlasDisposable.value=(0,o.getDisposeArrayDisposable)([(0,r.forwardEvent)(R.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),(0,r.forwardEvent)(R.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)])),this._charAtlas=R,this._charAtlas.warmUp(),(I=this._glyphRenderer.value)===null||I===void 0||I.setAtlas(this._charAtlas)}_clearModel(I){var R;this._model.clear(),I&&((R=this._glyphRenderer.value)===null||R===void 0||R.clear())}clearTextureAtlas(){var I;(I=this._charAtlas)===null||I===void 0||I.clearTexture(),this._clearModel(!0),this._requestRedrawViewport()}clear(){var I;this._clearModel(!0);for(let R of this._renderLayers)R.reset(this._terminal);(I=this._cursorBlinkStateManager.value)===null||I===void 0||I.restartBlinkAnimation(),this._updateCursorBlink()}registerCharacterJoiner(I){return-1}deregisterCharacterJoiner(I){return!1}renderRows(I,R){if(!this._isAttached){if(!(this._coreBrowserService.window.document.body.contains(this._core.screenElement)&&this._charSizeService.width&&this._charSizeService.height))return;this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0}for(let P of this._renderLayers)P.handleGridChanged(this._terminal,I,R);this._glyphRenderer.value&&this._rectangleRenderer.value&&(this._glyphRenderer.value.beginFrame()?(this._clearModel(!0),this._updateModel(0,this._terminal.rows-1)):this._updateModel(I,R),this._rectangleRenderer.value.renderBackgrounds(),this._glyphRenderer.value.render(this._model),this._cursorBlinkStateManager.value&&!this._cursorBlinkStateManager.value.isCursorVisible||this._rectangleRenderer.value.renderCursor())}_updateCursorBlink(){this._terminal.options.cursorBlink?this._cursorBlinkStateManager.value=new m.CursorBlinkStateManager(()=>{this._requestRedrawCursor()},this._coreBrowserService):this._cursorBlinkStateManager.clear(),this._requestRedrawCursor()}_updateModel(I,R){let P=this._core,W,E,L,x,O,U,Y,ae,z,fe,F,N,B,H=this._workCell;I=w(I,P.rows-1,0),R=w(R,P.rows-1,0);let le=this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY,j=Math.min(this._terminal.buffer.active.cursorX,P.cols-1),Le=-1,rt=this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden&&(!this._cursorBlinkStateManager.value||this._cursorBlinkStateManager.value.isCursorVisible);this._model.cursor=void 0;let Be=!1;for(E=I;E<=R;E++)for(L=E+P.buffer.ydisp,x=P.buffer.lines.get(L),this._model.lineLengths[E]=0,O=this._characterJoinerService.getJoinedCharacters(L),N=0;N<P.cols;N++)if(W=this._cellColorResolver.result.bg,x.loadCell(N,H),N===0&&(W=this._cellColorResolver.result.bg),U=!1,Y=N,O.length>0&&N===O[0][0]&&(U=!0,ae=O.shift(),H=new T(H,x.translateToString(!0,ae[0],ae[1]),ae[1]-ae[0]),Y=ae[1]-1),z=H.getChars(),fe=H.getCode(),F=(E*P.cols+N)*v.RENDER_MODEL_INDICIES_PER_CELL,this._cellColorResolver.resolve(H,N,L),rt&&L===le&&(N===j&&(this._model.cursor={x:j,y:this._terminal.buffer.active.cursorY,width:H.getWidth(),style:this._coreBrowserService.isFocused?P.options.cursorStyle||"block":P.options.cursorInactiveStyle,cursorWidth:P.options.cursorWidth,dpr:this._devicePixelRatio},Le=j+H.getWidth()-1),N>=j&&N<=Le&&(this._coreBrowserService.isFocused&&(P.options.cursorStyle||"block")==="block"||this._coreBrowserService.isFocused===!1&&P.options.cursorInactiveStyle==="block")&&(this._cellColorResolver.result.fg=50331648|this._themeService.colors.cursorAccent.rgba>>8&16777215,this._cellColorResolver.result.bg=50331648|this._themeService.colors.cursor.rgba>>8&16777215)),fe!==D.NULL_CELL_CODE&&(this._model.lineLengths[E]=N+1),(this._model.cells[F]!==fe||this._model.cells[F+v.RENDER_MODEL_BG_OFFSET]!==this._cellColorResolver.result.bg||this._model.cells[F+v.RENDER_MODEL_FG_OFFSET]!==this._cellColorResolver.result.fg||this._model.cells[F+v.RENDER_MODEL_EXT_OFFSET]!==this._cellColorResolver.result.ext)&&(Be=!0,z.length>1&&(fe|=v.COMBINED_CHAR_BIT_MASK),this._model.cells[F]=fe,this._model.cells[F+v.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[F+v.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[F+v.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext,this._glyphRenderer.value.updateCell(N,E,fe,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,z,W),U))for(H=this._workCell,N++;N<Y;N++)B=(E*P.cols+N)*v.RENDER_MODEL_INDICIES_PER_CELL,this._glyphRenderer.value.updateCell(N,E,D.NULL_CELL_CODE,0,0,0,D.NULL_CELL_CHAR,0),this._model.cells[B]=D.NULL_CELL_CODE,this._model.cells[B+v.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[B+v.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[B+v.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext;Be&&this._rectangleRenderer.value.updateBackgrounds(this._model),this._rectangleRenderer.value.updateCursor(this._model)}_updateDimensions(){this._charSizeService.width&&this._charSizeService.height&&(this.dimensions.device.char.width=Math.floor(this._charSizeService.width*this._devicePixelRatio),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*this._devicePixelRatio),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=this._optionsService.rawOptions.lineHeight===1?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._terminal.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._terminal.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/this._devicePixelRatio),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/this._devicePixelRatio),this.dimensions.css.cell.height=this.dimensions.device.cell.height/this._devicePixelRatio,this.dimensions.css.cell.width=this.dimensions.device.cell.width/this._devicePixelRatio)}_setCanvasDevicePixelDimensions(I,R){this._canvas.width===I&&this._canvas.height===R||(this._canvas.width=I,this._canvas.height=R,this._requestRedrawViewport())}_requestRedrawViewport(){this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})}_requestRedrawCursor(){let I=this._terminal.buffer.active.cursorY;this._onRequestRedraw.fire({start:I,end:I})}}n.WebglRenderer=M,f([C.traceCall],M.prototype,"renderRows",null);class T extends c.AttributeData{constructor(I,R,P){super(),this.content=0,this.combinedData="",this.fg=I.fg,this.bg=I.bg,this.combinedData=R,this._width=P}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(I){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}function w(A,I,R=0){return Math.max(Math.min(A,I),R)}n.JoinedCellData=T},381:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GLTexture=n.expandFloat32Array=n.createShader=n.createProgram=n.PROJECTION_MATRIX=void 0;let f=u(374);function s(i,p,m){let h=(0,f.throwIfFalsy)(i.createShader(p));if(i.shaderSource(h,m),i.compileShader(h),i.getShaderParameter(h,i.COMPILE_STATUS))return h;console.error(i.getShaderInfoLog(h)),i.deleteShader(h)}n.PROJECTION_MATRIX=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]),n.createProgram=function(i,p,m){let h=(0,f.throwIfFalsy)(i.createProgram());if(i.attachShader(h,(0,f.throwIfFalsy)(s(i,i.VERTEX_SHADER,p))),i.attachShader(h,(0,f.throwIfFalsy)(s(i,i.FRAGMENT_SHADER,m))),i.linkProgram(h),i.getProgramParameter(h,i.LINK_STATUS))return h;console.error(i.getProgramInfoLog(h)),i.deleteProgram(h)},n.createShader=s,n.expandFloat32Array=function(i,p){let m=Math.min(2*i.length,p),h=new Float32Array(m);for(let l=0;l<i.length;l++)h[l]=i[l];return h},n.GLTexture=class{constructor(i){this.texture=i,this.version=-1}}},592:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BaseRenderLayer=void 0;let f=u(627),s=u(237),i=u(374),p=u(859);class m extends p.Disposable{constructor(l,r,o,c,_,D,C,b){super(),this._container=r,this._alpha=_,this._coreBrowserService=D,this._optionsService=C,this._themeService=b,this._deviceCharWidth=0,this._deviceCharHeight=0,this._deviceCellWidth=0,this._deviceCellHeight=0,this._deviceCharLeft=0,this._deviceCharTop=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add(`xterm-${o}-layer`),this._canvas.style.zIndex=c.toString(),this._initCanvas(),this._container.appendChild(this._canvas),this.register(this._themeService.onChangeColors(S=>{this._refreshCharAtlas(l,S),this.reset(l)})),this.register((0,p.toDisposable)(()=>{this._canvas.remove()}))}_initCanvas(){this._ctx=(0,i.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}handleBlur(l){}handleFocus(l){}handleCursorMove(l){}handleGridChanged(l,r,o){}handleSelectionChanged(l,r,o,c=!1){}_setTransparency(l,r){if(r===this._alpha)return;let o=this._canvas;this._alpha=r,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,o),this._refreshCharAtlas(l,this._themeService.colors),this.handleGridChanged(l,0,l.rows-1)}_refreshCharAtlas(l,r){this._deviceCharWidth<=0&&this._deviceCharHeight<=0||(this._charAtlas=(0,f.acquireTextureAtlas)(l,this._optionsService.rawOptions,r,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlas.warmUp())}resize(l,r){this._deviceCellWidth=r.device.cell.width,this._deviceCellHeight=r.device.cell.height,this._deviceCharWidth=r.device.char.width,this._deviceCharHeight=r.device.char.height,this._deviceCharLeft=r.device.char.left,this._deviceCharTop=r.device.char.top,this._canvas.width=r.device.canvas.width,this._canvas.height=r.device.canvas.height,this._canvas.style.width=`${r.css.canvas.width}px`,this._canvas.style.height=`${r.css.canvas.height}px`,this._alpha||this._clearAll(),this._refreshCharAtlas(l,this._themeService.colors)}_fillBottomLineAtCells(l,r,o=1){this._ctx.fillRect(l*this._deviceCellWidth,(r+1)*this._deviceCellHeight-this._coreBrowserService.dpr-1,o*this._deviceCellWidth,this._coreBrowserService.dpr)}_clearAll(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}_clearCells(l,r,o,c){this._alpha?this._ctx.clearRect(l*this._deviceCellWidth,r*this._deviceCellHeight,o*this._deviceCellWidth,c*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(l*this._deviceCellWidth,r*this._deviceCellHeight,o*this._deviceCellWidth,c*this._deviceCellHeight))}_fillCharTrueColor(l,r,o,c){this._ctx.font=this._getFont(l,!1,!1),this._ctx.textBaseline=s.TEXT_BASELINE,this._clipCell(o,c,r.getWidth()),this._ctx.fillText(r.getChars(),o*this._deviceCellWidth+this._deviceCharLeft,c*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}_clipCell(l,r,o){this._ctx.beginPath(),this._ctx.rect(l*this._deviceCellWidth,r*this._deviceCellHeight,o*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}_getFont(l,r,o){return`${o?"italic":""} ${r?l.options.fontWeightBold:l.options.fontWeight} ${l.options.fontSize*this._coreBrowserService.dpr}px ${l.options.fontFamily}`}}n.BaseRenderLayer=m},733:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.LinkRenderLayer=void 0;let f=u(197),s=u(237),i=u(592);class p extends i.BaseRenderLayer{constructor(h,l,r,o,c,_,D){super(r,h,"link",l,!0,c,_,D),this.register(o.onShowLinkUnderline(C=>this._handleShowLinkUnderline(C))),this.register(o.onHideLinkUnderline(C=>this._handleHideLinkUnderline(C)))}resize(h,l){super.resize(h,l),this._state=void 0}reset(h){this._clearCurrentLink()}_clearCurrentLink(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);let h=this._state.y2-this._state.y1-1;h>0&&this._clearCells(0,this._state.y1+1,this._state.cols,h),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}_handleShowLinkUnderline(h){if(h.fg===s.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:h.fg!==void 0&&(0,f.is256Color)(h.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[h.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,h.y1===h.y2)this._fillBottomLineAtCells(h.x1,h.y1,h.x2-h.x1);else{this._fillBottomLineAtCells(h.x1,h.y1,h.cols-h.x1);for(let l=h.y1+1;l<h.y2;l++)this._fillBottomLineAtCells(0,l,h.cols);this._fillBottomLineAtCells(0,h.y2,h.x2)}this._state=h}_handleHideLinkUnderline(h){this._clearCurrentLink()}}n.LinkRenderLayer=p},820:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.addDisposableDomListener=void 0,n.addDisposableDomListener=function(u,f,s,i){u.addEventListener(f,s,i);let p=!1;return{dispose:()=>{p||(p=!0,u.removeEventListener(f,s,i))}}}},274:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CellColorResolver=void 0;let u,f=0,s=0,i=!1,p=!1,m=!1;n.CellColorResolver=class{constructor(h,l,r,o,c){this._terminal=h,this._selectionRenderModel=l,this._decorationService=r,this._coreBrowserService=o,this._themeService=c,this.result={fg:0,bg:0,ext:0}}resolve(h,l,r){this.result.bg=h.bg,this.result.fg=h.fg,this.result.ext=268435456&h.bg?h.extended.ext:0,s=0,f=0,p=!1,i=!1,m=!1,u=this._themeService.colors,this._decorationService.forEachDecorationAtCell(l,r,"bottom",o=>{o.backgroundColorRGB&&(s=o.backgroundColorRGB.rgba>>8&16777215,p=!0),o.foregroundColorRGB&&(f=o.foregroundColorRGB.rgba>>8&16777215,i=!0)}),m=this._selectionRenderModel.isCellSelected(this._terminal,l,r),m&&(s=(this._coreBrowserService.isFocused?u.selectionBackgroundOpaque:u.selectionInactiveBackgroundOpaque).rgba>>8&16777215,p=!0,u.selectionForeground&&(f=u.selectionForeground.rgba>>8&16777215,i=!0)),this._decorationService.forEachDecorationAtCell(l,r,"top",o=>{o.backgroundColorRGB&&(s=o.backgroundColorRGB.rgba>>8&16777215,p=!0),o.foregroundColorRGB&&(f=o.foregroundColorRGB.rgba>>8&16777215,i=!0)}),p&&(s=m?-16777216&h.bg&-134217729|s|50331648:-16777216&h.bg|s|50331648),i&&(f=-16777216&h.fg&-67108865|f|50331648),67108864&this.result.fg&&(p&&!i&&(f=50331648&this.result.bg?-134217728&this.result.fg|67108863&this.result.bg:-134217728&this.result.fg|16777215&u.background.rgba>>8|50331648,i=!0),!p&&i&&(s=50331648&this.result.fg?-67108864&this.result.bg|67108863&this.result.fg:-67108864&this.result.bg|16777215&u.foreground.rgba>>8|50331648,p=!0)),u=void 0,this.result.bg=p?s:this.result.bg,this.result.fg=i?f:this.result.fg}}},627:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.removeTerminalFromCache=n.acquireTextureAtlas=void 0;let f=u(509),s=u(197),i=[];n.acquireTextureAtlas=function(p,m,h,l,r,o,c,_){let D=(0,s.generateConfig)(l,r,o,c,m,h,_);for(let S=0;S<i.length;S++){let v=i[S],y=v.ownedBy.indexOf(p);if(y>=0){if((0,s.configEquals)(v.config,D))return v.atlas;v.ownedBy.length===1?(v.atlas.dispose(),i.splice(S,1)):v.ownedBy.splice(y,1);break}}for(let S=0;S<i.length;S++){let v=i[S];if((0,s.configEquals)(v.config,D))return v.ownedBy.push(p),v.atlas}let C=p._core,b={atlas:new f.TextureAtlas(document,D,C.unicodeService),config:D,ownedBy:[p]};return i.push(b),b.atlas},n.removeTerminalFromCache=function(p){for(let m=0;m<i.length;m++){let h=i[m].ownedBy.indexOf(p);if(h!==-1){i[m].ownedBy.length===1?(i[m].atlas.dispose(),i.splice(m,1)):i[m].ownedBy.splice(h,1);break}}}},197:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.is256Color=n.configEquals=n.generateConfig=void 0;let f=u(160);n.generateConfig=function(s,i,p,m,h,l,r){let o={foreground:l.foreground,background:l.background,cursor:f.NULL_COLOR,cursorAccent:f.NULL_COLOR,selectionForeground:f.NULL_COLOR,selectionBackgroundTransparent:f.NULL_COLOR,selectionBackgroundOpaque:f.NULL_COLOR,selectionInactiveBackgroundTransparent:f.NULL_COLOR,selectionInactiveBackgroundOpaque:f.NULL_COLOR,ansi:l.ansi.slice(),contrastCache:l.contrastCache,halfContrastCache:l.halfContrastCache};return{customGlyphs:h.customGlyphs,devicePixelRatio:r,letterSpacing:h.letterSpacing,lineHeight:h.lineHeight,deviceCellWidth:s,deviceCellHeight:i,deviceCharWidth:p,deviceCharHeight:m,fontFamily:h.fontFamily,fontSize:h.fontSize,fontWeight:h.fontWeight,fontWeightBold:h.fontWeightBold,allowTransparency:h.allowTransparency,drawBoldTextInBrightColors:h.drawBoldTextInBrightColors,minimumContrastRatio:h.minimumContrastRatio,colors:o}},n.configEquals=function(s,i){for(let p=0;p<s.colors.ansi.length;p++)if(s.colors.ansi[p].rgba!==i.colors.ansi[p].rgba)return!1;return s.devicePixelRatio===i.devicePixelRatio&&s.customGlyphs===i.customGlyphs&&s.lineHeight===i.lineHeight&&s.letterSpacing===i.letterSpacing&&s.fontFamily===i.fontFamily&&s.fontSize===i.fontSize&&s.fontWeight===i.fontWeight&&s.fontWeightBold===i.fontWeightBold&&s.allowTransparency===i.allowTransparency&&s.deviceCharWidth===i.deviceCharWidth&&s.deviceCharHeight===i.deviceCharHeight&&s.drawBoldTextInBrightColors===i.drawBoldTextInBrightColors&&s.minimumContrastRatio===i.minimumContrastRatio&&s.colors.foreground.rgba===i.colors.foreground.rgba&&s.colors.background.rgba===i.colors.background.rgba},n.is256Color=function(s){return(50331648&s)==16777216||(50331648&s)==33554432}},237:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TEXT_BASELINE=n.DIM_OPACITY=n.INVERTED_DEFAULT_COLOR=void 0;let f=u(399);n.INVERTED_DEFAULT_COLOR=257,n.DIM_OPACITY=.5,n.TEXT_BASELINE=f.isFirefox||f.isLegacyEdge?"bottom":"ideographic"},457:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CursorBlinkStateManager=void 0,n.CursorBlinkStateManager=class{constructor(u,f){this._renderCallback=u,this._coreBrowserService=f,this.isCursorVisible=!0,this._coreBrowserService.isFocused&&this._restartInterval()}get isPaused(){return!(this._blinkStartTimeout||this._blinkInterval)}dispose(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}restartBlinkAnimation(){this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})))}_restartInterval(u=600){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(()=>{if(this._animationTimeRestarted){let f=600-(Date.now()-this._animationTimeRestarted);if(this._animationTimeRestarted=void 0,f>0)return void this._restartInterval(f)}this.isCursorVisible=!1,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0}),this._blinkInterval=this._coreBrowserService.window.setInterval(()=>{if(this._animationTimeRestarted){let f=600-(Date.now()-this._animationTimeRestarted);return this._animationTimeRestarted=void 0,void this._restartInterval(f)}this.isCursorVisible=!this.isCursorVisible,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})},600)},u)}pause(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}resume(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}},860:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.tryDrawCustomChar=n.powerlineDefinitions=n.boxDrawingDefinitions=n.blockElementDefinitions=void 0;let f=u(374);n.blockElementDefinitions={"\u2580":[{x:0,y:0,w:8,h:4}],"\u2581":[{x:0,y:7,w:8,h:1}],"\u2582":[{x:0,y:6,w:8,h:2}],"\u2583":[{x:0,y:5,w:8,h:3}],"\u2584":[{x:0,y:4,w:8,h:4}],"\u2585":[{x:0,y:3,w:8,h:5}],"\u2586":[{x:0,y:2,w:8,h:6}],"\u2587":[{x:0,y:1,w:8,h:7}],"\u2588":[{x:0,y:0,w:8,h:8}],"\u2589":[{x:0,y:0,w:7,h:8}],"\u258A":[{x:0,y:0,w:6,h:8}],"\u258B":[{x:0,y:0,w:5,h:8}],"\u258C":[{x:0,y:0,w:4,h:8}],"\u258D":[{x:0,y:0,w:3,h:8}],"\u258E":[{x:0,y:0,w:2,h:8}],"\u258F":[{x:0,y:0,w:1,h:8}],"\u2590":[{x:4,y:0,w:4,h:8}],"\u2594":[{x:0,y:0,w:8,h:1}],"\u2595":[{x:7,y:0,w:1,h:8}],"\u2596":[{x:0,y:4,w:4,h:4}],"\u2597":[{x:4,y:4,w:4,h:4}],"\u2598":[{x:0,y:0,w:4,h:4}],"\u2599":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\u259A":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"\u259B":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"\u259C":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"\u259D":[{x:4,y:0,w:4,h:4}],"\u259E":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"\u259F":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\u{1FB70}":[{x:1,y:0,w:1,h:8}],"\u{1FB71}":[{x:2,y:0,w:1,h:8}],"\u{1FB72}":[{x:3,y:0,w:1,h:8}],"\u{1FB73}":[{x:4,y:0,w:1,h:8}],"\u{1FB74}":[{x:5,y:0,w:1,h:8}],"\u{1FB75}":[{x:6,y:0,w:1,h:8}],"\u{1FB76}":[{x:0,y:1,w:8,h:1}],"\u{1FB77}":[{x:0,y:2,w:8,h:1}],"\u{1FB78}":[{x:0,y:3,w:8,h:1}],"\u{1FB79}":[{x:0,y:4,w:8,h:1}],"\u{1FB7A}":[{x:0,y:5,w:8,h:1}],"\u{1FB7B}":[{x:0,y:6,w:8,h:1}],"\u{1FB7C}":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\u{1FB7D}":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\u{1FB7E}":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\u{1FB7F}":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\u{1FB80}":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"\u{1FB81}":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"\u{1FB82}":[{x:0,y:0,w:8,h:2}],"\u{1FB83}":[{x:0,y:0,w:8,h:3}],"\u{1FB84}":[{x:0,y:0,w:8,h:5}],"\u{1FB85}":[{x:0,y:0,w:8,h:6}],"\u{1FB86}":[{x:0,y:0,w:8,h:7}],"\u{1FB87}":[{x:6,y:0,w:2,h:8}],"\u{1FB88}":[{x:5,y:0,w:3,h:8}],"\u{1FB89}":[{x:3,y:0,w:5,h:8}],"\u{1FB8A}":[{x:2,y:0,w:6,h:8}],"\u{1FB8B}":[{x:1,y:0,w:7,h:8}],"\u{1FB95}":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"\u{1FB96}":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"\u{1FB97}":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};let s={"\u2591":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"\u2592":[[1,0],[0,0],[0,1],[0,0]],"\u2593":[[0,1],[1,1],[1,0],[1,1]]};n.boxDrawingDefinitions={"\u2500":{1:"M0,.5 L1,.5"},"\u2501":{3:"M0,.5 L1,.5"},"\u2502":{1:"M.5,0 L.5,1"},"\u2503":{3:"M.5,0 L.5,1"},"\u250C":{1:"M0.5,1 L.5,.5 L1,.5"},"\u250F":{3:"M0.5,1 L.5,.5 L1,.5"},"\u2510":{1:"M0,.5 L.5,.5 L.5,1"},"\u2513":{3:"M0,.5 L.5,.5 L.5,1"},"\u2514":{1:"M.5,0 L.5,.5 L1,.5"},"\u2517":{3:"M.5,0 L.5,.5 L1,.5"},"\u2518":{1:"M.5,0 L.5,.5 L0,.5"},"\u251B":{3:"M.5,0 L.5,.5 L0,.5"},"\u251C":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u2523":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u2524":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u252B":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u252C":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2533":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2534":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"\u253B":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"\u253C":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"\u254B":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"\u2574":{1:"M.5,.5 L0,.5"},"\u2578":{3:"M.5,.5 L0,.5"},"\u2575":{1:"M.5,.5 L.5,0"},"\u2579":{3:"M.5,.5 L.5,0"},"\u2576":{1:"M.5,.5 L1,.5"},"\u257A":{3:"M.5,.5 L1,.5"},"\u2577":{1:"M.5,.5 L.5,1"},"\u257B":{3:"M.5,.5 L.5,1"},"\u2550":{1:(l,r)=>`M0,${.5-r} L1,${.5-r} M0,${.5+r} L1,${.5+r}`},"\u2551":{1:(l,r)=>`M${.5-l},0 L${.5-l},1 M${.5+l},0 L${.5+l},1`},"\u2552":{1:(l,r)=>`M.5,1 L.5,${.5-r} L1,${.5-r} M.5,${.5+r} L1,${.5+r}`},"\u2553":{1:(l,r)=>`M${.5-l},1 L${.5-l},.5 L1,.5 M${.5+l},.5 L${.5+l},1`},"\u2554":{1:(l,r)=>`M1,${.5-r} L${.5-l},${.5-r} L${.5-l},1 M1,${.5+r} L${.5+l},${.5+r} L${.5+l},1`},"\u2555":{1:(l,r)=>`M0,${.5-r} L.5,${.5-r} L.5,1 M0,${.5+r} L.5,${.5+r}`},"\u2556":{1:(l,r)=>`M${.5+l},1 L${.5+l},.5 L0,.5 M${.5-l},.5 L${.5-l},1`},"\u2557":{1:(l,r)=>`M0,${.5+r} L${.5-l},${.5+r} L${.5-l},1 M0,${.5-r} L${.5+l},${.5-r} L${.5+l},1`},"\u2558":{1:(l,r)=>`M.5,0 L.5,${.5+r} L1,${.5+r} M.5,${.5-r} L1,${.5-r}`},"\u2559":{1:(l,r)=>`M1,.5 L${.5-l},.5 L${.5-l},0 M${.5+l},.5 L${.5+l},0`},"\u255A":{1:(l,r)=>`M1,${.5-r} L${.5+l},${.5-r} L${.5+l},0 M1,${.5+r} L${.5-l},${.5+r} L${.5-l},0`},"\u255B":{1:(l,r)=>`M0,${.5+r} L.5,${.5+r} L.5,0 M0,${.5-r} L.5,${.5-r}`},"\u255C":{1:(l,r)=>`M0,.5 L${.5+l},.5 L${.5+l},0 M${.5-l},.5 L${.5-l},0`},"\u255D":{1:(l,r)=>`M0,${.5-r} L${.5-l},${.5-r} L${.5-l},0 M0,${.5+r} L${.5+l},${.5+r} L${.5+l},0`},"\u255E":{1:(l,r)=>`M.5,0 L.5,1 M.5,${.5-r} L1,${.5-r} M.5,${.5+r} L1,${.5+r}`},"\u255F":{1:(l,r)=>`M${.5-l},0 L${.5-l},1 M${.5+l},0 L${.5+l},1 M${.5+l},.5 L1,.5`},"\u2560":{1:(l,r)=>`M${.5-l},0 L${.5-l},1 M1,${.5+r} L${.5+l},${.5+r} L${.5+l},1 M1,${.5-r} L${.5+l},${.5-r} L${.5+l},0`},"\u2561":{1:(l,r)=>`M.5,0 L.5,1 M0,${.5-r} L.5,${.5-r} M0,${.5+r} L.5,${.5+r}`},"\u2562":{1:(l,r)=>`M0,.5 L${.5-l},.5 M${.5-l},0 L${.5-l},1 M${.5+l},0 L${.5+l},1`},"\u2563":{1:(l,r)=>`M${.5+l},0 L${.5+l},1 M0,${.5+r} L${.5-l},${.5+r} L${.5-l},1 M0,${.5-r} L${.5-l},${.5-r} L${.5-l},0`},"\u2564":{1:(l,r)=>`M0,${.5-r} L1,${.5-r} M0,${.5+r} L1,${.5+r} M.5,${.5+r} L.5,1`},"\u2565":{1:(l,r)=>`M0,.5 L1,.5 M${.5-l},.5 L${.5-l},1 M${.5+l},.5 L${.5+l},1`},"\u2566":{1:(l,r)=>`M0,${.5-r} L1,${.5-r} M0,${.5+r} L${.5-l},${.5+r} L${.5-l},1 M1,${.5+r} L${.5+l},${.5+r} L${.5+l},1`},"\u2567":{1:(l,r)=>`M.5,0 L.5,${.5-r} M0,${.5-r} L1,${.5-r} M0,${.5+r} L1,${.5+r}`},"\u2568":{1:(l,r)=>`M0,.5 L1,.5 M${.5-l},.5 L${.5-l},0 M${.5+l},.5 L${.5+l},0`},"\u2569":{1:(l,r)=>`M0,${.5+r} L1,${.5+r} M0,${.5-r} L${.5-l},${.5-r} L${.5-l},0 M1,${.5-r} L${.5+l},${.5-r} L${.5+l},0`},"\u256A":{1:(l,r)=>`M.5,0 L.5,1 M0,${.5-r} L1,${.5-r} M0,${.5+r} L1,${.5+r}`},"\u256B":{1:(l,r)=>`M0,.5 L1,.5 M${.5-l},0 L${.5-l},1 M${.5+l},0 L${.5+l},1`},"\u256C":{1:(l,r)=>`M0,${.5+r} L${.5-l},${.5+r} L${.5-l},1 M1,${.5+r} L${.5+l},${.5+r} L${.5+l},1 M0,${.5-r} L${.5-l},${.5-r} L${.5-l},0 M1,${.5-r} L${.5+l},${.5-r} L${.5+l},0`},"\u2571":{1:"M1,0 L0,1"},"\u2572":{1:"M0,0 L1,1"},"\u2573":{1:"M1,0 L0,1 M0,0 L1,1"},"\u257C":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u257D":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"\u257E":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u257F":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u250D":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"\u250E":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2511":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"\u2512":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"\u2515":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"\u2516":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u2519":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"\u251A":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"\u251D":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"\u251E":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u251F":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2520":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"\u2521":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"\u2522":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"\u2525":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"\u2526":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u2527":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"\u2528":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"\u2529":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"\u252A":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"\u252D":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u252E":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"\u252F":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"\u2530":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2531":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"\u2532":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"\u2535":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u2536":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u2537":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"\u2538":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u2539":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"\u253A":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"\u253D":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u253E":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u253F":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"\u2540":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u2541":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2542":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"\u2543":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"\u2544":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"\u2545":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"\u2546":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"\u2547":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"\u2548":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2549":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u254A":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u254C":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"\u254D":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"\u2504":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"\u2505":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"\u2508":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"\u2509":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"\u254E":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"\u254F":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"\u2506":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"\u2507":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"\u250A":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"\u250B":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"\u256D":{1:(l,r)=>`M.5,1 L.5,${.5+r/.15*.5} C.5,${.5+r/.15*.5},.5,.5,1,.5`},"\u256E":{1:(l,r)=>`M.5,1 L.5,${.5+r/.15*.5} C.5,${.5+r/.15*.5},.5,.5,0,.5`},"\u256F":{1:(l,r)=>`M.5,0 L.5,${.5-r/.15*.5} C.5,${.5-r/.15*.5},.5,.5,0,.5`},"\u2570":{1:(l,r)=>`M.5,0 L.5,${.5-r/.15*.5} C.5,${.5-r/.15*.5},.5,.5,1,.5`}},n.powerlineDefinitions={"\uE0B0":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"\uE0B1":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0B2":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"\uE0B3":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0B4":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"\uE0B5":{d:"M.2,1 C.422,1,.8,.826,.78,.5 C.8,.174,0.422,0,.2,0",type:1,rightPadding:1},"\uE0B6":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"\uE0B7":{d:"M.8,1 C0.578,1,0.2,.826,.22,.5 C0.2,0.174,0.578,0,0.8,0",type:1,leftPadding:1},"\uE0B8":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"\uE0B9":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0BA":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"\uE0BC":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"\uE0BD":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0BE":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},n.powerlineDefinitions["\uE0BB"]=n.powerlineDefinitions["\uE0BD"],n.powerlineDefinitions["\uE0BF"]=n.powerlineDefinitions["\uE0B9"],n.tryDrawCustomChar=function(l,r,o,c,_,D,C,b){let S=n.blockElementDefinitions[r];if(S)return function(T,w,A,I,R,P){for(let W=0;W<w.length;W++){let E=w[W],L=R/8,x=P/8;T.fillRect(A+E.x*L,I+E.y*x,E.w*L,E.h*x)}}(l,S,o,c,_,D),!0;let v=s[r];if(v)return function(T,w,A,I,R,P){let W=i.get(w);W||(W=new Map,i.set(w,W));let E=T.fillStyle;if(typeof E!="string")throw new Error(`Unexpected fillStyle type "${E}"`);let L=W.get(E);if(!L){let x=w[0].length,O=w.length,U=document.createElement("canvas");U.width=x,U.height=O;let Y=(0,f.throwIfFalsy)(U.getContext("2d")),ae=new ImageData(x,O),z,fe,F,N;if(E.startsWith("#"))z=parseInt(E.slice(1,3),16),fe=parseInt(E.slice(3,5),16),F=parseInt(E.slice(5,7),16),N=E.length>7&&parseInt(E.slice(7,9),16)||1;else{if(!E.startsWith("rgba"))throw new Error(`Unexpected fillStyle color format "${E}" when drawing pattern glyph`);[z,fe,F,N]=E.substring(5,E.length-1).split(",").map(B=>parseFloat(B))}for(let B=0;B<O;B++)for(let H=0;H<x;H++)ae.data[4*(B*x+H)]=z,ae.data[4*(B*x+H)+1]=fe,ae.data[4*(B*x+H)+2]=F,ae.data[4*(B*x+H)+3]=w[B][H]*(255*N);Y.putImageData(ae,0,0),L=(0,f.throwIfFalsy)(T.createPattern(U,null)),W.set(E,L)}T.fillStyle=L,T.fillRect(A,I,R,P)}(l,v,o,c,_,D),!0;let y=n.boxDrawingDefinitions[r];if(y)return function(T,w,A,I,R,P,W){T.strokeStyle=T.fillStyle;for(let[E,L]of Object.entries(w)){let x;T.beginPath(),T.lineWidth=W*Number.parseInt(E),x=typeof L=="function"?L(.15,.15/P*R):L;for(let O of x.split(" ")){let U=O[0],Y=m[U];if(!Y){console.error(`Could not find drawing instructions for "${U}"`);continue}let ae=O.substring(1).split(",");ae[0]&&ae[1]&&Y(T,h(ae,R,P,A,I,!0,W))}T.stroke(),T.closePath()}}(l,y,o,c,_,D,b),!0;let M=n.powerlineDefinitions[r];return!!M&&(function(T,w,A,I,R,P,W,E){var L,x;let O=new Path2D;O.rect(A,I,R,P),T.clip(O),T.beginPath();let U=W/12;T.lineWidth=E*U;for(let Y of w.d.split(" ")){let ae=Y[0],z=m[ae];if(!z){console.error(`Could not find drawing instructions for "${ae}"`);continue}let fe=Y.substring(1).split(",");fe[0]&&fe[1]&&z(T,h(fe,R,P,A,I,!1,E,((L=w.leftPadding)!==null&&L!==void 0?L:0)*(U/2),((x=w.rightPadding)!==null&&x!==void 0?x:0)*(U/2)))}w.type===1?(T.strokeStyle=T.fillStyle,T.stroke()):T.fill(),T.closePath()}(l,M,o,c,_,D,C,b),!0)};let i=new Map;function p(l,r,o=0){return Math.max(Math.min(l,r),o)}let m={C:(l,r)=>l.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]),L:(l,r)=>l.lineTo(r[0],r[1]),M:(l,r)=>l.moveTo(r[0],r[1])};function h(l,r,o,c,_,D,C,b=0,S=0){let v=l.map(y=>parseFloat(y)||parseInt(y));if(v.length<2)throw new Error("Too few arguments for instruction");for(let y=0;y<v.length;y+=2)v[y]*=r-b*C-S*C,D&&v[y]!==0&&(v[y]=p(Math.round(v[y]+.5)-.5,r,0)),v[y]+=c+b*C;for(let y=1;y<v.length;y+=2)v[y]*=o,D&&v[y]!==0&&(v[y]=p(Math.round(v[y]+.5)-.5,o,0)),v[y]+=_;return v}},56:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.observeDevicePixelDimensions=void 0;let f=u(859);n.observeDevicePixelDimensions=function(s,i,p){let m=new i.ResizeObserver(h=>{let l=h.find(c=>c.target===s);if(!l)return;if(!("devicePixelContentBoxSize"in l))return m?.disconnect(),void(m=void 0);let r=l.devicePixelContentBoxSize[0].inlineSize,o=l.devicePixelContentBoxSize[0].blockSize;r>0&&o>0&&p(r,o)});try{m.observe(s,{box:["device-pixel-content-box"]})}catch{m.disconnect(),m=void 0}return(0,f.toDisposable)(()=>m?.disconnect())}},374:(g,n)=>{function u(f){return 57508<=f&&f<=57558}Object.defineProperty(n,"__esModule",{value:!0}),n.createRenderDimensions=n.excludeFromContrastRatioDemands=n.isRestrictedPowerlineGlyph=n.isPowerlineGlyph=n.throwIfFalsy=void 0,n.throwIfFalsy=function(f){if(!f)throw new Error("value must not be falsy");return f},n.isPowerlineGlyph=u,n.isRestrictedPowerlineGlyph=function(f){return 57520<=f&&f<=57527},n.excludeFromContrastRatioDemands=function(f){return u(f)||function(s){return 9472<=s&&s<=9631}(f)},n.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},296:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createSelectionRenderModel=void 0;class u{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(s,i,p,m=!1){if(this.selectionStart=i,this.selectionEnd=p,!i||!p||i[0]===p[0]&&i[1]===p[1])return void this.clear();let h=i[1]-s.buffer.active.viewportY,l=p[1]-s.buffer.active.viewportY,r=Math.max(h,0),o=Math.min(l,s.rows-1);r>=s.rows||o<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=m,this.viewportStartRow=h,this.viewportEndRow=l,this.viewportCappedStartRow=r,this.viewportCappedEndRow=o,this.startCol=i[0],this.endCol=p[0])}isCellSelected(s,i,p){return!!this.hasSelection&&(p-=s.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?i>=this.startCol&&p>=this.viewportCappedStartRow&&i<this.endCol&&p<=this.viewportCappedEndRow:i<this.startCol&&p>=this.viewportCappedStartRow&&i>=this.endCol&&p<=this.viewportCappedEndRow:p>this.viewportStartRow&&p<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&p===this.viewportStartRow&&i>=this.startCol&&i<this.endCol||this.viewportStartRow<this.viewportEndRow&&p===this.viewportEndRow&&i<this.endCol||this.viewportStartRow<this.viewportEndRow&&p===this.viewportStartRow&&i>=this.startCol)}}n.createSelectionRenderModel=function(){return new u}},509:function(g,n,u){var f=this&&this.__decorate||function(M,T,w,A){var I,R=arguments.length,P=R<3?T:A===null?A=Object.getOwnPropertyDescriptor(T,w):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(M,T,w,A);else for(var W=M.length-1;W>=0;W--)(I=M[W])&&(P=(R<3?I(P):R>3?I(T,w,P):I(T,w))||P);return R>3&&P&&Object.defineProperty(T,w,P),P};Object.defineProperty(n,"__esModule",{value:!0}),n.TextureAtlas=void 0;let s=u(237),i=u(860),p=u(374),m=u(160),h=u(345),l=u(485),r=u(385),o=u(147),c=u(855),_=u(776),D={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}},C;class b{get pages(){return this._pages}constructor(T,w,A){this._document=T,this._config=w,this._unicodeService=A,this._didWarmUp=!1,this._cacheMap=new l.FourKeyMap,this._cacheMapCombined=new l.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new o.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new h.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new h.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=y(T,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,p.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}dispose(){for(let T of this.pages)T.canvas.remove();this._onAddTextureAtlasCanvas.dispose()}warmUp(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}_doWarmUp(){let T=new r.IdleTaskQueue;for(let w=33;w<126;w++)T.enqueue(()=>{if(!this._cacheMap.get(w,c.DEFAULT_COLOR,c.DEFAULT_COLOR,c.DEFAULT_EXT)){let A=this._drawToCache(w,c.DEFAULT_COLOR,c.DEFAULT_COLOR,c.DEFAULT_EXT);this._cacheMap.set(w,c.DEFAULT_COLOR,c.DEFAULT_COLOR,c.DEFAULT_EXT,A)}})}beginFrame(){return this._requestClearModel}clearTexture(){if(this._pages[0].currentRow.x!==0||this._pages[0].currentRow.y!==0){for(let T of this._pages)T.clear();this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}_createNewPage(){if(b.maxAtlasPages&&this._pages.length>=Math.max(4,b.maxAtlasPages)){let w=this._pages.filter(L=>2*L.canvas.width<=(b.maxTextureSize||4096)).sort((L,x)=>x.canvas.width!==L.canvas.width?x.canvas.width-L.canvas.width:x.percentageUsed-L.percentageUsed),A=-1,I=0;for(let L=0;L<w.length;L++)if(w[L].canvas.width!==I)A=L,I=w[L].canvas.width;else if(L-A==3)break;let R=w.slice(A,A+4),P=R.map(L=>L.glyphs[0].texturePage).sort((L,x)=>L>x?1:-1),W=this.pages.length-R.length,E=this._mergePages(R,W);E.version++;for(let L=P.length-1;L>=0;L--)this._deletePage(P[L]);this.pages.push(E),this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(E.canvas)}let T=new S(this._document,this._textureSize);return this._pages.push(T),this._activePages.push(T),this._onAddTextureAtlasCanvas.fire(T.canvas),T}_mergePages(T,w){let A=2*T[0].canvas.width,I=new S(this._document,A,T);for(let[R,P]of T.entries()){let W=R*P.canvas.width%A,E=Math.floor(R/2)*P.canvas.height;I.ctx.drawImage(P.canvas,W,E);for(let x of P.glyphs)x.texturePage=w,x.sizeClipSpace.x=x.size.x/A,x.sizeClipSpace.y=x.size.y/A,x.texturePosition.x+=W,x.texturePosition.y+=E,x.texturePositionClipSpace.x=x.texturePosition.x/A,x.texturePositionClipSpace.y=x.texturePosition.y/A;this._onRemoveTextureAtlasCanvas.fire(P.canvas);let L=this._activePages.indexOf(P);L!==-1&&this._activePages.splice(L,1)}return I}_deletePage(T){this._pages.splice(T,1);for(let w=T;w<this._pages.length;w++){let A=this._pages[w];for(let I of A.glyphs)I.texturePage--;A.version++}}getRasterizedGlyphCombinedChar(T,w,A,I,R){return this._getFromCacheMap(this._cacheMapCombined,T,w,A,I,R)}getRasterizedGlyph(T,w,A,I,R){return this._getFromCacheMap(this._cacheMap,T,w,A,I,R)}_getFromCacheMap(T,w,A,I,R,P=!1){return C=T.get(w,A,I,R),C||(C=this._drawToCache(w,A,I,R,P),T.set(w,A,I,R,C)),C}_getColorFromAnsiIndex(T){if(T>=this._config.colors.ansi.length)throw new Error("No color found for idx "+T);return this._config.colors.ansi[T]}_getBackgroundColor(T,w,A,I){if(this._config.allowTransparency)return m.NULL_COLOR;let R;switch(T){case 16777216:case 33554432:R=this._getColorFromAnsiIndex(w);break;case 50331648:let P=o.AttributeData.toColorRGB(w);R=m.rgba.toColor(P[0],P[1],P[2]);break;default:R=A?m.color.opaque(this._config.colors.foreground):this._config.colors.background}return R}_getForegroundColor(T,w,A,I,R,P,W,E,L,x){let O=this._getMinimumContrastColor(T,w,A,I,R,P,!1,L,E,x);if(O)return O;let U;switch(R){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&L&&P<8&&(P+=8),U=this._getColorFromAnsiIndex(P);break;case 50331648:let Y=o.AttributeData.toColorRGB(P);U=m.rgba.toColor(Y[0],Y[1],Y[2]);break;default:U=W?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(U=m.color.opaque(U)),E&&(U=m.color.multiplyOpacity(U,s.DIM_OPACITY)),U}_resolveBackgroundRgba(T,w,A){switch(T){case 16777216:case 33554432:return this._getColorFromAnsiIndex(w).rgba;case 50331648:return w<<8;default:return A?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}_resolveForegroundRgba(T,w,A,I){switch(T){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&I&&w<8&&(w+=8),this._getColorFromAnsiIndex(w).rgba;case 50331648:return w<<8;default:return A?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}_getMinimumContrastColor(T,w,A,I,R,P,W,E,L,x){if(this._config.minimumContrastRatio===1||x)return;let O=this._getContrastCache(L),U=O.getColor(T,I);if(U!==void 0)return U||void 0;let Y=this._resolveBackgroundRgba(w,A,W),ae=this._resolveForegroundRgba(R,P,W,E),z=m.rgba.ensureContrastRatio(Y,ae,this._config.minimumContrastRatio/(L?2:1));if(!z)return void O.setColor(T,I,null);let fe=m.rgba.toColor(z>>24&255,z>>16&255,z>>8&255);return O.setColor(T,I,fe),fe}_getContrastCache(T){return T?this._config.colors.halfContrastCache:this._config.colors.contrastCache}_drawToCache(T,w,A,I,R=!1){let P=typeof T=="number"?String.fromCharCode(T):T,W=Math.min(this._config.deviceCellWidth*Math.max(P.length,2)+4,this._textureSize);this._tmpCanvas.width<W&&(this._tmpCanvas.width=W);let E=Math.min(this._config.deviceCellHeight+8,this._textureSize);if(this._tmpCanvas.height<E&&(this._tmpCanvas.height=E),this._tmpCtx.save(),this._workAttributeData.fg=A,this._workAttributeData.bg=w,this._workAttributeData.extended.ext=I,this._workAttributeData.isInvisible())return D;let L=!!this._workAttributeData.isBold(),x=!!this._workAttributeData.isInverse(),O=!!this._workAttributeData.isDim(),U=!!this._workAttributeData.isItalic(),Y=!!this._workAttributeData.isUnderline(),ae=!!this._workAttributeData.isStrikethrough(),z=!!this._workAttributeData.isOverline(),fe=this._workAttributeData.getFgColor(),F=this._workAttributeData.getFgColorMode(),N=this._workAttributeData.getBgColor(),B=this._workAttributeData.getBgColorMode();if(x){let K=fe;fe=N,N=K;let me=F;F=B,B=me}let H=this._getBackgroundColor(B,N,x,O);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=H.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";let le=L?this._config.fontWeightBold:this._config.fontWeight,j=U?"italic":"";this._tmpCtx.font=`${j} ${le} ${this._config.fontSize*this._config.devicePixelRatio}px ${this._config.fontFamily}`,this._tmpCtx.textBaseline=s.TEXT_BASELINE;let Le=P.length===1&&(0,p.isPowerlineGlyph)(P.charCodeAt(0)),rt=P.length===1&&(0,p.isRestrictedPowerlineGlyph)(P.charCodeAt(0)),Be=this._getForegroundColor(w,B,N,A,F,fe,x,O,L,(0,p.excludeFromContrastRatioDemands)(P.charCodeAt(0)));this._tmpCtx.fillStyle=Be.css;let Re=rt?0:4,qe=!1;this._config.customGlyphs!==!1&&(qe=(0,i.tryDrawCustomChar)(this._tmpCtx,P,Re,Re,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));let Ot,sr=!Le;if(Ot=typeof T=="number"?this._unicodeService.wcwidth(T):this._unicodeService.getStringCellWidth(T),Y){this._tmpCtx.save();let K=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),me=K%2==1?.5:0;if(this._tmpCtx.lineWidth=K,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())sr=!1,this._tmpCtx.strokeStyle=`rgb(${o.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(",")})`;else{sr=!1;let rr=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&rr<8&&(rr+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(rr).css}this._tmpCtx.beginPath();let $e=Re,ze=Math.ceil(Re+this._config.deviceCharHeight)-me-(R?2*K:0),St=ze+K,er=ze+2*K;for(let rr=0;rr<Ot;rr++){this._tmpCtx.save();let nt=$e+rr*this._config.deviceCellWidth,un=$e+(rr+1)*this._config.deviceCellWidth,E_=nt+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(nt,ze),this._tmpCtx.lineTo(un,ze),this._tmpCtx.moveTo(nt,er),this._tmpCtx.lineTo(un,er);break;case 3:let Ss=K<=1?er:Math.ceil(Re+this._config.deviceCharHeight-K/2)-me,Ts=K<=1?ze:Math.ceil(Re+this._config.deviceCharHeight+K/2)-me,lh=new Path2D;lh.rect(nt,ze,this._config.deviceCellWidth,er-ze),this._tmpCtx.clip(lh),this._tmpCtx.moveTo(nt-this._config.deviceCellWidth/2,St),this._tmpCtx.bezierCurveTo(nt-this._config.deviceCellWidth/2,Ts,nt,Ts,nt,St),this._tmpCtx.bezierCurveTo(nt,Ss,E_,Ss,E_,St),this._tmpCtx.bezierCurveTo(E_,Ts,un,Ts,un,St),this._tmpCtx.bezierCurveTo(un,Ss,un+this._config.deviceCellWidth/2,Ss,un+this._config.deviceCellWidth/2,St);break;case 4:this._tmpCtx.setLineDash([Math.round(K),Math.round(K)]),this._tmpCtx.moveTo(nt,ze),this._tmpCtx.lineTo(un,ze);break;case 5:this._tmpCtx.setLineDash([4*this._config.devicePixelRatio,3*this._config.devicePixelRatio]),this._tmpCtx.moveTo(nt,ze),this._tmpCtx.lineTo(un,ze);break;default:this._tmpCtx.moveTo(nt,ze),this._tmpCtx.lineTo(un,ze)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!qe&&this._config.fontSize>=12&&!this._config.allowTransparency&&P!==" "){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";let rr=this._tmpCtx.measureText(P);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in rr&&rr.actualBoundingBoxDescent>0){this._tmpCtx.save();let nt=new Path2D;nt.rect($e,ze-Math.ceil(K/2),this._config.deviceCellWidth*Ot,er-ze+Math.ceil(K/2)),this._tmpCtx.clip(nt),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=H.css,this._tmpCtx.strokeText(P,Re,Re+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(z){let K=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),me=K%2==1?.5:0;this._tmpCtx.lineWidth=K,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(Re,Re+me),this._tmpCtx.lineTo(Re+this._config.deviceCharWidth*Ot,Re+me),this._tmpCtx.stroke()}if(qe||this._tmpCtx.fillText(P,Re,Re+this._config.deviceCharHeight),P==="_"&&!this._config.allowTransparency){let K=v(this._tmpCtx.getImageData(Re,Re,this._config.deviceCellWidth,this._config.deviceCellHeight),H,Be,sr);if(K)for(let me=1;me<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=H.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(P,Re,Re+this._config.deviceCharHeight-me),K=v(this._tmpCtx.getImageData(Re,Re,this._config.deviceCellWidth,this._config.deviceCellHeight),H,Be,sr),K);me++);}if(ae){let K=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),me=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=K,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(Re,Re+Math.floor(this._config.deviceCharHeight/2)-me),this._tmpCtx.lineTo(Re+this._config.deviceCharWidth*Ot,Re+Math.floor(this._config.deviceCharHeight/2)-me),this._tmpCtx.stroke()}this._tmpCtx.restore();let dr=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height),dt;if(dt=this._config.allowTransparency?function(K){for(let me=0;me<K.data.length;me+=4)if(K.data[me+3]>0)return!1;return!0}(dr):v(dr,H,Be,sr),dt)return D;let ue=this._findGlyphBoundingBox(dr,this._workBoundingBox,W,rt,qe,Re),ie,re;for(;;){if(this._activePages.length===0){let K=this._createNewPage();ie=K,re=K.currentRow,re.height=ue.size.y;break}ie=this._activePages[this._activePages.length-1],re=ie.currentRow;for(let K of this._activePages)ue.size.y<=K.currentRow.height&&(ie=K,re=K.currentRow);for(let K=this._activePages.length-1;K>=0;K--)for(let me of this._activePages[K].fixedRows)me.height<=re.height&&ue.size.y<=me.height&&(ie=this._activePages[K],re=me);if(re.y+ue.size.y>=ie.canvas.height||re.height>ue.size.y+2){let K=!1;if(ie.currentRow.y+ie.currentRow.height+ue.size.y>=ie.canvas.height){let me;for(let $e of this._activePages)if($e.currentRow.y+$e.currentRow.height+ue.size.y<$e.canvas.height){me=$e;break}if(me)ie=me;else if(b.maxAtlasPages&&this._pages.length>=b.maxAtlasPages&&re.y+ue.size.y<=ie.canvas.height&&re.height>=ue.size.y&&re.x+ue.size.x<=ie.canvas.width)K=!0;else{let $e=this._createNewPage();ie=$e,re=$e.currentRow,re.height=ue.size.y,K=!0}}K||(ie.currentRow.height>0&&ie.fixedRows.push(ie.currentRow),re={x:0,y:ie.currentRow.y+ie.currentRow.height,height:ue.size.y},ie.fixedRows.push(re),ie.currentRow={x:0,y:re.y+re.height,height:0})}if(re.x+ue.size.x<=ie.canvas.width)break;re===ie.currentRow?(re.x=0,re.y+=re.height,re.height=0):ie.fixedRows.splice(ie.fixedRows.indexOf(re),1)}return ue.texturePage=this._pages.indexOf(ie),ue.texturePosition.x=re.x,ue.texturePosition.y=re.y,ue.texturePositionClipSpace.x=re.x/ie.canvas.width,ue.texturePositionClipSpace.y=re.y/ie.canvas.height,ue.sizeClipSpace.x/=ie.canvas.width,ue.sizeClipSpace.y/=ie.canvas.height,re.height=Math.max(re.height,ue.size.y),re.x+=ue.size.x,ie.ctx.putImageData(dr,ue.texturePosition.x-this._workBoundingBox.left,ue.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,ue.size.x,ue.size.y),ie.addGlyph(ue),ie.version++,ue}_findGlyphBoundingBox(T,w,A,I,R,P){w.top=0;let W=I?this._config.deviceCellHeight:this._tmpCanvas.height,E=I?this._config.deviceCellWidth:A,L=!1;for(let x=0;x<W;x++){for(let O=0;O<E;O++){let U=x*this._tmpCanvas.width*4+4*O+3;if(T.data[U]!==0){w.top=x,L=!0;break}}if(L)break}w.left=0,L=!1;for(let x=0;x<P+E;x++){for(let O=0;O<W;O++){let U=O*this._tmpCanvas.width*4+4*x+3;if(T.data[U]!==0){w.left=x,L=!0;break}}if(L)break}w.right=E,L=!1;for(let x=P+E-1;x>=P;x--){for(let O=0;O<W;O++){let U=O*this._tmpCanvas.width*4+4*x+3;if(T.data[U]!==0){w.right=x,L=!0;break}}if(L)break}w.bottom=W,L=!1;for(let x=W-1;x>=0;x--){for(let O=0;O<E;O++){let U=x*this._tmpCanvas.width*4+4*O+3;if(T.data[U]!==0){w.bottom=x,L=!0;break}}if(L)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:w.right-w.left+1,y:w.bottom-w.top+1},sizeClipSpace:{x:w.right-w.left+1,y:w.bottom-w.top+1},offset:{x:-w.left+P+(I||R?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-w.top+P+(I||R?this._config.lineHeight===1?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}n.TextureAtlas=b,f([_.traceCall],b.prototype,"_drawToCache",null);class S{get percentageUsed(){return this._usedPixels/(this.canvas.width*this.canvas.height)}get glyphs(){return this._glyphs}addGlyph(T){this._glyphs.push(T),this._usedPixels+=T.size.x*T.size.y}constructor(T,w,A){if(this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],A)for(let I of A)this._glyphs.push(...I.glyphs),this._usedPixels+=I._usedPixels;this.canvas=y(T,w,w),this.ctx=(0,p.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}function v(M,T,w,A){let I=T.rgba>>>24,R=T.rgba>>>16&255,P=T.rgba>>>8&255,W=w.rgba>>>24,E=w.rgba>>>16&255,L=w.rgba>>>8&255,x=Math.floor((Math.abs(I-W)+Math.abs(R-E)+Math.abs(P-L))/12),O=!0;for(let U=0;U<M.data.length;U+=4)M.data[U]===I&&M.data[U+1]===R&&M.data[U+2]===P||A&&Math.abs(M.data[U]-I)+Math.abs(M.data[U+1]-R)+Math.abs(M.data[U+2]-P)<x?M.data[U+3]=0:O=!1;return O}function y(M,T,w){let A=M.createElement("canvas");return A.width=T,A.height=w,A}},160:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.contrastRatio=n.toPaddedHex=n.rgba=n.rgb=n.css=n.color=n.channels=n.NULL_COLOR=void 0;let f=u(399),s=0,i=0,p=0,m=0;var h,l,r,o,c;function _(C){let b=C.toString(16);return b.length<2?"0"+b:b}function D(C,b){return C<b?(b+.05)/(C+.05):(C+.05)/(b+.05)}n.NULL_COLOR={css:"#00000000",rgba:0},function(C){C.toCss=function(b,S,v,y){return y!==void 0?`#${_(b)}${_(S)}${_(v)}${_(y)}`:`#${_(b)}${_(S)}${_(v)}`},C.toRgba=function(b,S,v,y=255){return(b<<24|S<<16|v<<8|y)>>>0}}(h||(n.channels=h={})),function(C){function b(S,v){return m=Math.round(255*v),[s,i,p]=c.toChannels(S.rgba),{css:h.toCss(s,i,p,m),rgba:h.toRgba(s,i,p,m)}}C.blend=function(S,v){if(m=(255&v.rgba)/255,m===1)return{css:v.css,rgba:v.rgba};let y=v.rgba>>24&255,M=v.rgba>>16&255,T=v.rgba>>8&255,w=S.rgba>>24&255,A=S.rgba>>16&255,I=S.rgba>>8&255;return s=w+Math.round((y-w)*m),i=A+Math.round((M-A)*m),p=I+Math.round((T-I)*m),{css:h.toCss(s,i,p),rgba:h.toRgba(s,i,p)}},C.isOpaque=function(S){return(255&S.rgba)==255},C.ensureContrastRatio=function(S,v,y){let M=c.ensureContrastRatio(S.rgba,v.rgba,y);if(M)return c.toColor(M>>24&255,M>>16&255,M>>8&255)},C.opaque=function(S){let v=(255|S.rgba)>>>0;return[s,i,p]=c.toChannels(v),{css:h.toCss(s,i,p),rgba:v}},C.opacity=b,C.multiplyOpacity=function(S,v){return m=255&S.rgba,b(S,m*v/255)},C.toColorRGB=function(S){return[S.rgba>>24&255,S.rgba>>16&255,S.rgba>>8&255]}}(l||(n.color=l={})),function(C){let b,S;if(!f.isNode){let v=document.createElement("canvas");v.width=1,v.height=1;let y=v.getContext("2d",{willReadFrequently:!0});y&&(b=y,b.globalCompositeOperation="copy",S=b.createLinearGradient(0,0,1,1))}C.toColor=function(v){if(v.match(/#[\da-f]{3,8}/i))switch(v.length){case 4:return s=parseInt(v.slice(1,2).repeat(2),16),i=parseInt(v.slice(2,3).repeat(2),16),p=parseInt(v.slice(3,4).repeat(2),16),c.toColor(s,i,p);case 5:return s=parseInt(v.slice(1,2).repeat(2),16),i=parseInt(v.slice(2,3).repeat(2),16),p=parseInt(v.slice(3,4).repeat(2),16),m=parseInt(v.slice(4,5).repeat(2),16),c.toColor(s,i,p,m);case 7:return{css:v,rgba:(parseInt(v.slice(1),16)<<8|255)>>>0};case 9:return{css:v,rgba:parseInt(v.slice(1),16)>>>0}}let y=v.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(y)return s=parseInt(y[1]),i=parseInt(y[2]),p=parseInt(y[3]),m=Math.round(255*(y[5]===void 0?1:parseFloat(y[5]))),c.toColor(s,i,p,m);if(!b||!S)throw new Error("css.toColor: Unsupported css format");if(b.fillStyle=S,b.fillStyle=v,typeof b.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(b.fillRect(0,0,1,1),[s,i,p,m]=b.getImageData(0,0,1,1).data,m!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:h.toRgba(s,i,p,m),css:v}}}(r||(n.css=r={})),function(C){function b(S,v,y){let M=S/255,T=v/255,w=y/255;return .2126*(M<=.03928?M/12.92:Math.pow((M+.055)/1.055,2.4))+.7152*(T<=.03928?T/12.92:Math.pow((T+.055)/1.055,2.4))+.0722*(w<=.03928?w/12.92:Math.pow((w+.055)/1.055,2.4))}C.relativeLuminance=function(S){return b(S>>16&255,S>>8&255,255&S)},C.relativeLuminance2=b}(o||(n.rgb=o={})),function(C){function b(v,y,M){let T=v>>24&255,w=v>>16&255,A=v>>8&255,I=y>>24&255,R=y>>16&255,P=y>>8&255,W=D(o.relativeLuminance2(I,R,P),o.relativeLuminance2(T,w,A));for(;W<M&&(I>0||R>0||P>0);)I-=Math.max(0,Math.ceil(.1*I)),R-=Math.max(0,Math.ceil(.1*R)),P-=Math.max(0,Math.ceil(.1*P)),W=D(o.relativeLuminance2(I,R,P),o.relativeLuminance2(T,w,A));return(I<<24|R<<16|P<<8|255)>>>0}function S(v,y,M){let T=v>>24&255,w=v>>16&255,A=v>>8&255,I=y>>24&255,R=y>>16&255,P=y>>8&255,W=D(o.relativeLuminance2(I,R,P),o.relativeLuminance2(T,w,A));for(;W<M&&(I<255||R<255||P<255);)I=Math.min(255,I+Math.ceil(.1*(255-I))),R=Math.min(255,R+Math.ceil(.1*(255-R))),P=Math.min(255,P+Math.ceil(.1*(255-P))),W=D(o.relativeLuminance2(I,R,P),o.relativeLuminance2(T,w,A));return(I<<24|R<<16|P<<8|255)>>>0}C.ensureContrastRatio=function(v,y,M){let T=o.relativeLuminance(v>>8),w=o.relativeLuminance(y>>8);if(D(T,w)<M){if(w<T){let R=b(v,y,M),P=D(T,o.relativeLuminance(R>>8));if(P<M){let W=S(v,y,M);return P>D(T,o.relativeLuminance(W>>8))?R:W}return R}let A=S(v,y,M),I=D(T,o.relativeLuminance(A>>8));if(I<M){let R=b(v,y,M);return I>D(T,o.relativeLuminance(R>>8))?A:R}return A}},C.reduceLuminance=b,C.increaseLuminance=S,C.toChannels=function(v){return[v>>24&255,v>>16&255,v>>8&255,255&v]},C.toColor=function(v,y,M,T){return{css:h.toCss(v,y,M,T),rgba:h.toRgba(v,y,M,T)}}}(c||(n.rgba=c={})),n.toPaddedHex=_,n.contrastRatio=D},345:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.forwardEvent=n.EventEmitter=void 0,n.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=u=>(this._listeners.push(u),{dispose:()=>{if(!this._disposed){for(let f=0;f<this._listeners.length;f++)if(this._listeners[f]===u)return void this._listeners.splice(f,1)}}})),this._event}fire(u,f){let s=[];for(let i=0;i<this._listeners.length;i++)s.push(this._listeners[i]);for(let i=0;i<s.length;i++)s[i].call(void 0,u,f)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},n.forwardEvent=function(u,f){return u(s=>f.fire(s))}},859:(g,n)=>{function u(f){for(let s of f)s.dispose();f.length=0}Object.defineProperty(n,"__esModule",{value:!0}),n.getDisposeArrayDisposable=n.disposeArray=n.toDisposable=n.MutableDisposable=n.Disposable=void 0,n.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let f of this._disposables)f.dispose();this._disposables.length=0}register(f){return this._disposables.push(f),f}unregister(f){let s=this._disposables.indexOf(f);s!==-1&&this._disposables.splice(s,1)}},n.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(f){var s;this._isDisposed||f===this._value||((s=this._value)===null||s===void 0||s.dispose(),this._value=f)}clear(){this.value=void 0}dispose(){var f;this._isDisposed=!0,(f=this._value)===null||f===void 0||f.dispose(),this._value=void 0}},n.toDisposable=function(f){return{dispose:f}},n.disposeArray=u,n.getDisposeArrayDisposable=function(f){return{dispose:()=>u(f)}}},485:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FourKeyMap=n.TwoKeyMap=void 0;class u{constructor(){this._data={}}set(s,i,p){this._data[s]||(this._data[s]={}),this._data[s][i]=p}get(s,i){return this._data[s]?this._data[s][i]:void 0}clear(){this._data={}}}n.TwoKeyMap=u,n.FourKeyMap=class{constructor(){this._data=new u}set(f,s,i,p,m){this._data.get(f,s)||this._data.set(f,s,new u),this._data.get(f,s).set(i,p,m)}get(f,s,i,p){var m;return(m=this._data.get(f,s))===null||m===void 0?void 0:m.get(i,p)}clear(){this._data.clear()}}},399:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isChromeOS=n.isLinux=n.isWindows=n.isIphone=n.isIpad=n.isMac=n.getSafariVersion=n.isSafari=n.isLegacyEdge=n.isFirefox=n.isNode=void 0,n.isNode=typeof navigator>"u";let u=n.isNode?"node":navigator.userAgent,f=n.isNode?"node":navigator.platform;n.isFirefox=u.includes("Firefox"),n.isLegacyEdge=u.includes("Edge"),n.isSafari=/^((?!chrome|android).)*safari/i.test(u),n.getSafariVersion=function(){if(!n.isSafari)return 0;let s=u.match(/Version\/(\d+)/);return s===null||s.length<2?0:parseInt(s[1])},n.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(f),n.isIpad=f==="iPad",n.isIphone=f==="iPhone",n.isWindows=["Windows","Win16","Win32","WinCE"].includes(f),n.isLinux=f.indexOf("Linux")>=0,n.isChromeOS=/\bCrOS\b/.test(u)},385:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DebouncedIdleTask=n.IdleTaskQueue=n.PriorityTaskQueue=void 0;let f=u(399);class s{constructor(){this._tasks=[],this._i=0}enqueue(m){this._tasks.push(m),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(m){this._idleCallback=void 0;let h=0,l=0,r=m.timeRemaining(),o=0;for(;this._i<this._tasks.length;){if(h=Date.now(),this._tasks[this._i]()||this._i++,h=Math.max(1,Date.now()-h),l=Math.max(h,l),o=m.timeRemaining(),1.5*l>o)return r-h<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(r-h))}ms`),void this._start();r=o}this.clear()}}class i extends s{_requestCallback(m){return setTimeout(()=>m(this._createDeadline(16)))}_cancelCallback(m){clearTimeout(m)}_createDeadline(m){let h=Date.now()+m;return{timeRemaining:()=>Math.max(0,h-Date.now())}}}n.PriorityTaskQueue=i,n.IdleTaskQueue=!f.isNode&&"requestIdleCallback"in window?class extends s{_requestCallback(p){return requestIdleCallback(p)}_cancelCallback(p){cancelIdleCallback(p)}}:i,n.DebouncedIdleTask=class{constructor(){this._queue=new n.IdleTaskQueue}set(p){this._queue.clear(),this._queue.enqueue(p)}flush(){this._queue.flush()}}},147:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ExtendedAttrs=n.AttributeData=void 0;class u{constructor(){this.fg=0,this.bg=0,this.extended=new f}static toColorRGB(i){return[i>>>16&255,i>>>8&255,255&i]}static fromColorRGB(i){return(255&i[0])<<16|(255&i[1])<<8|255&i[2]}clone(){let i=new u;return i.fg=this.fg,i.bg=this.bg,i.extended=this.extended.clone(),i}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}n.AttributeData=u;class f{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(i){this._ext=i}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(i){this._ext&=-469762049,this._ext|=i<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(i){this._ext&=-67108864,this._ext|=67108863&i}get urlId(){return this._urlId}set urlId(i){this._urlId=i}constructor(i=0,p=0){this._ext=0,this._urlId=0,this._ext=i,this._urlId=p}clone(){return new f(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}n.ExtendedAttrs=f},782:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CellData=void 0;let f=u(133),s=u(855),i=u(147);class p extends i.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new i.ExtendedAttrs,this.combinedData=""}static fromCharData(h){let l=new p;return l.setFromCharData(h),l}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,f.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(h){this.fg=h[s.CHAR_DATA_ATTR_INDEX],this.bg=0;let l=!1;if(h[s.CHAR_DATA_CHAR_INDEX].length>2)l=!0;else if(h[s.CHAR_DATA_CHAR_INDEX].length===2){let r=h[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=r&&r<=56319){let o=h[s.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=o&&o<=57343?this.content=1024*(r-55296)+o-56320+65536|h[s.CHAR_DATA_WIDTH_INDEX]<<22:l=!0}else l=!0}else this.content=h[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|h[s.CHAR_DATA_WIDTH_INDEX]<<22;l&&(this.combinedData=h[s.CHAR_DATA_CHAR_INDEX],this.content=2097152|h[s.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}n.CellData=p},855:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WHITESPACE_CELL_CODE=n.WHITESPACE_CELL_WIDTH=n.WHITESPACE_CELL_CHAR=n.NULL_CELL_CODE=n.NULL_CELL_WIDTH=n.NULL_CELL_CHAR=n.CHAR_DATA_CODE_INDEX=n.CHAR_DATA_WIDTH_INDEX=n.CHAR_DATA_CHAR_INDEX=n.CHAR_DATA_ATTR_INDEX=n.DEFAULT_EXT=n.DEFAULT_ATTR=n.DEFAULT_COLOR=void 0,n.DEFAULT_COLOR=0,n.DEFAULT_ATTR=256|n.DEFAULT_COLOR<<9,n.DEFAULT_EXT=0,n.CHAR_DATA_ATTR_INDEX=0,n.CHAR_DATA_CHAR_INDEX=1,n.CHAR_DATA_WIDTH_INDEX=2,n.CHAR_DATA_CODE_INDEX=3,n.NULL_CELL_CHAR="",n.NULL_CELL_WIDTH=1,n.NULL_CELL_CODE=0,n.WHITESPACE_CELL_CHAR=" ",n.WHITESPACE_CELL_WIDTH=1,n.WHITESPACE_CELL_CODE=32},133:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Utf8ToUtf32=n.StringToUtf32=n.utf32ToString=n.stringFromCodePoint=void 0,n.stringFromCodePoint=function(u){return u>65535?(u-=65536,String.fromCharCode(55296+(u>>10))+String.fromCharCode(u%1024+56320)):String.fromCharCode(u)},n.utf32ToString=function(u,f=0,s=u.length){let i="";for(let p=f;p<s;++p){let m=u[p];m>65535?(m-=65536,i+=String.fromCharCode(55296+(m>>10))+String.fromCharCode(m%1024+56320)):i+=String.fromCharCode(m)}return i},n.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(u,f){let s=u.length;if(!s)return 0;let i=0,p=0;if(this._interim){let m=u.charCodeAt(p++);56320<=m&&m<=57343?f[i++]=1024*(this._interim-55296)+m-56320+65536:(f[i++]=this._interim,f[i++]=m),this._interim=0}for(let m=p;m<s;++m){let h=u.charCodeAt(m);if(55296<=h&&h<=56319){if(++m>=s)return this._interim=h,i;let l=u.charCodeAt(m);56320<=l&&l<=57343?f[i++]=1024*(h-55296)+l-56320+65536:(f[i++]=h,f[i++]=l)}else h!==65279&&(f[i++]=h)}return i}},n.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(u,f){let s=u.length;if(!s)return 0;let i,p,m,h,l=0,r=0,o=0;if(this.interim[0]){let D=!1,C=this.interim[0];C&=(224&C)==192?31:(240&C)==224?15:7;let b,S=0;for(;(b=63&this.interim[++S])&&S<4;)C<<=6,C|=b;let v=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,y=v-S;for(;o<y;){if(o>=s)return 0;if(b=u[o++],(192&b)!=128){o--,D=!0;break}this.interim[S++]=b,C<<=6,C|=63&b}D||(v===2?C<128?o--:f[l++]=C:v===3?C<2048||C>=55296&&C<=57343||C===65279||(f[l++]=C):C<65536||C>1114111||(f[l++]=C)),this.interim.fill(0)}let c=s-4,_=o;for(;_<s;){for(;!(!(_<c)||128&(i=u[_])||128&(p=u[_+1])||128&(m=u[_+2])||128&(h=u[_+3]));)f[l++]=i,f[l++]=p,f[l++]=m,f[l++]=h,_+=4;if(i=u[_++],i<128)f[l++]=i;else if((224&i)==192){if(_>=s)return this.interim[0]=i,l;if(p=u[_++],(192&p)!=128){_--;continue}if(r=(31&i)<<6|63&p,r<128){_--;continue}f[l++]=r}else if((240&i)==224){if(_>=s)return this.interim[0]=i,l;if(p=u[_++],(192&p)!=128){_--;continue}if(_>=s)return this.interim[0]=i,this.interim[1]=p,l;if(m=u[_++],(192&m)!=128){_--;continue}if(r=(15&i)<<12|(63&p)<<6|63&m,r<2048||r>=55296&&r<=57343||r===65279)continue;f[l++]=r}else if((248&i)==240){if(_>=s)return this.interim[0]=i,l;if(p=u[_++],(192&p)!=128){_--;continue}if(_>=s)return this.interim[0]=i,this.interim[1]=p,l;if(m=u[_++],(192&m)!=128){_--;continue}if(_>=s)return this.interim[0]=i,this.interim[1]=p,this.interim[2]=m,l;if(h=u[_++],(192&h)!=128){_--;continue}if(r=(7&i)<<18|(63&p)<<12|(63&m)<<6|63&h,r<65536||r>1114111)continue;f[l++]=r}}return l}}},776:function(g,n,u){var f=this&&this.__decorate||function(r,o,c,_){var D,C=arguments.length,b=C<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,c):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,o,c,_);else for(var S=r.length-1;S>=0;S--)(D=r[S])&&(b=(C<3?D(b):C>3?D(o,c,b):D(o,c))||b);return C>3&&b&&Object.defineProperty(o,c,b),b},s=this&&this.__param||function(r,o){return function(c,_){o(c,_,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.traceCall=n.setTraceLogger=n.LogService=void 0;let i=u(859),p=u(97),m={trace:p.LogLevelEnum.TRACE,debug:p.LogLevelEnum.DEBUG,info:p.LogLevelEnum.INFO,warn:p.LogLevelEnum.WARN,error:p.LogLevelEnum.ERROR,off:p.LogLevelEnum.OFF},h,l=n.LogService=class extends i.Disposable{get logLevel(){return this._logLevel}constructor(r){super(),this._optionsService=r,this._logLevel=p.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),h=this}_updateLogLevel(){this._logLevel=m[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(r){for(let o=0;o<r.length;o++)typeof r[o]=="function"&&(r[o]=r[o]())}_log(r,o,c){this._evalLazyOptionalParams(c),r.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+o,...c)}trace(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.TRACE&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.trace.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.log,r,o)}debug(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.DEBUG&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.debug.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.log,r,o)}info(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.INFO&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.info.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.info,r,o)}warn(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.WARN&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.warn.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.warn,r,o)}error(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.ERROR&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.error.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.error,r,o)}};n.LogService=l=f([s(0,p.IOptionsService)],l),n.setTraceLogger=function(r){h=r},n.traceCall=function(r,o,c){if(typeof c.value!="function")throw new Error("not supported");let _=c.value;c.value=function(...D){if(h.logLevel!==p.LogLevelEnum.TRACE)return _.apply(this,D);h.trace(`GlyphRenderer#${_.name}(${D.map(b=>JSON.stringify(b)).join(", ")})`);let C=_.apply(this,D);return h.trace(`GlyphRenderer#${_.name} return`,C),C}}},726:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createDecorator=n.getServiceDependencies=n.serviceRegistry=void 0;let u="di$target",f="di$dependencies";n.serviceRegistry=new Map,n.getServiceDependencies=function(s){return s[f]||[]},n.createDecorator=function(s){if(n.serviceRegistry.has(s))return n.serviceRegistry.get(s);let i=function(p,m,h){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(l,r,o){r[u]===r?r[f].push({id:l,index:o}):(r[f]=[{id:l,index:o}],r[u]=r)})(i,p,h)};return i.toString=()=>s,n.serviceRegistry.set(s,i),i}},97:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IDecorationService=n.IUnicodeService=n.IOscLinkService=n.IOptionsService=n.ILogService=n.LogLevelEnum=n.IInstantiationService=n.ICharsetService=n.ICoreService=n.ICoreMouseService=n.IBufferService=void 0;let f=u(726);var s;n.IBufferService=(0,f.createDecorator)("BufferService"),n.ICoreMouseService=(0,f.createDecorator)("CoreMouseService"),n.ICoreService=(0,f.createDecorator)("CoreService"),n.ICharsetService=(0,f.createDecorator)("CharsetService"),n.IInstantiationService=(0,f.createDecorator)("InstantiationService"),function(i){i[i.TRACE=0]="TRACE",i[i.DEBUG=1]="DEBUG",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.OFF=5]="OFF"}(s||(n.LogLevelEnum=s={})),n.ILogService=(0,f.createDecorator)("LogService"),n.IOptionsService=(0,f.createDecorator)("OptionsService"),n.IOscLinkService=(0,f.createDecorator)("OscLinkService"),n.IUnicodeService=(0,f.createDecorator)("UnicodeService"),n.IDecorationService=(0,f.createDecorator)("DecorationService")}},t={};function a(g){var n=t[g];if(n!==void 0)return n.exports;var u=t[g]={exports:{}};return e[g].call(u.exports,u,u.exports,a),u.exports}var d={};return(()=>{var g=d;Object.defineProperty(g,"__esModule",{value:!0}),g.WebglAddon=void 0;let n=a(345),u=a(859),f=a(399),s=a(666),i=a(776);class p extends u.Disposable{constructor(h){if(f.isSafari&&(0,f.getSafariVersion)()<16)throw new Error("Webgl2 is only supported on Safari 16 and above");super(),this._preserveDrawingBuffer=h,this._onChangeTextureAtlas=this.register(new n.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new n.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new n.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onContextLoss=this.register(new n.EventEmitter),this.onContextLoss=this._onContextLoss.event}activate(h){let l=h._core;if(!h.element)return void this.register(l.onWillOpen(()=>this.activate(h)));this._terminal=h;let r=l.coreService,o=l.optionsService,c=l,_=c._renderService,D=c._characterJoinerService,C=c._charSizeService,b=c._coreBrowserService,S=c._decorationService,v=c._logService,y=c._themeService;(0,i.setTraceLogger)(v),this._renderer=this.register(new s.WebglRenderer(h,D,C,b,r,S,o,y,this._preserveDrawingBuffer)),this.register((0,n.forwardEvent)(this._renderer.onContextLoss,this._onContextLoss)),this.register((0,n.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,n.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),this.register((0,n.forwardEvent)(this._renderer.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)),_.setRenderer(this._renderer),this.register((0,u.toDisposable)(()=>{let M=this._terminal._core._renderService;M.setRenderer(this._terminal._core._createRenderer()),M.handleResize(h.cols,h.rows)}))}get textureAtlas(){var h;return(h=this._renderer)===null||h===void 0?void 0:h.textureAtlas}clearTextureAtlas(){var h;(h=this._renderer)===null||h===void 0||h.clearTextureAtlas()}}g.WebglAddon=p})(),d})())});var rb=ws((Hl,Hv)=>{(function(e,t){typeof Hl=="object"&&typeof Hv=="object"?Hv.exports=t():typeof define=="function"&&define.amd?define([],t):typeof Hl=="object"?Hl.WebLinksAddon=t():e.WebLinksAddon=t()})(self,()=>(()=>{"use strict";var e={6:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.LinkComputer=n.WebLinkProvider=void 0,n.WebLinkProvider=class{constructor(f,s,i,p={}){this._terminal=f,this._regex=s,this._handler=i,this._options=p}provideLinks(f,s){let i=u.computeLink(f,this._regex,this._terminal,this._handler);s(this._addCallbacks(i))}_addCallbacks(f){return f.map(s=>(s.leave=this._options.leave,s.hover=(i,p)=>{if(this._options.hover){let{range:m}=s;this._options.hover(i,p,m)}},s))}};class u{static computeLink(s,i,p,m){let h=new RegExp(i.source,(i.flags||"")+"g"),[l,r]=u._getWindowedLineStrings(s-1,p),o=l.join(""),c,_=[];for(;c=h.exec(o);){let D=c[0];try{let M=new URL(D),T=decodeURI(M.toString());if(D!==T&&D+"/"!==T)continue}catch{continue}let[C,b]=u._mapStrIdx(p,r,0,c.index),[S,v]=u._mapStrIdx(p,C,b,D.length);if(C===-1||b===-1||S===-1||v===-1)continue;let y={start:{x:b+1,y:C+1},end:{x:v,y:S+1}};_.push({range:y,text:D,activate:m})}return _}static _getWindowedLineStrings(s,i){let p,m=s,h=s,l=0,r="",o=[];if(p=i.buffer.active.getLine(s)){let c=p.translateToString(!0);if(p.isWrapped&&c[0]!==" "){for(l=0;(p=i.buffer.active.getLine(--m))&&l<2048&&(r=p.translateToString(!0),l+=r.length,o.push(r),p.isWrapped&&r.indexOf(" ")===-1););o.reverse()}for(o.push(c),l=0;(p=i.buffer.active.getLine(++h))&&p.isWrapped&&l<2048&&(r=p.translateToString(!0),l+=r.length,o.push(r),r.indexOf(" ")===-1););}return[o,m]}static _mapStrIdx(s,i,p,m){let h=s.buffer.active,l=h.getNullCell(),r=p;for(;m;){let o=h.getLine(i);if(!o)return[-1,-1];for(let c=r;c<o.length;++c){o.getCell(c,l);let _=l.getChars();if(l.getWidth()&&(m-=_.length||1,c===o.length-1&&_==="")){let D=h.getLine(i+1);D&&D.isWrapped&&(D.getCell(0,l),l.getWidth()===2&&(m+=1))}if(m<0)return[i,c]}i++,r=0}return[i,r]}}n.LinkComputer=u}},t={};function a(g){var n=t[g];if(n!==void 0)return n.exports;var u=t[g]={exports:{}};return e[g](u,u.exports,a),u.exports}var d={};return(()=>{var g=d;Object.defineProperty(g,"__esModule",{value:!0}),g.WebLinksAddon=void 0;let n=a(6),u=/https?:[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function f(s,i){let p=window.open();if(p){try{p.opener=null}catch{}p.location.href=i}else console.warn("Opening link blocked as opener could not be cleared")}g.WebLinksAddon=class{constructor(s=f,i={}){this._handler=s,this._options=i}activate(s){this._terminal=s;let i=this._options,p=i.urlRegex||u;this._linkProvider=this._terminal.registerLinkProvider(new n.WebLinkProvider(this._terminal,p,this._handler,i))}dispose(){var s;(s=this._linkProvider)===null||s===void 0||s.dispose()}}})(),d})())});var sb=ws((Wl,Bv)=>{(function(e,t){if(typeof Wl=="object"&&typeof Bv=="object")Bv.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var a=t();for(var d in a)(typeof Wl=="object"?Wl:e)[d]=a[d]}})(self,()=>(()=>{"use strict";var e={4567:function(g,n,u){var f=this&&this.__decorate||function(_,D,C,b){var S,v=arguments.length,y=v<3?D:b===null?b=Object.getOwnPropertyDescriptor(D,C):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(_,D,C,b);else for(var M=_.length-1;M>=0;M--)(S=_[M])&&(y=(v<3?S(y):v>3?S(D,C,y):S(D,C))||y);return v>3&&y&&Object.defineProperty(D,C,y),y},s=this&&this.__param||function(_,D){return function(C,b){D(C,b,_)}};Object.defineProperty(n,"__esModule",{value:!0}),n.AccessibilityManager=void 0;let i=u(9042),p=u(6114),m=u(9924),h=u(844),l=u(5596),r=u(4725),o=u(3656),c=n.AccessibilityManager=class extends h.Disposable{constructor(_,D){super(),this._terminal=_,this._renderService=D,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let C=0;C<this._terminal.rows;C++)this._rowElements[C]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[C]);if(this._topBoundaryFocusListener=C=>this._handleBoundaryFocus(C,0),this._bottomBoundaryFocusListener=C=>this._handleBoundaryFocus(C,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new m.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(C=>this._handleResize(C.rows))),this.register(this._terminal.onRender(C=>this._refreshRows(C.start,C.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(C=>this._handleChar(C))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(C=>this._handleTab(C))),this.register(this._terminal.onKey(C=>this._handleKey(C.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new l.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,o.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,h.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(_){for(let D=0;D<_;D++)this._handleChar(" ")}_handleChar(_){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==_&&(this._charsToAnnounce+=_):this._charsToAnnounce+=_,_===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=i.tooMuchOutput)),p.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,p.isMac&&this._liveRegion.remove()}_handleKey(_){this._clearLiveRegion(),/\p{Control}/u.test(_)||this._charsToConsume.push(_)}_refreshRows(_,D){this._liveRegionDebouncer.refresh(_,D,this._terminal.rows)}_renderRows(_,D){let C=this._terminal.buffer,b=C.lines.length.toString();for(let S=_;S<=D;S++){let v=C.translateBufferLineToString(C.ydisp+S,!0),y=(C.ydisp+S+1).toString(),M=this._rowElements[S];M&&(v.length===0?M.innerText="\xA0":M.textContent=v,M.setAttribute("aria-posinset",y),M.setAttribute("aria-setsize",b))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(_,D){let C=_.target,b=this._rowElements[D===0?1:this._rowElements.length-2];if(C.getAttribute("aria-posinset")===(D===0?"1":`${this._terminal.buffer.lines.length}`)||_.relatedTarget!==b)return;let S,v;if(D===0?(S=C,v=this._rowElements.pop(),this._rowContainer.removeChild(v)):(S=this._rowElements.shift(),v=C,this._rowContainer.removeChild(S)),S.removeEventListener("focus",this._topBoundaryFocusListener),v.removeEventListener("focus",this._bottomBoundaryFocusListener),D===0){let y=this._createAccessibilityTreeNode();this._rowElements.unshift(y),this._rowContainer.insertAdjacentElement("afterbegin",y)}else{let y=this._createAccessibilityTreeNode();this._rowElements.push(y),this._rowContainer.appendChild(y)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(D===0?-1:1),this._rowElements[D===0?1:this._rowElements.length-2].focus(),_.preventDefault(),_.stopImmediatePropagation()}_handleResize(_){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let D=this._rowContainer.children.length;D<this._terminal.rows;D++)this._rowElements[D]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[D]);for(;this._rowElements.length>_;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){let _=document.createElement("div");return _.setAttribute("role","listitem"),_.tabIndex=-1,this._refreshRowDimensions(_),_}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let _=0;_<this._terminal.rows;_++)this._refreshRowDimensions(this._rowElements[_])}}_refreshRowDimensions(_){_.style.height=`${this._renderService.dimensions.css.cell.height}px`}};n.AccessibilityManager=c=f([s(1,r.IRenderService)],c)},3614:(g,n)=>{function u(p){return p.replace(/\r?\n/g,"\r")}function f(p,m){return m?"\x1B[200~"+p+"\x1B[201~":p}function s(p,m,h,l){p=f(p=u(p),h.decPrivateModes.bracketedPasteMode&&l.rawOptions.ignoreBracketedPasteMode!==!0),h.triggerDataEvent(p,!0),m.value=""}function i(p,m,h){let l=h.getBoundingClientRect(),r=p.clientX-l.left-10,o=p.clientY-l.top-10;m.style.width="20px",m.style.height="20px",m.style.left=`${r}px`,m.style.top=`${o}px`,m.style.zIndex="1000",m.focus()}Object.defineProperty(n,"__esModule",{value:!0}),n.rightClickHandler=n.moveTextAreaUnderMouseCursor=n.paste=n.handlePasteEvent=n.copyHandler=n.bracketTextForPaste=n.prepareTextForTerminal=void 0,n.prepareTextForTerminal=u,n.bracketTextForPaste=f,n.copyHandler=function(p,m){p.clipboardData&&p.clipboardData.setData("text/plain",m.selectionText),p.preventDefault()},n.handlePasteEvent=function(p,m,h,l){p.stopPropagation(),p.clipboardData&&s(p.clipboardData.getData("text/plain"),m,h,l)},n.paste=s,n.moveTextAreaUnderMouseCursor=i,n.rightClickHandler=function(p,m,h,l,r){i(p,m,h),r&&l.rightClickSelect(p),m.value=l.selectionText,m.select()}},7239:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorContrastCache=void 0;let f=u(1505);n.ColorContrastCache=class{constructor(){this._color=new f.TwoKeyMap,this._css=new f.TwoKeyMap}setCss(s,i,p){this._css.set(s,i,p)}getCss(s,i){return this._css.get(s,i)}setColor(s,i,p){this._color.set(s,i,p)}getColor(s,i){return this._color.get(s,i)}clear(){this._color.clear(),this._css.clear()}}},3656:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.addDisposableDomListener=void 0,n.addDisposableDomListener=function(u,f,s,i){u.addEventListener(f,s,i);let p=!1;return{dispose:()=>{p||(p=!0,u.removeEventListener(f,s,i))}}}},6465:function(g,n,u){var f=this&&this.__decorate||function(r,o,c,_){var D,C=arguments.length,b=C<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,c):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,o,c,_);else for(var S=r.length-1;S>=0;S--)(D=r[S])&&(b=(C<3?D(b):C>3?D(o,c,b):D(o,c))||b);return C>3&&b&&Object.defineProperty(o,c,b),b},s=this&&this.__param||function(r,o){return function(c,_){o(c,_,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.Linkifier2=void 0;let i=u(3656),p=u(8460),m=u(844),h=u(2585),l=n.Linkifier2=class extends m.Disposable{get currentLink(){return this._currentLink}constructor(r){super(),this._bufferService=r,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new p.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new p.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,m.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,m.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}registerLinkProvider(r){return this._linkProviders.push(r),{dispose:()=>{let o=this._linkProviders.indexOf(r);o!==-1&&this._linkProviders.splice(o,1)}}}attachToDom(r,o,c){this._element=r,this._mouseService=o,this._renderService=c,this.register((0,i.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,i.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,i.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,i.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(r){if(this._lastMouseEvent=r,!this._element||!this._mouseService)return;let o=this._positionFromMouseEvent(r,this._element,this._mouseService);if(!o)return;this._isMouseOut=!1;let c=r.composedPath();for(let _=0;_<c.length;_++){let D=c[_];if(D.classList.contains("xterm"))break;if(D.classList.contains("xterm-hover"))return}this._lastBufferCell&&o.x===this._lastBufferCell.x&&o.y===this._lastBufferCell.y||(this._handleHover(o),this._lastBufferCell=o)}_handleHover(r){if(this._activeLine!==r.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(r,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,r)||(this._clearCurrentLink(),this._askForLink(r,!0))}_askForLink(r,o){var c,_;this._activeProviderReplies&&o||((c=this._activeProviderReplies)===null||c===void 0||c.forEach(C=>{C?.forEach(b=>{b.link.dispose&&b.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=r.y);let D=!1;for(let[C,b]of this._linkProviders.entries())o?!((_=this._activeProviderReplies)===null||_===void 0)&&_.get(C)&&(D=this._checkLinkProviderResult(C,r,D)):b.provideLinks(r.y,S=>{var v,y;if(this._isMouseOut)return;let M=S?.map(T=>({link:T}));(v=this._activeProviderReplies)===null||v===void 0||v.set(C,M),D=this._checkLinkProviderResult(C,r,D),((y=this._activeProviderReplies)===null||y===void 0?void 0:y.size)===this._linkProviders.length&&this._removeIntersectingLinks(r.y,this._activeProviderReplies)})}_removeIntersectingLinks(r,o){let c=new Set;for(let _=0;_<o.size;_++){let D=o.get(_);if(D)for(let C=0;C<D.length;C++){let b=D[C],S=b.link.range.start.y<r?0:b.link.range.start.x,v=b.link.range.end.y>r?this._bufferService.cols:b.link.range.end.x;for(let y=S;y<=v;y++){if(c.has(y)){D.splice(C--,1);break}c.add(y)}}}}_checkLinkProviderResult(r,o,c){var _;if(!this._activeProviderReplies)return c;let D=this._activeProviderReplies.get(r),C=!1;for(let b=0;b<r;b++)this._activeProviderReplies.has(b)&&!this._activeProviderReplies.get(b)||(C=!0);if(!C&&D){let b=D.find(S=>this._linkAtPosition(S.link,o));b&&(c=!0,this._handleNewLink(b))}if(this._activeProviderReplies.size===this._linkProviders.length&&!c)for(let b=0;b<this._activeProviderReplies.size;b++){let S=(_=this._activeProviderReplies.get(b))===null||_===void 0?void 0:_.find(v=>this._linkAtPosition(v.link,o));if(S){c=!0,this._handleNewLink(S);break}}return c}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(r){if(!this._element||!this._mouseService||!this._currentLink)return;let o=this._positionFromMouseEvent(r,this._element,this._mouseService);o&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,o)&&this._currentLink.link.activate(r,this._currentLink.link.text)}_clearCurrentLink(r,o){this._element&&this._currentLink&&this._lastMouseEvent&&(!r||!o||this._currentLink.link.range.start.y>=r&&this._currentLink.link.range.end.y<=o)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,m.disposeArray)(this._linkCacheDisposables))}_handleNewLink(r){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;let o=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);o&&this._linkAtPosition(r.link,o)&&(this._currentLink=r,this._currentLink.state={decorations:{underline:r.link.decorations===void 0||r.link.decorations.underline,pointerCursor:r.link.decorations===void 0||r.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,r.link,this._lastMouseEvent),r.link.decorations={},Object.defineProperties(r.link.decorations,{pointerCursor:{get:()=>{var c,_;return(_=(c=this._currentLink)===null||c===void 0?void 0:c.state)===null||_===void 0?void 0:_.decorations.pointerCursor},set:c=>{var _,D;!((_=this._currentLink)===null||_===void 0)&&_.state&&this._currentLink.state.decorations.pointerCursor!==c&&(this._currentLink.state.decorations.pointerCursor=c,this._currentLink.state.isHovered&&((D=this._element)===null||D===void 0||D.classList.toggle("xterm-cursor-pointer",c)))}},underline:{get:()=>{var c,_;return(_=(c=this._currentLink)===null||c===void 0?void 0:c.state)===null||_===void 0?void 0:_.decorations.underline},set:c=>{var _,D,C;!((_=this._currentLink)===null||_===void 0)&&_.state&&((C=(D=this._currentLink)===null||D===void 0?void 0:D.state)===null||C===void 0?void 0:C.decorations.underline)!==c&&(this._currentLink.state.decorations.underline=c,this._currentLink.state.isHovered&&this._fireUnderlineEvent(r.link,c))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(c=>{if(!this._currentLink)return;let _=c.start===0?0:c.start+1+this._bufferService.buffer.ydisp,D=this._bufferService.buffer.ydisp+1+c.end;if(this._currentLink.link.range.start.y>=_&&this._currentLink.link.range.end.y<=D&&(this._clearCurrentLink(_,D),this._lastMouseEvent&&this._element)){let C=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);C&&this._askForLink(C,!1)}})))}_linkHover(r,o,c){var _;!((_=this._currentLink)===null||_===void 0)&&_.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(o,!0),this._currentLink.state.decorations.pointerCursor&&r.classList.add("xterm-cursor-pointer")),o.hover&&o.hover(c,o.text)}_fireUnderlineEvent(r,o){let c=r.range,_=this._bufferService.buffer.ydisp,D=this._createLinkUnderlineEvent(c.start.x-1,c.start.y-_-1,c.end.x,c.end.y-_-1,void 0);(o?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(D)}_linkLeave(r,o,c){var _;!((_=this._currentLink)===null||_===void 0)&&_.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(o,!1),this._currentLink.state.decorations.pointerCursor&&r.classList.remove("xterm-cursor-pointer")),o.leave&&o.leave(c,o.text)}_linkAtPosition(r,o){let c=r.range.start.y*this._bufferService.cols+r.range.start.x,_=r.range.end.y*this._bufferService.cols+r.range.end.x,D=o.y*this._bufferService.cols+o.x;return c<=D&&D<=_}_positionFromMouseEvent(r,o,c){let _=c.getCoords(r,o,this._bufferService.cols,this._bufferService.rows);if(_)return{x:_[0],y:_[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(r,o,c,_,D){return{x1:r,y1:o,x2:c,y2:_,cols:this._bufferService.cols,fg:D}}};n.Linkifier2=l=f([s(0,h.IBufferService)],l)},9042:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.tooMuchOutput=n.promptLabel=void 0,n.promptLabel="Terminal input",n.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(g,n,u){var f=this&&this.__decorate||function(l,r,o,c){var _,D=arguments.length,C=D<3?r:c===null?c=Object.getOwnPropertyDescriptor(r,o):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(l,r,o,c);else for(var b=l.length-1;b>=0;b--)(_=l[b])&&(C=(D<3?_(C):D>3?_(r,o,C):_(r,o))||C);return D>3&&C&&Object.defineProperty(r,o,C),C},s=this&&this.__param||function(l,r){return function(o,c){r(o,c,l)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OscLinkProvider=void 0;let i=u(511),p=u(2585),m=n.OscLinkProvider=class{constructor(l,r,o){this._bufferService=l,this._optionsService=r,this._oscLinkService=o}provideLinks(l,r){var o;let c=this._bufferService.buffer.lines.get(l-1);if(!c)return void r(void 0);let _=[],D=this._optionsService.rawOptions.linkHandler,C=new i.CellData,b=c.getTrimmedLength(),S=-1,v=-1,y=!1;for(let M=0;M<b;M++)if(v!==-1||c.hasContent(M)){if(c.loadCell(M,C),C.hasExtendedAttrs()&&C.extended.urlId){if(v===-1){v=M,S=C.extended.urlId;continue}y=C.extended.urlId!==S}else v!==-1&&(y=!0);if(y||v!==-1&&M===b-1){let T=(o=this._oscLinkService.getLinkData(S))===null||o===void 0?void 0:o.uri;if(T){let w={start:{x:v+1,y:l},end:{x:M+(y||M!==b-1?0:1),y:l}},A=!1;if(!D?.allowNonHttpProtocols)try{let I=new URL(T);["http:","https:"].includes(I.protocol)||(A=!0)}catch{A=!0}A||_.push({text:T,range:w,activate:(I,R)=>D?D.activate(I,R,w):h(0,R),hover:(I,R)=>{var P;return(P=D?.hover)===null||P===void 0?void 0:P.call(D,I,R,w)},leave:(I,R)=>{var P;return(P=D?.leave)===null||P===void 0?void 0:P.call(D,I,R,w)}})}y=!1,C.hasExtendedAttrs()&&C.extended.urlId?(v=M,S=C.extended.urlId):(v=-1,S=-1)}}r(_)}};function h(l,r){if(confirm(`Do you want to navigate to ${r}?

WARNING: This link could potentially be dangerous`)){let o=window.open();if(o){try{o.opener=null}catch{}o.location.href=r}else console.warn("Opening link blocked as opener could not be cleared")}}n.OscLinkProvider=m=f([s(0,p.IBufferService),s(1,p.IOptionsService),s(2,p.IOscLinkService)],m)},6193:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.RenderDebouncer=void 0,n.RenderDebouncer=class{constructor(u,f){this._parentWindow=u,this._renderCallback=f,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(u){return this._refreshCallbacks.push(u),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(u,f,s){this._rowCount=s,u=u!==void 0?u:0,f=f!==void 0?f:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,u):u,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,f):f,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();let u=Math.max(this._rowStart,0),f=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(u,f),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(let u of this._refreshCallbacks)u(0);this._refreshCallbacks=[]}}},5596:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ScreenDprMonitor=void 0;let f=u(844);class s extends f.Disposable{constructor(p){super(),this._parentWindow=p,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,f.toDisposable)(()=>{this.clearListener()}))}setListener(p){this._listener&&this.clearListener(),this._listener=p,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var p;this._outerListener&&((p=this._resolutionMediaMatchList)===null||p===void 0||p.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}n.ScreenDprMonitor=s},3236:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Terminal=void 0;let f=u(3614),s=u(3656),i=u(6465),p=u(9042),m=u(3730),h=u(1680),l=u(3107),r=u(5744),o=u(2950),c=u(1296),_=u(428),D=u(4269),C=u(5114),b=u(8934),S=u(3230),v=u(9312),y=u(4725),M=u(6731),T=u(8055),w=u(8969),A=u(8460),I=u(844),R=u(6114),P=u(8437),W=u(2584),E=u(7399),L=u(5941),x=u(9074),O=u(2585),U=u(5435),Y=u(4567),ae=typeof window<"u"?window.document:null;class z extends w.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(F={}){super(F),this.browser=R,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new I.MutableDisposable),this._onCursorMove=this.register(new A.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new A.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new A.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new A.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new A.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new A.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new A.EventEmitter),this._onBlur=this.register(new A.EventEmitter),this._onA11yCharEmitter=this.register(new A.EventEmitter),this._onA11yTabEmitter=this.register(new A.EventEmitter),this._onWillOpen=this.register(new A.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(i.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(m.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(x.DecorationService),this._instantiationService.setService(O.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((N,B)=>this.refresh(N,B))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(N=>this._reportWindowsOptions(N))),this.register(this._inputHandler.onColor(N=>this._handleColorEvent(N))),this.register((0,A.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,A.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,A.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,A.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(N=>this._afterResize(N.cols,N.rows))),this.register((0,I.toDisposable)(()=>{var N,B;this._customKeyEventHandler=void 0,(B=(N=this.element)===null||N===void 0?void 0:N.parentNode)===null||B===void 0||B.removeChild(this.element)}))}_handleColorEvent(F){if(this._themeService)for(let N of F){let B,H="";switch(N.index){case 256:B="foreground",H="10";break;case 257:B="background",H="11";break;case 258:B="cursor",H="12";break;default:B="ansi",H="4;"+N.index}switch(N.type){case 0:let le=T.color.toColorRGB(B==="ansi"?this._themeService.colors.ansi[N.index]:this._themeService.colors[B]);this.coreService.triggerDataEvent(`${W.C0.ESC}]${H};${(0,L.toRgbString)(le)}${W.C1_ESCAPED.ST}`);break;case 1:if(B==="ansi")this._themeService.modifyColors(j=>j.ansi[N.index]=T.rgba.toColor(...N.color));else{let j=B;this._themeService.modifyColors(Le=>Le[j]=T.rgba.toColor(...N.color))}break;case 2:this._themeService.restoreColor(N.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(F){F?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(Y.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(F){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(W.C0.ESC+"[I"),this.updateCursorStyle(F),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var F;return(F=this.textarea)===null||F===void 0?void 0:F.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(W.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;let F=this.buffer.ybase+this.buffer.y,N=this.buffer.lines.get(F);if(!N)return;let B=Math.min(this.buffer.x,this.cols-1),H=this._renderService.dimensions.css.cell.height,le=N.getWidth(B),j=this._renderService.dimensions.css.cell.width*le,Le=this.buffer.y*this._renderService.dimensions.css.cell.height,rt=B*this._renderService.dimensions.css.cell.width;this.textarea.style.left=rt+"px",this.textarea.style.top=Le+"px",this.textarea.style.width=j+"px",this.textarea.style.height=H+"px",this.textarea.style.lineHeight=H+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,s.addDisposableDomListener)(this.element,"copy",N=>{this.hasSelection()&&(0,f.copyHandler)(N,this._selectionService)}));let F=N=>(0,f.handlePasteEvent)(N,this.textarea,this.coreService,this.optionsService);this.register((0,s.addDisposableDomListener)(this.textarea,"paste",F)),this.register((0,s.addDisposableDomListener)(this.element,"paste",F)),R.isFirefox?this.register((0,s.addDisposableDomListener)(this.element,"mousedown",N=>{N.button===2&&(0,f.rightClickHandler)(N,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,s.addDisposableDomListener)(this.element,"contextmenu",N=>{(0,f.rightClickHandler)(N,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),R.isLinux&&this.register((0,s.addDisposableDomListener)(this.element,"auxclick",N=>{N.button===1&&(0,f.moveTextAreaUnderMouseCursor)(N,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,s.addDisposableDomListener)(this.textarea,"keyup",F=>this._keyUp(F),!0)),this.register((0,s.addDisposableDomListener)(this.textarea,"keydown",F=>this._keyDown(F),!0)),this.register((0,s.addDisposableDomListener)(this.textarea,"keypress",F=>this._keyPress(F),!0)),this.register((0,s.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,s.addDisposableDomListener)(this.textarea,"compositionupdate",F=>this._compositionHelper.compositionupdate(F))),this.register((0,s.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,s.addDisposableDomListener)(this.textarea,"input",F=>this._inputEvent(F),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(F){var N;if(!F)throw new Error("Terminal requires a parent element.");F.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=F.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),F.appendChild(this.element);let B=ae.createDocumentFragment();this._viewportElement=ae.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),B.appendChild(this._viewportElement),this._viewportScrollArea=ae.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=ae.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=ae.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),B.appendChild(this.screenElement),this.textarea=ae.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",p.promptLabel),R.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(C.CoreBrowserService,this.textarea,(N=this._document.defaultView)!==null&&N!==void 0?N:window),this._instantiationService.setService(y.ICoreBrowserService,this._coreBrowserService),this.register((0,s.addDisposableDomListener)(this.textarea,"focus",H=>this._handleTextAreaFocus(H))),this.register((0,s.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(_.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(y.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(M.ThemeService),this._instantiationService.setService(y.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(D.CharacterJoinerService),this._instantiationService.setService(y.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(S.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(y.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(H=>this._onRender.fire(H))),this.onResize(H=>this._renderService.resize(H.cols,H.rows)),this._compositionView=ae.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(o.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(B);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(b.MouseService),this._instantiationService.setService(y.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(h.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(H=>this.scrollLines(H.amount,H.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(v.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(y.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(H=>this.scrollLines(H.amount,H.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(H=>this._renderService.handleSelectionChanged(H.start,H.end,H.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(H=>{this.textarea.value=H,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(H=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,s.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(l.BufferDecorationRenderer,this.screenElement)),this.register((0,s.addDisposableDomListener)(this.element,"mousedown",H=>this._selectionService.handleMouseDown(H))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(Y.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",H=>this._handleScreenReaderModeOptionChange(H))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(r.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",H=>{!this._overviewRulerRenderer&&H&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(r.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(c.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){let F=this,N=this.element;function B(j){let Le=F._mouseService.getMouseReportCoords(j,F.screenElement);if(!Le)return!1;let rt,Be;switch(j.overrideType||j.type){case"mousemove":Be=32,j.buttons===void 0?(rt=3,j.button!==void 0&&(rt=j.button<3?j.button:3)):rt=1&j.buttons?0:4&j.buttons?1:2&j.buttons?2:3;break;case"mouseup":Be=0,rt=j.button<3?j.button:3;break;case"mousedown":Be=1,rt=j.button<3?j.button:3;break;case"wheel":if(F.viewport.getLinesScrolled(j)===0)return!1;Be=j.deltaY<0?0:1,rt=4;break;default:return!1}return!(Be===void 0||rt===void 0||rt>4)&&F.coreMouseService.triggerMouseEvent({col:Le.col,row:Le.row,x:Le.x,y:Le.y,button:rt,action:Be,ctrl:j.ctrlKey,alt:j.altKey,shift:j.shiftKey})}let H={mouseup:null,wheel:null,mousedrag:null,mousemove:null},le={mouseup:j=>(B(j),j.buttons||(this._document.removeEventListener("mouseup",H.mouseup),H.mousedrag&&this._document.removeEventListener("mousemove",H.mousedrag)),this.cancel(j)),wheel:j=>(B(j),this.cancel(j,!0)),mousedrag:j=>{j.buttons&&B(j)},mousemove:j=>{j.buttons||B(j)}};this.register(this.coreMouseService.onProtocolChange(j=>{j?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(j)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&j?H.mousemove||(N.addEventListener("mousemove",le.mousemove),H.mousemove=le.mousemove):(N.removeEventListener("mousemove",H.mousemove),H.mousemove=null),16&j?H.wheel||(N.addEventListener("wheel",le.wheel,{passive:!1}),H.wheel=le.wheel):(N.removeEventListener("wheel",H.wheel),H.wheel=null),2&j?H.mouseup||(N.addEventListener("mouseup",le.mouseup),H.mouseup=le.mouseup):(this._document.removeEventListener("mouseup",H.mouseup),N.removeEventListener("mouseup",H.mouseup),H.mouseup=null),4&j?H.mousedrag||(H.mousedrag=le.mousedrag):(this._document.removeEventListener("mousemove",H.mousedrag),H.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,s.addDisposableDomListener)(N,"mousedown",j=>{if(j.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(j))return B(j),H.mouseup&&this._document.addEventListener("mouseup",H.mouseup),H.mousedrag&&this._document.addEventListener("mousemove",H.mousedrag),this.cancel(j)})),this.register((0,s.addDisposableDomListener)(N,"wheel",j=>{if(!H.wheel){if(!this.buffer.hasScrollback){let Le=this.viewport.getLinesScrolled(j);if(Le===0)return;let rt=W.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(j.deltaY<0?"A":"B"),Be="";for(let Re=0;Re<Math.abs(Le);Re++)Be+=rt;return this.coreService.triggerDataEvent(Be,!0),this.cancel(j,!0)}return this.viewport.handleWheel(j)?this.cancel(j):void 0}},{passive:!1})),this.register((0,s.addDisposableDomListener)(N,"touchstart",j=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(j),this.cancel(j)},{passive:!0})),this.register((0,s.addDisposableDomListener)(N,"touchmove",j=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(j)?void 0:this.cancel(j)},{passive:!1}))}refresh(F,N){var B;(B=this._renderService)===null||B===void 0||B.refreshRows(F,N)}updateCursorStyle(F){var N;!((N=this._selectionService)===null||N===void 0)&&N.shouldColumnSelect(F)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(F,N,B=0){var H;B===1?(super.scrollLines(F,N,B),this.refresh(0,this.rows-1)):(H=this.viewport)===null||H===void 0||H.scrollLines(F)}paste(F){(0,f.paste)(F,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(F){this._customKeyEventHandler=F}registerLinkProvider(F){return this.linkifier2.registerLinkProvider(F)}registerCharacterJoiner(F){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");let N=this._characterJoinerService.register(F);return this.refresh(0,this.rows-1),N}deregisterCharacterJoiner(F){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(F)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(F){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+F)}registerDecoration(F){return this._decorationService.registerDecoration(F)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(F,N,B){this._selectionService.setSelection(F,N,B)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var F;(F=this._selectionService)===null||F===void 0||F.clearSelection()}selectAll(){var F;(F=this._selectionService)===null||F===void 0||F.selectAll()}selectLines(F,N){var B;(B=this._selectionService)===null||B===void 0||B.selectLines(F,N)}_keyDown(F){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1)return!1;let N=this.browser.isMac&&this.options.macOptionIsMeta&&F.altKey;if(!N&&!this._compositionHelper.keydown(F))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;N||F.key!=="Dead"&&F.key!=="AltGraph"||(this._unprocessedDeadKey=!0);let B=(0,E.evaluateKeyboardEvent)(F,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(F),B.type===3||B.type===2){let H=this.rows-1;return this.scrollLines(B.type===2?-H:H),this.cancel(F,!0)}return B.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,F)||(B.cancel&&this.cancel(F,!0),!B.key||!!(F.key&&!F.ctrlKey&&!F.altKey&&!F.metaKey&&F.key.length===1&&F.key.charCodeAt(0)>=65&&F.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(B.key!==W.C0.ETX&&B.key!==W.C0.CR||(this.textarea.value=""),this._onKey.fire({key:B.key,domEvent:F}),this._showCursor(),this.coreService.triggerDataEvent(B.key,!0),!this.optionsService.rawOptions.screenReaderMode||F.altKey||F.ctrlKey?this.cancel(F,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(F,N){let B=F.isMac&&!this.options.macOptionIsMeta&&N.altKey&&!N.ctrlKey&&!N.metaKey||F.isWindows&&N.altKey&&N.ctrlKey&&!N.metaKey||F.isWindows&&N.getModifierState("AltGraph");return N.type==="keypress"?B:B&&(!N.keyCode||N.keyCode>47)}_keyUp(F){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1||(function(N){return N.keyCode===16||N.keyCode===17||N.keyCode===18}(F)||this.focus(),this.updateCursorStyle(F),this._keyPressHandled=!1)}_keyPress(F){let N;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1)return!1;if(this.cancel(F),F.charCode)N=F.charCode;else if(F.which===null||F.which===void 0)N=F.keyCode;else{if(F.which===0||F.charCode===0)return!1;N=F.which}return!(!N||(F.altKey||F.ctrlKey||F.metaKey)&&!this._isThirdLevelShift(this.browser,F)||(N=String.fromCharCode(N),this._onKey.fire({key:N,domEvent:F}),this._showCursor(),this.coreService.triggerDataEvent(N,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(F){if(F.data&&F.inputType==="insertText"&&(!F.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;let N=F.data;return this.coreService.triggerDataEvent(N,!0),this.cancel(F),!0}return!1}resize(F,N){F!==this.cols||N!==this.rows?super.resize(F,N):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(F,N){var B,H;(B=this._charSizeService)===null||B===void 0||B.measure(),(H=this.viewport)===null||H===void 0||H.syncScrollArea(!0)}clear(){var F;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let N=1;N<this.rows;N++)this.buffer.lines.push(this.buffer.getBlankLine(P.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(F=this.viewport)===null||F===void 0||F.reset(),this.refresh(0,this.rows-1)}}reset(){var F,N;this.options.rows=this.rows,this.options.cols=this.cols;let B=this._customKeyEventHandler;this._setup(),super.reset(),(F=this._selectionService)===null||F===void 0||F.reset(),this._decorationService.reset(),(N=this.viewport)===null||N===void 0||N.reset(),this._customKeyEventHandler=B,this.refresh(0,this.rows-1)}clearTextureAtlas(){var F;(F=this._renderService)===null||F===void 0||F.clearTextureAtlas()}_reportFocus(){var F;!((F=this.element)===null||F===void 0)&&F.classList.contains("focus")?this.coreService.triggerDataEvent(W.C0.ESC+"[I"):this.coreService.triggerDataEvent(W.C0.ESC+"[O")}_reportWindowsOptions(F){if(this._renderService)switch(F){case U.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:let N=this._renderService.dimensions.css.canvas.width.toFixed(0),B=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${W.C0.ESC}[4;${B};${N}t`);break;case U.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:let H=this._renderService.dimensions.css.cell.width.toFixed(0),le=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${W.C0.ESC}[6;${le};${H}t`)}}cancel(F,N){if(this.options.cancelEvents||N)return F.preventDefault(),F.stopPropagation(),!1}}n.Terminal=z},9924:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TimeBasedDebouncer=void 0,n.TimeBasedDebouncer=class{constructor(u,f=1e3){this._renderCallback=u,this._debounceThresholdMS=f,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(u,f,s){this._rowCount=s,u=u!==void 0?u:0,f=f!==void 0?f:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,u):u,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,f):f;let i=Date.now();if(i-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=i,this._innerRefresh();else if(!this._additionalRefreshRequested){let p=i-this._lastRefreshMs,m=this._debounceThresholdMS-p;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},m)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;let u=Math.max(this._rowStart,0),f=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(u,f)}}},1680:function(g,n,u){var f=this&&this.__decorate||function(o,c,_,D){var C,b=arguments.length,S=b<3?c:D===null?D=Object.getOwnPropertyDescriptor(c,_):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(o,c,_,D);else for(var v=o.length-1;v>=0;v--)(C=o[v])&&(S=(b<3?C(S):b>3?C(c,_,S):C(c,_))||S);return b>3&&S&&Object.defineProperty(c,_,S),S},s=this&&this.__param||function(o,c){return function(_,D){c(_,D,o)}};Object.defineProperty(n,"__esModule",{value:!0}),n.Viewport=void 0;let i=u(3656),p=u(4725),m=u(8460),h=u(844),l=u(2585),r=n.Viewport=class extends h.Disposable{constructor(o,c,_,D,C,b,S,v){super(),this._viewportElement=o,this._scrollArea=c,this._bufferService=_,this._optionsService=D,this._charSizeService=C,this._renderService=b,this._coreBrowserService=S,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new m.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,i.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(y=>this._activeBuffer=y.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(y=>this._renderDimensions=y)),this._handleThemeChange(v.colors),this.register(v.onChangeColors(y=>this._handleThemeChange(y))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(o){this._viewportElement.style.backgroundColor=o.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(o){if(o)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;let c=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==c&&(this._lastRecordedBufferHeight=c,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}let o=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==o&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=o),this._refreshAnimationFrame=null}syncScrollArea(o=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(o);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(o)}_handleScroll(o){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});let c=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:c,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;let o=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(o*(this._smoothScrollState.target-this._smoothScrollState.origin)),o<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(o,c){let _=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(c<0&&this._viewportElement.scrollTop!==0||c>0&&_<this._lastRecordedBufferHeight)||(o.cancelable&&o.preventDefault(),!1)}handleWheel(o){let c=this._getPixelsScrolled(o);return c!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+c:this._smoothScrollState.target+=c,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=c,this._bubbleScroll(o,c))}scrollLines(o){if(o!==0)if(this._optionsService.rawOptions.smoothScrollDuration){let c=o*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+c,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:o,suppressScrollEvent:!1})}_getPixelsScrolled(o){if(o.deltaY===0||o.shiftKey)return 0;let c=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_LINE?c*=this._currentRowHeight:o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(c*=this._currentRowHeight*this._bufferService.rows),c}getBufferElements(o,c){var _;let D,C="",b=[],S=c??this._bufferService.buffer.lines.length,v=this._bufferService.buffer.lines;for(let y=o;y<S;y++){let M=v.get(y);if(!M)continue;let T=(_=v.get(y+1))===null||_===void 0?void 0:_.isWrapped;if(C+=M.translateToString(!T),!T||y===v.length-1){let w=document.createElement("div");w.textContent=C,b.push(w),C.length>0&&(D=w),C=""}}return{bufferElements:b,cursorElement:D}}getLinesScrolled(o){if(o.deltaY===0||o.shiftKey)return 0;let c=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(c/=this._currentRowHeight+0,this._wheelPartialScroll+=c,c=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(c*=this._bufferService.rows),c}_applyScrollModifier(o,c){let _=this._optionsService.rawOptions.fastScrollModifier;return _==="alt"&&c.altKey||_==="ctrl"&&c.ctrlKey||_==="shift"&&c.shiftKey?o*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:o*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(o){this._lastTouchY=o.touches[0].pageY}handleTouchMove(o){let c=this._lastTouchY-o.touches[0].pageY;return this._lastTouchY=o.touches[0].pageY,c!==0&&(this._viewportElement.scrollTop+=c,this._bubbleScroll(o,c))}};n.Viewport=r=f([s(2,l.IBufferService),s(3,l.IOptionsService),s(4,p.ICharSizeService),s(5,p.IRenderService),s(6,p.ICoreBrowserService),s(7,p.IThemeService)],r)},3107:function(g,n,u){var f=this&&this.__decorate||function(r,o,c,_){var D,C=arguments.length,b=C<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,c):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,o,c,_);else for(var S=r.length-1;S>=0;S--)(D=r[S])&&(b=(C<3?D(b):C>3?D(o,c,b):D(o,c))||b);return C>3&&b&&Object.defineProperty(o,c,b),b},s=this&&this.__param||function(r,o){return function(c,_){o(c,_,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.BufferDecorationRenderer=void 0;let i=u(3656),p=u(4725),m=u(844),h=u(2585),l=n.BufferDecorationRenderer=class extends m.Disposable{constructor(r,o,c,_){super(),this._screenElement=r,this._bufferService=o,this._decorationService=c,this._renderService=_,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,i.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(D=>this._removeDecoration(D))),this.register((0,m.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(let r of this._decorationService.decorations)this._renderDecoration(r);this._dimensionsChanged=!1}_renderDecoration(r){this._refreshStyle(r),this._dimensionsChanged&&this._refreshXPosition(r)}_createElement(r){var o,c;let _=document.createElement("div");_.classList.add("xterm-decoration"),_.classList.toggle("xterm-decoration-top-layer",((o=r?.options)===null||o===void 0?void 0:o.layer)==="top"),_.style.width=`${Math.round((r.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,_.style.height=(r.options.height||1)*this._renderService.dimensions.css.cell.height+"px",_.style.top=(r.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",_.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;let D=(c=r.options.x)!==null&&c!==void 0?c:0;return D&&D>this._bufferService.cols&&(_.style.display="none"),this._refreshXPosition(r,_),_}_refreshStyle(r){let o=r.marker.line-this._bufferService.buffers.active.ydisp;if(o<0||o>=this._bufferService.rows)r.element&&(r.element.style.display="none",r.onRenderEmitter.fire(r.element));else{let c=this._decorationElements.get(r);c||(c=this._createElement(r),r.element=c,this._decorationElements.set(r,c),this._container.appendChild(c),r.onDispose(()=>{this._decorationElements.delete(r),c.remove()})),c.style.top=o*this._renderService.dimensions.css.cell.height+"px",c.style.display=this._altBufferIsActive?"none":"block",r.onRenderEmitter.fire(c)}}_refreshXPosition(r,o=r.element){var c;if(!o)return;let _=(c=r.options.x)!==null&&c!==void 0?c:0;(r.options.anchor||"left")==="right"?o.style.right=_?_*this._renderService.dimensions.css.cell.width+"px":"":o.style.left=_?_*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(r){var o;(o=this._decorationElements.get(r))===null||o===void 0||o.remove(),this._decorationElements.delete(r),r.dispose()}};n.BufferDecorationRenderer=l=f([s(1,h.IBufferService),s(2,h.IDecorationService),s(3,p.IRenderService)],l)},5871:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorZoneStore=void 0,n.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(u){if(u.options.overviewRulerOptions){for(let f of this._zones)if(f.color===u.options.overviewRulerOptions.color&&f.position===u.options.overviewRulerOptions.position){if(this._lineIntersectsZone(f,u.marker.line))return;if(this._lineAdjacentToZone(f,u.marker.line,u.options.overviewRulerOptions.position))return void this._addLineToZone(f,u.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=u.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=u.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=u.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=u.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:u.options.overviewRulerOptions.color,position:u.options.overviewRulerOptions.position,startBufferLine:u.marker.line,endBufferLine:u.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(u){this._linePadding=u}_lineIntersectsZone(u,f){return f>=u.startBufferLine&&f<=u.endBufferLine}_lineAdjacentToZone(u,f,s){return f>=u.startBufferLine-this._linePadding[s||"full"]&&f<=u.endBufferLine+this._linePadding[s||"full"]}_addLineToZone(u,f){u.startBufferLine=Math.min(u.startBufferLine,f),u.endBufferLine=Math.max(u.endBufferLine,f)}}},5744:function(g,n,u){var f=this&&this.__decorate||function(D,C,b,S){var v,y=arguments.length,M=y<3?C:S===null?S=Object.getOwnPropertyDescriptor(C,b):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(D,C,b,S);else for(var T=D.length-1;T>=0;T--)(v=D[T])&&(M=(y<3?v(M):y>3?v(C,b,M):v(C,b))||M);return y>3&&M&&Object.defineProperty(C,b,M),M},s=this&&this.__param||function(D,C){return function(b,S){C(b,S,D)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OverviewRulerRenderer=void 0;let i=u(5871),p=u(3656),m=u(4725),h=u(844),l=u(2585),r={full:0,left:0,center:0,right:0},o={full:0,left:0,center:0,right:0},c={full:0,left:0,center:0,right:0},_=n.OverviewRulerRenderer=class extends h.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(D,C,b,S,v,y,M){var T;super(),this._viewportElement=D,this._screenElement=C,this._bufferService=b,this._decorationService=S,this._renderService=v,this._optionsService=y,this._coreBrowseService=M,this._colorZoneStore=new i.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(T=this._viewportElement.parentElement)===null||T===void 0||T.insertBefore(this._canvas,this._viewportElement);let w=this._canvas.getContext("2d");if(!w)throw new Error("Ctx cannot be null");this._ctx=w,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,h.toDisposable)(()=>{var A;(A=this._canvas)===null||A===void 0||A.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,p.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){let D=Math.floor(this._canvas.width/3),C=Math.ceil(this._canvas.width/3);o.full=this._canvas.width,o.left=D,o.center=C,o.right=D,this._refreshDrawHeightConstants(),c.full=0,c.left=0,c.center=o.left,c.right=o.left+o.center}_refreshDrawHeightConstants(){r.full=Math.round(2*this._coreBrowseService.dpr);let D=this._canvas.height/this._bufferService.buffer.lines.length,C=Math.round(Math.max(Math.min(D,12),6)*this._coreBrowseService.dpr);r.left=C,r.center=C,r.right=C}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*r.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*r.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*r.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*r.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(let C of this._decorationService.decorations)this._colorZoneStore.addDecoration(C);this._ctx.lineWidth=1;let D=this._colorZoneStore.zones;for(let C of D)C.position!=="full"&&this._renderColorZone(C);for(let C of D)C.position==="full"&&this._renderColorZone(C);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(D){this._ctx.fillStyle=D.color,this._ctx.fillRect(c[D.position||"full"],Math.round((this._canvas.height-1)*(D.startBufferLine/this._bufferService.buffers.active.lines.length)-r[D.position||"full"]/2),o[D.position||"full"],Math.round((this._canvas.height-1)*((D.endBufferLine-D.startBufferLine)/this._bufferService.buffers.active.lines.length)+r[D.position||"full"]))}_queueRefresh(D,C){this._shouldUpdateDimensions=D||this._shouldUpdateDimensions,this._shouldUpdateAnchor=C||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};n.OverviewRulerRenderer=_=f([s(2,l.IBufferService),s(3,l.IDecorationService),s(4,m.IRenderService),s(5,l.IOptionsService),s(6,m.ICoreBrowserService)],_)},2950:function(g,n,u){var f=this&&this.__decorate||function(l,r,o,c){var _,D=arguments.length,C=D<3?r:c===null?c=Object.getOwnPropertyDescriptor(r,o):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(l,r,o,c);else for(var b=l.length-1;b>=0;b--)(_=l[b])&&(C=(D<3?_(C):D>3?_(r,o,C):_(r,o))||C);return D>3&&C&&Object.defineProperty(r,o,C),C},s=this&&this.__param||function(l,r){return function(o,c){r(o,c,l)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CompositionHelper=void 0;let i=u(4725),p=u(2585),m=u(2584),h=n.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(l,r,o,c,_,D){this._textarea=l,this._compositionView=r,this._bufferService=o,this._optionsService=c,this._coreService=_,this._renderService=D,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(l){this._compositionView.textContent=l.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(l){if(this._isComposing||this._isSendingComposition){if(l.keyCode===229||l.keyCode===16||l.keyCode===17||l.keyCode===18)return!1;this._finalizeComposition(!1)}return l.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(l){if(this._compositionView.classList.remove("active"),this._isComposing=!1,l){let r={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let o;this._isSendingComposition=!1,r.start+=this._dataAlreadySent.length,o=this._isComposing?this._textarea.value.substring(r.start,r.end):this._textarea.value.substring(r.start),o.length>0&&this._coreService.triggerDataEvent(o,!0)}},0)}else{this._isSendingComposition=!1;let r=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(r,!0)}}_handleAnyTextareaChanges(){let l=this._textarea.value;setTimeout(()=>{if(!this._isComposing){let r=this._textarea.value,o=r.replace(l,"");this._dataAlreadySent=o,r.length>l.length?this._coreService.triggerDataEvent(o,!0):r.length<l.length?this._coreService.triggerDataEvent(`${m.C0.DEL}`,!0):r.length===l.length&&r!==l&&this._coreService.triggerDataEvent(r,!0)}},0)}updateCompositionElements(l){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){let r=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),o=this._renderService.dimensions.css.cell.height,c=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,_=r*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=_+"px",this._compositionView.style.top=c+"px",this._compositionView.style.height=o+"px",this._compositionView.style.lineHeight=o+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";let D=this._compositionView.getBoundingClientRect();this._textarea.style.left=_+"px",this._textarea.style.top=c+"px",this._textarea.style.width=Math.max(D.width,1)+"px",this._textarea.style.height=Math.max(D.height,1)+"px",this._textarea.style.lineHeight=D.height+"px"}l||setTimeout(()=>this.updateCompositionElements(!0),0)}}};n.CompositionHelper=h=f([s(2,p.IBufferService),s(3,p.IOptionsService),s(4,p.ICoreService),s(5,i.IRenderService)],h)},9806:(g,n)=>{function u(f,s,i){let p=i.getBoundingClientRect(),m=f.getComputedStyle(i),h=parseInt(m.getPropertyValue("padding-left")),l=parseInt(m.getPropertyValue("padding-top"));return[s.clientX-p.left-h,s.clientY-p.top-l]}Object.defineProperty(n,"__esModule",{value:!0}),n.getCoords=n.getCoordsRelativeToElement=void 0,n.getCoordsRelativeToElement=u,n.getCoords=function(f,s,i,p,m,h,l,r,o){if(!h)return;let c=u(f,s,i);return c?(c[0]=Math.ceil((c[0]+(o?l/2:0))/l),c[1]=Math.ceil(c[1]/r),c[0]=Math.min(Math.max(c[0],1),p+(o?1:0)),c[1]=Math.min(Math.max(c[1],1),m),c):void 0}},9504:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.moveToCellSequence=void 0;let f=u(2584);function s(r,o,c,_){let D=r-i(r,c),C=o-i(o,c),b=Math.abs(D-C)-function(S,v,y){let M=0,T=S-i(S,y),w=v-i(v,y);for(let A=0;A<Math.abs(T-w);A++){let I=p(S,v)==="A"?-1:1,R=y.buffer.lines.get(T+I*A);R?.isWrapped&&M++}return M}(r,o,c);return l(b,h(p(r,o),_))}function i(r,o){let c=0,_=o.buffer.lines.get(r),D=_?.isWrapped;for(;D&&r>=0&&r<o.rows;)c++,_=o.buffer.lines.get(--r),D=_?.isWrapped;return c}function p(r,o){return r>o?"A":"B"}function m(r,o,c,_,D,C){let b=r,S=o,v="";for(;b!==c||S!==_;)b+=D?1:-1,D&&b>C.cols-1?(v+=C.buffer.translateBufferLineToString(S,!1,r,b),b=0,r=0,S++):!D&&b<0&&(v+=C.buffer.translateBufferLineToString(S,!1,0,r+1),b=C.cols-1,r=b,S--);return v+C.buffer.translateBufferLineToString(S,!1,r,b)}function h(r,o){let c=o?"O":"[";return f.C0.ESC+c+r}function l(r,o){r=Math.floor(r);let c="";for(let _=0;_<r;_++)c+=o;return c}n.moveToCellSequence=function(r,o,c,_){let D=c.buffer.x,C=c.buffer.y;if(!c.buffer.hasScrollback)return function(v,y,M,T,w,A){return s(y,T,w,A).length===0?"":l(m(v,y,v,y-i(y,w),!1,w).length,h("D",A))}(D,C,0,o,c,_)+s(C,o,c,_)+function(v,y,M,T,w,A){let I;I=s(y,T,w,A).length>0?T-i(T,w):y;let R=T,P=function(W,E,L,x,O,U){let Y;return Y=s(L,x,O,U).length>0?x-i(x,O):E,W<L&&Y<=x||W>=L&&Y<x?"C":"D"}(v,y,M,T,w,A);return l(m(v,I,M,R,P==="C",w).length,h(P,A))}(D,C,r,o,c,_);let b;if(C===o)return b=D>r?"D":"C",l(Math.abs(D-r),h(b,_));b=C>o?"D":"C";let S=Math.abs(C-o);return l(function(v,y){return y.cols-v}(C>o?r:D,c)+(S-1)*c.cols+1+((C>o?D:r)-1),h(b,_))}},1296:function(g,n,u){var f=this&&this.__decorate||function(w,A,I,R){var P,W=arguments.length,E=W<3?A:R===null?R=Object.getOwnPropertyDescriptor(A,I):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(w,A,I,R);else for(var L=w.length-1;L>=0;L--)(P=w[L])&&(E=(W<3?P(E):W>3?P(A,I,E):P(A,I))||E);return W>3&&E&&Object.defineProperty(A,I,E),E},s=this&&this.__param||function(w,A){return function(I,R){A(I,R,w)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomRenderer=void 0;let i=u(3787),p=u(2550),m=u(2223),h=u(6171),l=u(4725),r=u(8055),o=u(8460),c=u(844),_=u(2585),D="xterm-dom-renderer-owner-",C="xterm-rows",b="xterm-fg-",S="xterm-bg-",v="xterm-focus",y="xterm-selection",M=1,T=n.DomRenderer=class extends c.Disposable{constructor(w,A,I,R,P,W,E,L,x,O){super(),this._element=w,this._screenElement=A,this._viewportElement=I,this._linkifier2=R,this._charSizeService=W,this._optionsService=E,this._bufferService=L,this._coreBrowserService=x,this._themeService=O,this._terminalClass=M++,this._rowElements=[],this.onRequestRedraw=this.register(new o.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(C),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(y),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,h.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(U=>this._injectCss(U))),this._injectCss(this._themeService.colors),this._rowFactory=P.createInstance(i.DomRendererRowFactory,document),this._element.classList.add(D+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(U=>this._handleLinkHover(U))),this.register(this._linkifier2.onHideLinkUnderline(U=>this._handleLinkLeave(U))),this.register((0,c.toDisposable)(()=>{this._element.classList.remove(D+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new p.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){let w=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*w,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*w),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/w),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/w),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(let I of this._rowElements)I.style.width=`${this.dimensions.css.canvas.width}px`,I.style.height=`${this.dimensions.css.cell.height}px`,I.style.lineHeight=`${this.dimensions.css.cell.height}px`,I.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));let A=`${this._terminalSelector} .${C} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=A,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(w){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let A=`${this._terminalSelector} .${C} { color: ${w.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;A+=`${this._terminalSelector} .${C} .xterm-dim { color: ${r.color.multiplyOpacity(w.foreground,.5).css};}`,A+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,A+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",A+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${w.cursor.css};  color: ${w.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${w.cursor.css}; }}`,A+=`${this._terminalSelector} .${C}.${v} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${C}.${v} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-block { background-color: ${w.cursor.css}; color: ${w.cursorAccent.css};}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${w.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${w.cursor.css} inset;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${w.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,A+=`${this._terminalSelector} .${y} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${y} div { position: absolute; background-color: ${w.selectionBackgroundOpaque.css};}${this._terminalSelector} .${y} div { position: absolute; background-color: ${w.selectionInactiveBackgroundOpaque.css};}`;for(let[I,R]of w.ansi.entries())A+=`${this._terminalSelector} .${b}${I} { color: ${R.css}; }${this._terminalSelector} .${b}${I}.xterm-dim { color: ${r.color.multiplyOpacity(R,.5).css}; }${this._terminalSelector} .${S}${I} { background-color: ${R.css}; }`;A+=`${this._terminalSelector} .${b}${m.INVERTED_DEFAULT_COLOR} { color: ${r.color.opaque(w.background).css}; }${this._terminalSelector} .${b}${m.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${r.color.multiplyOpacity(r.color.opaque(w.background),.5).css}; }${this._terminalSelector} .${S}${m.INVERTED_DEFAULT_COLOR} { background-color: ${w.foreground.css}; }`,this._themeStyleElement.textContent=A}_setDefaultSpacing(){let w=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${w}px`,this._rowFactory.defaultSpacing=w}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(w,A){for(let I=this._rowElements.length;I<=A;I++){let R=document.createElement("div");this._rowContainer.appendChild(R),this._rowElements.push(R)}for(;this._rowElements.length>A;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(w,A){this._refreshRowElements(w,A),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(v)}handleFocus(){this._rowContainer.classList.add(v),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(w,A,I){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(w,A,I),this.renderRows(0,this._bufferService.rows-1),!w||!A)return;let R=w[1]-this._bufferService.buffer.ydisp,P=A[1]-this._bufferService.buffer.ydisp,W=Math.max(R,0),E=Math.min(P,this._bufferService.rows-1);if(W>=this._bufferService.rows||E<0)return;let L=document.createDocumentFragment();if(I){let x=w[0]>A[0];L.appendChild(this._createSelectionElement(W,x?A[0]:w[0],x?w[0]:A[0],E-W+1))}else{let x=R===W?w[0]:0,O=W===P?A[0]:this._bufferService.cols;L.appendChild(this._createSelectionElement(W,x,O));let U=E-W-1;if(L.appendChild(this._createSelectionElement(W+1,0,this._bufferService.cols,U)),W!==E){let Y=P===E?A[0]:this._bufferService.cols;L.appendChild(this._createSelectionElement(E,0,Y))}}this._selectionContainer.appendChild(L)}_createSelectionElement(w,A,I,R=1){let P=document.createElement("div");return P.style.height=R*this.dimensions.css.cell.height+"px",P.style.top=w*this.dimensions.css.cell.height+"px",P.style.left=A*this.dimensions.css.cell.width+"px",P.style.width=this.dimensions.css.cell.width*(I-A)+"px",P}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(let w of this._rowElements)w.replaceChildren()}renderRows(w,A){let I=this._bufferService.buffer,R=I.ybase+I.y,P=Math.min(I.x,this._bufferService.cols-1),W=this._optionsService.rawOptions.cursorBlink,E=this._optionsService.rawOptions.cursorStyle,L=this._optionsService.rawOptions.cursorInactiveStyle;for(let x=w;x<=A;x++){let O=x+I.ydisp,U=this._rowElements[x],Y=I.lines.get(O);if(!U||!Y)break;U.replaceChildren(...this._rowFactory.createRow(Y,O,O===R,E,L,P,W,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${D}${this._terminalClass}`}_handleLinkHover(w){this._setCellUnderline(w.x1,w.x2,w.y1,w.y2,w.cols,!0)}_handleLinkLeave(w){this._setCellUnderline(w.x1,w.x2,w.y1,w.y2,w.cols,!1)}_setCellUnderline(w,A,I,R,P,W){I<0&&(w=0),R<0&&(A=0);let E=this._bufferService.rows-1;I=Math.max(Math.min(I,E),0),R=Math.max(Math.min(R,E),0),P=Math.min(P,this._bufferService.cols);let L=this._bufferService.buffer,x=L.ybase+L.y,O=Math.min(L.x,P-1),U=this._optionsService.rawOptions.cursorBlink,Y=this._optionsService.rawOptions.cursorStyle,ae=this._optionsService.rawOptions.cursorInactiveStyle;for(let z=I;z<=R;++z){let fe=z+L.ydisp,F=this._rowElements[z],N=L.lines.get(fe);if(!F||!N)break;F.replaceChildren(...this._rowFactory.createRow(N,fe,fe===x,Y,ae,O,U,this.dimensions.css.cell.width,this._widthCache,W?z===I?w:0:-1,W?(z===R?A:P)-1:-1))}}};n.DomRenderer=T=f([s(4,_.IInstantiationService),s(5,l.ICharSizeService),s(6,_.IOptionsService),s(7,_.IBufferService),s(8,l.ICoreBrowserService),s(9,l.IThemeService)],T)},3787:function(g,n,u){var f=this&&this.__decorate||function(b,S,v,y){var M,T=arguments.length,w=T<3?S:y===null?y=Object.getOwnPropertyDescriptor(S,v):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(b,S,v,y);else for(var A=b.length-1;A>=0;A--)(M=b[A])&&(w=(T<3?M(w):T>3?M(S,v,w):M(S,v))||w);return T>3&&w&&Object.defineProperty(S,v,w),w},s=this&&this.__param||function(b,S){return function(v,y){S(v,y,b)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomRendererRowFactory=void 0;let i=u(2223),p=u(643),m=u(511),h=u(2585),l=u(8055),r=u(4725),o=u(4269),c=u(6171),_=u(3734),D=n.DomRendererRowFactory=class{constructor(b,S,v,y,M,T,w){this._document=b,this._characterJoinerService=S,this._optionsService=v,this._coreBrowserService=y,this._coreService=M,this._decorationService=T,this._themeService=w,this._workCell=new m.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(b,S,v){this._selectionStart=b,this._selectionEnd=S,this._columnSelectMode=v}createRow(b,S,v,y,M,T,w,A,I,R,P){let W=[],E=this._characterJoinerService.getJoinedCharacters(S),L=this._themeService.colors,x,O=b.getNoBgTrimmedLength();v&&O<T+1&&(O=T+1);let U=0,Y="",ae=0,z=0,fe=0,F=!1,N=0,B=!1,H=0,le=[],j=R!==-1&&P!==-1;for(let Le=0;Le<O;Le++){b.loadCell(Le,this._workCell);let rt=this._workCell.getWidth();if(rt===0)continue;let Be=!1,Re=Le,qe=this._workCell;if(E.length>0&&Le===E[0][0]){Be=!0;let nt=E.shift();qe=new o.JoinedCellData(this._workCell,b.translateToString(!0,nt[0],nt[1]),nt[1]-nt[0]),Re=nt[1]-1,rt=qe.getWidth()}let Ot=this._isCellInSelection(Le,S),sr=v&&Le===T,dr=j&&Le>=R&&Le<=P,dt=!1;this._decorationService.forEachDecorationAtCell(Le,S,void 0,nt=>{dt=!0});let ue=qe.getChars()||p.WHITESPACE_CELL_CHAR;if(ue===" "&&(qe.isUnderline()||qe.isOverline())&&(ue="\xA0"),H=rt*A-I.get(ue,qe.isBold(),qe.isItalic()),x){if(U&&(Ot&&B||!Ot&&!B&&qe.bg===ae)&&(Ot&&B&&L.selectionForeground||qe.fg===z)&&qe.extended.ext===fe&&dr===F&&H===N&&!sr&&!Be&&!dt){Y+=ue,U++;continue}U&&(x.textContent=Y),x=this._document.createElement("span"),U=0,Y=""}else x=this._document.createElement("span");if(ae=qe.bg,z=qe.fg,fe=qe.extended.ext,F=dr,N=H,B=Ot,Be&&T>=Le&&T<=Re&&(T=Le),!this._coreService.isCursorHidden&&sr){if(le.push("xterm-cursor"),this._coreBrowserService.isFocused)w&&le.push("xterm-cursor-blink"),le.push(y==="bar"?"xterm-cursor-bar":y==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(M)switch(M){case"outline":le.push("xterm-cursor-outline");break;case"block":le.push("xterm-cursor-block");break;case"bar":le.push("xterm-cursor-bar");break;case"underline":le.push("xterm-cursor-underline")}}if(qe.isBold()&&le.push("xterm-bold"),qe.isItalic()&&le.push("xterm-italic"),qe.isDim()&&le.push("xterm-dim"),Y=qe.isInvisible()?p.WHITESPACE_CELL_CHAR:qe.getChars()||p.WHITESPACE_CELL_CHAR,qe.isUnderline()&&(le.push(`xterm-underline-${qe.extended.underlineStyle}`),Y===" "&&(Y="\xA0"),!qe.isUnderlineColorDefault()))if(qe.isUnderlineColorRGB())x.style.textDecorationColor=`rgb(${_.AttributeData.toColorRGB(qe.getUnderlineColor()).join(",")})`;else{let nt=qe.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&qe.isBold()&&nt<8&&(nt+=8),x.style.textDecorationColor=L.ansi[nt].css}qe.isOverline()&&(le.push("xterm-overline"),Y===" "&&(Y="\xA0")),qe.isStrikethrough()&&le.push("xterm-strikethrough"),dr&&(x.style.textDecoration="underline");let ie=qe.getFgColor(),re=qe.getFgColorMode(),K=qe.getBgColor(),me=qe.getBgColorMode(),$e=!!qe.isInverse();if($e){let nt=ie;ie=K,K=nt;let un=re;re=me,me=un}let ze,St,er,rr=!1;switch(this._decorationService.forEachDecorationAtCell(Le,S,void 0,nt=>{nt.options.layer!=="top"&&rr||(nt.backgroundColorRGB&&(me=50331648,K=nt.backgroundColorRGB.rgba>>8&16777215,ze=nt.backgroundColorRGB),nt.foregroundColorRGB&&(re=50331648,ie=nt.foregroundColorRGB.rgba>>8&16777215,St=nt.foregroundColorRGB),rr=nt.options.layer==="top")}),!rr&&Ot&&(ze=this._coreBrowserService.isFocused?L.selectionBackgroundOpaque:L.selectionInactiveBackgroundOpaque,K=ze.rgba>>8&16777215,me=50331648,rr=!0,L.selectionForeground&&(re=50331648,ie=L.selectionForeground.rgba>>8&16777215,St=L.selectionForeground)),rr&&le.push("xterm-decoration-top"),me){case 16777216:case 33554432:er=L.ansi[K],le.push(`xterm-bg-${K}`);break;case 50331648:er=l.rgba.toColor(K>>16,K>>8&255,255&K),this._addStyle(x,`background-color:#${C((K>>>0).toString(16),"0",6)}`);break;default:$e?(er=L.foreground,le.push(`xterm-bg-${i.INVERTED_DEFAULT_COLOR}`)):er=L.background}switch(ze||qe.isDim()&&(ze=l.color.multiplyOpacity(er,.5)),re){case 16777216:case 33554432:qe.isBold()&&ie<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(ie+=8),this._applyMinimumContrast(x,er,L.ansi[ie],qe,ze,void 0)||le.push(`xterm-fg-${ie}`);break;case 50331648:let nt=l.rgba.toColor(ie>>16&255,ie>>8&255,255&ie);this._applyMinimumContrast(x,er,nt,qe,ze,St)||this._addStyle(x,`color:#${C(ie.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(x,er,L.foreground,qe,ze,void 0)||$e&&le.push(`xterm-fg-${i.INVERTED_DEFAULT_COLOR}`)}le.length&&(x.className=le.join(" "),le.length=0),sr||Be||dt?x.textContent=Y:U++,H!==this.defaultSpacing&&(x.style.letterSpacing=`${H}px`),W.push(x),Le=Re}return x&&U&&(x.textContent=Y),W}_applyMinimumContrast(b,S,v,y,M,T){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,c.excludeFromContrastRatioDemands)(y.getCode()))return!1;let w=this._getContrastCache(y),A;if(M||T||(A=w.getColor(S.rgba,v.rgba)),A===void 0){let I=this._optionsService.rawOptions.minimumContrastRatio/(y.isDim()?2:1);A=l.color.ensureContrastRatio(M||S,T||v,I),w.setColor((M||S).rgba,(T||v).rgba,A??null)}return!!A&&(this._addStyle(b,`color:${A.css}`),!0)}_getContrastCache(b){return b.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(b,S){b.setAttribute("style",`${b.getAttribute("style")||""}${S};`)}_isCellInSelection(b,S){let v=this._selectionStart,y=this._selectionEnd;return!(!v||!y)&&(this._columnSelectMode?v[0]<=y[0]?b>=v[0]&&S>=v[1]&&b<y[0]&&S<=y[1]:b<v[0]&&S>=v[1]&&b>=y[0]&&S<=y[1]:S>v[1]&&S<y[1]||v[1]===y[1]&&S===v[1]&&b>=v[0]&&b<y[0]||v[1]<y[1]&&S===y[1]&&b<y[0]||v[1]<y[1]&&S===v[1]&&b>=v[0])}};function C(b,S,v){for(;b.length<v;)b=S+b;return b}n.DomRendererRowFactory=D=f([s(1,r.ICharacterJoinerService),s(2,h.IOptionsService),s(3,r.ICoreBrowserService),s(4,h.ICoreService),s(5,h.IDecorationService),s(6,r.IThemeService)],D)},2550:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WidthCache=void 0,n.WidthCache=class{constructor(u){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=u.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";let f=u.createElement("span"),s=u.createElement("span");s.style.fontWeight="bold";let i=u.createElement("span");i.style.fontStyle="italic";let p=u.createElement("span");p.style.fontWeight="bold",p.style.fontStyle="italic",this._measureElements=[f,s,i,p],this._container.appendChild(f),this._container.appendChild(s),this._container.appendChild(i),this._container.appendChild(p),u.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(u,f,s,i){u===this._font&&f===this._fontSize&&s===this._weight&&i===this._weightBold||(this._font=u,this._fontSize=f,this._weight=s,this._weightBold=i,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${s}`,this._measureElements[1].style.fontWeight=`${i}`,this._measureElements[2].style.fontWeight=`${s}`,this._measureElements[3].style.fontWeight=`${i}`,this.clear())}get(u,f,s){let i=0;if(!f&&!s&&u.length===1&&(i=u.charCodeAt(0))<256)return this._flat[i]!==-9999?this._flat[i]:this._flat[i]=this._measure(u,0);let p=u;f&&(p+="B"),s&&(p+="I");let m=this._holey.get(p);if(m===void 0){let h=0;f&&(h|=1),s&&(h|=2),m=this._measure(u,h),this._holey.set(p,m)}return m}_measure(u,f){let s=this._measureElements[f];return s.textContent=u.repeat(32),s.offsetWidth/32}}},2223:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TEXT_BASELINE=n.DIM_OPACITY=n.INVERTED_DEFAULT_COLOR=void 0;let f=u(6114);n.INVERTED_DEFAULT_COLOR=257,n.DIM_OPACITY=.5,n.TEXT_BASELINE=f.isFirefox||f.isLegacyEdge?"bottom":"ideographic"},6171:(g,n)=>{function u(f){return 57508<=f&&f<=57558}Object.defineProperty(n,"__esModule",{value:!0}),n.createRenderDimensions=n.excludeFromContrastRatioDemands=n.isRestrictedPowerlineGlyph=n.isPowerlineGlyph=n.throwIfFalsy=void 0,n.throwIfFalsy=function(f){if(!f)throw new Error("value must not be falsy");return f},n.isPowerlineGlyph=u,n.isRestrictedPowerlineGlyph=function(f){return 57520<=f&&f<=57527},n.excludeFromContrastRatioDemands=function(f){return u(f)||function(s){return 9472<=s&&s<=9631}(f)},n.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionModel=void 0,n.SelectionModel=class{constructor(u){this._bufferService=u,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){let u=this.selectionStart[0]+this.selectionStartLength;return u>this._bufferService.cols?u%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)-1]:[u%this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)]:[u,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){let u=this.selectionStart[0]+this.selectionStartLength;return u>this._bufferService.cols?[u%this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)]:[Math.max(u,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){let u=this.selectionStart,f=this.selectionEnd;return!(!u||!f)&&(u[1]>f[1]||u[1]===f[1]&&u[0]>f[0])}handleTrim(u){return this.selectionStart&&(this.selectionStart[1]-=u),this.selectionEnd&&(this.selectionEnd[1]-=u),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(g,n,u){var f=this&&this.__decorate||function(r,o,c,_){var D,C=arguments.length,b=C<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,c):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,o,c,_);else for(var S=r.length-1;S>=0;S--)(D=r[S])&&(b=(C<3?D(b):C>3?D(o,c,b):D(o,c))||b);return C>3&&b&&Object.defineProperty(o,c,b),b},s=this&&this.__param||function(r,o){return function(c,_){o(c,_,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CharSizeService=void 0;let i=u(2585),p=u(8460),m=u(844),h=n.CharSizeService=class extends m.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(r,o,c){super(),this._optionsService=c,this.width=0,this.height=0,this._onCharSizeChange=this.register(new p.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new l(r,o,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){let r=this._measureStrategy.measure();r.width===this.width&&r.height===this.height||(this.width=r.width,this.height=r.height,this._onCharSizeChange.fire())}};n.CharSizeService=h=f([s(2,i.IOptionsService)],h);class l{constructor(o,c,_){this._document=o,this._parentElement=c,this._optionsService=_,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;let o={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return o.width!==0&&o.height!==0&&(this._result.width=o.width/32,this._result.height=Math.ceil(o.height)),this._result}}},4269:function(g,n,u){var f=this&&this.__decorate||function(o,c,_,D){var C,b=arguments.length,S=b<3?c:D===null?D=Object.getOwnPropertyDescriptor(c,_):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(o,c,_,D);else for(var v=o.length-1;v>=0;v--)(C=o[v])&&(S=(b<3?C(S):b>3?C(c,_,S):C(c,_))||S);return b>3&&S&&Object.defineProperty(c,_,S),S},s=this&&this.__param||function(o,c){return function(_,D){c(_,D,o)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CharacterJoinerService=n.JoinedCellData=void 0;let i=u(3734),p=u(643),m=u(511),h=u(2585);class l extends i.AttributeData{constructor(c,_,D){super(),this.content=0,this.combinedData="",this.fg=c.fg,this.bg=c.bg,this.combinedData=_,this._width=D}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(c){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}n.JoinedCellData=l;let r=n.CharacterJoinerService=class cb{constructor(c){this._bufferService=c,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new m.CellData}register(c){let _={id:this._nextCharacterJoinerId++,handler:c};return this._characterJoiners.push(_),_.id}deregister(c){for(let _=0;_<this._characterJoiners.length;_++)if(this._characterJoiners[_].id===c)return this._characterJoiners.splice(_,1),!0;return!1}getJoinedCharacters(c){if(this._characterJoiners.length===0)return[];let _=this._bufferService.buffer.lines.get(c);if(!_||_.length===0)return[];let D=[],C=_.translateToString(!0),b=0,S=0,v=0,y=_.getFg(0),M=_.getBg(0);for(let T=0;T<_.getTrimmedLength();T++)if(_.loadCell(T,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==y||this._workCell.bg!==M){if(T-b>1){let w=this._getJoinedRanges(C,v,S,_,b);for(let A=0;A<w.length;A++)D.push(w[A])}b=T,v=S,y=this._workCell.fg,M=this._workCell.bg}S+=this._workCell.getChars().length||p.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-b>1){let T=this._getJoinedRanges(C,v,S,_,b);for(let w=0;w<T.length;w++)D.push(T[w])}return D}_getJoinedRanges(c,_,D,C,b){let S=c.substring(_,D),v=[];try{v=this._characterJoiners[0].handler(S)}catch(y){console.error(y)}for(let y=1;y<this._characterJoiners.length;y++)try{let M=this._characterJoiners[y].handler(S);for(let T=0;T<M.length;T++)cb._mergeRanges(v,M[T])}catch(M){console.error(M)}return this._stringRangesToCellRanges(v,C,b),v}_stringRangesToCellRanges(c,_,D){let C=0,b=!1,S=0,v=c[C];if(v){for(let y=D;y<this._bufferService.cols;y++){let M=_.getWidth(y),T=_.getString(y).length||p.WHITESPACE_CELL_CHAR.length;if(M!==0){if(!b&&v[0]<=S&&(v[0]=y,b=!0),v[1]<=S){if(v[1]=y,v=c[++C],!v)break;v[0]<=S?(v[0]=y,b=!0):b=!1}S+=T}}v&&(v[1]=this._bufferService.cols)}}static _mergeRanges(c,_){let D=!1;for(let C=0;C<c.length;C++){let b=c[C];if(D){if(_[1]<=b[0])return c[C-1][1]=_[1],c;if(_[1]<=b[1])return c[C-1][1]=Math.max(_[1],b[1]),c.splice(C,1),c;c.splice(C,1),C--}else{if(_[1]<=b[0])return c.splice(C,0,_),c;if(_[1]<=b[1])return b[0]=Math.min(_[0],b[0]),c;_[0]<b[1]&&(b[0]=Math.min(_[0],b[0]),D=!0)}}return D?c[c.length-1][1]=_[1]:c.push(_),c}};n.CharacterJoinerService=r=f([s(0,h.IBufferService)],r)},5114:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CoreBrowserService=void 0,n.CoreBrowserService=class{constructor(u,f){this._textarea=u,this.window=f,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(g,n,u){var f=this&&this.__decorate||function(h,l,r,o){var c,_=arguments.length,D=_<3?l:o===null?o=Object.getOwnPropertyDescriptor(l,r):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(h,l,r,o);else for(var C=h.length-1;C>=0;C--)(c=h[C])&&(D=(_<3?c(D):_>3?c(l,r,D):c(l,r))||D);return _>3&&D&&Object.defineProperty(l,r,D),D},s=this&&this.__param||function(h,l){return function(r,o){l(r,o,h)}};Object.defineProperty(n,"__esModule",{value:!0}),n.MouseService=void 0;let i=u(4725),p=u(9806),m=n.MouseService=class{constructor(h,l){this._renderService=h,this._charSizeService=l}getCoords(h,l,r,o,c){return(0,p.getCoords)(window,h,l,r,o,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,c)}getMouseReportCoords(h,l){let r=(0,p.getCoordsRelativeToElement)(window,h,l);if(this._charSizeService.hasValidSize)return r[0]=Math.min(Math.max(r[0],0),this._renderService.dimensions.css.canvas.width-1),r[1]=Math.min(Math.max(r[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(r[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(r[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(r[0]),y:Math.floor(r[1])}}};n.MouseService=m=f([s(0,i.IRenderService),s(1,i.ICharSizeService)],m)},3230:function(g,n,u){var f=this&&this.__decorate||function(D,C,b,S){var v,y=arguments.length,M=y<3?C:S===null?S=Object.getOwnPropertyDescriptor(C,b):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(D,C,b,S);else for(var T=D.length-1;T>=0;T--)(v=D[T])&&(M=(y<3?v(M):y>3?v(C,b,M):v(C,b))||M);return y>3&&M&&Object.defineProperty(C,b,M),M},s=this&&this.__param||function(D,C){return function(b,S){C(b,S,D)}};Object.defineProperty(n,"__esModule",{value:!0}),n.RenderService=void 0;let i=u(3656),p=u(6193),m=u(5596),h=u(4725),l=u(8460),r=u(844),o=u(7226),c=u(2585),_=n.RenderService=class extends r.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(D,C,b,S,v,y,M,T){if(super(),this._rowCount=D,this._charSizeService=S,this._renderer=this.register(new r.MutableDisposable),this._pausedResizeTask=new o.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new l.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new l.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new l.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new l.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new p.RenderDebouncer(M.window,(w,A)=>this._renderRows(w,A)),this.register(this._renderDebouncer),this._screenDprMonitor=new m.ScreenDprMonitor(M.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(y.onResize(()=>this._fullRefresh())),this.register(y.buffers.onBufferActivate(()=>{var w;return(w=this._renderer.value)===null||w===void 0?void 0:w.clear()})),this.register(b.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(v.onDecorationRegistered(()=>this._fullRefresh())),this.register(v.onDecorationRemoved(()=>this._fullRefresh())),this.register(b.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(y.cols,y.rows),this._fullRefresh()})),this.register(b.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(y.buffer.y,y.buffer.y,!0))),this.register((0,i.addDisposableDomListener)(M.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(T.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in M.window){let w=new M.window.IntersectionObserver(A=>this._handleIntersectionChange(A[A.length-1]),{threshold:0});w.observe(C),this.register({dispose:()=>w.disconnect()})}}_handleIntersectionChange(D){this._isPaused=D.isIntersecting===void 0?D.intersectionRatio===0:!D.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(D,C,b=!1){this._isPaused?this._needsFullRefresh=!0:(b||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(D,C,this._rowCount))}_renderRows(D,C){this._renderer.value&&(D=Math.min(D,this._rowCount-1),C=Math.min(C,this._rowCount-1),this._renderer.value.renderRows(D,C),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:D,end:C}),this._onRender.fire({start:D,end:C}),this._isNextRenderRedrawOnly=!0)}resize(D,C){this._rowCount=C,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(D){this._renderer.value=D,this._renderer.value.onRequestRedraw(C=>this.refreshRows(C.start,C.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(D){return this._renderDebouncer.addRefreshCallback(D)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var D,C;this._renderer.value&&((C=(D=this._renderer.value).clearTextureAtlas)===null||C===void 0||C.call(D),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(D,C){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(D,C)):this._renderer.value.handleResize(D,C),this._fullRefresh())}handleCharSizeChanged(){var D;(D=this._renderer.value)===null||D===void 0||D.handleCharSizeChanged()}handleBlur(){var D;(D=this._renderer.value)===null||D===void 0||D.handleBlur()}handleFocus(){var D;(D=this._renderer.value)===null||D===void 0||D.handleFocus()}handleSelectionChanged(D,C,b){var S;this._selectionState.start=D,this._selectionState.end=C,this._selectionState.columnSelectMode=b,(S=this._renderer.value)===null||S===void 0||S.handleSelectionChanged(D,C,b)}handleCursorMove(){var D;(D=this._renderer.value)===null||D===void 0||D.handleCursorMove()}clear(){var D;(D=this._renderer.value)===null||D===void 0||D.clear()}};n.RenderService=_=f([s(2,c.IOptionsService),s(3,h.ICharSizeService),s(4,c.IDecorationService),s(5,c.IBufferService),s(6,h.ICoreBrowserService),s(7,h.IThemeService)],_)},9312:function(g,n,u){var f=this&&this.__decorate||function(v,y,M,T){var w,A=arguments.length,I=A<3?y:T===null?T=Object.getOwnPropertyDescriptor(y,M):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(v,y,M,T);else for(var R=v.length-1;R>=0;R--)(w=v[R])&&(I=(A<3?w(I):A>3?w(y,M,I):w(y,M))||I);return A>3&&I&&Object.defineProperty(y,M,I),I},s=this&&this.__param||function(v,y){return function(M,T){y(M,T,v)}};Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionService=void 0;let i=u(9806),p=u(9504),m=u(456),h=u(4725),l=u(8460),r=u(844),o=u(6114),c=u(4841),_=u(511),D=u(2585),C=String.fromCharCode(160),b=new RegExp(C,"g"),S=n.SelectionService=class extends r.Disposable{constructor(v,y,M,T,w,A,I,R,P){super(),this._element=v,this._screenElement=y,this._linkifier=M,this._bufferService=T,this._coreService=w,this._mouseService=A,this._optionsService=I,this._renderService=R,this._coreBrowserService=P,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new _.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new l.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new l.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new l.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new l.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=W=>this._handleMouseMove(W),this._mouseUpListener=W=>this._handleMouseUp(W),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(W=>this._handleTrim(W)),this.register(this._bufferService.buffers.onBufferActivate(W=>this._handleBufferActivate(W))),this.enable(),this._model=new m.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,r.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){let v=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;return!(!v||!y||v[0]===y[0]&&v[1]===y[1])}get selectionText(){let v=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;if(!v||!y)return"";let M=this._bufferService.buffer,T=[];if(this._activeSelectionMode===3){if(v[0]===y[0])return"";let w=v[0]<y[0]?v[0]:y[0],A=v[0]<y[0]?y[0]:v[0];for(let I=v[1];I<=y[1];I++){let R=M.translateBufferLineToString(I,!0,w,A);T.push(R)}}else{let w=v[1]===y[1]?y[0]:void 0;T.push(M.translateBufferLineToString(v[1],!0,v[0],w));for(let A=v[1]+1;A<=y[1]-1;A++){let I=M.lines.get(A),R=M.translateBufferLineToString(A,!0);I?.isWrapped?T[T.length-1]+=R:T.push(R)}if(v[1]!==y[1]){let A=M.lines.get(y[1]),I=M.translateBufferLineToString(y[1],!0,0,y[0]);A&&A.isWrapped?T[T.length-1]+=I:T.push(I)}}return T.map(w=>w.replace(b," ")).join(o.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(v){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),o.isLinux&&v&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(v){let y=this._getMouseBufferCoords(v),M=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;return!!(M&&T&&y)&&this._areCoordsInSelection(y,M,T)}isCellInSelection(v,y){let M=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;return!(!M||!T)&&this._areCoordsInSelection([v,y],M,T)}_areCoordsInSelection(v,y,M){return v[1]>y[1]&&v[1]<M[1]||y[1]===M[1]&&v[1]===y[1]&&v[0]>=y[0]&&v[0]<M[0]||y[1]<M[1]&&v[1]===M[1]&&v[0]<M[0]||y[1]<M[1]&&v[1]===y[1]&&v[0]>=y[0]}_selectWordAtCursor(v,y){var M,T;let w=(T=(M=this._linkifier.currentLink)===null||M===void 0?void 0:M.link)===null||T===void 0?void 0:T.range;if(w)return this._model.selectionStart=[w.start.x-1,w.start.y-1],this._model.selectionStartLength=(0,c.getRangeLength)(w,this._bufferService.cols),this._model.selectionEnd=void 0,!0;let A=this._getMouseBufferCoords(v);return!!A&&(this._selectWordAt(A,y),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(v,y){this._model.clearSelection(),v=Math.max(v,0),y=Math.min(y,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,v],this._model.selectionEnd=[this._bufferService.cols,y],this.refresh(),this._onSelectionChange.fire()}_handleTrim(v){this._model.handleTrim(v)&&this.refresh()}_getMouseBufferCoords(v){let y=this._mouseService.getCoords(v,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(y)return y[0]--,y[1]--,y[1]+=this._bufferService.buffer.ydisp,y}_getMouseEventScrollAmount(v){let y=(0,i.getCoordsRelativeToElement)(this._coreBrowserService.window,v,this._screenElement)[1],M=this._renderService.dimensions.css.canvas.height;return y>=0&&y<=M?0:(y>M&&(y-=M),y=Math.min(Math.max(y,-50),50),y/=50,y/Math.abs(y)+Math.round(14*y))}shouldForceSelection(v){return o.isMac?v.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:v.shiftKey}handleMouseDown(v){if(this._mouseDownTimeStamp=v.timeStamp,(v.button!==2||!this.hasSelection)&&v.button===0){if(!this._enabled){if(!this.shouldForceSelection(v))return;v.stopPropagation()}v.preventDefault(),this._dragScrollAmount=0,this._enabled&&v.shiftKey?this._handleIncrementalClick(v):v.detail===1?this._handleSingleClick(v):v.detail===2?this._handleDoubleClick(v):v.detail===3&&this._handleTripleClick(v),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(v){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(v))}_handleSingleClick(v){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(v)?3:0,this._model.selectionStart=this._getMouseBufferCoords(v),!this._model.selectionStart)return;this._model.selectionEnd=void 0;let y=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);y&&y.length!==this._model.selectionStart[0]&&y.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(v){this._selectWordAtCursor(v,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(v){let y=this._getMouseBufferCoords(v);y&&(this._activeSelectionMode=2,this._selectLineAt(y[1]))}shouldColumnSelect(v){return v.altKey&&!(o.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(v){if(v.stopImmediatePropagation(),!this._model.selectionStart)return;let y=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(v),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(v),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));let M=this._bufferService.buffer;if(this._model.selectionEnd[1]<M.lines.length){let T=M.lines.get(this._model.selectionEnd[1]);T&&T.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}y&&y[0]===this._model.selectionEnd[0]&&y[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});let v=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(v.ydisp+this._bufferService.rows,v.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=v.ydisp),this.refresh()}}_handleMouseUp(v){let y=v.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&y<500&&v.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){let M=this._mouseService.getCoords(v,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(M&&M[0]!==void 0&&M[1]!==void 0){let T=(0,p.moveToCellSequence)(M[0]-1,M[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(T,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){let v=this._model.finalSelectionStart,y=this._model.finalSelectionEnd,M=!(!v||!y||v[0]===y[0]&&v[1]===y[1]);M?v&&y&&(this._oldSelectionStart&&this._oldSelectionEnd&&v[0]===this._oldSelectionStart[0]&&v[1]===this._oldSelectionStart[1]&&y[0]===this._oldSelectionEnd[0]&&y[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(v,y,M)):this._oldHasSelection&&this._fireOnSelectionChange(v,y,M)}_fireOnSelectionChange(v,y,M){this._oldSelectionStart=v,this._oldSelectionEnd=y,this._oldHasSelection=M,this._onSelectionChange.fire()}_handleBufferActivate(v){this.clearSelection(),this._trimListener.dispose(),this._trimListener=v.activeBuffer.lines.onTrim(y=>this._handleTrim(y))}_convertViewportColToCharacterIndex(v,y){let M=y;for(let T=0;y>=T;T++){let w=v.loadCell(T,this._workCell).getChars().length;this._workCell.getWidth()===0?M--:w>1&&y!==T&&(M+=w-1)}return M}setSelection(v,y,M){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[v,y],this._model.selectionStartLength=M,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(v){this._isClickInSelection(v)||(this._selectWordAtCursor(v,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(v,y,M=!0,T=!0){if(v[0]>=this._bufferService.cols)return;let w=this._bufferService.buffer,A=w.lines.get(v[1]);if(!A)return;let I=w.translateBufferLineToString(v[1],!1),R=this._convertViewportColToCharacterIndex(A,v[0]),P=R,W=v[0]-R,E=0,L=0,x=0,O=0;if(I.charAt(R)===" "){for(;R>0&&I.charAt(R-1)===" ";)R--;for(;P<I.length&&I.charAt(P+1)===" ";)P++}else{let ae=v[0],z=v[0];A.getWidth(ae)===0&&(E++,ae--),A.getWidth(z)===2&&(L++,z++);let fe=A.getString(z).length;for(fe>1&&(O+=fe-1,P+=fe-1);ae>0&&R>0&&!this._isCharWordSeparator(A.loadCell(ae-1,this._workCell));){A.loadCell(ae-1,this._workCell);let F=this._workCell.getChars().length;this._workCell.getWidth()===0?(E++,ae--):F>1&&(x+=F-1,R-=F-1),R--,ae--}for(;z<A.length&&P+1<I.length&&!this._isCharWordSeparator(A.loadCell(z+1,this._workCell));){A.loadCell(z+1,this._workCell);let F=this._workCell.getChars().length;this._workCell.getWidth()===2?(L++,z++):F>1&&(O+=F-1,P+=F-1),P++,z++}}P++;let U=R+W-E+x,Y=Math.min(this._bufferService.cols,P-R+E+L-x-O);if(y||I.slice(R,P).trim()!==""){if(M&&U===0&&A.getCodePoint(0)!==32){let ae=w.lines.get(v[1]-1);if(ae&&A.isWrapped&&ae.getCodePoint(this._bufferService.cols-1)!==32){let z=this._getWordAt([this._bufferService.cols-1,v[1]-1],!1,!0,!1);if(z){let fe=this._bufferService.cols-z.start;U-=fe,Y+=fe}}}if(T&&U+Y===this._bufferService.cols&&A.getCodePoint(this._bufferService.cols-1)!==32){let ae=w.lines.get(v[1]+1);if(ae?.isWrapped&&ae.getCodePoint(0)!==32){let z=this._getWordAt([0,v[1]+1],!1,!1,!0);z&&(Y+=z.length)}}return{start:U,length:Y}}}_selectWordAt(v,y){let M=this._getWordAt(v,y);if(M){for(;M.start<0;)M.start+=this._bufferService.cols,v[1]--;this._model.selectionStart=[M.start,v[1]],this._model.selectionStartLength=M.length}}_selectToWordAt(v){let y=this._getWordAt(v,!0);if(y){let M=v[1];for(;y.start<0;)y.start+=this._bufferService.cols,M--;if(!this._model.areSelectionValuesReversed())for(;y.start+y.length>this._bufferService.cols;)y.length-=this._bufferService.cols,M++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?y.start:y.start+y.length,M]}}_isCharWordSeparator(v){return v.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(v.getChars())>=0}_selectLineAt(v){let y=this._bufferService.buffer.getWrappedRangeForLine(v),M={start:{x:0,y:y.first},end:{x:this._bufferService.cols-1,y:y.last}};this._model.selectionStart=[0,y.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,c.getRangeLength)(M,this._bufferService.cols)}};n.SelectionService=S=f([s(3,D.IBufferService),s(4,D.ICoreService),s(5,h.IMouseService),s(6,D.IOptionsService),s(7,h.IRenderService),s(8,h.ICoreBrowserService)],S)},4725:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IThemeService=n.ICharacterJoinerService=n.ISelectionService=n.IRenderService=n.IMouseService=n.ICoreBrowserService=n.ICharSizeService=void 0;let f=u(8343);n.ICharSizeService=(0,f.createDecorator)("CharSizeService"),n.ICoreBrowserService=(0,f.createDecorator)("CoreBrowserService"),n.IMouseService=(0,f.createDecorator)("MouseService"),n.IRenderService=(0,f.createDecorator)("RenderService"),n.ISelectionService=(0,f.createDecorator)("SelectionService"),n.ICharacterJoinerService=(0,f.createDecorator)("CharacterJoinerService"),n.IThemeService=(0,f.createDecorator)("ThemeService")},6731:function(g,n,u){var f=this&&this.__decorate||function(S,v,y,M){var T,w=arguments.length,A=w<3?v:M===null?M=Object.getOwnPropertyDescriptor(v,y):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(S,v,y,M);else for(var I=S.length-1;I>=0;I--)(T=S[I])&&(A=(w<3?T(A):w>3?T(v,y,A):T(v,y))||A);return w>3&&A&&Object.defineProperty(v,y,A),A},s=this&&this.__param||function(S,v){return function(y,M){v(y,M,S)}};Object.defineProperty(n,"__esModule",{value:!0}),n.ThemeService=n.DEFAULT_ANSI_COLORS=void 0;let i=u(7239),p=u(8055),m=u(8460),h=u(844),l=u(2585),r=p.css.toColor("#ffffff"),o=p.css.toColor("#000000"),c=p.css.toColor("#ffffff"),_=p.css.toColor("#000000"),D={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};n.DEFAULT_ANSI_COLORS=Object.freeze((()=>{let S=[p.css.toColor("#2e3436"),p.css.toColor("#cc0000"),p.css.toColor("#4e9a06"),p.css.toColor("#c4a000"),p.css.toColor("#3465a4"),p.css.toColor("#75507b"),p.css.toColor("#06989a"),p.css.toColor("#d3d7cf"),p.css.toColor("#555753"),p.css.toColor("#ef2929"),p.css.toColor("#8ae234"),p.css.toColor("#fce94f"),p.css.toColor("#729fcf"),p.css.toColor("#ad7fa8"),p.css.toColor("#34e2e2"),p.css.toColor("#eeeeec")],v=[0,95,135,175,215,255];for(let y=0;y<216;y++){let M=v[y/36%6|0],T=v[y/6%6|0],w=v[y%6];S.push({css:p.channels.toCss(M,T,w),rgba:p.channels.toRgba(M,T,w)})}for(let y=0;y<24;y++){let M=8+10*y;S.push({css:p.channels.toCss(M,M,M),rgba:p.channels.toRgba(M,M,M)})}return S})());let C=n.ThemeService=class extends h.Disposable{get colors(){return this._colors}constructor(S){super(),this._optionsService=S,this._contrastCache=new i.ColorContrastCache,this._halfContrastCache=new i.ColorContrastCache,this._onChangeColors=this.register(new m.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:r,background:o,cursor:c,cursorAccent:_,selectionForeground:void 0,selectionBackgroundTransparent:D,selectionBackgroundOpaque:p.color.blend(o,D),selectionInactiveBackgroundTransparent:D,selectionInactiveBackgroundOpaque:p.color.blend(o,D),ansi:n.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(S={}){let v=this._colors;if(v.foreground=b(S.foreground,r),v.background=b(S.background,o),v.cursor=b(S.cursor,c),v.cursorAccent=b(S.cursorAccent,_),v.selectionBackgroundTransparent=b(S.selectionBackground,D),v.selectionBackgroundOpaque=p.color.blend(v.background,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundTransparent=b(S.selectionInactiveBackground,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundOpaque=p.color.blend(v.background,v.selectionInactiveBackgroundTransparent),v.selectionForeground=S.selectionForeground?b(S.selectionForeground,p.NULL_COLOR):void 0,v.selectionForeground===p.NULL_COLOR&&(v.selectionForeground=void 0),p.color.isOpaque(v.selectionBackgroundTransparent)&&(v.selectionBackgroundTransparent=p.color.opacity(v.selectionBackgroundTransparent,.3)),p.color.isOpaque(v.selectionInactiveBackgroundTransparent)&&(v.selectionInactiveBackgroundTransparent=p.color.opacity(v.selectionInactiveBackgroundTransparent,.3)),v.ansi=n.DEFAULT_ANSI_COLORS.slice(),v.ansi[0]=b(S.black,n.DEFAULT_ANSI_COLORS[0]),v.ansi[1]=b(S.red,n.DEFAULT_ANSI_COLORS[1]),v.ansi[2]=b(S.green,n.DEFAULT_ANSI_COLORS[2]),v.ansi[3]=b(S.yellow,n.DEFAULT_ANSI_COLORS[3]),v.ansi[4]=b(S.blue,n.DEFAULT_ANSI_COLORS[4]),v.ansi[5]=b(S.magenta,n.DEFAULT_ANSI_COLORS[5]),v.ansi[6]=b(S.cyan,n.DEFAULT_ANSI_COLORS[6]),v.ansi[7]=b(S.white,n.DEFAULT_ANSI_COLORS[7]),v.ansi[8]=b(S.brightBlack,n.DEFAULT_ANSI_COLORS[8]),v.ansi[9]=b(S.brightRed,n.DEFAULT_ANSI_COLORS[9]),v.ansi[10]=b(S.brightGreen,n.DEFAULT_ANSI_COLORS[10]),v.ansi[11]=b(S.brightYellow,n.DEFAULT_ANSI_COLORS[11]),v.ansi[12]=b(S.brightBlue,n.DEFAULT_ANSI_COLORS[12]),v.ansi[13]=b(S.brightMagenta,n.DEFAULT_ANSI_COLORS[13]),v.ansi[14]=b(S.brightCyan,n.DEFAULT_ANSI_COLORS[14]),v.ansi[15]=b(S.brightWhite,n.DEFAULT_ANSI_COLORS[15]),S.extendedAnsi){let y=Math.min(v.ansi.length-16,S.extendedAnsi.length);for(let M=0;M<y;M++)v.ansi[M+16]=b(S.extendedAnsi[M],n.DEFAULT_ANSI_COLORS[M+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(S){this._restoreColor(S),this._onChangeColors.fire(this.colors)}_restoreColor(S){if(S!==void 0)switch(S){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[S]=this._restoreColors.ansi[S]}else for(let v=0;v<this._restoreColors.ansi.length;++v)this._colors.ansi[v]=this._restoreColors.ansi[v]}modifyColors(S){S(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function b(S,v){if(S!==void 0)try{return p.css.toColor(S)}catch{}return v}n.ThemeService=C=f([s(0,l.IOptionsService)],C)},6349:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CircularList=void 0;let f=u(8460),s=u(844);class i extends s.Disposable{constructor(m){super(),this._maxLength=m,this.onDeleteEmitter=this.register(new f.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new f.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new f.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(m){if(this._maxLength===m)return;let h=new Array(m);for(let l=0;l<Math.min(m,this.length);l++)h[l]=this._array[this._getCyclicIndex(l)];this._array=h,this._maxLength=m,this._startIndex=0}get length(){return this._length}set length(m){if(m>this._length)for(let h=this._length;h<m;h++)this._array[h]=void 0;this._length=m}get(m){return this._array[this._getCyclicIndex(m)]}set(m,h){this._array[this._getCyclicIndex(m)]=h}push(m){this._array[this._getCyclicIndex(this._length)]=m,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(m,h,...l){if(h){for(let r=m;r<this._length-h;r++)this._array[this._getCyclicIndex(r)]=this._array[this._getCyclicIndex(r+h)];this._length-=h,this.onDeleteEmitter.fire({index:m,amount:h})}for(let r=this._length-1;r>=m;r--)this._array[this._getCyclicIndex(r+l.length)]=this._array[this._getCyclicIndex(r)];for(let r=0;r<l.length;r++)this._array[this._getCyclicIndex(m+r)]=l[r];if(l.length&&this.onInsertEmitter.fire({index:m,amount:l.length}),this._length+l.length>this._maxLength){let r=this._length+l.length-this._maxLength;this._startIndex+=r,this._length=this._maxLength,this.onTrimEmitter.fire(r)}else this._length+=l.length}trimStart(m){m>this._length&&(m=this._length),this._startIndex+=m,this._length-=m,this.onTrimEmitter.fire(m)}shiftElements(m,h,l){if(!(h<=0)){if(m<0||m>=this._length)throw new Error("start argument out of range");if(m+l<0)throw new Error("Cannot shift elements in list beyond index 0");if(l>0){for(let o=h-1;o>=0;o--)this.set(m+o+l,this.get(m+o));let r=m+h+l-this._length;if(r>0)for(this._length+=r;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let r=0;r<h;r++)this.set(m+r+l,this.get(m+r))}}_getCyclicIndex(m){return(this._startIndex+m)%this._maxLength}}n.CircularList=i},1439:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.clone=void 0,n.clone=function u(f,s=5){if(typeof f!="object")return f;let i=Array.isArray(f)?[]:{};for(let p in f)i[p]=s<=1?f[p]:f[p]&&u(f[p],s-1);return i}},8055:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.contrastRatio=n.toPaddedHex=n.rgba=n.rgb=n.css=n.color=n.channels=n.NULL_COLOR=void 0;let f=u(6114),s=0,i=0,p=0,m=0;var h,l,r,o,c;function _(C){let b=C.toString(16);return b.length<2?"0"+b:b}function D(C,b){return C<b?(b+.05)/(C+.05):(C+.05)/(b+.05)}n.NULL_COLOR={css:"#00000000",rgba:0},function(C){C.toCss=function(b,S,v,y){return y!==void 0?`#${_(b)}${_(S)}${_(v)}${_(y)}`:`#${_(b)}${_(S)}${_(v)}`},C.toRgba=function(b,S,v,y=255){return(b<<24|S<<16|v<<8|y)>>>0}}(h||(n.channels=h={})),function(C){function b(S,v){return m=Math.round(255*v),[s,i,p]=c.toChannels(S.rgba),{css:h.toCss(s,i,p,m),rgba:h.toRgba(s,i,p,m)}}C.blend=function(S,v){if(m=(255&v.rgba)/255,m===1)return{css:v.css,rgba:v.rgba};let y=v.rgba>>24&255,M=v.rgba>>16&255,T=v.rgba>>8&255,w=S.rgba>>24&255,A=S.rgba>>16&255,I=S.rgba>>8&255;return s=w+Math.round((y-w)*m),i=A+Math.round((M-A)*m),p=I+Math.round((T-I)*m),{css:h.toCss(s,i,p),rgba:h.toRgba(s,i,p)}},C.isOpaque=function(S){return(255&S.rgba)==255},C.ensureContrastRatio=function(S,v,y){let M=c.ensureContrastRatio(S.rgba,v.rgba,y);if(M)return c.toColor(M>>24&255,M>>16&255,M>>8&255)},C.opaque=function(S){let v=(255|S.rgba)>>>0;return[s,i,p]=c.toChannels(v),{css:h.toCss(s,i,p),rgba:v}},C.opacity=b,C.multiplyOpacity=function(S,v){return m=255&S.rgba,b(S,m*v/255)},C.toColorRGB=function(S){return[S.rgba>>24&255,S.rgba>>16&255,S.rgba>>8&255]}}(l||(n.color=l={})),function(C){let b,S;if(!f.isNode){let v=document.createElement("canvas");v.width=1,v.height=1;let y=v.getContext("2d",{willReadFrequently:!0});y&&(b=y,b.globalCompositeOperation="copy",S=b.createLinearGradient(0,0,1,1))}C.toColor=function(v){if(v.match(/#[\da-f]{3,8}/i))switch(v.length){case 4:return s=parseInt(v.slice(1,2).repeat(2),16),i=parseInt(v.slice(2,3).repeat(2),16),p=parseInt(v.slice(3,4).repeat(2),16),c.toColor(s,i,p);case 5:return s=parseInt(v.slice(1,2).repeat(2),16),i=parseInt(v.slice(2,3).repeat(2),16),p=parseInt(v.slice(3,4).repeat(2),16),m=parseInt(v.slice(4,5).repeat(2),16),c.toColor(s,i,p,m);case 7:return{css:v,rgba:(parseInt(v.slice(1),16)<<8|255)>>>0};case 9:return{css:v,rgba:parseInt(v.slice(1),16)>>>0}}let y=v.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(y)return s=parseInt(y[1]),i=parseInt(y[2]),p=parseInt(y[3]),m=Math.round(255*(y[5]===void 0?1:parseFloat(y[5]))),c.toColor(s,i,p,m);if(!b||!S)throw new Error("css.toColor: Unsupported css format");if(b.fillStyle=S,b.fillStyle=v,typeof b.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(b.fillRect(0,0,1,1),[s,i,p,m]=b.getImageData(0,0,1,1).data,m!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:h.toRgba(s,i,p,m),css:v}}}(r||(n.css=r={})),function(C){function b(S,v,y){let M=S/255,T=v/255,w=y/255;return .2126*(M<=.03928?M/12.92:Math.pow((M+.055)/1.055,2.4))+.7152*(T<=.03928?T/12.92:Math.pow((T+.055)/1.055,2.4))+.0722*(w<=.03928?w/12.92:Math.pow((w+.055)/1.055,2.4))}C.relativeLuminance=function(S){return b(S>>16&255,S>>8&255,255&S)},C.relativeLuminance2=b}(o||(n.rgb=o={})),function(C){function b(v,y,M){let T=v>>24&255,w=v>>16&255,A=v>>8&255,I=y>>24&255,R=y>>16&255,P=y>>8&255,W=D(o.relativeLuminance2(I,R,P),o.relativeLuminance2(T,w,A));for(;W<M&&(I>0||R>0||P>0);)I-=Math.max(0,Math.ceil(.1*I)),R-=Math.max(0,Math.ceil(.1*R)),P-=Math.max(0,Math.ceil(.1*P)),W=D(o.relativeLuminance2(I,R,P),o.relativeLuminance2(T,w,A));return(I<<24|R<<16|P<<8|255)>>>0}function S(v,y,M){let T=v>>24&255,w=v>>16&255,A=v>>8&255,I=y>>24&255,R=y>>16&255,P=y>>8&255,W=D(o.relativeLuminance2(I,R,P),o.relativeLuminance2(T,w,A));for(;W<M&&(I<255||R<255||P<255);)I=Math.min(255,I+Math.ceil(.1*(255-I))),R=Math.min(255,R+Math.ceil(.1*(255-R))),P=Math.min(255,P+Math.ceil(.1*(255-P))),W=D(o.relativeLuminance2(I,R,P),o.relativeLuminance2(T,w,A));return(I<<24|R<<16|P<<8|255)>>>0}C.ensureContrastRatio=function(v,y,M){let T=o.relativeLuminance(v>>8),w=o.relativeLuminance(y>>8);if(D(T,w)<M){if(w<T){let R=b(v,y,M),P=D(T,o.relativeLuminance(R>>8));if(P<M){let W=S(v,y,M);return P>D(T,o.relativeLuminance(W>>8))?R:W}return R}let A=S(v,y,M),I=D(T,o.relativeLuminance(A>>8));if(I<M){let R=b(v,y,M);return I>D(T,o.relativeLuminance(R>>8))?A:R}return A}},C.reduceLuminance=b,C.increaseLuminance=S,C.toChannels=function(v){return[v>>24&255,v>>16&255,v>>8&255,255&v]},C.toColor=function(v,y,M,T){return{css:h.toCss(v,y,M,T),rgba:h.toRgba(v,y,M,T)}}}(c||(n.rgba=c={})),n.toPaddedHex=_,n.contrastRatio=D},8969:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CoreTerminal=void 0;let f=u(844),s=u(2585),i=u(4348),p=u(7866),m=u(744),h=u(7302),l=u(6975),r=u(8460),o=u(1753),c=u(1480),_=u(7994),D=u(9282),C=u(5435),b=u(5981),S=u(2660),v=!1;class y extends f.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new r.EventEmitter),this._onScroll.event(T=>{var w;(w=this._onScrollApi)===null||w===void 0||w.fire(T.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(T){for(let w in T)this.optionsService.options[w]=T[w]}constructor(T){super(),this._windowsWrappingHeuristics=this.register(new f.MutableDisposable),this._onBinary=this.register(new r.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new r.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new r.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new r.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new r.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new r.EventEmitter),this._instantiationService=new i.InstantiationService,this.optionsService=this.register(new h.OptionsService(T)),this._instantiationService.setService(s.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(m.BufferService)),this._instantiationService.setService(s.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(p.LogService)),this._instantiationService.setService(s.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(l.CoreService)),this._instantiationService.setService(s.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(o.CoreMouseService)),this._instantiationService.setService(s.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(c.UnicodeService)),this._instantiationService.setService(s.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(_.CharsetService),this._instantiationService.setService(s.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(S.OscLinkService),this._instantiationService.setService(s.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new C.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,r.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,r.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,r.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,r.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(w=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(w=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new b.WriteBuffer((w,A)=>this._inputHandler.parse(w,A))),this.register((0,r.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(T,w){this._writeBuffer.write(T,w)}writeSync(T,w){this._logService.logLevel<=s.LogLevelEnum.WARN&&!v&&(this._logService.warn("writeSync is unreliable and will be removed soon."),v=!0),this._writeBuffer.writeSync(T,w)}resize(T,w){isNaN(T)||isNaN(w)||(T=Math.max(T,m.MINIMUM_COLS),w=Math.max(w,m.MINIMUM_ROWS),this._bufferService.resize(T,w))}scroll(T,w=!1){this._bufferService.scroll(T,w)}scrollLines(T,w,A){this._bufferService.scrollLines(T,w,A)}scrollPages(T){this.scrollLines(T*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(T){let w=T-this._bufferService.buffer.ydisp;w!==0&&this.scrollLines(w)}registerEscHandler(T,w){return this._inputHandler.registerEscHandler(T,w)}registerDcsHandler(T,w){return this._inputHandler.registerDcsHandler(T,w)}registerCsiHandler(T,w){return this._inputHandler.registerCsiHandler(T,w)}registerOscHandler(T,w){return this._inputHandler.registerOscHandler(T,w)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let T=!1,w=this.optionsService.rawOptions.windowsPty;w&&w.buildNumber!==void 0&&w.buildNumber!==void 0?T=w.backend==="conpty"&&w.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(T=!0),T?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){let T=[];T.push(this.onLineFeed(D.updateWindowsModeWrappedState.bind(null,this._bufferService))),T.push(this.registerCsiHandler({final:"H"},()=>((0,D.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,f.toDisposable)(()=>{for(let w of T)w.dispose()})}}}n.CoreTerminal=y},8460:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.forwardEvent=n.EventEmitter=void 0,n.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=u=>(this._listeners.push(u),{dispose:()=>{if(!this._disposed){for(let f=0;f<this._listeners.length;f++)if(this._listeners[f]===u)return void this._listeners.splice(f,1)}}})),this._event}fire(u,f){let s=[];for(let i=0;i<this._listeners.length;i++)s.push(this._listeners[i]);for(let i=0;i<s.length;i++)s[i].call(void 0,u,f)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},n.forwardEvent=function(u,f){return u(s=>f.fire(s))}},5435:function(g,n,u){var f=this&&this.__decorate||function(W,E,L,x){var O,U=arguments.length,Y=U<3?E:x===null?x=Object.getOwnPropertyDescriptor(E,L):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Y=Reflect.decorate(W,E,L,x);else for(var ae=W.length-1;ae>=0;ae--)(O=W[ae])&&(Y=(U<3?O(Y):U>3?O(E,L,Y):O(E,L))||Y);return U>3&&Y&&Object.defineProperty(E,L,Y),Y},s=this&&this.__param||function(W,E){return function(L,x){E(L,x,W)}};Object.defineProperty(n,"__esModule",{value:!0}),n.InputHandler=n.WindowsOptionsReportType=void 0;let i=u(2584),p=u(7116),m=u(2015),h=u(844),l=u(482),r=u(8437),o=u(8460),c=u(643),_=u(511),D=u(3734),C=u(2585),b=u(6242),S=u(6351),v=u(5941),y={"(":0,")":1,"*":2,"+":3,"-":1,".":2},M=131072;function T(W,E){if(W>24)return E.setWinLines||!1;switch(W){case 1:return!!E.restoreWin;case 2:return!!E.minimizeWin;case 3:return!!E.setWinPosition;case 4:return!!E.setWinSizePixels;case 5:return!!E.raiseWin;case 6:return!!E.lowerWin;case 7:return!!E.refreshWin;case 8:return!!E.setWinSizeChars;case 9:return!!E.maximizeWin;case 10:return!!E.fullscreenWin;case 11:return!!E.getWinState;case 13:return!!E.getWinPosition;case 14:return!!E.getWinSizePixels;case 15:return!!E.getScreenSizePixels;case 16:return!!E.getCellSizePixels;case 18:return!!E.getWinSizeChars;case 19:return!!E.getScreenSizeChars;case 20:return!!E.getIconTitle;case 21:return!!E.getWinTitle;case 22:return!!E.pushTitle;case 23:return!!E.popTitle;case 24:return!!E.setWinLines}return!1}var w;(function(W){W[W.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",W[W.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(w||(n.WindowsOptionsReportType=w={}));let A=0;class I extends h.Disposable{getAttrData(){return this._curAttrData}constructor(E,L,x,O,U,Y,ae,z,fe=new m.EscapeSequenceParser){super(),this._bufferService=E,this._charsetService=L,this._coreService=x,this._logService=O,this._optionsService=U,this._oscLinkService=Y,this._coreMouseService=ae,this._unicodeService=z,this._parser=fe,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new l.StringToUtf32,this._utf8Decoder=new l.Utf8ToUtf32,this._workCell=new _.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=r.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=r.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new o.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new o.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new o.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new o.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new o.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new o.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new o.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new o.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new o.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new o.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new o.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new o.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new o.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new R(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(F=>this._activeBuffer=F.activeBuffer)),this._parser.setCsiHandlerFallback((F,N)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(F),params:N.toArray()})}),this._parser.setEscHandlerFallback(F=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(F)})}),this._parser.setExecuteHandlerFallback(F=>{this._logService.debug("Unknown EXECUTE code: ",{code:F})}),this._parser.setOscHandlerFallback((F,N,B)=>{this._logService.debug("Unknown OSC code: ",{identifier:F,action:N,data:B})}),this._parser.setDcsHandlerFallback((F,N,B)=>{N==="HOOK"&&(B=B.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(F),action:N,payload:B})}),this._parser.setPrintHandler((F,N,B)=>this.print(F,N,B)),this._parser.registerCsiHandler({final:"@"},F=>this.insertChars(F)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},F=>this.scrollLeft(F)),this._parser.registerCsiHandler({final:"A"},F=>this.cursorUp(F)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},F=>this.scrollRight(F)),this._parser.registerCsiHandler({final:"B"},F=>this.cursorDown(F)),this._parser.registerCsiHandler({final:"C"},F=>this.cursorForward(F)),this._parser.registerCsiHandler({final:"D"},F=>this.cursorBackward(F)),this._parser.registerCsiHandler({final:"E"},F=>this.cursorNextLine(F)),this._parser.registerCsiHandler({final:"F"},F=>this.cursorPrecedingLine(F)),this._parser.registerCsiHandler({final:"G"},F=>this.cursorCharAbsolute(F)),this._parser.registerCsiHandler({final:"H"},F=>this.cursorPosition(F)),this._parser.registerCsiHandler({final:"I"},F=>this.cursorForwardTab(F)),this._parser.registerCsiHandler({final:"J"},F=>this.eraseInDisplay(F,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},F=>this.eraseInDisplay(F,!0)),this._parser.registerCsiHandler({final:"K"},F=>this.eraseInLine(F,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},F=>this.eraseInLine(F,!0)),this._parser.registerCsiHandler({final:"L"},F=>this.insertLines(F)),this._parser.registerCsiHandler({final:"M"},F=>this.deleteLines(F)),this._parser.registerCsiHandler({final:"P"},F=>this.deleteChars(F)),this._parser.registerCsiHandler({final:"S"},F=>this.scrollUp(F)),this._parser.registerCsiHandler({final:"T"},F=>this.scrollDown(F)),this._parser.registerCsiHandler({final:"X"},F=>this.eraseChars(F)),this._parser.registerCsiHandler({final:"Z"},F=>this.cursorBackwardTab(F)),this._parser.registerCsiHandler({final:"`"},F=>this.charPosAbsolute(F)),this._parser.registerCsiHandler({final:"a"},F=>this.hPositionRelative(F)),this._parser.registerCsiHandler({final:"b"},F=>this.repeatPrecedingCharacter(F)),this._parser.registerCsiHandler({final:"c"},F=>this.sendDeviceAttributesPrimary(F)),this._parser.registerCsiHandler({prefix:">",final:"c"},F=>this.sendDeviceAttributesSecondary(F)),this._parser.registerCsiHandler({final:"d"},F=>this.linePosAbsolute(F)),this._parser.registerCsiHandler({final:"e"},F=>this.vPositionRelative(F)),this._parser.registerCsiHandler({final:"f"},F=>this.hVPosition(F)),this._parser.registerCsiHandler({final:"g"},F=>this.tabClear(F)),this._parser.registerCsiHandler({final:"h"},F=>this.setMode(F)),this._parser.registerCsiHandler({prefix:"?",final:"h"},F=>this.setModePrivate(F)),this._parser.registerCsiHandler({final:"l"},F=>this.resetMode(F)),this._parser.registerCsiHandler({prefix:"?",final:"l"},F=>this.resetModePrivate(F)),this._parser.registerCsiHandler({final:"m"},F=>this.charAttributes(F)),this._parser.registerCsiHandler({final:"n"},F=>this.deviceStatus(F)),this._parser.registerCsiHandler({prefix:"?",final:"n"},F=>this.deviceStatusPrivate(F)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},F=>this.softReset(F)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},F=>this.setCursorStyle(F)),this._parser.registerCsiHandler({final:"r"},F=>this.setScrollRegion(F)),this._parser.registerCsiHandler({final:"s"},F=>this.saveCursor(F)),this._parser.registerCsiHandler({final:"t"},F=>this.windowOptions(F)),this._parser.registerCsiHandler({final:"u"},F=>this.restoreCursor(F)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},F=>this.insertColumns(F)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},F=>this.deleteColumns(F)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},F=>this.selectProtected(F)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},F=>this.requestMode(F,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},F=>this.requestMode(F,!1)),this._parser.setExecuteHandler(i.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(i.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(i.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(i.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(i.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(i.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(i.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(i.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(i.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(i.C1.IND,()=>this.index()),this._parser.setExecuteHandler(i.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(i.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new b.OscHandler(F=>(this.setTitle(F),this.setIconName(F),!0))),this._parser.registerOscHandler(1,new b.OscHandler(F=>this.setIconName(F))),this._parser.registerOscHandler(2,new b.OscHandler(F=>this.setTitle(F))),this._parser.registerOscHandler(4,new b.OscHandler(F=>this.setOrReportIndexedColor(F))),this._parser.registerOscHandler(8,new b.OscHandler(F=>this.setHyperlink(F))),this._parser.registerOscHandler(10,new b.OscHandler(F=>this.setOrReportFgColor(F))),this._parser.registerOscHandler(11,new b.OscHandler(F=>this.setOrReportBgColor(F))),this._parser.registerOscHandler(12,new b.OscHandler(F=>this.setOrReportCursorColor(F))),this._parser.registerOscHandler(104,new b.OscHandler(F=>this.restoreIndexedColor(F))),this._parser.registerOscHandler(110,new b.OscHandler(F=>this.restoreFgColor(F))),this._parser.registerOscHandler(111,new b.OscHandler(F=>this.restoreBgColor(F))),this._parser.registerOscHandler(112,new b.OscHandler(F=>this.restoreCursorColor(F))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(let F in p.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:F},()=>this.selectCharset("("+F)),this._parser.registerEscHandler({intermediates:")",final:F},()=>this.selectCharset(")"+F)),this._parser.registerEscHandler({intermediates:"*",final:F},()=>this.selectCharset("*"+F)),this._parser.registerEscHandler({intermediates:"+",final:F},()=>this.selectCharset("+"+F)),this._parser.registerEscHandler({intermediates:"-",final:F},()=>this.selectCharset("-"+F)),this._parser.registerEscHandler({intermediates:".",final:F},()=>this.selectCharset("."+F)),this._parser.registerEscHandler({intermediates:"/",final:F},()=>this.selectCharset("/"+F));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(F=>(this._logService.error("Parsing error: ",F),F)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new S.DcsHandler((F,N)=>this.requestStatusString(F,N)))}_preserveStack(E,L,x,O){this._parseStack.paused=!0,this._parseStack.cursorStartX=E,this._parseStack.cursorStartY=L,this._parseStack.decodedLength=x,this._parseStack.position=O}_logSlowResolvingAsync(E){this._logService.logLevel<=C.LogLevelEnum.WARN&&Promise.race([E,new Promise((L,x)=>setTimeout(()=>x("#SLOW_TIMEOUT"),5e3))]).catch(L=>{if(L!=="#SLOW_TIMEOUT")throw L;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(E,L){let x,O=this._activeBuffer.x,U=this._activeBuffer.y,Y=0,ae=this._parseStack.paused;if(ae){if(x=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,L))return this._logSlowResolvingAsync(x),x;O=this._parseStack.cursorStartX,U=this._parseStack.cursorStartY,this._parseStack.paused=!1,E.length>M&&(Y=this._parseStack.position+M)}if(this._logService.logLevel<=C.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof E=="string"?` "${E}"`:` "${Array.prototype.map.call(E,z=>String.fromCharCode(z)).join("")}"`),typeof E=="string"?E.split("").map(z=>z.charCodeAt(0)):E),this._parseBuffer.length<E.length&&this._parseBuffer.length<M&&(this._parseBuffer=new Uint32Array(Math.min(E.length,M))),ae||this._dirtyRowTracker.clearRange(),E.length>M)for(let z=Y;z<E.length;z+=M){let fe=z+M<E.length?z+M:E.length,F=typeof E=="string"?this._stringDecoder.decode(E.substring(z,fe),this._parseBuffer):this._utf8Decoder.decode(E.subarray(z,fe),this._parseBuffer);if(x=this._parser.parse(this._parseBuffer,F))return this._preserveStack(O,U,F,z),this._logSlowResolvingAsync(x),x}else if(!ae){let z=typeof E=="string"?this._stringDecoder.decode(E,this._parseBuffer):this._utf8Decoder.decode(E,this._parseBuffer);if(x=this._parser.parse(this._parseBuffer,z))return this._preserveStack(O,U,z,0),this._logSlowResolvingAsync(x),x}this._activeBuffer.x===O&&this._activeBuffer.y===U||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(E,L,x){let O,U,Y=this._charsetService.charset,ae=this._optionsService.rawOptions.screenReaderMode,z=this._bufferService.cols,fe=this._coreService.decPrivateModes.wraparound,F=this._coreService.modes.insertMode,N=this._curAttrData,B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&x-L>0&&B.getWidth(this._activeBuffer.x-1)===2&&B.setCellFromCodePoint(this._activeBuffer.x-1,0,1,N.fg,N.bg,N.extended);for(let H=L;H<x;++H){if(O=E[H],U=this._unicodeService.wcwidth(O),O<127&&Y){let le=Y[String.fromCharCode(O)];le&&(O=le.charCodeAt(0))}if(ae&&this._onA11yChar.fire((0,l.stringFromCodePoint)(O)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),U||!this._activeBuffer.x){if(this._activeBuffer.x+U-1>=z){if(fe){for(;this._activeBuffer.x<z;)B.setCellFromCodePoint(this._activeBuffer.x++,0,1,N.fg,N.bg,N.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=z-1,U===2)continue}if(F&&(B.insertCells(this._activeBuffer.x,U,this._activeBuffer.getNullCell(N),N),B.getWidth(z-1)===2&&B.setCellFromCodePoint(z-1,c.NULL_CELL_CODE,c.NULL_CELL_WIDTH,N.fg,N.bg,N.extended)),B.setCellFromCodePoint(this._activeBuffer.x++,O,U,N.fg,N.bg,N.extended),U>0)for(;--U;)B.setCellFromCodePoint(this._activeBuffer.x++,0,0,N.fg,N.bg,N.extended)}else B.getWidth(this._activeBuffer.x-1)?B.addCodepointToCell(this._activeBuffer.x-1,O):B.addCodepointToCell(this._activeBuffer.x-2,O)}x-L>0&&(B.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<z&&x-L>0&&B.getWidth(this._activeBuffer.x)===0&&!B.hasContent(this._activeBuffer.x)&&B.setCellFromCodePoint(this._activeBuffer.x,0,1,N.fg,N.bg,N.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(E,L){return E.final!=="t"||E.prefix||E.intermediates?this._parser.registerCsiHandler(E,L):this._parser.registerCsiHandler(E,x=>!T(x.params[0],this._optionsService.rawOptions.windowOptions)||L(x))}registerDcsHandler(E,L){return this._parser.registerDcsHandler(E,new S.DcsHandler(L))}registerEscHandler(E,L){return this._parser.registerEscHandler(E,L)}registerOscHandler(E,L){return this._parser.registerOscHandler(E,new b.OscHandler(L))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var E;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||E===void 0)&&E.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;let L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);L.hasWidth(this._activeBuffer.x)&&!L.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let E=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-E),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(E=this._bufferService.cols-1){this._activeBuffer.x=Math.min(E,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(E,L){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=E,this._activeBuffer.y=this._activeBuffer.scrollTop+L):(this._activeBuffer.x=E,this._activeBuffer.y=L),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(E,L){this._restrictCursor(),this._setCursor(this._activeBuffer.x+E,this._activeBuffer.y+L)}cursorUp(E){let L=this._activeBuffer.y-this._activeBuffer.scrollTop;return L>=0?this._moveCursor(0,-Math.min(L,E.params[0]||1)):this._moveCursor(0,-(E.params[0]||1)),!0}cursorDown(E){let L=this._activeBuffer.scrollBottom-this._activeBuffer.y;return L>=0?this._moveCursor(0,Math.min(L,E.params[0]||1)):this._moveCursor(0,E.params[0]||1),!0}cursorForward(E){return this._moveCursor(E.params[0]||1,0),!0}cursorBackward(E){return this._moveCursor(-(E.params[0]||1),0),!0}cursorNextLine(E){return this.cursorDown(E),this._activeBuffer.x=0,!0}cursorPrecedingLine(E){return this.cursorUp(E),this._activeBuffer.x=0,!0}cursorCharAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(E){return this._setCursor(E.length>=2?(E.params[1]||1)-1:0,(E.params[0]||1)-1),!0}charPosAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(E){return this._moveCursor(E.params[0]||1,0),!0}linePosAbsolute(E){return this._setCursor(this._activeBuffer.x,(E.params[0]||1)-1),!0}vPositionRelative(E){return this._moveCursor(0,E.params[0]||1),!0}hVPosition(E){return this.cursorPosition(E),!0}tabClear(E){let L=E.params[0];return L===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:L===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let L=E.params[0]||1;for(;L--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let L=E.params[0]||1;for(;L--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(E){let L=E.params[0];return L===1&&(this._curAttrData.bg|=536870912),L!==2&&L!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(E,L,x,O=!1,U=!1){let Y=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);Y.replaceCells(L,x,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),U),O&&(Y.isWrapped=!1)}_resetBufferLine(E,L=!1){let x=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);x&&(x.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),L),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+E),x.isWrapped=!1)}eraseInDisplay(E,L=!1){let x;switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:for(x=this._activeBuffer.y,this._dirtyRowTracker.markDirty(x),this._eraseInBufferLine(x++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,L);x<this._bufferService.rows;x++)this._resetBufferLine(x,L);this._dirtyRowTracker.markDirty(x);break;case 1:for(x=this._activeBuffer.y,this._dirtyRowTracker.markDirty(x),this._eraseInBufferLine(x,0,this._activeBuffer.x+1,!0,L),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(x+1).isWrapped=!1);x--;)this._resetBufferLine(x,L);this._dirtyRowTracker.markDirty(0);break;case 2:for(x=this._bufferService.rows,this._dirtyRowTracker.markDirty(x-1);x--;)this._resetBufferLine(x,L);this._dirtyRowTracker.markDirty(0);break;case 3:let O=this._activeBuffer.lines.length-this._bufferService.rows;O>0&&(this._activeBuffer.lines.trimStart(O),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-O,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-O,0),this._onScroll.fire(0))}return!0}eraseInLine(E,L=!1){switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,L);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,L);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,L)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(E){this._restrictCursor();let L=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let x=this._activeBuffer.ybase+this._activeBuffer.y,O=this._bufferService.rows-1-this._activeBuffer.scrollBottom,U=this._bufferService.rows-1+this._activeBuffer.ybase-O+1;for(;L--;)this._activeBuffer.lines.splice(U-1,1),this._activeBuffer.lines.splice(x,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(E){this._restrictCursor();let L=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let x=this._activeBuffer.ybase+this._activeBuffer.y,O;for(O=this._bufferService.rows-1-this._activeBuffer.scrollBottom,O=this._bufferService.rows-1+this._activeBuffer.ybase-O;L--;)this._activeBuffer.lines.splice(x,1),this._activeBuffer.lines.splice(O,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(E){this._restrictCursor();let L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.insertCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(E){this._restrictCursor();let L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.deleteCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(E){let L=E.params[0]||1;for(;L--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(E){let L=E.params[0]||1;for(;L--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(r.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let L=E.params[0]||1;for(let x=this._activeBuffer.scrollTop;x<=this._activeBuffer.scrollBottom;++x){let O=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);O.deleteCells(0,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let L=E.params[0]||1;for(let x=this._activeBuffer.scrollTop;x<=this._activeBuffer.scrollBottom;++x){let O=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);O.insertCells(0,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let L=E.params[0]||1;for(let x=this._activeBuffer.scrollTop;x<=this._activeBuffer.scrollBottom;++x){let O=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);O.insertCells(this._activeBuffer.x,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let L=E.params[0]||1;for(let x=this._activeBuffer.scrollTop;x<=this._activeBuffer.scrollBottom;++x){let O=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);O.deleteCells(this._activeBuffer.x,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(E){this._restrictCursor();let L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(E.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(E){if(!this._parser.precedingCodepoint)return!0;let L=E.params[0]||1,x=new Uint32Array(L);for(let O=0;O<L;++O)x[O]=this._parser.precedingCodepoint;return this.print(x,0,x.length),!0}sendDeviceAttributesPrimary(E){return E.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(i.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(i.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(E){return E.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(i.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(i.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(E.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(i.C0.ESC+"[>83;40003;0c")),!0}_is(E){return(this._optionsService.rawOptions.termName+"").indexOf(E)===0}setMode(E){for(let L=0;L<E.length;L++)switch(E.params[L]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(E){for(let L=0;L<E.length;L++)switch(E.params[L]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,p.DEFAULT_CHARSET),this._charsetService.setgCharset(1,p.DEFAULT_CHARSET),this._charsetService.setgCharset(2,p.DEFAULT_CHARSET),this._charsetService.setgCharset(3,p.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(E){for(let L=0;L<E.length;L++)switch(E.params[L]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(E){for(let L=0;L<E.length;L++)switch(E.params[L]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),E.params[L]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(E,L){let x=this._coreService.decPrivateModes,{activeProtocol:O,activeEncoding:U}=this._coreMouseService,Y=this._coreService,{buffers:ae,cols:z}=this._bufferService,{active:fe,alt:F}=ae,N=this._optionsService.rawOptions,B=Le=>Le?1:2,H=E.params[0];return le=H,j=L?H===2?4:H===4?B(Y.modes.insertMode):H===12?3:H===20?B(N.convertEol):0:H===1?B(x.applicationCursorKeys):H===3?N.windowOptions.setWinLines?z===80?2:z===132?1:0:0:H===6?B(x.origin):H===7?B(x.wraparound):H===8?3:H===9?B(O==="X10"):H===12?B(N.cursorBlink):H===25?B(!Y.isCursorHidden):H===45?B(x.reverseWraparound):H===66?B(x.applicationKeypad):H===67?4:H===1e3?B(O==="VT200"):H===1002?B(O==="DRAG"):H===1003?B(O==="ANY"):H===1004?B(x.sendFocus):H===1005?4:H===1006?B(U==="SGR"):H===1015?4:H===1016?B(U==="SGR_PIXELS"):H===1048?1:H===47||H===1047||H===1049?B(fe===F):H===2004?B(x.bracketedPasteMode):0,Y.triggerDataEvent(`${i.C0.ESC}[${L?"":"?"}${le};${j}$y`),!0;var le,j}_updateAttrColor(E,L,x,O,U){return L===2?(E|=50331648,E&=-16777216,E|=D.AttributeData.fromColorRGB([x,O,U])):L===5&&(E&=-50331904,E|=33554432|255&x),E}_extractColor(E,L,x){let O=[0,0,-1,0,0,0],U=0,Y=0;do{if(O[Y+U]=E.params[L+Y],E.hasSubParams(L+Y)){let ae=E.getSubParams(L+Y),z=0;do O[1]===5&&(U=1),O[Y+z+1+U]=ae[z];while(++z<ae.length&&z+Y+1+U<O.length);break}if(O[1]===5&&Y+U>=2||O[1]===2&&Y+U>=5)break;O[1]&&(U=1)}while(++Y+L<E.length&&Y+U<O.length);for(let ae=2;ae<O.length;++ae)O[ae]===-1&&(O[ae]=0);switch(O[0]){case 38:x.fg=this._updateAttrColor(x.fg,O[1],O[3],O[4],O[5]);break;case 48:x.bg=this._updateAttrColor(x.bg,O[1],O[3],O[4],O[5]);break;case 58:x.extended=x.extended.clone(),x.extended.underlineColor=this._updateAttrColor(x.extended.underlineColor,O[1],O[3],O[4],O[5])}return Y}_processUnderline(E,L){L.extended=L.extended.clone(),(!~E||E>5)&&(E=1),L.extended.underlineStyle=E,L.fg|=268435456,E===0&&(L.fg&=-268435457),L.updateExtended()}_processSGR0(E){E.fg=r.DEFAULT_ATTR_DATA.fg,E.bg=r.DEFAULT_ATTR_DATA.bg,E.extended=E.extended.clone(),E.extended.underlineStyle=0,E.extended.underlineColor&=-67108864,E.updateExtended()}charAttributes(E){if(E.length===1&&E.params[0]===0)return this._processSGR0(this._curAttrData),!0;let L=E.length,x,O=this._curAttrData;for(let U=0;U<L;U++)x=E.params[U],x>=30&&x<=37?(O.fg&=-50331904,O.fg|=16777216|x-30):x>=40&&x<=47?(O.bg&=-50331904,O.bg|=16777216|x-40):x>=90&&x<=97?(O.fg&=-50331904,O.fg|=16777224|x-90):x>=100&&x<=107?(O.bg&=-50331904,O.bg|=16777224|x-100):x===0?this._processSGR0(O):x===1?O.fg|=134217728:x===3?O.bg|=67108864:x===4?(O.fg|=268435456,this._processUnderline(E.hasSubParams(U)?E.getSubParams(U)[0]:1,O)):x===5?O.fg|=536870912:x===7?O.fg|=67108864:x===8?O.fg|=1073741824:x===9?O.fg|=2147483648:x===2?O.bg|=134217728:x===21?this._processUnderline(2,O):x===22?(O.fg&=-134217729,O.bg&=-134217729):x===23?O.bg&=-67108865:x===24?(O.fg&=-268435457,this._processUnderline(0,O)):x===25?O.fg&=-536870913:x===27?O.fg&=-67108865:x===28?O.fg&=-1073741825:x===29?O.fg&=2147483647:x===39?(O.fg&=-67108864,O.fg|=16777215&r.DEFAULT_ATTR_DATA.fg):x===49?(O.bg&=-67108864,O.bg|=16777215&r.DEFAULT_ATTR_DATA.bg):x===38||x===48||x===58?U+=this._extractColor(E,U,O):x===53?O.bg|=1073741824:x===55?O.bg&=-1073741825:x===59?(O.extended=O.extended.clone(),O.extended.underlineColor=-1,O.updateExtended()):x===100?(O.fg&=-67108864,O.fg|=16777215&r.DEFAULT_ATTR_DATA.fg,O.bg&=-67108864,O.bg|=16777215&r.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",x);return!0}deviceStatus(E){switch(E.params[0]){case 5:this._coreService.triggerDataEvent(`${i.C0.ESC}[0n`);break;case 6:let L=this._activeBuffer.y+1,x=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${i.C0.ESC}[${L};${x}R`)}return!0}deviceStatusPrivate(E){if(E.params[0]===6){let L=this._activeBuffer.y+1,x=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${i.C0.ESC}[?${L};${x}R`)}return!0}softReset(E){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=r.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(E){let L=E.params[0]||1;switch(L){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}let x=L%2==1;return this._optionsService.options.cursorBlink=x,!0}setScrollRegion(E){let L=E.params[0]||1,x;return(E.length<2||(x=E.params[1])>this._bufferService.rows||x===0)&&(x=this._bufferService.rows),x>L&&(this._activeBuffer.scrollTop=L-1,this._activeBuffer.scrollBottom=x-1,this._setCursor(0,0)),!0}windowOptions(E){if(!T(E.params[0],this._optionsService.rawOptions.windowOptions))return!0;let L=E.length>1?E.params[1]:0;switch(E.params[0]){case 14:L!==2&&this._onRequestWindowsOptionsReport.fire(w.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(w.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${i.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:L!==0&&L!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),L!==0&&L!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:L!==0&&L!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),L!==0&&L!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(E){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(E){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(E){return this._windowTitle=E,this._onTitleChange.fire(E),!0}setIconName(E){return this._iconName=E,!0}setOrReportIndexedColor(E){let L=[],x=E.split(";");for(;x.length>1;){let O=x.shift(),U=x.shift();if(/^\d+$/.exec(O)){let Y=parseInt(O);if(P(Y))if(U==="?")L.push({type:0,index:Y});else{let ae=(0,v.parseColor)(U);ae&&L.push({type:1,index:Y,color:ae})}}}return L.length&&this._onColor.fire(L),!0}setHyperlink(E){let L=E.split(";");return!(L.length<2)&&(L[1]?this._createHyperlink(L[0],L[1]):!L[0]&&this._finishHyperlink())}_createHyperlink(E,L){this._getCurrentLinkId()&&this._finishHyperlink();let x=E.split(":"),O,U=x.findIndex(Y=>Y.startsWith("id="));return U!==-1&&(O=x[U].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:O,uri:L}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(E,L){let x=E.split(";");for(let O=0;O<x.length&&!(L>=this._specialColors.length);++O,++L)if(x[O]==="?")this._onColor.fire([{type:0,index:this._specialColors[L]}]);else{let U=(0,v.parseColor)(x[O]);U&&this._onColor.fire([{type:1,index:this._specialColors[L],color:U}])}return!0}setOrReportFgColor(E){return this._setOrReportSpecialColor(E,0)}setOrReportBgColor(E){return this._setOrReportSpecialColor(E,1)}setOrReportCursorColor(E){return this._setOrReportSpecialColor(E,2)}restoreIndexedColor(E){if(!E)return this._onColor.fire([{type:2}]),!0;let L=[],x=E.split(";");for(let O=0;O<x.length;++O)if(/^\d+$/.exec(x[O])){let U=parseInt(x[O]);P(U)&&L.push({type:2,index:U})}return L.length&&this._onColor.fire(L),!0}restoreFgColor(E){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(E){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(E){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,p.DEFAULT_CHARSET),!0}selectCharset(E){return E.length!==2?(this.selectDefaultCharset(),!0):(E[0]==="/"||this._charsetService.setgCharset(y[E[0]],p.CHARSETS[E[1]]||p.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){let E=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,E,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=r.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=r.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(E){return this._charsetService.setgLevel(E),!0}screenAlignmentPattern(){let E=new _.CellData;E.content=4194304|"E".charCodeAt(0),E.fg=this._curAttrData.fg,E.bg=this._curAttrData.bg,this._setCursor(0,0);for(let L=0;L<this._bufferService.rows;++L){let x=this._activeBuffer.ybase+this._activeBuffer.y+L,O=this._activeBuffer.lines.get(x);O&&(O.fill(E),O.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(E,L){let x=this._bufferService.buffer,O=this._optionsService.rawOptions;return(U=>(this._coreService.triggerDataEvent(`${i.C0.ESC}${U}${i.C0.ESC}\\`),!0))(E==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:E==='"p'?'P1$r61;1"p':E==="r"?`P1$r${x.scrollTop+1};${x.scrollBottom+1}r`:E==="m"?"P1$r0m":E===" q"?`P1$r${{block:2,underline:4,bar:6}[O.cursorStyle]-(O.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(E,L){this._dirtyRowTracker.markRangeDirty(E,L)}}n.InputHandler=I;let R=class{constructor(W){this._bufferService=W,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(W){W<this.start?this.start=W:W>this.end&&(this.end=W)}markRangeDirty(W,E){W>E&&(A=W,W=E,E=A),W<this.start&&(this.start=W),E>this.end&&(this.end=E)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function P(W){return 0<=W&&W<256}R=f([s(0,C.IBufferService)],R)},844:(g,n)=>{function u(f){for(let s of f)s.dispose();f.length=0}Object.defineProperty(n,"__esModule",{value:!0}),n.getDisposeArrayDisposable=n.disposeArray=n.toDisposable=n.MutableDisposable=n.Disposable=void 0,n.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let f of this._disposables)f.dispose();this._disposables.length=0}register(f){return this._disposables.push(f),f}unregister(f){let s=this._disposables.indexOf(f);s!==-1&&this._disposables.splice(s,1)}},n.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(f){var s;this._isDisposed||f===this._value||((s=this._value)===null||s===void 0||s.dispose(),this._value=f)}clear(){this.value=void 0}dispose(){var f;this._isDisposed=!0,(f=this._value)===null||f===void 0||f.dispose(),this._value=void 0}},n.toDisposable=function(f){return{dispose:f}},n.disposeArray=u,n.getDisposeArrayDisposable=function(f){return{dispose:()=>u(f)}}},1505:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FourKeyMap=n.TwoKeyMap=void 0;class u{constructor(){this._data={}}set(s,i,p){this._data[s]||(this._data[s]={}),this._data[s][i]=p}get(s,i){return this._data[s]?this._data[s][i]:void 0}clear(){this._data={}}}n.TwoKeyMap=u,n.FourKeyMap=class{constructor(){this._data=new u}set(f,s,i,p,m){this._data.get(f,s)||this._data.set(f,s,new u),this._data.get(f,s).set(i,p,m)}get(f,s,i,p){var m;return(m=this._data.get(f,s))===null||m===void 0?void 0:m.get(i,p)}clear(){this._data.clear()}}},6114:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isChromeOS=n.isLinux=n.isWindows=n.isIphone=n.isIpad=n.isMac=n.getSafariVersion=n.isSafari=n.isLegacyEdge=n.isFirefox=n.isNode=void 0,n.isNode=typeof navigator>"u";let u=n.isNode?"node":navigator.userAgent,f=n.isNode?"node":navigator.platform;n.isFirefox=u.includes("Firefox"),n.isLegacyEdge=u.includes("Edge"),n.isSafari=/^((?!chrome|android).)*safari/i.test(u),n.getSafariVersion=function(){if(!n.isSafari)return 0;let s=u.match(/Version\/(\d+)/);return s===null||s.length<2?0:parseInt(s[1])},n.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(f),n.isIpad=f==="iPad",n.isIphone=f==="iPhone",n.isWindows=["Windows","Win16","Win32","WinCE"].includes(f),n.isLinux=f.indexOf("Linux")>=0,n.isChromeOS=/\bCrOS\b/.test(u)},6106:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SortedList=void 0;let u=0;n.SortedList=class{constructor(f){this._getKey=f,this._array=[]}clear(){this._array.length=0}insert(f){this._array.length!==0?(u=this._search(this._getKey(f)),this._array.splice(u,0,f)):this._array.push(f)}delete(f){if(this._array.length===0)return!1;let s=this._getKey(f);if(s===void 0||(u=this._search(s),u===-1)||this._getKey(this._array[u])!==s)return!1;do if(this._array[u]===f)return this._array.splice(u,1),!0;while(++u<this._array.length&&this._getKey(this._array[u])===s);return!1}*getKeyIterator(f){if(this._array.length!==0&&(u=this._search(f),!(u<0||u>=this._array.length)&&this._getKey(this._array[u])===f))do yield this._array[u];while(++u<this._array.length&&this._getKey(this._array[u])===f)}forEachByKey(f,s){if(this._array.length!==0&&(u=this._search(f),!(u<0||u>=this._array.length)&&this._getKey(this._array[u])===f))do s(this._array[u]);while(++u<this._array.length&&this._getKey(this._array[u])===f)}values(){return[...this._array].values()}_search(f){let s=0,i=this._array.length-1;for(;i>=s;){let p=s+i>>1,m=this._getKey(this._array[p]);if(m>f)i=p-1;else{if(!(m<f)){for(;p>0&&this._getKey(this._array[p-1])===f;)p--;return p}s=p+1}}return s}}},7226:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DebouncedIdleTask=n.IdleTaskQueue=n.PriorityTaskQueue=void 0;let f=u(6114);class s{constructor(){this._tasks=[],this._i=0}enqueue(m){this._tasks.push(m),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(m){this._idleCallback=void 0;let h=0,l=0,r=m.timeRemaining(),o=0;for(;this._i<this._tasks.length;){if(h=Date.now(),this._tasks[this._i]()||this._i++,h=Math.max(1,Date.now()-h),l=Math.max(h,l),o=m.timeRemaining(),1.5*l>o)return r-h<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(r-h))}ms`),void this._start();r=o}this.clear()}}class i extends s{_requestCallback(m){return setTimeout(()=>m(this._createDeadline(16)))}_cancelCallback(m){clearTimeout(m)}_createDeadline(m){let h=Date.now()+m;return{timeRemaining:()=>Math.max(0,h-Date.now())}}}n.PriorityTaskQueue=i,n.IdleTaskQueue=!f.isNode&&"requestIdleCallback"in window?class extends s{_requestCallback(p){return requestIdleCallback(p)}_cancelCallback(p){cancelIdleCallback(p)}}:i,n.DebouncedIdleTask=class{constructor(){this._queue=new n.IdleTaskQueue}set(p){this._queue.clear(),this._queue.enqueue(p)}flush(){this._queue.flush()}}},9282:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.updateWindowsModeWrappedState=void 0;let f=u(643);n.updateWindowsModeWrappedState=function(s){let i=s.buffer.lines.get(s.buffer.ybase+s.buffer.y-1),p=i?.get(s.cols-1),m=s.buffer.lines.get(s.buffer.ybase+s.buffer.y);m&&p&&(m.isWrapped=p[f.CHAR_DATA_CODE_INDEX]!==f.NULL_CELL_CODE&&p[f.CHAR_DATA_CODE_INDEX]!==f.WHITESPACE_CELL_CODE)}},3734:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ExtendedAttrs=n.AttributeData=void 0;class u{constructor(){this.fg=0,this.bg=0,this.extended=new f}static toColorRGB(i){return[i>>>16&255,i>>>8&255,255&i]}static fromColorRGB(i){return(255&i[0])<<16|(255&i[1])<<8|255&i[2]}clone(){let i=new u;return i.fg=this.fg,i.bg=this.bg,i.extended=this.extended.clone(),i}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}n.AttributeData=u;class f{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(i){this._ext=i}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(i){this._ext&=-469762049,this._ext|=i<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(i){this._ext&=-67108864,this._ext|=67108863&i}get urlId(){return this._urlId}set urlId(i){this._urlId=i}constructor(i=0,p=0){this._ext=0,this._urlId=0,this._ext=i,this._urlId=p}clone(){return new f(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}n.ExtendedAttrs=f},9092:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Buffer=n.MAX_BUFFER_SIZE=void 0;let f=u(6349),s=u(7226),i=u(3734),p=u(8437),m=u(4634),h=u(511),l=u(643),r=u(4863),o=u(7116);n.MAX_BUFFER_SIZE=4294967295,n.Buffer=class{constructor(c,_,D){this._hasScrollback=c,this._optionsService=_,this._bufferService=D,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=p.DEFAULT_ATTR_DATA.clone(),this.savedCharset=o.DEFAULT_CHARSET,this.markers=[],this._nullCell=h.CellData.fromCharData([0,l.NULL_CELL_CHAR,l.NULL_CELL_WIDTH,l.NULL_CELL_CODE]),this._whitespaceCell=h.CellData.fromCharData([0,l.WHITESPACE_CELL_CHAR,l.WHITESPACE_CELL_WIDTH,l.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new s.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new f.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(c){return c?(this._nullCell.fg=c.fg,this._nullCell.bg=c.bg,this._nullCell.extended=c.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new i.ExtendedAttrs),this._nullCell}getWhitespaceCell(c){return c?(this._whitespaceCell.fg=c.fg,this._whitespaceCell.bg=c.bg,this._whitespaceCell.extended=c.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new i.ExtendedAttrs),this._whitespaceCell}getBlankLine(c,_){return new p.BufferLine(this._bufferService.cols,this.getNullCell(c),_)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){let c=this.ybase+this.y-this.ydisp;return c>=0&&c<this._rows}_getCorrectBufferLength(c){if(!this._hasScrollback)return c;let _=c+this._optionsService.rawOptions.scrollback;return _>n.MAX_BUFFER_SIZE?n.MAX_BUFFER_SIZE:_}fillViewportRows(c){if(this.lines.length===0){c===void 0&&(c=p.DEFAULT_ATTR_DATA);let _=this._rows;for(;_--;)this.lines.push(this.getBlankLine(c))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new f.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(c,_){let D=this.getNullCell(p.DEFAULT_ATTR_DATA),C=0,b=this._getCorrectBufferLength(_);if(b>this.lines.maxLength&&(this.lines.maxLength=b),this.lines.length>0){if(this._cols<c)for(let v=0;v<this.lines.length;v++)C+=+this.lines.get(v).resize(c,D);let S=0;if(this._rows<_)for(let v=this._rows;v<_;v++)this.lines.length<_+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new p.BufferLine(c,D)):this.ybase>0&&this.lines.length<=this.ybase+this.y+S+1?(this.ybase--,S++,this.ydisp>0&&this.ydisp--):this.lines.push(new p.BufferLine(c,D)));else for(let v=this._rows;v>_;v--)this.lines.length>_+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(b<this.lines.maxLength){let v=this.lines.length-b;v>0&&(this.lines.trimStart(v),this.ybase=Math.max(this.ybase-v,0),this.ydisp=Math.max(this.ydisp-v,0),this.savedY=Math.max(this.savedY-v,0)),this.lines.maxLength=b}this.x=Math.min(this.x,c-1),this.y=Math.min(this.y,_-1),S&&(this.y+=S),this.savedX=Math.min(this.savedX,c-1),this.scrollTop=0}if(this.scrollBottom=_-1,this._isReflowEnabled&&(this._reflow(c,_),this._cols>c))for(let S=0;S<this.lines.length;S++)C+=+this.lines.get(S).resize(c,D);this._cols=c,this._rows=_,this._memoryCleanupQueue.clear(),C>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let c=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,c=!1);let _=0;for(;this._memoryCleanupPosition<this.lines.length;)if(_+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),_>100)return!0;return c}get _isReflowEnabled(){let c=this._optionsService.rawOptions.windowsPty;return c&&c.buildNumber?this._hasScrollback&&c.backend==="conpty"&&c.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(c,_){this._cols!==c&&(c>this._cols?this._reflowLarger(c,_):this._reflowSmaller(c,_))}_reflowLarger(c,_){let D=(0,m.reflowLargerGetLinesToRemove)(this.lines,this._cols,c,this.ybase+this.y,this.getNullCell(p.DEFAULT_ATTR_DATA));if(D.length>0){let C=(0,m.reflowLargerCreateNewLayout)(this.lines,D);(0,m.reflowLargerApplyNewLayout)(this.lines,C.layout),this._reflowLargerAdjustViewport(c,_,C.countRemoved)}}_reflowLargerAdjustViewport(c,_,D){let C=this.getNullCell(p.DEFAULT_ATTR_DATA),b=D;for(;b-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<_&&this.lines.push(new p.BufferLine(c,C))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-D,0)}_reflowSmaller(c,_){let D=this.getNullCell(p.DEFAULT_ATTR_DATA),C=[],b=0;for(let S=this.lines.length-1;S>=0;S--){let v=this.lines.get(S);if(!v||!v.isWrapped&&v.getTrimmedLength()<=c)continue;let y=[v];for(;v.isWrapped&&S>0;)v=this.lines.get(--S),y.unshift(v);let M=this.ybase+this.y;if(M>=S&&M<S+y.length)continue;let T=y[y.length-1].getTrimmedLength(),w=(0,m.reflowSmallerGetNewLineLengths)(y,this._cols,c),A=w.length-y.length,I;I=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+A):Math.max(0,this.lines.length-this.lines.maxLength+A);let R=[];for(let O=0;O<A;O++){let U=this.getBlankLine(p.DEFAULT_ATTR_DATA,!0);R.push(U)}R.length>0&&(C.push({start:S+y.length+b,newLines:R}),b+=R.length),y.push(...R);let P=w.length-1,W=w[P];W===0&&(P--,W=w[P]);let E=y.length-A-1,L=T;for(;E>=0;){let O=Math.min(L,W);if(y[P]===void 0)break;if(y[P].copyCellsFrom(y[E],L-O,W-O,O,!0),W-=O,W===0&&(P--,W=w[P]),L-=O,L===0){E--;let U=Math.max(E,0);L=(0,m.getWrappedLineTrimmedLength)(y,U,this._cols)}}for(let O=0;O<y.length;O++)w[O]<c&&y[O].setCell(w[O],D);let x=A-I;for(;x-- >0;)this.ybase===0?this.y<_-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+b)-_&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+A,this.ybase+_-1)}if(C.length>0){let S=[],v=[];for(let P=0;P<this.lines.length;P++)v.push(this.lines.get(P));let y=this.lines.length,M=y-1,T=0,w=C[T];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+b);let A=0;for(let P=Math.min(this.lines.maxLength-1,y+b-1);P>=0;P--)if(w&&w.start>M+A){for(let W=w.newLines.length-1;W>=0;W--)this.lines.set(P--,w.newLines[W]);P++,S.push({index:M+1,amount:w.newLines.length}),A+=w.newLines.length,w=C[++T]}else this.lines.set(P,v[M--]);let I=0;for(let P=S.length-1;P>=0;P--)S[P].index+=I,this.lines.onInsertEmitter.fire(S[P]),I+=S[P].amount;let R=Math.max(0,y+b-this.lines.maxLength);R>0&&this.lines.onTrimEmitter.fire(R)}}translateBufferLineToString(c,_,D=0,C){let b=this.lines.get(c);return b?b.translateToString(_,D,C):""}getWrappedRangeForLine(c){let _=c,D=c;for(;_>0&&this.lines.get(_).isWrapped;)_--;for(;D+1<this.lines.length&&this.lines.get(D+1).isWrapped;)D++;return{first:_,last:D}}setupTabStops(c){for(c!=null?this.tabs[c]||(c=this.prevStop(c)):(this.tabs={},c=0);c<this._cols;c+=this._optionsService.rawOptions.tabStopWidth)this.tabs[c]=!0}prevStop(c){for(c==null&&(c=this.x);!this.tabs[--c]&&c>0;);return c>=this._cols?this._cols-1:c<0?0:c}nextStop(c){for(c==null&&(c=this.x);!this.tabs[++c]&&c<this._cols;);return c>=this._cols?this._cols-1:c<0?0:c}clearMarkers(c){this._isClearing=!0;for(let _=0;_<this.markers.length;_++)this.markers[_].line===c&&(this.markers[_].dispose(),this.markers.splice(_--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let c=0;c<this.markers.length;c++)this.markers[c].dispose(),this.markers.splice(c--,1);this._isClearing=!1}addMarker(c){let _=new r.Marker(c);return this.markers.push(_),_.register(this.lines.onTrim(D=>{_.line-=D,_.line<0&&_.dispose()})),_.register(this.lines.onInsert(D=>{_.line>=D.index&&(_.line+=D.amount)})),_.register(this.lines.onDelete(D=>{_.line>=D.index&&_.line<D.index+D.amount&&_.dispose(),_.line>D.index&&(_.line-=D.amount)})),_.register(_.onDispose(()=>this._removeMarker(_))),_}_removeMarker(c){this._isClearing||this.markers.splice(this.markers.indexOf(c),1)}}},8437:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferLine=n.DEFAULT_ATTR_DATA=void 0;let f=u(3734),s=u(511),i=u(643),p=u(482);n.DEFAULT_ATTR_DATA=Object.freeze(new f.AttributeData);let m=0;class h{constructor(r,o,c=!1){this.isWrapped=c,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*r);let _=o||s.CellData.fromCharData([0,i.NULL_CELL_CHAR,i.NULL_CELL_WIDTH,i.NULL_CELL_CODE]);for(let D=0;D<r;++D)this.setCell(D,_);this.length=r}get(r){let o=this._data[3*r+0],c=2097151&o;return[this._data[3*r+1],2097152&o?this._combined[r]:c?(0,p.stringFromCodePoint)(c):"",o>>22,2097152&o?this._combined[r].charCodeAt(this._combined[r].length-1):c]}set(r,o){this._data[3*r+1]=o[i.CHAR_DATA_ATTR_INDEX],o[i.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[r]=o[1],this._data[3*r+0]=2097152|r|o[i.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*r+0]=o[i.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|o[i.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(r){return this._data[3*r+0]>>22}hasWidth(r){return 12582912&this._data[3*r+0]}getFg(r){return this._data[3*r+1]}getBg(r){return this._data[3*r+2]}hasContent(r){return 4194303&this._data[3*r+0]}getCodePoint(r){let o=this._data[3*r+0];return 2097152&o?this._combined[r].charCodeAt(this._combined[r].length-1):2097151&o}isCombined(r){return 2097152&this._data[3*r+0]}getString(r){let o=this._data[3*r+0];return 2097152&o?this._combined[r]:2097151&o?(0,p.stringFromCodePoint)(2097151&o):""}isProtected(r){return 536870912&this._data[3*r+2]}loadCell(r,o){return m=3*r,o.content=this._data[m+0],o.fg=this._data[m+1],o.bg=this._data[m+2],2097152&o.content&&(o.combinedData=this._combined[r]),268435456&o.bg&&(o.extended=this._extendedAttrs[r]),o}setCell(r,o){2097152&o.content&&(this._combined[r]=o.combinedData),268435456&o.bg&&(this._extendedAttrs[r]=o.extended),this._data[3*r+0]=o.content,this._data[3*r+1]=o.fg,this._data[3*r+2]=o.bg}setCellFromCodePoint(r,o,c,_,D,C){268435456&D&&(this._extendedAttrs[r]=C),this._data[3*r+0]=o|c<<22,this._data[3*r+1]=_,this._data[3*r+2]=D}addCodepointToCell(r,o){let c=this._data[3*r+0];2097152&c?this._combined[r]+=(0,p.stringFromCodePoint)(o):(2097151&c?(this._combined[r]=(0,p.stringFromCodePoint)(2097151&c)+(0,p.stringFromCodePoint)(o),c&=-2097152,c|=2097152):c=o|4194304,this._data[3*r+0]=c)}insertCells(r,o,c,_){if((r%=this.length)&&this.getWidth(r-1)===2&&this.setCellFromCodePoint(r-1,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs),o<this.length-r){let D=new s.CellData;for(let C=this.length-r-o-1;C>=0;--C)this.setCell(r+o+C,this.loadCell(r+C,D));for(let C=0;C<o;++C)this.setCell(r+C,c)}else for(let D=r;D<this.length;++D)this.setCell(D,c);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs)}deleteCells(r,o,c,_){if(r%=this.length,o<this.length-r){let D=new s.CellData;for(let C=0;C<this.length-r-o;++C)this.setCell(r+C,this.loadCell(r+o+C,D));for(let C=this.length-o;C<this.length;++C)this.setCell(C,c)}else for(let D=r;D<this.length;++D)this.setCell(D,c);r&&this.getWidth(r-1)===2&&this.setCellFromCodePoint(r-1,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs),this.getWidth(r)!==0||this.hasContent(r)||this.setCellFromCodePoint(r,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs)}replaceCells(r,o,c,_,D=!1){if(D)for(r&&this.getWidth(r-1)===2&&!this.isProtected(r-1)&&this.setCellFromCodePoint(r-1,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs),o<this.length&&this.getWidth(o-1)===2&&!this.isProtected(o)&&this.setCellFromCodePoint(o,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs);r<o&&r<this.length;)this.isProtected(r)||this.setCell(r,c),r++;else for(r&&this.getWidth(r-1)===2&&this.setCellFromCodePoint(r-1,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs),o<this.length&&this.getWidth(o-1)===2&&this.setCellFromCodePoint(o,0,1,_?.fg||0,_?.bg||0,_?.extended||new f.ExtendedAttrs);r<o&&r<this.length;)this.setCell(r++,c)}resize(r,o){if(r===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;let c=3*r;if(r>this.length){if(this._data.buffer.byteLength>=4*c)this._data=new Uint32Array(this._data.buffer,0,c);else{let _=new Uint32Array(c);_.set(this._data),this._data=_}for(let _=this.length;_<r;++_)this.setCell(_,o)}else{this._data=this._data.subarray(0,c);let _=Object.keys(this._combined);for(let C=0;C<_.length;C++){let b=parseInt(_[C],10);b>=r&&delete this._combined[b]}let D=Object.keys(this._extendedAttrs);for(let C=0;C<D.length;C++){let b=parseInt(D[C],10);b>=r&&delete this._extendedAttrs[b]}}return this.length=r,4*c*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){let r=new Uint32Array(this._data.length);return r.set(this._data),this._data=r,1}return 0}fill(r,o=!1){if(o)for(let c=0;c<this.length;++c)this.isProtected(c)||this.setCell(c,r);else{this._combined={},this._extendedAttrs={};for(let c=0;c<this.length;++c)this.setCell(c,r)}}copyFrom(r){this.length!==r.length?this._data=new Uint32Array(r._data):this._data.set(r._data),this.length=r.length,this._combined={};for(let o in r._combined)this._combined[o]=r._combined[o];this._extendedAttrs={};for(let o in r._extendedAttrs)this._extendedAttrs[o]=r._extendedAttrs[o];this.isWrapped=r.isWrapped}clone(){let r=new h(0);r._data=new Uint32Array(this._data),r.length=this.length;for(let o in this._combined)r._combined[o]=this._combined[o];for(let o in this._extendedAttrs)r._extendedAttrs[o]=this._extendedAttrs[o];return r.isWrapped=this.isWrapped,r}getTrimmedLength(){for(let r=this.length-1;r>=0;--r)if(4194303&this._data[3*r+0])return r+(this._data[3*r+0]>>22);return 0}getNoBgTrimmedLength(){for(let r=this.length-1;r>=0;--r)if(4194303&this._data[3*r+0]||50331648&this._data[3*r+2])return r+(this._data[3*r+0]>>22);return 0}copyCellsFrom(r,o,c,_,D){let C=r._data;if(D)for(let S=_-1;S>=0;S--){for(let v=0;v<3;v++)this._data[3*(c+S)+v]=C[3*(o+S)+v];268435456&C[3*(o+S)+2]&&(this._extendedAttrs[c+S]=r._extendedAttrs[o+S])}else for(let S=0;S<_;S++){for(let v=0;v<3;v++)this._data[3*(c+S)+v]=C[3*(o+S)+v];268435456&C[3*(o+S)+2]&&(this._extendedAttrs[c+S]=r._extendedAttrs[o+S])}let b=Object.keys(r._combined);for(let S=0;S<b.length;S++){let v=parseInt(b[S],10);v>=o&&(this._combined[v-o+c]=r._combined[v])}}translateToString(r=!1,o=0,c=this.length){r&&(c=Math.min(c,this.getTrimmedLength()));let _="";for(;o<c;){let D=this._data[3*o+0],C=2097151&D;_+=2097152&D?this._combined[o]:C?(0,p.stringFromCodePoint)(C):i.WHITESPACE_CELL_CHAR,o+=D>>22||1}return _}}n.BufferLine=h},4841:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getRangeLength=void 0,n.getRangeLength=function(u,f){if(u.start.y>u.end.y)throw new Error(`Buffer range end (${u.end.x}, ${u.end.y}) cannot be before start (${u.start.x}, ${u.start.y})`);return f*(u.end.y-u.start.y)+(u.end.x-u.start.x+1)}},4634:(g,n)=>{function u(f,s,i){if(s===f.length-1)return f[s].getTrimmedLength();let p=!f[s].hasContent(i-1)&&f[s].getWidth(i-1)===1,m=f[s+1].getWidth(0)===2;return p&&m?i-1:i}Object.defineProperty(n,"__esModule",{value:!0}),n.getWrappedLineTrimmedLength=n.reflowSmallerGetNewLineLengths=n.reflowLargerApplyNewLayout=n.reflowLargerCreateNewLayout=n.reflowLargerGetLinesToRemove=void 0,n.reflowLargerGetLinesToRemove=function(f,s,i,p,m){let h=[];for(let l=0;l<f.length-1;l++){let r=l,o=f.get(++r);if(!o.isWrapped)continue;let c=[f.get(l)];for(;r<f.length&&o.isWrapped;)c.push(o),o=f.get(++r);if(p>=l&&p<r){l+=c.length-1;continue}let _=0,D=u(c,_,s),C=1,b=0;for(;C<c.length;){let v=u(c,C,s),y=v-b,M=i-D,T=Math.min(y,M);c[_].copyCellsFrom(c[C],b,D,T,!1),D+=T,D===i&&(_++,D=0),b+=T,b===v&&(C++,b=0),D===0&&_!==0&&c[_-1].getWidth(i-1)===2&&(c[_].copyCellsFrom(c[_-1],i-1,D++,1,!1),c[_-1].setCell(i-1,m))}c[_].replaceCells(D,i,m);let S=0;for(let v=c.length-1;v>0&&(v>_||c[v].getTrimmedLength()===0);v--)S++;S>0&&(h.push(l+c.length-S),h.push(S)),l+=c.length-1}return h},n.reflowLargerCreateNewLayout=function(f,s){let i=[],p=0,m=s[p],h=0;for(let l=0;l<f.length;l++)if(m===l){let r=s[++p];f.onDeleteEmitter.fire({index:l-h,amount:r}),l+=r-1,h+=r,m=s[++p]}else i.push(l);return{layout:i,countRemoved:h}},n.reflowLargerApplyNewLayout=function(f,s){let i=[];for(let p=0;p<s.length;p++)i.push(f.get(s[p]));for(let p=0;p<i.length;p++)f.set(p,i[p]);f.length=s.length},n.reflowSmallerGetNewLineLengths=function(f,s,i){let p=[],m=f.map((o,c)=>u(f,c,s)).reduce((o,c)=>o+c),h=0,l=0,r=0;for(;r<m;){if(m-r<i){p.push(m-r);break}h+=i;let o=u(f,l,s);h>o&&(h-=o,l++);let c=f[l].getWidth(h-1)===2;c&&h--;let _=c?i-1:i;p.push(_),r+=_}return p},n.getWrappedLineTrimmedLength=u},5295:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferSet=void 0;let f=u(8460),s=u(844),i=u(9092);class p extends s.Disposable{constructor(h,l){super(),this._optionsService=h,this._bufferService=l,this._onBufferActivate=this.register(new f.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new i.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new i.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(h){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(h),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(h,l){this._normal.resize(h,l),this._alt.resize(h,l),this.setupTabStops(h)}setupTabStops(h){this._normal.setupTabStops(h),this._alt.setupTabStops(h)}}n.BufferSet=p},511:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CellData=void 0;let f=u(482),s=u(643),i=u(3734);class p extends i.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new i.ExtendedAttrs,this.combinedData=""}static fromCharData(h){let l=new p;return l.setFromCharData(h),l}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,f.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(h){this.fg=h[s.CHAR_DATA_ATTR_INDEX],this.bg=0;let l=!1;if(h[s.CHAR_DATA_CHAR_INDEX].length>2)l=!0;else if(h[s.CHAR_DATA_CHAR_INDEX].length===2){let r=h[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=r&&r<=56319){let o=h[s.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=o&&o<=57343?this.content=1024*(r-55296)+o-56320+65536|h[s.CHAR_DATA_WIDTH_INDEX]<<22:l=!0}else l=!0}else this.content=h[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|h[s.CHAR_DATA_WIDTH_INDEX]<<22;l&&(this.combinedData=h[s.CHAR_DATA_CHAR_INDEX],this.content=2097152|h[s.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}n.CellData=p},643:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WHITESPACE_CELL_CODE=n.WHITESPACE_CELL_WIDTH=n.WHITESPACE_CELL_CHAR=n.NULL_CELL_CODE=n.NULL_CELL_WIDTH=n.NULL_CELL_CHAR=n.CHAR_DATA_CODE_INDEX=n.CHAR_DATA_WIDTH_INDEX=n.CHAR_DATA_CHAR_INDEX=n.CHAR_DATA_ATTR_INDEX=n.DEFAULT_EXT=n.DEFAULT_ATTR=n.DEFAULT_COLOR=void 0,n.DEFAULT_COLOR=0,n.DEFAULT_ATTR=256|n.DEFAULT_COLOR<<9,n.DEFAULT_EXT=0,n.CHAR_DATA_ATTR_INDEX=0,n.CHAR_DATA_CHAR_INDEX=1,n.CHAR_DATA_WIDTH_INDEX=2,n.CHAR_DATA_CODE_INDEX=3,n.NULL_CELL_CHAR="",n.NULL_CELL_WIDTH=1,n.NULL_CELL_CODE=0,n.WHITESPACE_CELL_CHAR=" ",n.WHITESPACE_CELL_WIDTH=1,n.WHITESPACE_CELL_CODE=32},4863:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Marker=void 0;let f=u(8460),s=u(844);class i{get id(){return this._id}constructor(m){this.line=m,this.isDisposed=!1,this._disposables=[],this._id=i._nextId++,this._onDispose=this.register(new f.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,s.disposeArray)(this._disposables),this._disposables.length=0)}register(m){return this._disposables.push(m),m}}n.Marker=i,i._nextId=1},7116:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_CHARSET=n.CHARSETS=void 0,n.CHARSETS={},n.DEFAULT_CHARSET=n.CHARSETS.B,n.CHARSETS[0]={"`":"\u25C6",a:"\u2592",b:"\u2409",c:"\u240C",d:"\u240D",e:"\u240A",f:"\xB0",g:"\xB1",h:"\u2424",i:"\u240B",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"},n.CHARSETS.A={"#":"\xA3"},n.CHARSETS.B=void 0,n.CHARSETS[4]={"#":"\xA3","@":"\xBE","[":"ij","\\":"\xBD","]":"|","{":"\xA8","|":"f","}":"\xBC","~":"\xB4"},n.CHARSETS.C=n.CHARSETS[5]={"[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},n.CHARSETS.R={"#":"\xA3","@":"\xE0","[":"\xB0","\\":"\xE7","]":"\xA7","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xA8"},n.CHARSETS.Q={"@":"\xE0","[":"\xE2","\\":"\xE7","]":"\xEA","^":"\xEE","`":"\xF4","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xFB"},n.CHARSETS.K={"@":"\xA7","[":"\xC4","\\":"\xD6","]":"\xDC","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xDF"},n.CHARSETS.Y={"#":"\xA3","@":"\xA7","[":"\xB0","\\":"\xE7","]":"\xE9","`":"\xF9","{":"\xE0","|":"\xF2","}":"\xE8","~":"\xEC"},n.CHARSETS.E=n.CHARSETS[6]={"@":"\xC4","[":"\xC6","\\":"\xD8","]":"\xC5","^":"\xDC","`":"\xE4","{":"\xE6","|":"\xF8","}":"\xE5","~":"\xFC"},n.CHARSETS.Z={"#":"\xA3","@":"\xA7","[":"\xA1","\\":"\xD1","]":"\xBF","{":"\xB0","|":"\xF1","}":"\xE7"},n.CHARSETS.H=n.CHARSETS[7]={"@":"\xC9","[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},n.CHARSETS["="]={"#":"\xF9","@":"\xE0","[":"\xE9","\\":"\xE7","]":"\xEA","^":"\xEE",_:"\xE8","`":"\xF4","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xFB"}},2584:(g,n)=>{var u,f,s;Object.defineProperty(n,"__esModule",{value:!0}),n.C1_ESCAPED=n.C1=n.C0=void 0,function(i){i.NUL="\0",i.SOH="",i.STX="",i.ETX="",i.EOT="",i.ENQ="",i.ACK="",i.BEL="\x07",i.BS="\b",i.HT="	",i.LF=`
`,i.VT="\v",i.FF="\f",i.CR="\r",i.SO="",i.SI="",i.DLE="",i.DC1="",i.DC2="",i.DC3="",i.DC4="",i.NAK="",i.SYN="",i.ETB="",i.CAN="",i.EM="",i.SUB="",i.ESC="\x1B",i.FS="",i.GS="",i.RS="",i.US="",i.SP=" ",i.DEL="\x7F"}(u||(n.C0=u={})),function(i){i.PAD="\x80",i.HOP="\x81",i.BPH="\x82",i.NBH="\x83",i.IND="\x84",i.NEL="\x85",i.SSA="\x86",i.ESA="\x87",i.HTS="\x88",i.HTJ="\x89",i.VTS="\x8A",i.PLD="\x8B",i.PLU="\x8C",i.RI="\x8D",i.SS2="\x8E",i.SS3="\x8F",i.DCS="\x90",i.PU1="\x91",i.PU2="\x92",i.STS="\x93",i.CCH="\x94",i.MW="\x95",i.SPA="\x96",i.EPA="\x97",i.SOS="\x98",i.SGCI="\x99",i.SCI="\x9A",i.CSI="\x9B",i.ST="\x9C",i.OSC="\x9D",i.PM="\x9E",i.APC="\x9F"}(f||(n.C1=f={})),function(i){i.ST=`${u.ESC}\\`}(s||(n.C1_ESCAPED=s={}))},7399:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.evaluateKeyboardEvent=void 0;let f=u(2584),s={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};n.evaluateKeyboardEvent=function(i,p,m,h){let l={type:0,cancel:!1,key:void 0},r=(i.shiftKey?1:0)|(i.altKey?2:0)|(i.ctrlKey?4:0)|(i.metaKey?8:0);switch(i.keyCode){case 0:i.key==="UIKeyInputUpArrow"?l.key=p?f.C0.ESC+"OA":f.C0.ESC+"[A":i.key==="UIKeyInputLeftArrow"?l.key=p?f.C0.ESC+"OD":f.C0.ESC+"[D":i.key==="UIKeyInputRightArrow"?l.key=p?f.C0.ESC+"OC":f.C0.ESC+"[C":i.key==="UIKeyInputDownArrow"&&(l.key=p?f.C0.ESC+"OB":f.C0.ESC+"[B");break;case 8:if(i.altKey){l.key=f.C0.ESC+f.C0.DEL;break}l.key=f.C0.DEL;break;case 9:if(i.shiftKey){l.key=f.C0.ESC+"[Z";break}l.key=f.C0.HT,l.cancel=!0;break;case 13:l.key=i.altKey?f.C0.ESC+f.C0.CR:f.C0.CR,l.cancel=!0;break;case 27:l.key=f.C0.ESC,i.altKey&&(l.key=f.C0.ESC+f.C0.ESC),l.cancel=!0;break;case 37:if(i.metaKey)break;r?(l.key=f.C0.ESC+"[1;"+(r+1)+"D",l.key===f.C0.ESC+"[1;3D"&&(l.key=f.C0.ESC+(m?"b":"[1;5D"))):l.key=p?f.C0.ESC+"OD":f.C0.ESC+"[D";break;case 39:if(i.metaKey)break;r?(l.key=f.C0.ESC+"[1;"+(r+1)+"C",l.key===f.C0.ESC+"[1;3C"&&(l.key=f.C0.ESC+(m?"f":"[1;5C"))):l.key=p?f.C0.ESC+"OC":f.C0.ESC+"[C";break;case 38:if(i.metaKey)break;r?(l.key=f.C0.ESC+"[1;"+(r+1)+"A",m||l.key!==f.C0.ESC+"[1;3A"||(l.key=f.C0.ESC+"[1;5A")):l.key=p?f.C0.ESC+"OA":f.C0.ESC+"[A";break;case 40:if(i.metaKey)break;r?(l.key=f.C0.ESC+"[1;"+(r+1)+"B",m||l.key!==f.C0.ESC+"[1;3B"||(l.key=f.C0.ESC+"[1;5B")):l.key=p?f.C0.ESC+"OB":f.C0.ESC+"[B";break;case 45:i.shiftKey||i.ctrlKey||(l.key=f.C0.ESC+"[2~");break;case 46:l.key=r?f.C0.ESC+"[3;"+(r+1)+"~":f.C0.ESC+"[3~";break;case 36:l.key=r?f.C0.ESC+"[1;"+(r+1)+"H":p?f.C0.ESC+"OH":f.C0.ESC+"[H";break;case 35:l.key=r?f.C0.ESC+"[1;"+(r+1)+"F":p?f.C0.ESC+"OF":f.C0.ESC+"[F";break;case 33:i.shiftKey?l.type=2:i.ctrlKey?l.key=f.C0.ESC+"[5;"+(r+1)+"~":l.key=f.C0.ESC+"[5~";break;case 34:i.shiftKey?l.type=3:i.ctrlKey?l.key=f.C0.ESC+"[6;"+(r+1)+"~":l.key=f.C0.ESC+"[6~";break;case 112:l.key=r?f.C0.ESC+"[1;"+(r+1)+"P":f.C0.ESC+"OP";break;case 113:l.key=r?f.C0.ESC+"[1;"+(r+1)+"Q":f.C0.ESC+"OQ";break;case 114:l.key=r?f.C0.ESC+"[1;"+(r+1)+"R":f.C0.ESC+"OR";break;case 115:l.key=r?f.C0.ESC+"[1;"+(r+1)+"S":f.C0.ESC+"OS";break;case 116:l.key=r?f.C0.ESC+"[15;"+(r+1)+"~":f.C0.ESC+"[15~";break;case 117:l.key=r?f.C0.ESC+"[17;"+(r+1)+"~":f.C0.ESC+"[17~";break;case 118:l.key=r?f.C0.ESC+"[18;"+(r+1)+"~":f.C0.ESC+"[18~";break;case 119:l.key=r?f.C0.ESC+"[19;"+(r+1)+"~":f.C0.ESC+"[19~";break;case 120:l.key=r?f.C0.ESC+"[20;"+(r+1)+"~":f.C0.ESC+"[20~";break;case 121:l.key=r?f.C0.ESC+"[21;"+(r+1)+"~":f.C0.ESC+"[21~";break;case 122:l.key=r?f.C0.ESC+"[23;"+(r+1)+"~":f.C0.ESC+"[23~";break;case 123:l.key=r?f.C0.ESC+"[24;"+(r+1)+"~":f.C0.ESC+"[24~";break;default:if(!i.ctrlKey||i.shiftKey||i.altKey||i.metaKey)if(m&&!h||!i.altKey||i.metaKey)!m||i.altKey||i.ctrlKey||i.shiftKey||!i.metaKey?i.key&&!i.ctrlKey&&!i.altKey&&!i.metaKey&&i.keyCode>=48&&i.key.length===1?l.key=i.key:i.key&&i.ctrlKey&&(i.key==="_"&&(l.key=f.C0.US),i.key==="@"&&(l.key=f.C0.NUL)):i.keyCode===65&&(l.type=1);else{let o=s[i.keyCode],c=o?.[i.shiftKey?1:0];if(c)l.key=f.C0.ESC+c;else if(i.keyCode>=65&&i.keyCode<=90){let _=i.ctrlKey?i.keyCode-64:i.keyCode+32,D=String.fromCharCode(_);i.shiftKey&&(D=D.toUpperCase()),l.key=f.C0.ESC+D}else if(i.keyCode===32)l.key=f.C0.ESC+(i.ctrlKey?f.C0.NUL:" ");else if(i.key==="Dead"&&i.code.startsWith("Key")){let _=i.code.slice(3,4);i.shiftKey||(_=_.toLowerCase()),l.key=f.C0.ESC+_,l.cancel=!0}}else i.keyCode>=65&&i.keyCode<=90?l.key=String.fromCharCode(i.keyCode-64):i.keyCode===32?l.key=f.C0.NUL:i.keyCode>=51&&i.keyCode<=55?l.key=String.fromCharCode(i.keyCode-51+27):i.keyCode===56?l.key=f.C0.DEL:i.keyCode===219?l.key=f.C0.ESC:i.keyCode===220?l.key=f.C0.FS:i.keyCode===221&&(l.key=f.C0.GS)}return l}},482:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Utf8ToUtf32=n.StringToUtf32=n.utf32ToString=n.stringFromCodePoint=void 0,n.stringFromCodePoint=function(u){return u>65535?(u-=65536,String.fromCharCode(55296+(u>>10))+String.fromCharCode(u%1024+56320)):String.fromCharCode(u)},n.utf32ToString=function(u,f=0,s=u.length){let i="";for(let p=f;p<s;++p){let m=u[p];m>65535?(m-=65536,i+=String.fromCharCode(55296+(m>>10))+String.fromCharCode(m%1024+56320)):i+=String.fromCharCode(m)}return i},n.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(u,f){let s=u.length;if(!s)return 0;let i=0,p=0;if(this._interim){let m=u.charCodeAt(p++);56320<=m&&m<=57343?f[i++]=1024*(this._interim-55296)+m-56320+65536:(f[i++]=this._interim,f[i++]=m),this._interim=0}for(let m=p;m<s;++m){let h=u.charCodeAt(m);if(55296<=h&&h<=56319){if(++m>=s)return this._interim=h,i;let l=u.charCodeAt(m);56320<=l&&l<=57343?f[i++]=1024*(h-55296)+l-56320+65536:(f[i++]=h,f[i++]=l)}else h!==65279&&(f[i++]=h)}return i}},n.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(u,f){let s=u.length;if(!s)return 0;let i,p,m,h,l=0,r=0,o=0;if(this.interim[0]){let D=!1,C=this.interim[0];C&=(224&C)==192?31:(240&C)==224?15:7;let b,S=0;for(;(b=63&this.interim[++S])&&S<4;)C<<=6,C|=b;let v=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,y=v-S;for(;o<y;){if(o>=s)return 0;if(b=u[o++],(192&b)!=128){o--,D=!0;break}this.interim[S++]=b,C<<=6,C|=63&b}D||(v===2?C<128?o--:f[l++]=C:v===3?C<2048||C>=55296&&C<=57343||C===65279||(f[l++]=C):C<65536||C>1114111||(f[l++]=C)),this.interim.fill(0)}let c=s-4,_=o;for(;_<s;){for(;!(!(_<c)||128&(i=u[_])||128&(p=u[_+1])||128&(m=u[_+2])||128&(h=u[_+3]));)f[l++]=i,f[l++]=p,f[l++]=m,f[l++]=h,_+=4;if(i=u[_++],i<128)f[l++]=i;else if((224&i)==192){if(_>=s)return this.interim[0]=i,l;if(p=u[_++],(192&p)!=128){_--;continue}if(r=(31&i)<<6|63&p,r<128){_--;continue}f[l++]=r}else if((240&i)==224){if(_>=s)return this.interim[0]=i,l;if(p=u[_++],(192&p)!=128){_--;continue}if(_>=s)return this.interim[0]=i,this.interim[1]=p,l;if(m=u[_++],(192&m)!=128){_--;continue}if(r=(15&i)<<12|(63&p)<<6|63&m,r<2048||r>=55296&&r<=57343||r===65279)continue;f[l++]=r}else if((248&i)==240){if(_>=s)return this.interim[0]=i,l;if(p=u[_++],(192&p)!=128){_--;continue}if(_>=s)return this.interim[0]=i,this.interim[1]=p,l;if(m=u[_++],(192&m)!=128){_--;continue}if(_>=s)return this.interim[0]=i,this.interim[1]=p,this.interim[2]=m,l;if(h=u[_++],(192&h)!=128){_--;continue}if(r=(7&i)<<18|(63&p)<<12|(63&m)<<6|63&h,r<65536||r>1114111)continue;f[l++]=r}}return l}}},225:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeV6=void 0;let u=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],f=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],s;n.UnicodeV6=class{constructor(){if(this.version="6",!s){s=new Uint8Array(65536),s.fill(1),s[0]=0,s.fill(0,1,32),s.fill(0,127,160),s.fill(2,4352,4448),s[9001]=2,s[9002]=2,s.fill(2,11904,42192),s[12351]=1,s.fill(2,44032,55204),s.fill(2,63744,64256),s.fill(2,65040,65050),s.fill(2,65072,65136),s.fill(2,65280,65377),s.fill(2,65504,65511);for(let i=0;i<u.length;++i)s.fill(0,u[i][0],u[i][1]+1)}}wcwidth(i){return i<32?0:i<127?1:i<65536?s[i]:function(p,m){let h,l=0,r=m.length-1;if(p<m[0][0]||p>m[r][1])return!1;for(;r>=l;)if(h=l+r>>1,p>m[h][1])l=h+1;else{if(!(p<m[h][0]))return!0;r=h-1}return!1}(i,f)?0:i>=131072&&i<=196605||i>=196608&&i<=262141?2:1}}},5981:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WriteBuffer=void 0;let f=u(8460),s=u(844);class i extends s.Disposable{constructor(m){super(),this._action=m,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new f.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(m,h){if(h!==void 0&&this._syncCalls>h)return void(this._syncCalls=0);if(this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let l;for(this._isSyncWriting=!0;l=this._writeBuffer.shift();){this._action(l);let r=this._callbacks.shift();r&&r()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(m,h){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(h),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(h)}_innerWrite(m=0,h=!0){let l=m||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){let r=this._writeBuffer[this._bufferOffset],o=this._action(r,h);if(o){let _=D=>Date.now()-l>=12?setTimeout(()=>this._innerWrite(0,D)):this._innerWrite(l,D);return void o.catch(D=>(queueMicrotask(()=>{throw D}),Promise.resolve(!1))).then(_)}let c=this._callbacks[this._bufferOffset];if(c&&c(),this._bufferOffset++,this._pendingData-=r.length,Date.now()-l>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}n.WriteBuffer=i},5941:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.toRgbString=n.parseColor=void 0;let u=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,f=/^[\da-f]+$/;function s(i,p){let m=i.toString(16),h=m.length<2?"0"+m:m;switch(p){case 4:return m[0];case 8:return h;case 12:return(h+h).slice(0,3);default:return h+h}}n.parseColor=function(i){if(!i)return;let p=i.toLowerCase();if(p.indexOf("rgb:")===0){p=p.slice(4);let m=u.exec(p);if(m){let h=m[1]?15:m[4]?255:m[7]?4095:65535;return[Math.round(parseInt(m[1]||m[4]||m[7]||m[10],16)/h*255),Math.round(parseInt(m[2]||m[5]||m[8]||m[11],16)/h*255),Math.round(parseInt(m[3]||m[6]||m[9]||m[12],16)/h*255)]}}else if(p.indexOf("#")===0&&(p=p.slice(1),f.exec(p)&&[3,6,9,12].includes(p.length))){let m=p.length/3,h=[0,0,0];for(let l=0;l<3;++l){let r=parseInt(p.slice(m*l,m*l+m),16);h[l]=m===1?r<<4:m===2?r:m===3?r>>4:r>>8}return h}},n.toRgbString=function(i,p=16){let[m,h,l]=i;return`rgb:${s(m,p)}/${s(h,p)}/${s(l,p)}`}},5770:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PAYLOAD_LIMIT=void 0,n.PAYLOAD_LIMIT=1e7},6351:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DcsHandler=n.DcsParser=void 0;let f=u(482),s=u(8742),i=u(5770),p=[];n.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=p,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=p}registerHandler(h,l){this._handlers[h]===void 0&&(this._handlers[h]=[]);let r=this._handlers[h];return r.push(l),{dispose:()=>{let o=r.indexOf(l);o!==-1&&r.splice(o,1)}}}clearHandler(h){this._handlers[h]&&delete this._handlers[h]}setHandlerFallback(h){this._handlerFb=h}reset(){if(this._active.length)for(let h=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;h>=0;--h)this._active[h].unhook(!1);this._stack.paused=!1,this._active=p,this._ident=0}hook(h,l){if(this.reset(),this._ident=h,this._active=this._handlers[h]||p,this._active.length)for(let r=this._active.length-1;r>=0;r--)this._active[r].hook(l);else this._handlerFb(this._ident,"HOOK",l)}put(h,l,r){if(this._active.length)for(let o=this._active.length-1;o>=0;o--)this._active[o].put(h,l,r);else this._handlerFb(this._ident,"PUT",(0,f.utf32ToString)(h,l,r))}unhook(h,l=!0){if(this._active.length){let r=!1,o=this._active.length-1,c=!1;if(this._stack.paused&&(o=this._stack.loopPosition-1,r=l,c=this._stack.fallThrough,this._stack.paused=!1),!c&&r===!1){for(;o>=0&&(r=this._active[o].unhook(h),r!==!0);o--)if(r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!1,r;o--}for(;o>=0;o--)if(r=this._active[o].unhook(!1),r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!0,r}else this._handlerFb(this._ident,"UNHOOK",h);this._active=p,this._ident=0}};let m=new s.Params;m.addParam(0),n.DcsHandler=class{constructor(h){this._handler=h,this._data="",this._params=m,this._hitLimit=!1}hook(h){this._params=h.length>1||h.params[0]?h.clone():m,this._data="",this._hitLimit=!1}put(h,l,r){this._hitLimit||(this._data+=(0,f.utf32ToString)(h,l,r),this._data.length>i.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(h){let l=!1;if(this._hitLimit)l=!1;else if(h&&(l=this._handler(this._data,this._params),l instanceof Promise))return l.then(r=>(this._params=m,this._data="",this._hitLimit=!1,r));return this._params=m,this._data="",this._hitLimit=!1,l}}},2015:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.EscapeSequenceParser=n.VT500_TRANSITION_TABLE=n.TransitionTable=void 0;let f=u(844),s=u(8742),i=u(6242),p=u(6351);class m{constructor(o){this.table=new Uint8Array(o)}setDefault(o,c){this.table.fill(o<<4|c)}add(o,c,_,D){this.table[c<<8|o]=_<<4|D}addMany(o,c,_,D){for(let C=0;C<o.length;C++)this.table[c<<8|o[C]]=_<<4|D}}n.TransitionTable=m;let h=160;n.VT500_TRANSITION_TABLE=function(){let r=new m(4095),o=Array.apply(null,Array(256)).map((S,v)=>v),c=(S,v)=>o.slice(S,v),_=c(32,127),D=c(0,24);D.push(25),D.push.apply(D,c(28,32));let C=c(0,14),b;for(b in r.setDefault(1,0),r.addMany(_,0,2,0),C)r.addMany([24,26,153,154],b,3,0),r.addMany(c(128,144),b,3,0),r.addMany(c(144,152),b,3,0),r.add(156,b,0,0),r.add(27,b,11,1),r.add(157,b,4,8),r.addMany([152,158,159],b,0,7),r.add(155,b,11,3),r.add(144,b,11,9);return r.addMany(D,0,3,0),r.addMany(D,1,3,1),r.add(127,1,0,1),r.addMany(D,8,0,8),r.addMany(D,3,3,3),r.add(127,3,0,3),r.addMany(D,4,3,4),r.add(127,4,0,4),r.addMany(D,6,3,6),r.addMany(D,5,3,5),r.add(127,5,0,5),r.addMany(D,2,3,2),r.add(127,2,0,2),r.add(93,1,4,8),r.addMany(_,8,5,8),r.add(127,8,5,8),r.addMany([156,27,24,26,7],8,6,0),r.addMany(c(28,32),8,0,8),r.addMany([88,94,95],1,0,7),r.addMany(_,7,0,7),r.addMany(D,7,0,7),r.add(156,7,0,0),r.add(127,7,0,7),r.add(91,1,11,3),r.addMany(c(64,127),3,7,0),r.addMany(c(48,60),3,8,4),r.addMany([60,61,62,63],3,9,4),r.addMany(c(48,60),4,8,4),r.addMany(c(64,127),4,7,0),r.addMany([60,61,62,63],4,0,6),r.addMany(c(32,64),6,0,6),r.add(127,6,0,6),r.addMany(c(64,127),6,0,0),r.addMany(c(32,48),3,9,5),r.addMany(c(32,48),5,9,5),r.addMany(c(48,64),5,0,6),r.addMany(c(64,127),5,7,0),r.addMany(c(32,48),4,9,5),r.addMany(c(32,48),1,9,2),r.addMany(c(32,48),2,9,2),r.addMany(c(48,127),2,10,0),r.addMany(c(48,80),1,10,0),r.addMany(c(81,88),1,10,0),r.addMany([89,90,92],1,10,0),r.addMany(c(96,127),1,10,0),r.add(80,1,11,9),r.addMany(D,9,0,9),r.add(127,9,0,9),r.addMany(c(28,32),9,0,9),r.addMany(c(32,48),9,9,12),r.addMany(c(48,60),9,8,10),r.addMany([60,61,62,63],9,9,10),r.addMany(D,11,0,11),r.addMany(c(32,128),11,0,11),r.addMany(c(28,32),11,0,11),r.addMany(D,10,0,10),r.add(127,10,0,10),r.addMany(c(28,32),10,0,10),r.addMany(c(48,60),10,8,10),r.addMany([60,61,62,63],10,0,11),r.addMany(c(32,48),10,9,12),r.addMany(D,12,0,12),r.add(127,12,0,12),r.addMany(c(28,32),12,0,12),r.addMany(c(32,48),12,9,12),r.addMany(c(48,64),12,0,11),r.addMany(c(64,127),12,12,13),r.addMany(c(64,127),10,12,13),r.addMany(c(64,127),9,12,13),r.addMany(D,13,13,13),r.addMany(_,13,13,13),r.add(127,13,0,13),r.addMany([27,156,24,26],13,14,0),r.add(h,0,2,0),r.add(h,8,5,8),r.add(h,6,0,6),r.add(h,11,0,11),r.add(h,13,13,13),r}();class l extends f.Disposable{constructor(o=n.VT500_TRANSITION_TABLE){super(),this._transitions=o,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new s.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(c,_,D)=>{},this._executeHandlerFb=c=>{},this._csiHandlerFb=(c,_)=>{},this._escHandlerFb=c=>{},this._errorHandlerFb=c=>c,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,f.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new i.OscParser),this._dcsParser=this.register(new p.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(o,c=[64,126]){let _=0;if(o.prefix){if(o.prefix.length>1)throw new Error("only one byte as prefix supported");if(_=o.prefix.charCodeAt(0),_&&60>_||_>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(o.intermediates){if(o.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let C=0;C<o.intermediates.length;++C){let b=o.intermediates.charCodeAt(C);if(32>b||b>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");_<<=8,_|=b}}if(o.final.length!==1)throw new Error("final must be a single byte");let D=o.final.charCodeAt(0);if(c[0]>D||D>c[1])throw new Error(`final must be in range ${c[0]} .. ${c[1]}`);return _<<=8,_|=D,_}identToString(o){let c=[];for(;o;)c.push(String.fromCharCode(255&o)),o>>=8;return c.reverse().join("")}setPrintHandler(o){this._printHandler=o}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(o,c){let _=this._identifier(o,[48,126]);this._escHandlers[_]===void 0&&(this._escHandlers[_]=[]);let D=this._escHandlers[_];return D.push(c),{dispose:()=>{let C=D.indexOf(c);C!==-1&&D.splice(C,1)}}}clearEscHandler(o){this._escHandlers[this._identifier(o,[48,126])]&&delete this._escHandlers[this._identifier(o,[48,126])]}setEscHandlerFallback(o){this._escHandlerFb=o}setExecuteHandler(o,c){this._executeHandlers[o.charCodeAt(0)]=c}clearExecuteHandler(o){this._executeHandlers[o.charCodeAt(0)]&&delete this._executeHandlers[o.charCodeAt(0)]}setExecuteHandlerFallback(o){this._executeHandlerFb=o}registerCsiHandler(o,c){let _=this._identifier(o);this._csiHandlers[_]===void 0&&(this._csiHandlers[_]=[]);let D=this._csiHandlers[_];return D.push(c),{dispose:()=>{let C=D.indexOf(c);C!==-1&&D.splice(C,1)}}}clearCsiHandler(o){this._csiHandlers[this._identifier(o)]&&delete this._csiHandlers[this._identifier(o)]}setCsiHandlerFallback(o){this._csiHandlerFb=o}registerDcsHandler(o,c){return this._dcsParser.registerHandler(this._identifier(o),c)}clearDcsHandler(o){this._dcsParser.clearHandler(this._identifier(o))}setDcsHandlerFallback(o){this._dcsParser.setHandlerFallback(o)}registerOscHandler(o,c){return this._oscParser.registerHandler(o,c)}clearOscHandler(o){this._oscParser.clearHandler(o)}setOscHandlerFallback(o){this._oscParser.setHandlerFallback(o)}setErrorHandler(o){this._errorHandler=o}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(o,c,_,D,C){this._parseStack.state=o,this._parseStack.handlers=c,this._parseStack.handlerPos=_,this._parseStack.transition=D,this._parseStack.chunkPos=C}parse(o,c,_){let D,C=0,b=0,S=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,S=this._parseStack.chunkPos+1;else{if(_===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");let v=this._parseStack.handlers,y=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(_===!1&&y>-1){for(;y>=0&&(D=v[y](this._params),D!==!0);y--)if(D instanceof Promise)return this._parseStack.handlerPos=y,D}this._parseStack.handlers=[];break;case 4:if(_===!1&&y>-1){for(;y>=0&&(D=v[y](),D!==!0);y--)if(D instanceof Promise)return this._parseStack.handlerPos=y,D}this._parseStack.handlers=[];break;case 6:if(C=o[this._parseStack.chunkPos],D=this._dcsParser.unhook(C!==24&&C!==26,_),D)return D;C===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(C=o[this._parseStack.chunkPos],D=this._oscParser.end(C!==24&&C!==26,_),D)return D;C===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,S=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let v=S;v<c;++v){switch(C=o[v],b=this._transitions.table[this.currentState<<8|(C<160?C:h)],b>>4){case 2:for(let A=v+1;;++A){if(A>=c||(C=o[A])<32||C>126&&C<h){this._printHandler(o,v,A),v=A-1;break}if(++A>=c||(C=o[A])<32||C>126&&C<h){this._printHandler(o,v,A),v=A-1;break}if(++A>=c||(C=o[A])<32||C>126&&C<h){this._printHandler(o,v,A),v=A-1;break}if(++A>=c||(C=o[A])<32||C>126&&C<h){this._printHandler(o,v,A),v=A-1;break}}break;case 3:this._executeHandlers[C]?this._executeHandlers[C]():this._executeHandlerFb(C),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:v,code:C,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:let y=this._csiHandlers[this._collect<<8|C],M=y?y.length-1:-1;for(;M>=0&&(D=y[M](this._params),D!==!0);M--)if(D instanceof Promise)return this._preserveStack(3,y,M,b,v),D;M<0&&this._csiHandlerFb(this._collect<<8|C,this._params),this.precedingCodepoint=0;break;case 8:do switch(C){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(C-48)}while(++v<c&&(C=o[v])>47&&C<60);v--;break;case 9:this._collect<<=8,this._collect|=C;break;case 10:let T=this._escHandlers[this._collect<<8|C],w=T?T.length-1:-1;for(;w>=0&&(D=T[w](),D!==!0);w--)if(D instanceof Promise)return this._preserveStack(4,T,w,b,v),D;w<0&&this._escHandlerFb(this._collect<<8|C),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|C,this._params);break;case 13:for(let A=v+1;;++A)if(A>=c||(C=o[A])===24||C===26||C===27||C>127&&C<h){this._dcsParser.put(o,v,A),v=A-1;break}break;case 14:if(D=this._dcsParser.unhook(C!==24&&C!==26),D)return this._preserveStack(6,[],0,b,v),D;C===27&&(b|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let A=v+1;;A++)if(A>=c||(C=o[A])<32||C>127&&C<h){this._oscParser.put(o,v,A),v=A-1;break}break;case 6:if(D=this._oscParser.end(C!==24&&C!==26),D)return this._preserveStack(5,[],0,b,v),D;C===27&&(b|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&b}}}n.EscapeSequenceParser=l},6242:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OscHandler=n.OscParser=void 0;let f=u(5770),s=u(482),i=[];n.OscParser=class{constructor(){this._state=0,this._active=i,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(p,m){this._handlers[p]===void 0&&(this._handlers[p]=[]);let h=this._handlers[p];return h.push(m),{dispose:()=>{let l=h.indexOf(m);l!==-1&&h.splice(l,1)}}}clearHandler(p){this._handlers[p]&&delete this._handlers[p]}setHandlerFallback(p){this._handlerFb=p}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=i}reset(){if(this._state===2)for(let p=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;p>=0;--p)this._active[p].end(!1);this._stack.paused=!1,this._active=i,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||i,this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].start();else this._handlerFb(this._id,"START")}_put(p,m,h){if(this._active.length)for(let l=this._active.length-1;l>=0;l--)this._active[l].put(p,m,h);else this._handlerFb(this._id,"PUT",(0,s.utf32ToString)(p,m,h))}start(){this.reset(),this._state=1}put(p,m,h){if(this._state!==3){if(this._state===1)for(;m<h;){let l=p[m++];if(l===59){this._state=2,this._start();break}if(l<48||57<l)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+l-48}this._state===2&&h-m>0&&this._put(p,m,h)}}end(p,m=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let h=!1,l=this._active.length-1,r=!1;if(this._stack.paused&&(l=this._stack.loopPosition-1,h=m,r=this._stack.fallThrough,this._stack.paused=!1),!r&&h===!1){for(;l>=0&&(h=this._active[l].end(p),h!==!0);l--)if(h instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=l,this._stack.fallThrough=!1,h;l--}for(;l>=0;l--)if(h=this._active[l].end(!1),h instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=l,this._stack.fallThrough=!0,h}else this._handlerFb(this._id,"END",p);this._active=i,this._id=-1,this._state=0}}},n.OscHandler=class{constructor(p){this._handler=p,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(p,m,h){this._hitLimit||(this._data+=(0,s.utf32ToString)(p,m,h),this._data.length>f.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(p){let m=!1;if(this._hitLimit)m=!1;else if(p&&(m=this._handler(this._data),m instanceof Promise))return m.then(h=>(this._data="",this._hitLimit=!1,h));return this._data="",this._hitLimit=!1,m}}},8742:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Params=void 0;let u=2147483647;class f{static fromArray(i){let p=new f;if(!i.length)return p;for(let m=Array.isArray(i[0])?1:0;m<i.length;++m){let h=i[m];if(Array.isArray(h))for(let l=0;l<h.length;++l)p.addSubParam(h[l]);else p.addParam(h)}return p}constructor(i=32,p=32){if(this.maxLength=i,this.maxSubParamsLength=p,p>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(i),this.length=0,this._subParams=new Int32Array(p),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(i),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){let i=new f(this.maxLength,this.maxSubParamsLength);return i.params.set(this.params),i.length=this.length,i._subParams.set(this._subParams),i._subParamsLength=this._subParamsLength,i._subParamsIdx.set(this._subParamsIdx),i._rejectDigits=this._rejectDigits,i._rejectSubDigits=this._rejectSubDigits,i._digitIsSub=this._digitIsSub,i}toArray(){let i=[];for(let p=0;p<this.length;++p){i.push(this.params[p]);let m=this._subParamsIdx[p]>>8,h=255&this._subParamsIdx[p];h-m>0&&i.push(Array.prototype.slice.call(this._subParams,m,h))}return i}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(i){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(i<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=i>u?u:i}}addSubParam(i){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(i<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=i>u?u:i,this._subParamsIdx[this.length-1]++}}hasSubParams(i){return(255&this._subParamsIdx[i])-(this._subParamsIdx[i]>>8)>0}getSubParams(i){let p=this._subParamsIdx[i]>>8,m=255&this._subParamsIdx[i];return m-p>0?this._subParams.subarray(p,m):null}getSubParamsAll(){let i={};for(let p=0;p<this.length;++p){let m=this._subParamsIdx[p]>>8,h=255&this._subParamsIdx[p];h-m>0&&(i[p]=this._subParams.slice(m,h))}return i}addDigit(i){let p;if(this._rejectDigits||!(p=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;let m=this._digitIsSub?this._subParams:this.params,h=m[p-1];m[p-1]=~h?Math.min(10*h+i,u):i}}n.Params=f},5741:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AddonManager=void 0,n.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let u=this._addons.length-1;u>=0;u--)this._addons[u].instance.dispose()}loadAddon(u,f){let s={instance:f,dispose:f.dispose,isDisposed:!1};this._addons.push(s),f.dispose=()=>this._wrappedAddonDispose(s),f.activate(u)}_wrappedAddonDispose(u){if(u.isDisposed)return;let f=-1;for(let s=0;s<this._addons.length;s++)if(this._addons[s]===u){f=s;break}if(f===-1)throw new Error("Could not dispose an addon that has not been loaded");u.isDisposed=!0,u.dispose.apply(u.instance),this._addons.splice(f,1)}}},8771:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferApiView=void 0;let f=u(3785),s=u(511);n.BufferApiView=class{constructor(i,p){this._buffer=i,this.type=p}init(i){return this._buffer=i,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(i){let p=this._buffer.lines.get(i);if(p)return new f.BufferLineApiView(p)}getNullCell(){return new s.CellData}}},3785:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferLineApiView=void 0;let f=u(511);n.BufferLineApiView=class{constructor(s){this._line=s}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(s,i){if(!(s<0||s>=this._line.length))return i?(this._line.loadCell(s,i),i):this._line.loadCell(s,new f.CellData)}translateToString(s,i,p){return this._line.translateToString(s,i,p)}}},8285:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferNamespaceApi=void 0;let f=u(8771),s=u(8460),i=u(844);class p extends i.Disposable{constructor(h){super(),this._core=h,this._onBufferChange=this.register(new s.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new f.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new f.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}n.BufferNamespaceApi=p},7975:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ParserApi=void 0,n.ParserApi=class{constructor(u){this._core=u}registerCsiHandler(u,f){return this._core.registerCsiHandler(u,s=>f(s.toArray()))}addCsiHandler(u,f){return this.registerCsiHandler(u,f)}registerDcsHandler(u,f){return this._core.registerDcsHandler(u,(s,i)=>f(s,i.toArray()))}addDcsHandler(u,f){return this.registerDcsHandler(u,f)}registerEscHandler(u,f){return this._core.registerEscHandler(u,f)}addEscHandler(u,f){return this.registerEscHandler(u,f)}registerOscHandler(u,f){return this._core.registerOscHandler(u,f)}addOscHandler(u,f){return this.registerOscHandler(u,f)}}},7090:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeApi=void 0,n.UnicodeApi=class{constructor(u){this._core=u}register(u){this._core.unicodeService.register(u)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(u){this._core.unicodeService.activeVersion=u}}},744:function(g,n,u){var f=this&&this.__decorate||function(r,o,c,_){var D,C=arguments.length,b=C<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,c):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,o,c,_);else for(var S=r.length-1;S>=0;S--)(D=r[S])&&(b=(C<3?D(b):C>3?D(o,c,b):D(o,c))||b);return C>3&&b&&Object.defineProperty(o,c,b),b},s=this&&this.__param||function(r,o){return function(c,_){o(c,_,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.BufferService=n.MINIMUM_ROWS=n.MINIMUM_COLS=void 0;let i=u(8460),p=u(844),m=u(5295),h=u(2585);n.MINIMUM_COLS=2,n.MINIMUM_ROWS=1;let l=n.BufferService=class extends p.Disposable{get buffer(){return this.buffers.active}constructor(r){super(),this.isUserScrolling=!1,this._onResize=this.register(new i.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new i.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(r.rawOptions.cols||0,n.MINIMUM_COLS),this.rows=Math.max(r.rawOptions.rows||0,n.MINIMUM_ROWS),this.buffers=this.register(new m.BufferSet(r,this))}resize(r,o){this.cols=r,this.rows=o,this.buffers.resize(r,o),this._onResize.fire({cols:r,rows:o})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(r,o=!1){let c=this.buffer,_;_=this._cachedBlankLine,_&&_.length===this.cols&&_.getFg(0)===r.fg&&_.getBg(0)===r.bg||(_=c.getBlankLine(r,o),this._cachedBlankLine=_),_.isWrapped=o;let D=c.ybase+c.scrollTop,C=c.ybase+c.scrollBottom;if(c.scrollTop===0){let b=c.lines.isFull;C===c.lines.length-1?b?c.lines.recycle().copyFrom(_):c.lines.push(_.clone()):c.lines.splice(C+1,0,_.clone()),b?this.isUserScrolling&&(c.ydisp=Math.max(c.ydisp-1,0)):(c.ybase++,this.isUserScrolling||c.ydisp++)}else{let b=C-D+1;c.lines.shiftElements(D+1,b-1,-1),c.lines.set(C,_.clone())}this.isUserScrolling||(c.ydisp=c.ybase),this._onScroll.fire(c.ydisp)}scrollLines(r,o,c){let _=this.buffer;if(r<0){if(_.ydisp===0)return;this.isUserScrolling=!0}else r+_.ydisp>=_.ybase&&(this.isUserScrolling=!1);let D=_.ydisp;_.ydisp=Math.max(Math.min(_.ydisp+r,_.ybase),0),D!==_.ydisp&&(o||this._onScroll.fire(_.ydisp))}};n.BufferService=l=f([s(0,h.IOptionsService)],l)},7994:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CharsetService=void 0,n.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(u){this.glevel=u,this.charset=this._charsets[u]}setgCharset(u,f){this._charsets[u]=f,this.glevel===u&&(this.charset=f)}}},1753:function(g,n,u){var f=this&&this.__decorate||function(_,D,C,b){var S,v=arguments.length,y=v<3?D:b===null?b=Object.getOwnPropertyDescriptor(D,C):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(_,D,C,b);else for(var M=_.length-1;M>=0;M--)(S=_[M])&&(y=(v<3?S(y):v>3?S(D,C,y):S(D,C))||y);return v>3&&y&&Object.defineProperty(D,C,y),y},s=this&&this.__param||function(_,D){return function(C,b){D(C,b,_)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CoreMouseService=void 0;let i=u(2585),p=u(8460),m=u(844),h={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:_=>_.button!==4&&_.action===1&&(_.ctrl=!1,_.alt=!1,_.shift=!1,!0)},VT200:{events:19,restrict:_=>_.action!==32},DRAG:{events:23,restrict:_=>_.action!==32||_.button!==3},ANY:{events:31,restrict:_=>!0}};function l(_,D){let C=(_.ctrl?16:0)|(_.shift?4:0)|(_.alt?8:0);return _.button===4?(C|=64,C|=_.action):(C|=3&_.button,4&_.button&&(C|=64),8&_.button&&(C|=128),_.action===32?C|=32:_.action!==0||D||(C|=3)),C}let r=String.fromCharCode,o={DEFAULT:_=>{let D=[l(_,!1)+32,_.col+32,_.row+32];return D[0]>255||D[1]>255||D[2]>255?"":`\x1B[M${r(D[0])}${r(D[1])}${r(D[2])}`},SGR:_=>{let D=_.action===0&&_.button!==4?"m":"M";return`\x1B[<${l(_,!0)};${_.col};${_.row}${D}`},SGR_PIXELS:_=>{let D=_.action===0&&_.button!==4?"m":"M";return`\x1B[<${l(_,!0)};${_.x};${_.y}${D}`}},c=n.CoreMouseService=class extends m.Disposable{constructor(_,D){super(),this._bufferService=_,this._coreService=D,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new p.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(let C of Object.keys(h))this.addProtocol(C,h[C]);for(let C of Object.keys(o))this.addEncoding(C,o[C]);this.reset()}addProtocol(_,D){this._protocols[_]=D}addEncoding(_,D){this._encodings[_]=D}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(_){if(!this._protocols[_])throw new Error(`unknown protocol "${_}"`);this._activeProtocol=_,this._onProtocolChange.fire(this._protocols[_].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(_){if(!this._encodings[_])throw new Error(`unknown encoding "${_}"`);this._activeEncoding=_}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(_){if(_.col<0||_.col>=this._bufferService.cols||_.row<0||_.row>=this._bufferService.rows||_.button===4&&_.action===32||_.button===3&&_.action!==32||_.button!==4&&(_.action===2||_.action===3)||(_.col++,_.row++,_.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,_,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(_))return!1;let D=this._encodings[this._activeEncoding](_);return D&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(D):this._coreService.triggerDataEvent(D,!0)),this._lastEvent=_,!0}explainEvents(_){return{down:!!(1&_),up:!!(2&_),drag:!!(4&_),move:!!(8&_),wheel:!!(16&_)}}_equalEvents(_,D,C){if(C){if(_.x!==D.x||_.y!==D.y)return!1}else if(_.col!==D.col||_.row!==D.row)return!1;return _.button===D.button&&_.action===D.action&&_.ctrl===D.ctrl&&_.alt===D.alt&&_.shift===D.shift}};n.CoreMouseService=c=f([s(0,i.IBufferService),s(1,i.ICoreService)],c)},6975:function(g,n,u){var f=this&&this.__decorate||function(c,_,D,C){var b,S=arguments.length,v=S<3?_:C===null?C=Object.getOwnPropertyDescriptor(_,D):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(c,_,D,C);else for(var y=c.length-1;y>=0;y--)(b=c[y])&&(v=(S<3?b(v):S>3?b(_,D,v):b(_,D))||v);return S>3&&v&&Object.defineProperty(_,D,v),v},s=this&&this.__param||function(c,_){return function(D,C){_(D,C,c)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CoreService=void 0;let i=u(1439),p=u(8460),m=u(844),h=u(2585),l=Object.freeze({insertMode:!1}),r=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),o=n.CoreService=class extends m.Disposable{constructor(c,_,D){super(),this._bufferService=c,this._logService=_,this._optionsService=D,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new p.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new p.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new p.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new p.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,i.clone)(l),this.decPrivateModes=(0,i.clone)(r)}reset(){this.modes=(0,i.clone)(l),this.decPrivateModes=(0,i.clone)(r)}triggerDataEvent(c,_=!1){if(this._optionsService.rawOptions.disableStdin)return;let D=this._bufferService.buffer;_&&this._optionsService.rawOptions.scrollOnUserInput&&D.ybase!==D.ydisp&&this._onRequestScrollToBottom.fire(),_&&this._onUserInput.fire(),this._logService.debug(`sending data "${c}"`,()=>c.split("").map(C=>C.charCodeAt(0))),this._onData.fire(c)}triggerBinaryEvent(c){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${c}"`,()=>c.split("").map(_=>_.charCodeAt(0))),this._onBinary.fire(c))}};n.CoreService=o=f([s(0,h.IBufferService),s(1,h.ILogService),s(2,h.IOptionsService)],o)},9074:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DecorationService=void 0;let f=u(8055),s=u(8460),i=u(844),p=u(6106),m=0,h=0;class l extends i.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new p.SortedList(c=>c?.marker.line),this._onDecorationRegistered=this.register(new s.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new s.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,i.toDisposable)(()=>this.reset()))}registerDecoration(c){if(c.marker.isDisposed)return;let _=new r(c);if(_){let D=_.marker.onDispose(()=>_.dispose());_.onDispose(()=>{_&&(this._decorations.delete(_)&&this._onDecorationRemoved.fire(_),D.dispose())}),this._decorations.insert(_),this._onDecorationRegistered.fire(_)}return _}reset(){for(let c of this._decorations.values())c.dispose();this._decorations.clear()}*getDecorationsAtCell(c,_,D){var C,b,S;let v=0,y=0;for(let M of this._decorations.getKeyIterator(_))v=(C=M.options.x)!==null&&C!==void 0?C:0,y=v+((b=M.options.width)!==null&&b!==void 0?b:1),c>=v&&c<y&&(!D||((S=M.options.layer)!==null&&S!==void 0?S:"bottom")===D)&&(yield M)}forEachDecorationAtCell(c,_,D,C){this._decorations.forEachByKey(_,b=>{var S,v,y;m=(S=b.options.x)!==null&&S!==void 0?S:0,h=m+((v=b.options.width)!==null&&v!==void 0?v:1),c>=m&&c<h&&(!D||((y=b.options.layer)!==null&&y!==void 0?y:"bottom")===D)&&C(b)})}}n.DecorationService=l;class r extends i.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=f.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=f.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(c){super(),this.options=c,this.onRenderEmitter=this.register(new s.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new s.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=c.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.InstantiationService=n.ServiceCollection=void 0;let f=u(2585),s=u(8343);class i{constructor(...m){this._entries=new Map;for(let[h,l]of m)this.set(h,l)}set(m,h){let l=this._entries.get(m);return this._entries.set(m,h),l}forEach(m){for(let[h,l]of this._entries.entries())m(h,l)}has(m){return this._entries.has(m)}get(m){return this._entries.get(m)}}n.ServiceCollection=i,n.InstantiationService=class{constructor(){this._services=new i,this._services.set(f.IInstantiationService,this)}setService(p,m){this._services.set(p,m)}getService(p){return this._services.get(p)}createInstance(p,...m){let h=(0,s.getServiceDependencies)(p).sort((o,c)=>o.index-c.index),l=[];for(let o of h){let c=this._services.get(o.id);if(!c)throw new Error(`[createInstance] ${p.name} depends on UNKNOWN service ${o.id}.`);l.push(c)}let r=h.length>0?h[0].index:m.length;if(m.length!==r)throw new Error(`[createInstance] First service dependency of ${p.name} at position ${r+1} conflicts with ${m.length} static arguments`);return new p(...m,...l)}}},7866:function(g,n,u){var f=this&&this.__decorate||function(r,o,c,_){var D,C=arguments.length,b=C<3?o:_===null?_=Object.getOwnPropertyDescriptor(o,c):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,o,c,_);else for(var S=r.length-1;S>=0;S--)(D=r[S])&&(b=(C<3?D(b):C>3?D(o,c,b):D(o,c))||b);return C>3&&b&&Object.defineProperty(o,c,b),b},s=this&&this.__param||function(r,o){return function(c,_){o(c,_,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.traceCall=n.setTraceLogger=n.LogService=void 0;let i=u(844),p=u(2585),m={trace:p.LogLevelEnum.TRACE,debug:p.LogLevelEnum.DEBUG,info:p.LogLevelEnum.INFO,warn:p.LogLevelEnum.WARN,error:p.LogLevelEnum.ERROR,off:p.LogLevelEnum.OFF},h,l=n.LogService=class extends i.Disposable{get logLevel(){return this._logLevel}constructor(r){super(),this._optionsService=r,this._logLevel=p.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),h=this}_updateLogLevel(){this._logLevel=m[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(r){for(let o=0;o<r.length;o++)typeof r[o]=="function"&&(r[o]=r[o]())}_log(r,o,c){this._evalLazyOptionalParams(c),r.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+o,...c)}trace(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.TRACE&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.trace.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.log,r,o)}debug(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.DEBUG&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.debug.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.log,r,o)}info(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.INFO&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.info.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.info,r,o)}warn(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.WARN&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.warn.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.warn,r,o)}error(r,...o){var c,_;this._logLevel<=p.LogLevelEnum.ERROR&&this._log((_=(c=this._optionsService.options.logger)===null||c===void 0?void 0:c.error.bind(this._optionsService.options.logger))!==null&&_!==void 0?_:console.error,r,o)}};n.LogService=l=f([s(0,p.IOptionsService)],l),n.setTraceLogger=function(r){h=r},n.traceCall=function(r,o,c){if(typeof c.value!="function")throw new Error("not supported");let _=c.value;c.value=function(...D){if(h.logLevel!==p.LogLevelEnum.TRACE)return _.apply(this,D);h.trace(`GlyphRenderer#${_.name}(${D.map(b=>JSON.stringify(b)).join(", ")})`);let C=_.apply(this,D);return h.trace(`GlyphRenderer#${_.name} return`,C),C}}},7302:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OptionsService=n.DEFAULT_OPTIONS=void 0;let f=u(8460),s=u(844),i=u(6114);n.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:i.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};let p=["normal","bold","100","200","300","400","500","600","700","800","900"];class m extends s.Disposable{constructor(l){super(),this._onOptionChange=this.register(new f.EventEmitter),this.onOptionChange=this._onOptionChange.event;let r=Object.assign({},n.DEFAULT_OPTIONS);for(let o in l)if(o in r)try{let c=l[o];r[o]=this._sanitizeAndValidateOption(o,c)}catch(c){console.error(c)}this.rawOptions=r,this.options=Object.assign({},r),this._setupOptions()}onSpecificOptionChange(l,r){return this.onOptionChange(o=>{o===l&&r(this.rawOptions[l])})}onMultipleOptionChange(l,r){return this.onOptionChange(o=>{l.indexOf(o)!==-1&&r()})}_setupOptions(){let l=o=>{if(!(o in n.DEFAULT_OPTIONS))throw new Error(`No option with key "${o}"`);return this.rawOptions[o]},r=(o,c)=>{if(!(o in n.DEFAULT_OPTIONS))throw new Error(`No option with key "${o}"`);c=this._sanitizeAndValidateOption(o,c),this.rawOptions[o]!==c&&(this.rawOptions[o]=c,this._onOptionChange.fire(o))};for(let o in this.rawOptions){let c={get:l.bind(this,o),set:r.bind(this,o)};Object.defineProperty(this.options,o,c)}}_sanitizeAndValidateOption(l,r){switch(l){case"cursorStyle":if(r||(r=n.DEFAULT_OPTIONS[l]),!function(o){return o==="block"||o==="underline"||o==="bar"}(r))throw new Error(`"${r}" is not a valid value for ${l}`);break;case"wordSeparator":r||(r=n.DEFAULT_OPTIONS[l]);break;case"fontWeight":case"fontWeightBold":if(typeof r=="number"&&1<=r&&r<=1e3)break;r=p.includes(r)?r:n.DEFAULT_OPTIONS[l];break;case"cursorWidth":r=Math.floor(r);case"lineHeight":case"tabStopWidth":if(r<1)throw new Error(`${l} cannot be less than 1, value: ${r}`);break;case"minimumContrastRatio":r=Math.max(1,Math.min(21,Math.round(10*r)/10));break;case"scrollback":if((r=Math.min(r,4294967295))<0)throw new Error(`${l} cannot be less than 0, value: ${r}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(r<=0)throw new Error(`${l} cannot be less than or equal to 0, value: ${r}`);break;case"rows":case"cols":if(!r&&r!==0)throw new Error(`${l} must be numeric, value: ${r}`);break;case"windowsPty":r=r??{}}return r}}n.OptionsService=m},2660:function(g,n,u){var f=this&&this.__decorate||function(m,h,l,r){var o,c=arguments.length,_=c<3?h:r===null?r=Object.getOwnPropertyDescriptor(h,l):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(m,h,l,r);else for(var D=m.length-1;D>=0;D--)(o=m[D])&&(_=(c<3?o(_):c>3?o(h,l,_):o(h,l))||_);return c>3&&_&&Object.defineProperty(h,l,_),_},s=this&&this.__param||function(m,h){return function(l,r){h(l,r,m)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OscLinkService=void 0;let i=u(2585),p=n.OscLinkService=class{constructor(m){this._bufferService=m,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(m){let h=this._bufferService.buffer;if(m.id===void 0){let D=h.addMarker(h.ybase+h.y),C={data:m,id:this._nextId++,lines:[D]};return D.onDispose(()=>this._removeMarkerFromLink(C,D)),this._dataByLinkId.set(C.id,C),C.id}let l=m,r=this._getEntryIdKey(l),o=this._entriesWithId.get(r);if(o)return this.addLineToLink(o.id,h.ybase+h.y),o.id;let c=h.addMarker(h.ybase+h.y),_={id:this._nextId++,key:this._getEntryIdKey(l),data:l,lines:[c]};return c.onDispose(()=>this._removeMarkerFromLink(_,c)),this._entriesWithId.set(_.key,_),this._dataByLinkId.set(_.id,_),_.id}addLineToLink(m,h){let l=this._dataByLinkId.get(m);if(l&&l.lines.every(r=>r.line!==h)){let r=this._bufferService.buffer.addMarker(h);l.lines.push(r),r.onDispose(()=>this._removeMarkerFromLink(l,r))}}getLinkData(m){var h;return(h=this._dataByLinkId.get(m))===null||h===void 0?void 0:h.data}_getEntryIdKey(m){return`${m.id};;${m.uri}`}_removeMarkerFromLink(m,h){let l=m.lines.indexOf(h);l!==-1&&(m.lines.splice(l,1),m.lines.length===0&&(m.data.id!==void 0&&this._entriesWithId.delete(m.key),this._dataByLinkId.delete(m.id)))}};n.OscLinkService=p=f([s(0,i.IBufferService)],p)},8343:(g,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createDecorator=n.getServiceDependencies=n.serviceRegistry=void 0;let u="di$target",f="di$dependencies";n.serviceRegistry=new Map,n.getServiceDependencies=function(s){return s[f]||[]},n.createDecorator=function(s){if(n.serviceRegistry.has(s))return n.serviceRegistry.get(s);let i=function(p,m,h){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(l,r,o){r[u]===r?r[f].push({id:l,index:o}):(r[f]=[{id:l,index:o}],r[u]=r)})(i,p,h)};return i.toString=()=>s,n.serviceRegistry.set(s,i),i}},2585:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IDecorationService=n.IUnicodeService=n.IOscLinkService=n.IOptionsService=n.ILogService=n.LogLevelEnum=n.IInstantiationService=n.ICharsetService=n.ICoreService=n.ICoreMouseService=n.IBufferService=void 0;let f=u(8343);var s;n.IBufferService=(0,f.createDecorator)("BufferService"),n.ICoreMouseService=(0,f.createDecorator)("CoreMouseService"),n.ICoreService=(0,f.createDecorator)("CoreService"),n.ICharsetService=(0,f.createDecorator)("CharsetService"),n.IInstantiationService=(0,f.createDecorator)("InstantiationService"),function(i){i[i.TRACE=0]="TRACE",i[i.DEBUG=1]="DEBUG",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.OFF=5]="OFF"}(s||(n.LogLevelEnum=s={})),n.ILogService=(0,f.createDecorator)("LogService"),n.IOptionsService=(0,f.createDecorator)("OptionsService"),n.IOscLinkService=(0,f.createDecorator)("OscLinkService"),n.IUnicodeService=(0,f.createDecorator)("UnicodeService"),n.IDecorationService=(0,f.createDecorator)("DecorationService")},1480:(g,n,u)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeService=void 0;let f=u(8460),s=u(225);n.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new f.EventEmitter,this.onChange=this._onChange.event;let i=new s.UnicodeV6;this.register(i),this._active=i.version,this._activeProvider=i}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(i){if(!this._providers[i])throw new Error(`unknown Unicode version "${i}"`);this._active=i,this._activeProvider=this._providers[i],this._onChange.fire(i)}register(i){this._providers[i.version]=i}wcwidth(i){return this._activeProvider.wcwidth(i)}getStringCellWidth(i){let p=0,m=i.length;for(let h=0;h<m;++h){let l=i.charCodeAt(h);if(55296<=l&&l<=56319){if(++h>=m)return p+this.wcwidth(l);let r=i.charCodeAt(h);56320<=r&&r<=57343?l=1024*(l-55296)+r-56320+65536:p+=this.wcwidth(r)}p+=this.wcwidth(l)}return p}}}},t={};function a(g){var n=t[g];if(n!==void 0)return n.exports;var u=t[g]={exports:{}};return e[g].call(u.exports,u,u.exports,a),u.exports}var d={};return(()=>{var g=d;Object.defineProperty(g,"__esModule",{value:!0}),g.Terminal=void 0;let n=a(9042),u=a(3236),f=a(844),s=a(5741),i=a(8285),p=a(7975),m=a(7090),h=["cols","rows"];class l extends f.Disposable{constructor(o){super(),this._core=this.register(new u.Terminal(o)),this._addonManager=this.register(new s.AddonManager),this._publicOptions=Object.assign({},this._core.options);let c=D=>this._core.options[D],_=(D,C)=>{this._checkReadonlyOptions(D),this._core.options[D]=C};for(let D in this._core.options){let C={get:c.bind(this,D),set:_.bind(this,D)};Object.defineProperty(this._publicOptions,D,C)}}_checkReadonlyOptions(o){if(h.includes(o))throw new Error(`Option "${o}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new p.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new m.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new i.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){let o=this._core.coreService.decPrivateModes,c="none";switch(this._core.coreMouseService.activeProtocol){case"X10":c="x10";break;case"VT200":c="vt200";break;case"DRAG":c="drag";break;case"ANY":c="any"}return{applicationCursorKeysMode:o.applicationCursorKeys,applicationKeypadMode:o.applicationKeypad,bracketedPasteMode:o.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:c,originMode:o.origin,reverseWraparoundMode:o.reverseWraparound,sendFocusMode:o.sendFocus,wraparoundMode:o.wraparound}}get options(){return this._publicOptions}set options(o){for(let c in o)this._publicOptions[c]=o[c]}blur(){this._core.blur()}focus(){this._core.focus()}resize(o,c){this._verifyIntegers(o,c),this._core.resize(o,c)}open(o){this._core.open(o)}attachCustomKeyEventHandler(o){this._core.attachCustomKeyEventHandler(o)}registerLinkProvider(o){return this._core.registerLinkProvider(o)}registerCharacterJoiner(o){return this._checkProposedApi(),this._core.registerCharacterJoiner(o)}deregisterCharacterJoiner(o){this._checkProposedApi(),this._core.deregisterCharacterJoiner(o)}registerMarker(o=0){return this._verifyIntegers(o),this._core.registerMarker(o)}registerDecoration(o){var c,_,D;return this._checkProposedApi(),this._verifyPositiveIntegers((c=o.x)!==null&&c!==void 0?c:0,(_=o.width)!==null&&_!==void 0?_:0,(D=o.height)!==null&&D!==void 0?D:0),this._core.registerDecoration(o)}hasSelection(){return this._core.hasSelection()}select(o,c,_){this._verifyIntegers(o,c,_),this._core.select(o,c,_)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(o,c){this._verifyIntegers(o,c),this._core.selectLines(o,c)}dispose(){super.dispose()}scrollLines(o){this._verifyIntegers(o),this._core.scrollLines(o)}scrollPages(o){this._verifyIntegers(o),this._core.scrollPages(o)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(o){this._verifyIntegers(o),this._core.scrollToLine(o)}clear(){this._core.clear()}write(o,c){this._core.write(o,c)}writeln(o,c){this._core.write(o),this._core.write(`\r
`,c)}paste(o){this._core.paste(o)}refresh(o,c){this._verifyIntegers(o,c),this._core.refresh(o,c)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(o){this._addonManager.loadAddon(this,o)}static get strings(){return n}_verifyIntegers(...o){for(let c of o)if(c===1/0||isNaN(c)||c%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...o){for(let c of o)if(c&&(c===1/0||isNaN(c)||c%1!=0||c<0))throw new Error("This API only accepts positive integers")}}g.Terminal=l})(),d})())});var ph=function(e){return function(t){for(var a=e.length,d=t.length,g=new Array(a*d),n=0,u=0;u<a;u++)for(var f=e[u],s=0;s<d;s++)g[n++]=f(t[s]);return g}};var Ms={compose:function(e){return function(t){return function(a){return e(t(a))}}}};var pe=function(e){return e.identity},de={identity:function(e){return e},Semigroupoid0:function(){return Ms}};var nr=!0;var Ge=function(e){return function(t){return function(a){return e(a)(t)}}},Te=function(e){return function(t){return e}};var dh=function(e){return function(t){for(var a=t.length,d=new Array(a),g=0;g<a;g++)d[g]=e(t[g]);return d}};var ar=function(){function e(){}return e.value=new e,e}();var $=function(e){return e.map};var gt=function(e){return $(e)(Te(void 0))},Oi=function(e){var t=$(e);return function(a){return function(d){return t(Te(d))(a)}}};var Tt={map:dh};var Sw=pe(de);var Ho={apply:ph,Functor0:function(){return Tt}},Xe=function(e){return e.apply};var No=function(e){var t=Xe(e),a=$(e.Functor0());return function(d){return function(g){return t(a(Te(Sw))(d))(g)}}};var Q=function(e){return e.pure},Lu=function(e){var t=Q(e);return function(a){return function(d){if(!a)return d;if(a)return t(void 0);throw new Error("Failed pattern match at Control.Applicative (line 68, column 1 - line 68, column 65): "+[a.constructor.name,d.constructor.name])}}},Yr=function(e){var t=Q(e);return function(a){return function(d){if(a)return d;if(!a)return t(void 0);throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[a.constructor.name,d.constructor.name])}}},Au=function(e){var t=Xe(e.Apply0()),a=Q(e);return function(d){return function(g){return t(a(d))(g)}}};var Pi={pure:function(e){return[e]},Apply0:function(){return Ho}};var vh=function(e){return function(t){for(var a=[],d=0,g=e.length;d<g;d++)Array.prototype.push.apply(a,t(e[d]));return a}};var Lt=function(e){return e.discard};var ko={bind:vh,Apply0:function(){return Ho}},se=function(e){return e.bind},$t=function(e){return Ge(se(e))},Ls=function(e){var t=$t(e);return function(a){return function(d){return function(g){return t(a)(d(g))}}}};var At={discard:function(e){return se(e)}};var hh=function(e){var t=se(e.Bind1()),a=Lu(e.Applicative0());return function(d){return function(g){return t(d)(function(n){return a(n)(g)})}}};var gh=function(e){var t=se(e.Bind1()),a=Q(e.Applicative0());return function(d){return function(g){return t(g)(function(n){return a(d(n))})}}},Lr=function(e){var t=se(e.Bind1()),a=Q(e.Applicative0());return function(d){return function(g){return t(d)(function(n){return t(g)(function(u){return a(n(u))})})}}};var Dh=function(e){return function(t){return e+t}},Ch=function(e){return function(t){return e.length===0?t:t.length===0?e:e.concat(t)}};var xr=function(e){return e.reflectSymbol};var As={append:Dh};var wt={append:Ch};var ce=function(e){return e.append};var L_={alt:ce(wt),Functor0:function(){return Tt}},or=function(e){return e.alt};var bh=String.fromCharCode(65535),Sh=String.fromCharCode(0),Fw=Number.POSITIVE_INFINITY,Lw=Number.NEGATIVE_INFINITY;var xs=function(e){return function(t){return function(a){return function(d){return function(g){return d<g?e:d===g?t:a}}}}};var Th=xs,wh=xs,Eh=xs,Mh=xs,Fh=function(e){return function(t){return function(a){for(var d=0,g=t.length,n=a.length;d<g&&d<n;){var u=t[d],f=a[d],s=e(u)(f);if(s!==0)return s;d++}return g===n?0:g>n?-1:1}}};var Is=function(e){return function(t){return e===t}};var Lh=Is,Ah=Is,xh=Is,Ih=Is,Rh=function(e){return function(t){return function(a){if(t.length!==a.length)return!1;for(var d=0;d<t.length;d++)if(!e(t[d])(a[d]))return!1;return!0}}};var A_={eq:function(e){return function(t){return!0}}},yr={eq:Ih};var xu={eq:Ah},Ni={eq:Lh},Oh={eq:xh};var Ee=function(e){return e.eq};var Hn=function(e){return{eq:Rh(Ee(e))}};var X=function(){function e(){}return e.value=new e,e}(),te=function(){function e(){}return e.value=new e,e}(),ye=function(){function e(){}return e.value=new e,e}();var Ph=function(e){return function(t){return e+t|0}},Hh=function(e){return function(t){return e*t|0}};var ki={add:Ph,zero:0,mul:Hh,one:1};var gn=function(e){return e.one};var kr=function(e){return e.add};var Bi={compare:function(e){return function(t){return ye.value}},Eq0:function(){return A_}},Qt=function(){return{compare:Eh(X.value)(ye.value)(te.value),Eq0:function(){return yr}}}();var $i=function(){return{compare:wh(X.value)(ye.value)(te.value),Eq0:function(){return xu}}}(),ir=function(){return{compare:Th(X.value)(ye.value)(te.value),Eq0:function(){return Ni}}}(),Os=function(){return{compare:Mh(X.value)(ye.value)(te.value),Eq0:function(){return Oh}}}();var he=function(e){return e.compare},Nw=he(ir);var Ps=function(e){var t=he(e);return function(a){return function(d){var g=t(a)(d);if(g instanceof X)return d;if(g instanceof ye||g instanceof te)return a;throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[g.constructor.name])}}},x_=function(e){var t=he(e);return function(a){return function(d){var g=t(a)(d);if(g instanceof X||g instanceof ye)return a;if(g instanceof te)return d;throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[g.constructor.name])}}},ka=function(e){var t=he(e),a=Hn(e.Eq0());return{compare:function(){var d=function(g){return function(n){var u=t(g)(n);if(u instanceof ye)return 0;if(u instanceof X)return 1;if(u instanceof te)return-1;throw new Error("Failed pattern match at Data.Ord (line 79, column 7 - line 82, column 17): "+[u.constructor.name])}};return function(g){return function(n){return Nw(0)(Fh(d)(g)(n))}}}(),Eq0:function(){return a}}};var qh=function(e){var t=x_(e),a=Ps(e);return function(d){return function(g){return function(n){return t(g)(a(d)(n))}}}};var Nn=function(e){return e.top};var Hs={top:2147483647,bottom:-2147483648,Ord0:function(){return ir}},Iu={top:bh,bottom:Sh,Ord0:function(){return Os}};var la=function(e){return e.bottom};var Uh=function(e){return e.toString()},zh=function(e){var t=e.toString();return isNaN(t+".0")?t:t+".0"};var Wn={show:zh},Bo={show:Uh};var Vh={show:function(e){if(e)return"true";if(!e)return"false";throw new Error("Failed pattern match at Data.Show (line 29, column 1 - line 31, column 23): "+[e.constructor.name])}},Fe=function(e){return e.show};var zw=pe(de),q=function(){function e(){}return e.value=new e,e}(),k=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}();var P_=function(e){var t=ce(e);return{append:function(a){return function(d){if(a instanceof q)return d;if(d instanceof q)return a;if(a instanceof k&&d instanceof k)return new k(t(a.value0)(d.value0));throw new Error("Failed pattern match at Data.Maybe (line 182, column 1 - line 185, column 43): "+[a.constructor.name,d.constructor.name])}}}};var Gh=function(e){var t=P_(e);return{mempty:q.value,Semigroup0:function(){return t}}};var Qe=function(e){return function(t){return function(a){if(a instanceof q)return e;if(a instanceof k)return t(a.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[e.constructor.name,t.constructor.name,a.constructor.name])}}},pa=Qe(!0)(Te(!1)),qi=Qe(!1)(Te(!0));var pt={map:function(e){return function(t){return t instanceof k?new k(e(t.value0)):q.value}}},Vw=$(pt);var tr=function(e){return Qe(e)(zw)},Dn=function(){return function(e){if(e instanceof k)return e.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[e.constructor.name])}};var $o=function(e){var t=Ee(e);return{eq:function(a){return function(d){return a instanceof q&&d instanceof q?!0:a instanceof k&&d instanceof k?t(a.value0)(d.value0):!1}}}};var Ns={apply:function(e){return function(t){if(e instanceof k)return Vw(e.value0)(t);if(e instanceof q)return q.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[e.constructor.name,t.constructor.name])}},Functor0:function(){return pt}};var Wr={bind:function(e){return function(t){if(e instanceof k)return t(e.value0);if(e instanceof q)return q.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[e.constructor.name,t.constructor.name])}},Apply0:function(){return Ns}};var Ye=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Je=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}();var lr=function(e){return function(t){return function(a){if(a instanceof Ye)return e(a.value0);if(a instanceof Je)return t(a.value0);throw new Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): "+[e.constructor.name,t.constructor.name,a.constructor.name])}}},ks=function(){return lr(Te(q.value))(k.create)}();var jh=lr(Te(!1))(Te(!0));var da=function(e){return e};var qo={map:function(e){return function(t){return e(t)}}};var Ws={apply:function(e){return function(t){return e(t)}},Functor0:function(){return qo}},H_={bind:function(e){return function(t){return t(e)}},Apply0:function(){return Ws}},Bs={pure:da,Apply0:function(){return Ws}},$s={Applicative0:function(){return Bs},Bind1:function(){return H_}};var Ba={mempty:"",Semigroup0:function(){return As}};var Ou={mempty:[],Semigroup0:function(){return wt}};var Ze=function(e){return e.mempty};var Kh=function(e){return function(){return e}},Xh=function(e){return function(t){return function(){return t(e())()}}};var Yh=function(e,t,a){var d=0,g;return function(n){if(d===2)return g;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,g=a(),d=2,g}},Bn={Applicative0:function(){return xt},Bind1:function(){return Zr}},Zr={bind:Xh,Apply0:function(){return eg(0)}},xt={pure:Kh,Apply0:function(){return eg(0)}},Zh=Yh("functorEffect","Effect",function(){return{map:Au(xt)}}),eg=Yh("applyEffect","Effect",function(){return{apply:Lr(Bn),Functor0:function(){return Zh(0)}}}),Oe=Zh(20);var tg=function(e){return function(){return{value:e}}};var Pe=function(e){return function(){return e.value}},rg=function(e){return function(t){return function(){var a=e(t.value);return t.value=a.state,a.value}}},vt=function(e){return function(t){return function(){t.value=e}}};var Zw=gt(Oe),It=tg,W_=rg,ng=function(e){return W_(function(t){var a=e(t);return{state:a,value:a}})},en=function(e){return function(t){return Zw(ng(e)(t))}};var n1=$t(Zr),a1=$(Oe),Gt=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Pt=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Sr=function(e){return e.tailRecM};var Us={tailRecM:function(e){return function(t){var a=function(d){if(d instanceof Pt)return d.value0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 137, column 30 - line 137, column 44): "+[d.constructor.name])};return function(){var g=n1(It)(e(t))();return function(){for(;!function(){var u=Pe(g)();if(u instanceof Gt){var f=e(u.value0)();return vt(f)(g)(),!1}if(u instanceof Pt)return!0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 128, column 22 - line 133, column 28): "+[u.constructor.name])}(););return{}}(),a1(a)(Pe(g))()}}},Monad0:function(){return Bn}};var ag=function(e){return function(t){return function(a){for(var d=t,g=a.length,n=g-1;n>=0;n--)d=e(a[n])(d);return d}}},og=function(e){return function(t){return function(a){for(var d=t,g=a.length,n=0;n<g;n++)d=e(d)(a[n]);return d}}};var ig={empty:[],Alt0:function(){return L_}},Br=function(e){return e.empty};var cg=function(e){return function(t){return e&&t}},sg=function(e){return function(t){return e||t}},fg=function(e){return!e};var Hu=function(e){return e.tt};var $n=function(e){return e.not};var z_=function(e){return e.implies};var Nu=function(e){return e.ff};var Uo=function(e){return e.disj},fn={ff:!1,tt:!0,implies:function(e){return function(t){return Uo(fn)($n(fn)(e))(t)}},conj:cg,disj:sg,not:fg};var Ui=function(e){return e.conj},ku=function(e){var t=Nu(e),a=Hu(e),d=z_(e),g=Ui(e),n=Uo(e),u=$n(e);return{ff:function(f){return t},tt:function(f){return a},implies:function(f){return function(s){return function(i){return d(f(i))(s(i))}}},conj:function(f){return function(s){return function(i){return g(f(i))(s(i))}}},disj:function(f){return function(s){return function(i){return n(f(i))(s(i))}}},not:function(f){return function(s){return u(f(s))}}}};var J=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),va=function(e){return function(t){return e(t.value0)(t.value1)}};var qt=function(e){return e.value1};var ma={map:function(e){return function(t){return new J(t.value0,e(t.value1))}}};var _r=function(e){return e.value0};var Vs=function(e){var t=Ee(e);return function(a){var d=Ee(a);return{eq:function(g){return function(n){return t(g.value0)(n.value0)&&d(g.value1)(n.value1)}}}}},zo=function(e){var t=he(e),a=Vs(e.Eq0());return function(d){var g=he(d),n=a(d.Eq0());return{compare:function(u){return function(f){var s=t(u.value0)(f.value0);return s instanceof X?X.value:s instanceof te?te.value:g(u.value1)(f.value1)}},Eq0:function(){return n}}}};var rn=function(e){return e.bimap};var d1={append:function(e){return function(t){return e instanceof k?e:t}}};var _g=function(){return{mempty:q.value,Semigroup0:function(){return d1}}}();var V=function(e){return e};var Js=function(){return V};var v1=Js();var jt=function(){return v1};var m1=pe(de);var h1=jt();var Dt=function(e){return e.foldr};var Et=function(e){var t=No(e.Apply0()),a=Q(e);return function(d){var g=Dt(d);return function(n){return g(function(u){return t(n(u))})(a(void 0))}}},Qs=function(e){var t=Et(e);return function(a){return Ge(t(a))}};var Ct=function(e){return e.foldl};var qn=function(e){var t=Ct(e);return function(a){var d=ce(a.Semigroup0()),g=Ze(a);return function(n){return function(u){var f=function(s){return function(i){return s.init?{init:!1,acc:i}:{init:!1,acc:d(s.acc)(d(n)(i))}}};return t(f)({init:!0,acc:g})(u).acc}}}};var Kt={foldr:function(e){return function(t){return function(a){if(a instanceof q)return t;if(a instanceof k)return e(a.value0)(t);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[e.constructor.name,t.constructor.name,a.constructor.name])}}},foldl:function(e){return function(t){return function(a){if(a instanceof q)return t;if(a instanceof k)return e(t)(a.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[e.constructor.name,t.constructor.name,a.constructor.name])}}},foldMap:function(e){var t=Ze(e);return function(a){return function(d){if(d instanceof q)return t;if(d instanceof k)return a(d.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[a.constructor.name,d.constructor.name])}}}};var gg=function(e){var t=Dt(e);return function(a){var d=ce(a.Semigroup0()),g=Ze(a);return function(n){return t(function(u){return function(f){return d(n(u))(f)}})(g)}}},Nt={foldr:ag,foldl:og,foldMap:function(e){return gg(Nt)(e)}};var Mt=function(e){return e.foldMap};var Ks=function(e){var t=Mt(e)(_g);return function(a){var d=Ee(a);return function(g){var n=t(function(u){var f=d(g)(u.value0);return f?new k(u.value1):q.value});return function(u){return h1(n(u))}}}};var Go=function(e){var t=Mt(e);return function(a){return t(a)(m1)}};var Zs=function(e){return e.foldl1};var U1=function(){function e(g){return[g]}function t(g){return function(n){return[g,n]}}function a(g){return function(n){return function(u){return[g,n,u]}}}function d(g){return function(n){return g.concat(n)}}return function(g){return function(n){return function(u){return function(f){return function(s){function i(p,m){switch(m-p){case 0:return u([]);case 1:return n(e)(f(s[p]));case 2:return g(n(t)(f(s[p])))(f(s[p+1]));case 3:return g(g(n(a)(f(s[p])))(f(s[p+1])))(f(s[p+2]));default:var h=p+Math.floor((m-p)/4)*2;return g(n(d)(i(p,h)))(i(h,m))}}return i(0,s.length)}}}}}}();var wr=function(e){return e.traverse};var op={traverse:function(e){var t=Q(e),a=$(e.Apply0().Functor0());return function(d){return function(g){if(g instanceof q)return t(q.value);if(g instanceof k)return a(k.create)(d(g.value0));throw new Error("Failed pattern match at Data.Traversable (line 115, column 1 - line 119, column 33): "+[d.constructor.name,g.constructor.name])}}},sequence:function(e){var t=Q(e),a=$(e.Apply0().Functor0());return function(d){if(d instanceof q)return t(q.value);if(d instanceof k)return a(k.create)(d.value0);throw new Error("Failed pattern match at Data.Traversable (line 115, column 1 - line 119, column 33): "+[d.constructor.name])}},Functor0:function(){return pt},Foldable1:function(){return Kt}};var xg=function(e){return function(t){return function(a){return function(d){return function(g){return function(n){for(var u=[],f=n;;){var s=g(f);if(e(s))return u;var i=t(s);u.push(a(i)),f=d(i)}}}}}}};var Ig=function(e){return function(t){return function(a){return function(d){return function(g){return function(n){for(var u=[],f=n;;){var s=g(f);u.push(a(s));var i=d(s);if(e(i))return u;f=t(i)}}}}}}};var cE=Dn();var up={unfoldr1:Ig(pa)(cE)(_r)(qt)};var fE=Dn(),yn=function(e){return e.unfoldr};var Ji={unfoldr:xg(pa)(fE)(_r)(qt),Unfoldable10:function(){return up}};var Rr=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var nf=function(e){var t=Br(e);return function(a){return new Rr(a,t)}};var af=function(e){var t=or(e.Plus1().Alt0()),a=Q(e.Applicative0());return function(d){return t(a(d.value0))(d.value1)}};var Qi=function(e){var t=$(e);return{map:function(a){return function(d){return new Rr(a(d.value0),t(a)(d.value1))}}}};var Ju=function(e){var t=Mt(e),a=Ct(e),d=Dt(e);return{foldMap:function(g){var n=ce(g.Semigroup0()),u=t(g);return function(f){return function(s){return n(f(s.value0))(u(f)(s.value1))}}},foldl:function(g){return function(n){return function(u){return a(g)(g(n)(u.value0))(u.value1)}}},foldr:function(g){return function(n){return function(u){return g(u.value0)(d(g)(n)(u.value1))}}}}};var lp=function(e){var t=Ct(e),a=Dt(e),d=Ju(e);return{foldMap1:function(g){var n=ce(g);return function(u){return function(f){return t(function(s){return function(i){return n(s)(u(i))}})(u(f.value0))(f.value1)}}},foldr1:function(g){return function(n){return Qe(n.value0)(g(n.value0))(a(function(u){var f=Qe(u)(g(u));return function(s){return k.create(f(s))}})(q.value)(n.value1))}},foldl1:function(g){return function(n){return t(g)(n.value0)(n.value1)}},Foldable0:function(){return d}}};var He=function(){function e(){}return e.value=new e,e}(),_e=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),_p=function(e){return e};var hE=function(e){var t=function(a){return function(d){var g=a,n=!1,u;function f(s,i){if(i instanceof _e&&i.value1 instanceof _e&&i.value1.value1 instanceof _e){g=new _e(i,s),d=i.value1.value1.value1;return}var p=function(h){return h instanceof _e&&h.value1 instanceof _e&&h.value1.value1 instanceof He?new _e(e(h.value0),new _e(e(h.value1.value0),He.value)):h instanceof _e&&h.value1 instanceof He?new _e(e(h.value0),He.value):He.value},m=function(h){return function(l){var r=h,o=!1,c;function _(D,C){if(D instanceof _e&&D.value0 instanceof _e&&D.value0.value1 instanceof _e&&D.value0.value1.value1 instanceof _e){r=D.value1,l=new _e(e(D.value0.value0),new _e(e(D.value0.value1.value0),new _e(e(D.value0.value1.value1.value0),C)));return}return o=!0,C}for(;!o;)c=_(r,l);return c}};return n=!0,m(s)(p(i))}for(;!n;)u=f(g,d);return u}};return t(He.value)},pp={map:hE};var Sn={foldr:function(e){return function(t){var a=function(){var g=function(n){return function(u){var f=n,s=!1,i;function p(m,h){if(h instanceof He)return s=!0,m;if(h instanceof _e){f=new _e(h.value0,m),u=h.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[m.constructor.name,h.constructor.name])}for(;!s;)i=p(f,u);return i}};return g(He.value)}(),d=Ct(Sn)(Ge(e))(t);return function(g){return d(a(g))}}},foldl:function(e){var t=function(a){return function(d){var g=a,n=!1,u;function f(s,i){if(i instanceof He)return n=!0,s;if(i instanceof _e){g=e(s)(i.value0),d=i.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[i.constructor.name])}for(;!n;)u=f(g,d);return u}};return t},foldMap:function(e){var t=ce(e.Semigroup0()),a=Ze(e);return function(d){return Ct(Sn)(function(g){var n=t(g);return function(u){return n(d(u))}})(a)}}};var gE=Dt(Sn);var of={append:function(e){return function(t){return gE(_e.create)(t)(e)}}},DE=ce(of);var CE={alt:DE,Functor0:function(){return pp}},Hg=function(){return{empty:He.value,Alt0:function(){return CE}}}();var jo=function(){var e=function(t){return function(a){var d=t,g=!1,n;function u(f,s){if(s instanceof He)return g=!0,f;if(s instanceof _e){d=new _e(s.value0,f),a=s.value1;return}throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[f.constructor.name,s.constructor.name])}for(;!g;)n=u(d,a);return n}};return e(He.value)}();var $g=function(e){return e instanceof He};var cf=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var Ug=function(e){var t=!1,a;function d(g){if(g.value0 instanceof He&&g.value1 instanceof He)return t=!0,q.value;if(g.value0 instanceof He){e=new cf(jo(g.value1),He.value);return}if(g.value0 instanceof _e)return t=!0,new k(new J(g.value0.value0,new cf(g.value0.value1,g.value1)));throw new Error("Failed pattern match at Data.CatQueue (line 82, column 1 - line 82, column 63): "+[g.constructor.name])}for(;!t;)a=d(e);return a},zg=function(e){return function(t){return new cf(e.value0,new _e(t,e.value1))}};var Vg=function(e){return e.value0 instanceof He&&e.value1 instanceof He};var Gg=function(){return new cf(He.value,He.value)}();var Ki=function(){function e(){}return e.value=new e,e}(),sf=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var jg=function(e){return function(t){if(e instanceof Ki)return t;if(t instanceof Ki)return e;if(e instanceof sf)return new sf(e.value0,zg(e.value1)(t));throw new Error("Failed pattern match at Data.CatList (line 108, column 1 - line 108, column 54): "+[e.constructor.name,t.constructor.name])}},EE=function(e){return function(t){return function(a){var d=function(n){return function(u){return function(f){var s=n,i=u,p=!1,m;function h(l,r,o){if(o instanceof He)return p=!0,r;if(o instanceof _e){s=l,i=l(r)(o.value0),f=o.value1;return}throw new Error("Failed pattern match at Data.CatList (line 124, column 3 - line 124, column 59): "+[l.constructor.name,r.constructor.name,o.constructor.name])}for(;!p;)m=h(s,i,f);return m}}},g=function(n){return function(u){var f=n,s=!1,i;function p(m,h){var l=Ug(m);if(l instanceof q)return s=!0,d(function(r){return function(o){return o(r)}})(t)(h);if(l instanceof k){f=l.value0.value1,u=new _e(e(l.value0.value0),h);return}throw new Error("Failed pattern match at Data.CatList (line 120, column 14 - line 122, column 67): "+[l.constructor.name])}for(;!s;)i=p(f,u);return i}};return g(a)(He.value)}}},Jg=function(e){if(e instanceof Ki)return q.value;if(e instanceof sf)return new k(new J(e.value0,function(){var t=Vg(e.value1);return t?Ki.value:EE(jg)(Ki.value)(e.value1)}()));throw new Error("Failed pattern match at Data.CatList (line 99, column 1 - line 99, column 61): "+[e.constructor.name])};var Qg=function(){return Ki.value}(),Kg=jg;var Xg={append:Kg};var Yg=function(e){return function(t){return Kg(e)(new sf(t,Gg))}};var FE=function(e,t,a){var d=0,g;return function(n){if(d===2)return g;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,g=a(),d=2,g}},LE=ce(Xg);var vp=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Qu=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Ku=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Zg=function(e){var t=!1,a;function d(g){var n=function(s){return s},u=function(s){return function(i){return new vp(s.value0,LE(s.value1)(i))}};if(g.value0 instanceof Qu){var f=Jg(g.value1);if(f instanceof q)return t=!0,new Qu(g.value0.value0);if(f instanceof k){e=u(n(f.value0.value0)(g.value0.value0))(f.value0.value1);return}throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): "+[f.constructor.name])}if(g.value0 instanceof Ku)return t=!0,new Ku(g.value0.value0,function(s){return u(g.value0.value1(s))(g.value1)});throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): "+[g.value0.constructor.name])}for(;!t;)a=d(e);return a},ja=function(e){var t=$(e);return function(a){var d=a.Monad0(),g=$(d.Bind1().Apply0().Functor0()),n=Q(d.Applicative0()),u=Sr(a);return function(f){var s=function(i){var p=Zg(i);if(p instanceof Qu)return g(Pt.create)(n(p.value0));if(p instanceof Ku)return g(Gt.create)(f(t(p.value1)(p.value0)));throw new Error("Failed pattern match at Control.Monad.Free (line 194, column 10 - line 196, column 37): "+[p.constructor.name])};return u(s)}}};var eD=function(e){return new vp(e,Qg)};var Xu={Applicative0:function(){return nn},Bind1:function(){return $r}},Ja={map:function(e){return function(t){return $t($r)(function(){var a=Q(nn);return function(d){return a(e(d))}}())(t)}}},$r={bind:function(e){return function(t){return new vp(e.value0,Yg(e.value1)(t))}},Apply0:function(){return tD(0)}},nn={pure:function(e){return eD(Qu.create(e))},Apply0:function(){return tD(0)}},tD=FE("freeApply","Control.Monad.Free",function(){return{apply:Lr(Xu),Functor0:function(){return Ja}}});var AE=Q(nn);var it=function(e){return eD(new Ku(e,function(t){return AE(t)}))};var rD=function(e){var t=e.Monad0(),a=$(t.Bind1().Apply0().Functor0()),d=Q(t.Applicative0()),g=Sr(e);return function(n){var u=function(f){var s=Zg(f);if(s instanceof Qu)return a(Pt.create)(d(s.value0));if(s instanceof Ku)return a(function(i){return Gt.create(s.value1(i))})(n(s.value0));throw new Error("Failed pattern match at Control.Monad.Free (line 158, column 10 - line 160, column 37): "+[s.constructor.name])};return g(u)}};var xE=function(e){return function(t){if(e<1)return[];var a=new Array(e);return a.fill(t)}},IE=function(e){return function(t){for(var a=[],d=0,g=0;g<e;g++)a[d++]=t;return a}},nD=typeof Array.prototype.fill=="function"?xE:IE,aD=function(){function e(g,n){this.head=g,this.tail=n}var t={};function a(g){return function(n){return new e(g,n)}}function d(g){for(var n=[],u=0,f=g;f!==t;)n[u++]=f.head,f=f.tail;return n}return function(g){return function(n){return d(g(a)(t)(n))}}}(),_n=function(e){return e.length},oD=function(e){return function(t){return function(a){return a.length===0?e({}):t(a[0])(a.slice(1))}}},iD=function(e){return function(t){return function(a){return function(d){return d<0||d>=a.length?t:e(a[d])}}}};var uD=function(e){return function(t){return function(a){return function(d){for(var g=0,n=d.length;g<n;g++)if(a(d[g]))return e(g);return t}}}};var cD=function(e){return function(t){return function(a){return function(d){if(a<0||a>=d.length)return t;var g=d.slice();return g.splice(a,1),e(g)}}}};var Yu=function(e){return function(t){return t.filter(e)}};var sD=function(){function e(t,a,d,g,n,u){var f,s,i,p,m,h,l;for(f=n+(u-n>>1),f-n>1&&e(t,a,g,d,n,f),u-f>1&&e(t,a,g,d,f,u),s=n,i=f,p=n;s<f&&i<u;)m=g[s],h=g[i],l=a(t(m)(h)),l>0?(d[p++]=h,++i):(d[p++]=m,++s);for(;s<f;)d[p++]=g[s++];for(;i<u;)d[p++]=g[i++]}return function(t){return function(a){return function(d){var g;return d.length<2?d:(g=d.slice(0),e(t,a,g,d.slice(0),0,d.length),g)}}}}(),ff=function(e){return function(t){return function(a){return a.slice(e,t)}}};var fD=function(e){return function(t){return function(){return e(t())}}};var lf=function(e){return function(t){return function(){for(var a=0,d=e.length;a<d;a++)t(e[a])()}}};var _f={map:fD};var NE=function(){function e(t,a,d,g,n,u){var f,s,i,p,m,h,l;for(f=n+(u-n>>1),f-n>1&&e(t,a,g,d,n,f),u-f>1&&e(t,a,g,d,f,u),s=n,i=f,p=n;s<f&&i<u;)m=g[s],h=g[i],l=a(t(m)(h)),l>0?(d[p++]=h,++i):(d[p++]=m,++s);for(;s<f;)d[p++]=g[s++];for(;i<u;)d[p++]=g[i++]}return function(t){return function(a){return function(d){return function(){return d.length<2||e(t,a,d,d.slice(0),0,d.length),d}}}}}();var tM=Dn();var rM=ce(wt);var mp=function(){return oD(Te(q.value))(function(e){return function(t){return new k({head:e,tail:t})}})}();var CD=function(e){return sD(e)(function(t){if(t instanceof te)return 1;if(t instanceof ye)return 0;if(t instanceof X)return-1;throw new Error("Failed pattern match at Data.Array (line 870, column 31 - line 873, column 11): "+[t.constructor.name])})};var hp=function(e){var t=he(e);return function(a){return CD(t)(a)}};var ec=function(e){return[e]},yD=function(e){return _n(e)===0};var bD=function(){return iD(k.create)(q.value)}();var gp=function(e){return bD(e)(0)};var Dp=function(e){return aD(Dt(e))};var SD=function(){return uD(k.create)(q.value)}();var tc=function(e){return function(t){var a=e<1;return a?t:ff(e)(_n(t))(t)}};var TD=function(){return cD(k.create)(q.value)}(),Cp=function(e){return function(t){return function(a){return a.length===0?[]:Qe(a)(function(d){return tM(TD(d)(a))})(SD(e(t))(a))}}};var Er=function(e){return function(t){return rM([e])(t)}};var wD=Ge(se(ko)),ga=function(e){return wD(function(){var t=Qe([])(ec);return function(a){return t(e(a))}}())};var Tn=function(e){return e.state},rc=function(e){var t=Tn(e);return function(a){return t(function(d){return new J(void 0,a)})}},Qa=function(e){var t=Tn(e);return function(a){return t(function(d){return new J(void 0,a(d))})}},Xi=function(e){var t=Tn(e);return function(a){return t(function(d){var g=a(d);return new J(g,g)})}};var Jo=function(e){return Tn(e)(function(t){return new J(t,t)})};var aM={dimap:function(e){return function(t){return function(a){return function(d){return a(e(d))}}}}},Da={first:function(e){return function(t){return e(_r(t))}},second:function(e){return function(t){return e(qt(t))}},Profunctor0:function(){return aM}};var pf={dimap:function(e){return function(t){return function(a){return function(d){return t(a(e(d)))}}}}},Qo=function(e){return e.dimap};var pn={first:function(e){return function(t){return new J(e(t.value0),t.value1)}},second:$(ma),Profunctor0:function(){return pf}},Ko=function(e){return e.second},Yi=function(e){return e.first};var vM=jt(),mM=pe(de);var hM=function(e){return vM(e(mM))},qr=function(e){return function(t){return hM(t)(e)}};var wp=function(e){return function(t){var a=Qo(t.Profunctor0()),d=Yi(t);return function(g){return a(e)(function(n){return n.value1(n.value0)})(d(g))}}};var mf=function(e){return e},Xo=function(e){return function(t){return mf(e)(Te(t))}};var Ep=function(e){return function(t){return t.split(e)}};var jn=function(e){return e.trim()},Xa=function(e){return function(t){return t.join(e)}};var hf=function(e){return e===""};var pr=function(){var e={},t="Pure",a="Throw",d="Catch",g="Sync",n="Async",u="Bind",f="Bracket",s="Fork",i="Sequential",p="Map",m="Apply",h="Alt",l="Cons",r="Resume",o="Release",c="Finalizer",_="Finalized",D="Forked",C="Fiber",b="Thunk";function S(z,fe,F,N){this.tag=z,this._1=fe,this._2=F,this._3=N}function v(z){var fe=function(F,N,B){return new S(z,F,N,B)};return fe.tag=z,fe}function y(z){return new S(t,void 0)}function M(z){try{z()}catch(fe){setTimeout(function(){throw fe},0)}}function T(z,fe,F){try{return fe(F())}catch(N){return z(N)}}function w(z,fe,F){try{return fe(F)()}catch(N){return F(z(N))(),y}}var A=function(){var z=1024,fe=0,F=0,N=new Array(z),B=!1;function H(){var le;for(B=!0;fe!==0;)fe--,le=N[F],N[F]=void 0,F=(F+1)%z,le();B=!1}return{isDraining:function(){return B},enqueue:function(le){var j,Le;fe===z&&(Le=B,H(),B=Le),N[(F+fe)%z]=le,fe++,B||H()}}}();function I(z){var fe={},F=0,N=0;return{register:function(B){var H=F++;B.onComplete({rethrow:!0,handler:function(le){return function(){N--,delete fe[H]}}})(),fe[H]=B,N++},isEmpty:function(){return N===0},killAll:function(B,H){return function(){if(N===0)return H();var le=0,j={};function Le(Be){j[Be]=fe[Be].kill(B,function(Re){return function(){delete j[Be],le--,z.isLeft(Re)&&z.fromLeft(Re)&&setTimeout(function(){throw z.fromLeft(Re)},0),le===0&&H()}})()}for(var rt in fe)fe.hasOwnProperty(rt)&&(le++,Le(rt));return fe={},F=0,N=0,function(Be){return new S(g,function(){for(var Re in j)j.hasOwnProperty(Re)&&j[Re]()})}}}}}var R=0,P=1,W=2,E=3,L=4,x=5,O=6;function U(z,fe,F){var N=0,B=R,H=F,le=null,j=null,Le=null,rt=null,Be=null,Re=0,qe=0,Ot=null,sr=!0;function dr(re){for(var K,me,$e;;)switch(K=null,me=null,$e=null,B){case W:B=P;try{H=Le(H),rt===null?Le=null:(Le=rt._1,rt=rt._2)}catch(St){B=x,le=z.left(St),H=null}break;case E:z.isLeft(H)?(B=x,le=H,H=null):Le===null?B=x:(B=W,H=z.fromRight(H));break;case P:switch(H.tag){case u:Le&&(rt=new S(l,Le,rt)),Le=H._2,B=P,H=H._1;break;case t:Le===null?(B=x,H=z.right(H._1)):(B=W,H=H._1);break;case g:B=E,H=T(z.left,z.right,H._1);break;case n:B=L,H=w(z.left,H._1,function(St){return function(){N===re&&(N++,A.enqueue(function(){N===re+1&&(B=E,H=St,dr(N))}))}});return;case a:B=x,le=z.left(H._1),H=null;break;case d:Le===null?Be=new S(l,H,Be,j):Be=new S(l,H,new S(l,new S(r,Le,rt),Be,j),j),Le=null,rt=null,B=P,H=H._1;break;case f:Re++,Le===null?Be=new S(l,H,Be,j):Be=new S(l,H,new S(l,new S(r,Le,rt),Be,j),j),Le=null,rt=null,B=P,H=H._1;break;case s:B=E,K=U(z,fe,H._2),fe&&fe.register(K),H._1&&K.run(),H=z.right(K);break;case i:B=P,H=ae(z,fe,H._1);break}break;case x:if(Le=null,rt=null,Be===null)B=O,H=j||le||H;else switch(K=Be._3,$e=Be._1,Be=Be._2,$e.tag){case d:j&&j!==K&&Re===0?B=x:le&&(B=P,H=$e._2(z.fromLeft(le)),le=null);break;case r:j&&j!==K&&Re===0||le?B=x:(Le=$e._1,rt=$e._2,B=W,H=z.fromRight(H));break;case f:Re--,le===null&&(me=z.fromRight(H),Be=new S(l,new S(o,$e._2,me),Be,K),(j===K||Re>0)&&(B=P,H=$e._3(me)));break;case o:Be=new S(l,new S(_,H,le),Be,j),B=P,j&&j!==K&&Re===0?H=$e._1.killed(z.fromLeft(j))($e._2):le?H=$e._1.failed(z.fromLeft(le))($e._2):H=$e._1.completed(z.fromRight(H))($e._2),le=null,Re++;break;case c:Re++,Be=new S(l,new S(_,H,le),Be,j),B=P,H=$e._1;break;case _:Re--,B=x,H=$e._1,le=$e._2;break}break;case O:for(var ze in Ot)Ot.hasOwnProperty(ze)&&(sr=sr&&Ot[ze].rethrow,M(Ot[ze].handler(H)));Ot=null,j&&le?setTimeout(function(){throw z.fromLeft(le)},0):z.isLeft(H)&&sr&&setTimeout(function(){if(sr)throw z.fromLeft(H)},0);return;case R:B=P;break;case L:return}}function dt(re){return function(){if(B===O)return sr=sr&&re.rethrow,re.handler(H)(),function(){};var K=qe++;return Ot=Ot||{},Ot[K]=re,function(){Ot!==null&&delete Ot[K]}}}function ue(re,K){return function(){if(B===O)return K(z.right(void 0))(),function(){};var me=dt({rethrow:!1,handler:function(){return K(z.right(void 0))}})();switch(B){case R:j=z.left(re),B=O,H=j,dr(N);break;case L:j===null&&(j=z.left(re)),Re===0&&(B===L&&(Be=new S(l,new S(c,H(re)),Be,j)),B=x,H=null,le=null,dr(++N));break;default:j===null&&(j=z.left(re)),Re===0&&(B=x,H=null,le=null)}return me}}function ie(re){return function(){var K=dt({rethrow:!1,handler:re})();return B===R&&dr(N),K}}return{kill:ue,join:ie,onComplete:dt,isSuspended:function(){return B===R},run:function(){B===R&&(A.isDraining()?dr(N):A.enqueue(function(){dr(N)}))}}}function Y(z,fe,F,N){var B=0,H={},le=0,j={},Le=new Error("[ParAff] Early exit"),rt=null,Be=e;function Re(dt,ue,ie){var re=ue,K=null,me=null,$e=0,ze={},St,er;e:for(;;)switch(St=null,re.tag){case D:if(re._3===e&&(St=H[re._1],ze[$e++]=St.kill(dt,function(rr){return function(){$e--,$e===0&&ie(rr)()}})),K===null)break e;re=K._2,me===null?K=null:(K=me._1,me=me._2);break;case p:re=re._2;break;case m:case h:K&&(me=new S(l,K,me)),K=re,re=re._1;break}if($e===0)ie(z.right(void 0))();else for(er=0,St=$e;er<St;er++)ze[er]=ze[er]();return ze}function qe(dt,ue,ie){var re,K,me,$e,ze,St;z.isLeft(dt)?(re=dt,K=null):(K=dt,re=null);e:for(;;){if(me=null,$e=null,ze=null,St=null,rt!==null)return;if(ue===null){N(re||K)();return}if(ue._3!==e)return;switch(ue.tag){case p:re===null?(ue._3=z.right(ue._1(z.fromRight(K))),K=ue._3):ue._3=re;break;case m:if(me=ue._1._3,$e=ue._2._3,re){if(ue._3=re,ze=!0,St=le++,j[St]=Re(Le,re===me?ue._2:ue._1,function(){return function(){delete j[St],ze?ze=!1:ie===null?qe(re,null,null):qe(re,ie._1,ie._2)}}),ze){ze=!1;return}}else{if(me===e||$e===e)return;K=z.right(z.fromRight(me)(z.fromRight($e))),ue._3=K}break;case h:if(me=ue._1._3,$e=ue._2._3,me===e&&z.isLeft($e)||$e===e&&z.isLeft(me))return;if(me!==e&&z.isLeft(me)&&$e!==e&&z.isLeft($e))re=K===me?$e:me,K=null,ue._3=re;else if(ue._3=K,ze=!0,St=le++,j[St]=Re(Le,K===me?ue._2:ue._1,function(){return function(){delete j[St],ze?ze=!1:ie===null?qe(K,null,null):qe(K,ie._1,ie._2)}}),ze){ze=!1;return}break}ie===null?ue=null:(ue=ie._1,ie=ie._2)}}function Ot(dt){return function(ue){return function(){delete H[dt._1],dt._3=ue,qe(ue,dt._2._1,dt._2._2)}}}function sr(){var dt=P,ue=F,ie=null,re=null,K,me;e:for(;;)switch(K=null,me=null,dt){case P:switch(ue.tag){case p:ie&&(re=new S(l,ie,re)),ie=new S(p,ue._1,e,e),ue=ue._2;break;case m:ie&&(re=new S(l,ie,re)),ie=new S(m,e,ue._2,e),ue=ue._1;break;case h:ie&&(re=new S(l,ie,re)),ie=new S(h,e,ue._2,e),ue=ue._1;break;default:me=B++,dt=x,K=ue,ue=new S(D,me,new S(l,ie,re),e),K=U(z,fe,K),K.onComplete({rethrow:!1,handler:Ot(ue)})(),H[me]=K,fe&&fe.register(K)}break;case x:if(ie===null)break e;ie._1===e?(ie._1=ue,dt=P,ue=ie._2,ie._2=e):(ie._2=ue,ue=ie,re===null?ie=null:(ie=re._1,re=re._2))}for(Be=ue,me=0;me<B;me++)H[me].run()}function dr(dt,ue){rt=z.left(dt);var ie;for(var re in j)if(j.hasOwnProperty(re)){ie=j[re];for(re in ie)ie.hasOwnProperty(re)&&ie[re]()}j=null;var K=Re(dt,Be,ue);return function(me){return new S(n,function($e){return function(){for(var ze in K)K.hasOwnProperty(ze)&&K[ze]();return y}})}}return sr(),function(dt){return new S(n,function(ue){return function(){return dr(dt,ue)}})}}function ae(z,fe,F){return new S(n,function(N){return function(){return Y(z,fe,F,N)}})}return S.EMPTY=e,S.Pure=v(t),S.Throw=v(a),S.Catch=v(d),S.Sync=v(g),S.Async=v(n),S.Bind=v(u),S.Bracket=v(f),S.Fork=v(s),S.Seq=v(i),S.ParMap=v(p),S.ParApply=v(m),S.ParAlt=v(h),S.Fiber=U,S.Supervisor=I,S.Scheduler=A,S.nonCanceler=y,S}(),HD=pr.Pure,ND=pr.Throw;function kD(e){return function(t){return pr.Catch(e,t)}}function WD(e){return function(t){return t.tag===pr.Pure.tag?pr.Pure(e(t._1)):pr.Bind(t,function(a){return pr.Pure(e(a))})}}function BD(e){return function(t){return pr.Bind(e,t)}}function Mp(e){return function(t){return pr.Fork(e,t)}}var $D=pr.Sync;function qD(e){return function(t){return pr.ParMap(e,t)}}function UD(e){return function(t){return pr.ParApply(e,t)}}var Ca=pr.Async;function gf(e){return function(t){return function(a){return pr.Bracket(e,t,a)}}}function zD(e,t){return function(){return pr.Fiber(e,null,t)}}var bM=function(){function e(a,d){return a===0&&typeof setImmediate<"u"?setImmediate(d):setTimeout(d,a)}function t(a,d){return a===0&&typeof clearImmediate<"u"?clearImmediate(d):clearTimeout(d)}return function(a,d){return pr.Async(function(g){return function(){var n=e(d,g(a()));return function(){return pr.Sync(function(){return a(t(d,n))})}}})}}(),VD=pr.Seq;function wn(e){return new Error(e)}function ya(e){return function(){throw e}}function Df(e){return function(t){return function(){try{return t()}catch(a){return a instanceof Error||Object.prototype.toString.call(a)==="[object Error]"?e(a)():e(new Error(a.toString()))()}}}}var GD=function(e){return ya(wn(e))};var Ur=function(e){return e.throwError};var EM={throwError:ya,Monad0:function(){return Bn}};var jD={catchError:Ge(Df),MonadThrow0:function(){return EM}};var Qn=function(e){return e.catchError};var ac=function(e){var t=Qn(e),a=e.MonadThrow0().Monad0(),d=$(a.Bind1().Apply0().Functor0()),g=Q(a.Applicative0());return function(n){return t(d(Je.create)(n))(function(u){return g(Ye.create(u))})}};var an=function(e){return e.ask};var mt=function(e){return e.lift};var Cf={liftEffect:pe(de),Monad0:function(){return Bn}},Ke=function(e){return e.liftEffect};var Sa=function(e){return e.tell};var AM=$(pt);var Fp=function(e){return e},QD=function(e){return e};var yf={lift:function(e){var t=gh(e)(k.create);return function(a){return Fp(t(a))}}},xM=mt(yf);var IM=function(e){var t=$(e);return{map:function(a){return function(d){return t(AM(a))(d)}}}},bf=function(e){return{Applicative0:function(){return Ap(e)},Bind1:function(){return Lp(e)}}},Lp=function(e){var t=se(e.Bind1()),a=Q(e.Applicative0());return{bind:function(d){return function(g){return t(d)(function(n){if(n instanceof q)return a(q.value);if(n instanceof k){var u=g(n.value0);return u}throw new Error("Failed pattern match at Control.Monad.Maybe.Trans (line 54, column 11 - line 56, column 42): "+[n.constructor.name])})}},Apply0:function(){return KD(e)}}},KD=function(e){var t=IM(e.Bind1().Apply0().Functor0());return{apply:Lr(bf(e)),Functor0:function(){return t}}},Ap=function(e){return{pure:function(){var t=Q(e.Applicative0());return function(a){return Fp(t(k.create(a)))}}(),Apply0:function(){return KD(e)}}};var XD=function(e){var t=Sr(e),a=e.Monad0(),d=se(a.Bind1()),g=Q(a.Applicative0()),n=bf(a);return{tailRecM:function(u){var f=t(function(s){var i=u(s);return d(i)(function(p){return g(function(){if(p instanceof q)return new Pt(q.value);if(p instanceof k&&p.value0 instanceof Gt)return new Gt(p.value0.value0);if(p instanceof k&&p.value0 instanceof Pt)return new Pt(new k(p.value0.value0));throw new Error("Failed pattern match at Control.Monad.Maybe.Trans (line 82, column 16 - line 85, column 43): "+[p.constructor.name])}())})});return function(s){return Fp(f(s))}},Monad0:function(){return n}}},YD=function(e){var t=e.Monad0(),a=xM(t),d=Tn(e),g=bf(t);return{state:function(n){return a(d(n))},Monad0:function(){return g}}};var ZD=function(e){return e};var Ya=function(e){return e};var Sf={lift:function(e){return function(t){return ZD(Te(t))}}},RM=mt(Sf),e0=function(e){return function(t){return function(a){return e(t(a))}}},OM=function(e){return{map:function(){var t=$(e);return function(a){return e0(t(a))}}()}};var t0=function(e){var t=Xe(e),a=OM(e.Functor0());return{apply:function(d){return function(g){return function(n){return t(d(n))(g(n))}}},Functor0:function(){return a}}},Yo=function(e){var t=se(e),a=t0(e.Apply0());return{bind:function(d){return function(g){return function(n){return t(d(n))(function(u){var f=g(u);return f(n)})}}},Apply0:function(){return a}}};var Tf=function(e){var t=t0(e.Apply0());return{pure:function(){var a=Q(e);return function(d){return ZD(Te(a(d)))}}(),Apply0:function(){return t}}},fc=function(e){var t=Tf(e.Applicative0()),a=Yo(e.Bind1());return{Applicative0:function(){return t},Bind1:function(){return a}}},tu=function(e){var t=fc(e);return{ask:Q(e.Applicative0()),Monad0:function(){return t}}};var Za=function(e){var t=e.Monad0(),a=fc(t);return{liftEffect:function(){var d=RM(t),g=Ke(e);return function(n){return d(g(n))}}(),Monad0:function(){return a}}},ru=function(e){var t=e.Monad0(),a=$t(t.Bind1()),d=Q(t.Applicative0()),g=Sr(e),n=fc(t);return{tailRecM:function(u){return function(f){var s=function(i){return function(p){var m=u(p);return a(d)(m(i))}};return function(i){return g(s(i))(f)}}},Monad0:function(){return n}}};var Ip=function(e){return e},Rp=function(e){return e};var wf=function(e){return function(t){return e(t)}},Op=function(e){var t=$(e);return{map:function(a){return wf(t(function(d){return new J(a(d.value0),d.value1)}))}}};var Ef=function(e){var t=ce(e);return function(a){var d=Xe(a),g=a.Functor0(),n=$(g),u=Op(g);return{apply:function(f){return function(s){var i=function(p){return function(m){return new J(p.value0(m.value0),t(p.value1)(m.value1))}};return d(n(i)(f))(s)}},Functor0:function(){return u}}}},Pp=function(e){var t=ce(e),a=Ef(e);return function(d){var g=se(d),n=d.Apply0(),u=$(n.Functor0()),f=a(n);return{bind:function(s){return function(i){return g(s)(function(p){var m=i(p.value0);return u(function(h){return new J(h.value0,t(p.value1)(h.value1))})(m)})}},Apply0:function(){return f}}}};var Hp=function(e){var t=Ze(e),a=Ef(e.Semigroup0());return function(d){var g=Q(d),n=a(d.Apply0());return{pure:function(u){return g(new J(u,t))},Apply0:function(){return n}}}},r0=function(e){var t=Hp(e),a=Pp(e.Semigroup0());return function(d){var g=t(d.Applicative0()),n=a(d.Bind1());return{Applicative0:function(){return g},Bind1:function(){return n}}}};var n0=function(e){var t=e.Semigroup0(),a=r0(e);return function(d){var g=a(d);return{tell:function(){var n=Q(d.Applicative0()),u=J.create(void 0);return function(f){return Ip(n(u(f)))}}(),Semigroup0:function(){return t},Monad1:function(){return g}}}};var nu=function(e){return e.sequential},eo=function(e){return e.parallel};var WM=pe(de),BM=function(e){var t=nu(e),a=Et(e.Applicative1()),d=eo(e);return function(g){var n=a(g);return function(u){var f=n(function(s){return d(u(s))});return function(s){return t(f(s))}}}};var lc=function(e){var t=BM(e);return function(a){return t(a)(WM)}};var _c=function(e){return e()};var i0=function(e){return e()};var u0=function(e){throw new Error(e)};var c0=function(){return u0};var VM=c0(),GM=i0,to=function(e){return GM(function(){return VM(e)})};var s0=function(e,t,a){var d=0,g;return function(n){if(d===2)return g;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,g=a(),d=2,g}},jM=Q(xt),$p=gt(Oe),f0=$(Oe);var JM=function(e){return e},l0=Mp(!1);var QM={map:qD},ro={map:WD},KM=$(ro),_0=Mp(!0),XM=function(){var e=function(d){if(d instanceof Je)return d.value0;if(d instanceof Ye)return to("unsafeFromRight: Left");throw new Error("Failed pattern match at Effect.Aff (line 412, column 21 - line 414, column 54): "+[d.constructor.name])},t=function(d){if(d instanceof Ye)return d.value0;if(d instanceof Je)return to("unsafeFromLeft: Right");throw new Error("Failed pattern match at Effect.Aff (line 407, column 20 - line 409, column 55): "+[d.constructor.name])},a=function(d){if(d instanceof Ye)return!0;if(d instanceof Je)return!1;throw new Error("Failed pattern match at Effect.Aff (line 402, column 12 - line 404, column 21): "+[d.constructor.name])};return{isLeft:a,fromLeft:t,fromRight:e,left:Ye.create,right:Je.create}}(),p0=function(e){return zD(XM,e)},d0=function(e){return function(){var a=p0(e)();return a.run(),a}},qp=function(e){return $p(d0(e))};var YM=function(e){return function(t){return gf(e)({killed:Te(t),failed:Te(t),completed:Te(t)})}},ZM={apply:UD,Functor0:function(){return QM}};var ei={Applicative0:function(){return Kn},Bind1:function(){return Mr}},Mr={bind:BD,Apply0:function(){return v0(0)}},Kn={pure:HD,Apply0:function(){return v0(0)}},v0=s0("applyAff","Effect.Aff",function(){return{apply:Lr(ei),Functor0:function(){return ro}}});var Lf=Q(Kn),m0=se(Mr);var eF=$t(Mr);var h0=function(e){return function(t){return YM(Lf(void 0))(Te(e))(Te(t))}};var Fr={liftEffect:$D,Monad0:function(){return ei}},Ff=Ke(Fr),ti=function(e){return JM(Te(Ff(e)))},pc=function(e){return Ca(function(t){return f0(ti)(e.join(t))})},g0={map:function(e){return function(t){return _c(p0(KM(e)(pc(t))))}}};var dc=function(e){return function(t){return m0(Ff(t.isSuspended))(function(a){return a?Ff($p(t.kill(e,Te(jM(void 0))))):Ca(function(d){return f0(ti)(t.kill(e,d))})})}};var Af={throwError:ND,Monad0:function(){return ei}},D0={catchError:kD,MonadThrow0:function(){return Af}},tF=ac(D0);var rF=function(e){return function(t){return d0(eF(function(a){return Ff(e(a))})(tF(t)))}},xf=function(e){return function(t){return $p(rF(e)(t))}};var ri={parallel:V,sequential:VD,Monad0:function(){return ei},Applicative1:function(){return C0(0)}},C0=s0("applicativeParAff","Effect.Aff",function(){return{pure:function(){var e=eo(ri);return function(t){return e(Lf(t))}}(),Apply0:function(){return ZM}}}),Up=C0(136);var au={tailRecM:function(e){var t=function(a){return m0(e(a))(function(d){if(d instanceof Pt)return Lf(d.value0);if(d instanceof Gt)return t(d.value0);throw new Error("Failed pattern match at Effect.Aff (line 104, column 7 - line 106, column 23): "+[d.constructor.name])})};return t},Monad0:function(){return ei}};var y0=Te(Lf(void 0));var no=function(){function e(){this.head=null,this.last=null,this.size=0}function t(p,m){this.queue=p,this.value=m,this.next=null,this.prev=null}function a(p){this.draining=!1,this.error=null,this.value=p,this.takes=new e,this.reads=new e,this.puts=new e}var d={};function g(p){try{p()}catch(m){setTimeout(function(){throw m},0)}}function n(p,m){var h=new t(p,m);switch(p.size){case 0:p.head=h;break;case 1:h.prev=p.head,p.head.next=h,p.last=h;break;default:h.prev=p.last,p.last.next=h,p.last=h}return p.size++,h}function u(p){var m;switch(p.size){case 0:return null;case 1:m=p.head,p.head=null;break;case 2:m=p.last,p.head.next=null,p.last=null;break;default:m=p.last,p.last=m.prev,p.last.next=null}return m.prev=null,m.queue=null,p.size--,m.value}function f(p){var m;switch(p.size){case 0:return null;case 1:m=p.head,p.head=null;break;case 2:m=p.head,p.last.prev=null,p.head=p.last,p.last=null;break;default:m=p.head,p.head=m.next,p.head.prev=null}return m.next=null,m.queue=null,p.size--,m.value}function s(p){if(p.queue!==null){if(p.queue.last===p){u(p.queue);return}if(p.queue.head===p){f(p.queue);return}p.prev&&(p.prev.next=p.next),p.next&&(p.next.prev=p.prev),p.queue.size--,p.queue=null,p.value=null,p.next=null,p.prev=null}}function i(p,m){if(!m.draining){var h=m.puts,l=m.takes,r=m.reads,o,c,_,D,C;for(m.draining=!0;;){if(o=null,c=null,_=null,D=m.value,C=r.size,m.error!==null){for(D=p.left(m.error);o=f(h);)g(o.cb(D));for(;c=f(r);)g(c(D));for(;_=f(l);)g(_(D));break}if(D===d&&(o=f(h))&&(m.value=D=o.value),D!==d){for(_=f(l);C--&&(c=f(r));)g(c(p.right(D)));_!==null&&(m.value=d,g(_(p.right(D))))}if(o!==null&&g(o.cb(p.right(void 0))),m.value===d&&h.size===0||m.value!==d&&l.size===0)break}m.draining=!1}}return a.EMPTY=d,a.putLast=n,a.takeLast=u,a.takeHead=f,a.deleteCell=s,a.drainVar=i,a}();function zp(){return new no(no.EMPTY)}function b0(e,t,a,d){return function(){var g=no.putLast(a.puts,{cb:d,value:t});return no.drainVar(e,a),function(){no.deleteCell(g)}}}function S0(e,t,a){return function(){var d=no.putLast(t.takes,a);return no.drainVar(e,t),function(){no.deleteCell(d)}}}var T0=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),w0=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),E0=function(){function e(){}return e.value=new e,e}();var M0=function(){return{left:Ye.create,right:Je.create,nothing:q.value,just:k.create,killed:T0.create,filled:w0.create,empty:E0.value}}();var F0=function(e){return function(t){return function(a){return b0(M0,e,t,a)}}};var L0=function(e){return function(t){return S0(M0,e,t)}};var oF=Ke(Fr);var Vp=function(e){return Ca(function(t){return function(){var d=L0(e)(t)();return ti(d)}})};var vc=function(e){return function(t){return Ca(function(a){return function(){var g=F0(e)(t)(a)();return ti(g)}})}};var mc=oF(zp);var lF=mt(Sf);var gc={liftAff:pe(de),MonadEffect0:function(){return Fr}},Yn=function(e){return e.liftAff};var I0=function(e){var t=e.MonadEffect0(),a=Za(t);return{liftAff:function(){var d=lF(t.Monad0()),g=Yn(e);return function(n){return d(g(n))}}(),MonadEffect0:function(){return a}}};var Zn=V,Jp=V;var _F=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var P0=function(e){return function(t){return Zn(function(a){return e(a.value0)(a.value1)})(t)}};var H0=function(e){return function(t){return Jp(new _F(e,t))}},Qp={map:function(e){return function(t){return Zn(function(a){return H0(function(d){return e(a.value0(d))})(a.value1)})(t)}}};var N0=H0(pe(de));var Me=function(){function e(){}return e.value=new e,e}(),We=function(){function e(t,a,d,g){this.value0=t,this.value1=a,this.value2=d,this.value3=g}return e.create=function(t){return function(a){return function(d){return function(g){return new e(t,a,d,g)}}}},e}(),at=function(){function e(t,a,d,g,n,u,f){this.value0=t,this.value1=a,this.value2=d,this.value3=g,this.value4=n,this.value5=u,this.value6=f}return e.create=function(t){return function(a){return function(d){return function(g){return function(n){return function(u){return function(f){return new e(t,a,d,g,n,u,f)}}}}}}},e}(),ao=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),Ta=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),oo=function(){function e(t,a,d,g,n,u){this.value0=t,this.value1=a,this.value2=d,this.value3=g,this.value4=n,this.value5=u}return e.create=function(t){return function(a){return function(d){return function(g){return function(n){return function(u){return new e(t,a,d,g,n,u)}}}}}},e}(),ea=function(){function e(t,a,d,g,n,u){this.value0=t,this.value1=a,this.value2=d,this.value3=g,this.value4=n,this.value5=u}return e.create=function(t){return function(a){return function(d){return function(g){return function(n){return function(u){return new e(t,a,d,g,n,u)}}}}}},e}(),io=function(){function e(t,a,d,g,n,u){this.value0=t,this.value1=a,this.value2=d,this.value3=g,this.value4=n,this.value5=u}return e.create=function(t){return function(a){return function(d){return function(g){return function(n){return function(u){return new e(t,a,d,g,n,u)}}}}}},e}(),If=function(){function e(t,a,d,g){this.value0=t,this.value1=a,this.value2=d,this.value3=g}return e.create=function(t){return function(a){return function(d){return function(g){return new e(t,a,d,g)}}}},e}();var Rf=function(e){return function(t){return new We(Me.value,e,t,Me.value)}},B0=function(e){var t=yn(e);return function(a){var d=function(g){var n=!1,u;function f(s){if(s instanceof He)return n=!0,q.value;if(s instanceof _e){if(s.value0 instanceof Me){g=s.value1;return}if(s.value0 instanceof We&&s.value0.value0 instanceof Me&&s.value0.value3 instanceof Me)return n=!0,new k(new J(new J(s.value0.value1,s.value0.value2),s.value1));if(s.value0 instanceof We&&s.value0.value0 instanceof Me)return n=!0,new k(new J(new J(s.value0.value1,s.value0.value2),new _e(s.value0.value3,s.value1)));if(s.value0 instanceof We){g=new _e(s.value0.value0,new _e(Rf(s.value0.value1)(s.value0.value2),new _e(s.value0.value3,s.value1)));return}if(s.value0 instanceof at){g=new _e(s.value0.value0,new _e(Rf(s.value0.value1)(s.value0.value2),new _e(s.value0.value3,new _e(Rf(s.value0.value4)(s.value0.value5),new _e(s.value0.value6,s.value1)))));return}throw new Error("Failed pattern match at Data.Map.Internal (line 624, column 18 - line 633, column 71): "+[s.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 623, column 3 - line 623, column 19): "+[s.constructor.name])}for(;!n;)u=f(g);return u};return t(d)(new _e(a,He.value))}};var ni=function(e){var t=he(e);return function(a){var d=function(g){var n=!1,u;function f(s){if(s instanceof Me)return n=!0,q.value;if(s instanceof We){var i=t(a)(s.value1);if(i instanceof ye)return n=!0,new k(s.value2);if(i instanceof X){g=s.value0;return}g=s.value3;return}if(s instanceof at){var p=t(a)(s.value1);if(p instanceof ye)return n=!0,new k(s.value2);var m=t(a)(s.value4);if(m instanceof ye)return n=!0,new k(s.value5);if(p instanceof X){g=s.value0;return}if(m instanceof te){g=s.value6;return}g=s.value3;return}throw new Error("Failed pattern match at Data.Map.Internal (line 241, column 5 - line 241, column 22): "+[s.constructor.name])}for(;!n;)u=f(g);return u};return d}};var $0=function(e){return function(t){return function(a){var d=e,g=t,n=!1,u;function f(s,i,p){if(i instanceof He)return n=!0,p;if(i instanceof _e){if(i.value0 instanceof ao){d=s,g=i.value1,a=new We(p,i.value0.value0,i.value0.value1,i.value0.value2);return}if(i.value0 instanceof Ta){d=s,g=i.value1,a=new We(i.value0.value0,i.value0.value1,i.value0.value2,p);return}if(i.value0 instanceof oo){d=s,g=i.value1,a=new at(p,i.value0.value0,i.value0.value1,i.value0.value2,i.value0.value3,i.value0.value4,i.value0.value5);return}if(i.value0 instanceof ea){d=s,g=i.value1,a=new at(i.value0.value0,i.value0.value1,i.value0.value2,p,i.value0.value3,i.value0.value4,i.value0.value5);return}if(i.value0 instanceof io){d=s,g=i.value1,a=new at(i.value0.value0,i.value0.value1,i.value0.value2,i.value0.value3,i.value0.value4,i.value0.value5,p);return}throw new Error("Failed pattern match at Data.Map.Internal (line 462, column 3 - line 467, column 88): "+[i.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 459, column 1 - line 459, column 80): "+[i.constructor.name,p.constructor.name])}for(;!n;)u=f(d,g,a);return u}}},wa=function(e){var t=$0(e),a=he(e);return function(d){return function(g){var n=function(f){return function(s){var i=f,p=!1,m;function h(l,r){if(l instanceof He)return p=!0,new We(r.value0,r.value1,r.value2,r.value3);if(l instanceof _e){if(l.value0 instanceof ao)return p=!0,t(l.value1)(new at(r.value0,r.value1,r.value2,r.value3,l.value0.value0,l.value0.value1,l.value0.value2));if(l.value0 instanceof Ta)return p=!0,t(l.value1)(new at(l.value0.value0,l.value0.value1,l.value0.value2,r.value0,r.value1,r.value2,r.value3));if(l.value0 instanceof oo){i=l.value1,s=new If(new We(r.value0,r.value1,r.value2,r.value3),l.value0.value0,l.value0.value1,new We(l.value0.value2,l.value0.value3,l.value0.value4,l.value0.value5));return}if(l.value0 instanceof ea){i=l.value1,s=new If(new We(l.value0.value0,l.value0.value1,l.value0.value2,r.value0),r.value1,r.value2,new We(r.value3,l.value0.value3,l.value0.value4,l.value0.value5));return}if(l.value0 instanceof io){i=l.value1,s=new If(new We(l.value0.value0,l.value0.value1,l.value0.value2,l.value0.value3),l.value0.value4,l.value0.value5,new We(r.value0,r.value1,r.value2,r.value3));return}throw new Error("Failed pattern match at Data.Map.Internal (line 498, column 5 - line 503, column 108): "+[l.value0.constructor.name,r.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 495, column 3 - line 495, column 56): "+[l.constructor.name,r.constructor.name])}for(;!p;)m=h(i,s);return m}},u=function(f){return function(s){var i=f,p=!1,m;function h(l,r){if(r instanceof Me)return p=!0,n(l)(new If(Me.value,d,g,Me.value));if(r instanceof We){var o=a(d)(r.value1);if(o instanceof ye)return p=!0,t(l)(new We(r.value0,d,g,r.value3));if(o instanceof X){i=new _e(new ao(r.value1,r.value2,r.value3),l),s=r.value0;return}i=new _e(new Ta(r.value0,r.value1,r.value2),l),s=r.value3;return}if(r instanceof at){var o=a(d)(r.value1);if(o instanceof ye)return p=!0,t(l)(new at(r.value0,d,g,r.value3,r.value4,r.value5,r.value6));var c=a(d)(r.value4);if(c instanceof ye)return p=!0,t(l)(new at(r.value0,r.value1,r.value2,r.value3,d,g,r.value6));if(o instanceof X){i=new _e(new oo(r.value1,r.value2,r.value3,r.value4,r.value5,r.value6),l),s=r.value0;return}if(o instanceof te&&c instanceof X){i=new _e(new ea(r.value0,r.value1,r.value2,r.value4,r.value5,r.value6),l),s=r.value3;return}i=new _e(new io(r.value0,r.value1,r.value2,r.value3,r.value4,r.value5),l),s=r.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 478, column 3 - line 478, column 55): "+[l.constructor.name,r.constructor.name])}for(;!p;)m=h(i,s);return m}};return u(He.value)}}},Xp=function(e){var t=$0(e),a=he(e);return function(d){var g=function(s){return function(i){var p=s,m=!1,h;function l(r,o){if(r instanceof He)return m=!0,o;if(r instanceof _e){if(r.value0 instanceof ao&&r.value0.value2 instanceof Me&&o instanceof Me)return m=!0,t(r.value1)(new We(Me.value,r.value0.value0,r.value0.value1,Me.value));if(r.value0 instanceof Ta&&r.value0.value0 instanceof Me&&o instanceof Me)return m=!0,t(r.value1)(new We(Me.value,r.value0.value1,r.value0.value2,Me.value));if(r.value0 instanceof ao&&r.value0.value2 instanceof We){p=r.value1,i=new at(o,r.value0.value0,r.value0.value1,r.value0.value2.value0,r.value0.value2.value1,r.value0.value2.value2,r.value0.value2.value3);return}if(r.value0 instanceof Ta&&r.value0.value0 instanceof We){p=r.value1,i=new at(r.value0.value0.value0,r.value0.value0.value1,r.value0.value0.value2,r.value0.value0.value3,r.value0.value1,r.value0.value2,o);return}return r.value0 instanceof ao&&r.value0.value2 instanceof at?(m=!0,t(r.value1)(new We(new We(o,r.value0.value0,r.value0.value1,r.value0.value2.value0),r.value0.value2.value1,r.value0.value2.value2,new We(r.value0.value2.value3,r.value0.value2.value4,r.value0.value2.value5,r.value0.value2.value6)))):r.value0 instanceof Ta&&r.value0.value0 instanceof at?(m=!0,t(r.value1)(new We(new We(r.value0.value0.value0,r.value0.value0.value1,r.value0.value0.value2,r.value0.value0.value3),r.value0.value0.value4,r.value0.value0.value5,new We(r.value0.value0.value6,r.value0.value1,r.value0.value2,o)))):r.value0 instanceof oo&&r.value0.value2 instanceof Me&&r.value0.value5 instanceof Me&&o instanceof Me?(m=!0,t(r.value1)(new at(Me.value,r.value0.value0,r.value0.value1,Me.value,r.value0.value3,r.value0.value4,Me.value))):r.value0 instanceof ea&&r.value0.value0 instanceof Me&&r.value0.value5 instanceof Me&&o instanceof Me?(m=!0,t(r.value1)(new at(Me.value,r.value0.value1,r.value0.value2,Me.value,r.value0.value3,r.value0.value4,Me.value))):r.value0 instanceof io&&r.value0.value0 instanceof Me&&r.value0.value3 instanceof Me&&o instanceof Me?(m=!0,t(r.value1)(new at(Me.value,r.value0.value1,r.value0.value2,Me.value,r.value0.value4,r.value0.value5,Me.value))):r.value0 instanceof oo&&r.value0.value2 instanceof We?(m=!0,t(r.value1)(new We(new at(o,r.value0.value0,r.value0.value1,r.value0.value2.value0,r.value0.value2.value1,r.value0.value2.value2,r.value0.value2.value3),r.value0.value3,r.value0.value4,r.value0.value5))):r.value0 instanceof ea&&r.value0.value0 instanceof We?(m=!0,t(r.value1)(new We(new at(r.value0.value0.value0,r.value0.value0.value1,r.value0.value0.value2,r.value0.value0.value3,r.value0.value1,r.value0.value2,o),r.value0.value3,r.value0.value4,r.value0.value5))):r.value0 instanceof ea&&r.value0.value5 instanceof We?(m=!0,t(r.value1)(new We(r.value0.value0,r.value0.value1,r.value0.value2,new at(o,r.value0.value3,r.value0.value4,r.value0.value5.value0,r.value0.value5.value1,r.value0.value5.value2,r.value0.value5.value3)))):r.value0 instanceof io&&r.value0.value3 instanceof We?(m=!0,t(r.value1)(new We(r.value0.value0,r.value0.value1,r.value0.value2,new at(r.value0.value3.value0,r.value0.value3.value1,r.value0.value3.value2,r.value0.value3.value3,r.value0.value4,r.value0.value5,o)))):r.value0 instanceof oo&&r.value0.value2 instanceof at?(m=!0,t(r.value1)(new at(new We(o,r.value0.value0,r.value0.value1,r.value0.value2.value0),r.value0.value2.value1,r.value0.value2.value2,new We(r.value0.value2.value3,r.value0.value2.value4,r.value0.value2.value5,r.value0.value2.value6),r.value0.value3,r.value0.value4,r.value0.value5))):r.value0 instanceof ea&&r.value0.value0 instanceof at?(m=!0,t(r.value1)(new at(new We(r.value0.value0.value0,r.value0.value0.value1,r.value0.value0.value2,r.value0.value0.value3),r.value0.value0.value4,r.value0.value0.value5,new We(r.value0.value0.value6,r.value0.value1,r.value0.value2,o),r.value0.value3,r.value0.value4,r.value0.value5))):r.value0 instanceof ea&&r.value0.value5 instanceof at?(m=!0,t(r.value1)(new at(r.value0.value0,r.value0.value1,r.value0.value2,new We(o,r.value0.value3,r.value0.value4,r.value0.value5.value0),r.value0.value5.value1,r.value0.value5.value2,new We(r.value0.value5.value3,r.value0.value5.value4,r.value0.value5.value5,r.value0.value5.value6)))):r.value0 instanceof io&&r.value0.value3 instanceof at?(m=!0,t(r.value1)(new at(r.value0.value0,r.value0.value1,r.value0.value2,new We(r.value0.value3.value0,r.value0.value3.value1,r.value0.value3.value2,r.value0.value3.value3),r.value0.value3.value4,r.value0.value3.value5,new We(r.value0.value3.value6,r.value0.value4,r.value0.value5,o)))):(m=!0,to("The impossible happened in partial function `up`."))}throw new Error("Failed pattern match at Data.Map.Internal (line 552, column 5 - line 573, column 86): "+[r.constructor.name])}for(;!m;)h=l(p,i);return h}},n=function(s){return function(i){var p=s,m=!1,h;function l(r,o){if(o instanceof We&&o.value0 instanceof Me&&o.value3 instanceof Me)return m=!0,g(r)(Me.value);if(o instanceof We){p=new _e(new Ta(o.value0,o.value1,o.value2),r),i=o.value3;return}if(o instanceof at&&o.value0 instanceof Me&&o.value3 instanceof Me&&o.value6 instanceof Me)return m=!0,g(new _e(new Ta(Me.value,o.value1,o.value2),r))(Me.value);if(o instanceof at){p=new _e(new io(o.value0,o.value1,o.value2,o.value3,o.value4,o.value5),r),i=o.value6;return}return m=!0,to("The impossible happened in partial function `removeMaxNode`.")}for(;!m;)h=l(p,i);return h}},u=function(s){var i=!1,p;function m(h){if(h instanceof We&&h.value3 instanceof Me)return i=!0,{key:h.value1,value:h.value2};if(h instanceof We){s=h.value3;return}if(h instanceof at&&h.value6 instanceof Me)return i=!0,{key:h.value4,value:h.value5};if(h instanceof at){s=h.value6;return}return i=!0,to("The impossible happened in partial function `maxNode`.")}for(;!i;)p=m(s);return p},f=function(s){return function(i){var p=s,m=!1,h;function l(r,o){if(o instanceof Me)return m=!0,q.value;if(o instanceof We){var c=a(d)(o.value1);if(o.value3 instanceof Me&&c instanceof ye)return m=!0,new k(new J(o.value2,g(r)(Me.value)));if(c instanceof ye){var _=u(o.value0);return m=!0,new k(new J(o.value2,n(new _e(new ao(_.key,_.value,o.value3),r))(o.value0)))}if(c instanceof X){p=new _e(new ao(o.value1,o.value2,o.value3),r),i=o.value0;return}p=new _e(new Ta(o.value0,o.value1,o.value2),r),i=o.value3;return}if(o instanceof at){var D=function(){return o.value0 instanceof Me&&o.value3 instanceof Me&&o.value6 instanceof Me}(),c=a(d)(o.value4),C=a(d)(o.value1);if(D&&C instanceof ye)return m=!0,new k(new J(o.value2,t(r)(new We(Me.value,o.value4,o.value5,Me.value))));if(D&&c instanceof ye)return m=!0,new k(new J(o.value5,t(r)(new We(Me.value,o.value1,o.value2,Me.value))));if(C instanceof ye){var _=u(o.value0);return m=!0,new k(new J(o.value2,n(new _e(new oo(_.key,_.value,o.value3,o.value4,o.value5,o.value6),r))(o.value0)))}if(c instanceof ye){var _=u(o.value3);return m=!0,new k(new J(o.value5,n(new _e(new ea(o.value0,o.value1,o.value2,_.key,_.value,o.value6),r))(o.value3)))}if(C instanceof X){p=new _e(new oo(o.value1,o.value2,o.value3,o.value4,o.value5,o.value6),r),i=o.value0;return}if(C instanceof te&&c instanceof X){p=new _e(new ea(o.value0,o.value1,o.value2,o.value4,o.value5,o.value6),r),i=o.value3;return}p=new _e(new io(o.value0,o.value1,o.value2,o.value3,o.value4,o.value5),r),i=o.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 525, column 16 - line 548, column 80): "+[o.constructor.name])}for(;!m;)h=l(p,i);return h}};return f(He.value)}},ur={foldr:function(e){return function(t){return function(a){if(a instanceof Me)return t;if(a instanceof We)return Dt(ur)(e)(e(a.value2)(Dt(ur)(e)(t)(a.value3)))(a.value0);if(a instanceof at)return Dt(ur)(e)(e(a.value2)(Dt(ur)(e)(e(a.value5)(Dt(ur)(e)(t)(a.value6)))(a.value3)))(a.value0);throw new Error("Failed pattern match at Data.Map.Internal (line 133, column 17 - line 136, column 85): "+[a.constructor.name])}}},foldl:function(e){return function(t){return function(a){if(a instanceof Me)return t;if(a instanceof We)return Ct(ur)(e)(e(Ct(ur)(e)(t)(a.value0))(a.value2))(a.value3);if(a instanceof at)return Ct(ur)(e)(e(Ct(ur)(e)(e(Ct(ur)(e)(t)(a.value0))(a.value2))(a.value3))(a.value5))(a.value6);throw new Error("Failed pattern match at Data.Map.Internal (line 137, column 17 - line 140, column 85): "+[a.constructor.name])}}},foldMap:function(e){var t=Ze(e),a=ce(e.Semigroup0());return function(d){return function(g){if(g instanceof Me)return t;if(g instanceof We)return a(Mt(ur)(e)(d)(g.value0))(a(d(g.value2))(Mt(ur)(e)(d)(g.value3)));if(g instanceof at)return a(Mt(ur)(e)(d)(g.value0))(a(d(g.value2))(a(Mt(ur)(e)(d)(g.value3))(a(d(g.value5))(Mt(ur)(e)(d)(g.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 141, column 17 - line 144, column 93): "+[g.constructor.name])}}}};var q0=function(){var e=function(t){return function(a){var d=t,g=!1,n;function u(f,s){if(s instanceof Me)return g=!0,f;if(s instanceof We){d=new k({key:s.value1,value:s.value2}),a=s.value3;return}if(s instanceof at){d=new k({key:s.value4,value:s.value5}),a=s.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 330, column 5 - line 330, column 22): "+[f.constructor.name,s.constructor.name])}for(;!g;)n=u(d,a);return n}};return e(q.value)}();var Mn=function(){return Me.value}();var Cc=function(e){var t=Xp(e);return function(a){return function(d){return Qe(d)(qt)(t(a)(d))}}};var U0=function(e){var t=ni(e),a=Cc(e),d=wa(e);return function(g){return function(n){return function(u){var f=g(t(n)(u));if(f instanceof q)return a(n)(u);if(f instanceof k)return d(n)(f.value0)(u);throw new Error("Failed pattern match at Data.Map.Internal (line 596, column 15 - line 598, column 25): "+[f.constructor.name])}}}};var MF=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}();var Of=function(e){return MF.create(Ee(e.Eq0()))(he(e))},FF={eq:function(e){return function(t){return e.value0(e.value2)(t.value2)}}},z0={compare:function(e){return function(t){return e.value1(e.value2)(t.value2)}},Eq0:function(){return FF}};var Yp=zo(Qt)(z0);var AF=Xp(Yp),xF=ni(Yp),IF=wa(Yp);var V0=function(){return function(e){var t=xr(e);return function(a){var d=Of(a);return function(g){return function(n){return function(u){return AF(new J(t(g),d(n)))(u)}}}}}},Pf=function(){return function(e){var t=xr(e);return function(a){var d=Of(a);return function(g){return function(n){return function(u){return xF(new J(t(g),d(n)))(u)}}}}}},G0=function(){return function(e){var t=xr(e);return function(a){var d=Of(a);return function(g){return function(n){return function(u){return function(f){return IF(new J(t(g),d(n)))(u)(f)}}}}}}},j0=function(e){var t=Et(e)(ur);return function(a){return function(d){return t(function(g){return d(g)})(a)}}},iu=Mn;var Nf=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),ai=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}();function J0(e,t,a){return e==null?t:a(e)}function Zp(e){return e}var Ea=Qe(null)(Zp),Ft=function(e){return J0(e,q.value,k.create)};var Wt=function(){function e(t,a,d,g){this.value0=t,this.value1=a,this.value2=d,this.value3=g}return e.create=function(t){return function(a){return function(d){return function(g){return new e(t,a,d,g)}}}},e}(),Sc=V,zr=function(e,t){return e.value2(e.value1,t)},Bt=V,Vr=function(e){return e.value3(e.value1)},hr=Sc(function(e){return e.value0});var Q0=$(Tt),XF=$(ma);var uo=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Ma=function(){function e(t,a,d,g){this.value0=t,this.value1=a,this.value2=d,this.value3=g}return e.create=function(t){return function(a){return function(d){return function(g){return new e(t,a,d,g)}}}},e}(),co=function(){function e(t,a,d,g){this.value0=t,this.value1=a,this.value2=d,this.value3=g}return e.create=function(t){return function(a){return function(d){return function(g){return new e(t,a,d,g)}}}},e}(),so=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Fa=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),YF=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),K0=function(e){return function(t){return e(t)}};var ZF=V;var eL={bimap:function(e){return function(t){return K0(function(a){return ZF(new YF(function(d){return e(a.value0(d))},function(d){return t(a.value1(d))},a.value2))})}}},tL=rn(eL);var oi=K0(function(e){var t=function(a){if(a instanceof uo)return new uo(a.value0);if(a instanceof Ma)return new Ma(a.value0,a.value1,e.value0(a.value2),Q0(t)(a.value3));if(a instanceof co)return new co(a.value0,a.value1,e.value0(a.value2),Q0(XF(t))(a.value3));if(a instanceof so)return new so(e.value1(a.value0));if(a instanceof Fa)return new Fa(tL(e.value0)(e.value1)(a.value0));throw new Error("Failed pattern match at Halogen.VDom.Types (line 86, column 7 - line 86, column 27): "+[a.constructor.name])};return t(e.value2)});function ii(e,t){return t[e]}function td(e,t){return t.hasOwnProperty(e)}function La(e,t,a){a[e]=t}function rd(e,t){for(var a=[],d=0;d<e.length;d++)a.push(t(d,e[d]));return a}function nd(e,t){for(var a=0;a<e.length;a++)t(e[a])}function ad(e,t){for(var a=Object.keys(e),d=0;d<a.length;d++){var g=a[d];t(g,e[g])}}function od(e,t,a,d,g){for(var n=[],u=e.length,f=t.length,s=0;;){if(s<u)s<f?n.push(a(s,e[s],t[s])):d(s,e[s]);else if(s<f)n.push(g(s,t[s]));else break;s++}return n}function Tc(e,t,a){for(var d={},g=0;g<e.length;g++){var n=e[g],u=t(n);d[u]=a(u,g,n)}return d}function wc(e,t,a,d,g,n){for(var u={},f=0;f<t.length;f++){var s=t[f],i=a(s);e.hasOwnProperty(i)?u[i]=d(i,f,e[i],s):u[i]=n(i,f,s)}for(var i in e)i in u||g(i,e[i]);return u}function ui(e,t){return e===t}function id(e,t){return t.createTextNode(e)}function ud(e,t){t.textContent=e}function Wf(e,t,a){return e!=null?a.createElementNS(e,t):a.createElement(t)}function fo(e,t,a){var d=a.childNodes.item(e)||null;d!==t&&a.insertBefore(t,d)}function Ec(e,t){t&&e.parentNode===t&&t.removeChild(e)}function Mc(e){return e.parentNode}function Bf(e,t,a,d){e!=null?d.setAttributeNS(e,t,a):d.setAttribute(t,a)}function $f(e,t,a){e!=null?a.removeAttributeNS(e,t):a.removeAttribute(t)}function cd(e,t,a){return e!=null?a.hasAttributeNS(e,t):a.hasAttribute(t)}function sd(e,t,a){a.addEventListener(e,t,!1)}function fd(e,t,a){a.removeEventListener(e,t,!1)}var ld=void 0;var Fc=function(){return{}};function _d(e){return function(t){return function(a){return function(){return a[e]=t,a}}}}var pd=ii,dd=V,vd=La,md=Fc;var qf=function(e){return function(t){return t[e]}},iL=qf("namespaceURI"),uL=qf("prefix"),cL=qf("localName"),sL=qf("tagName");var Uf=function(e){return function(t){return function(){return t[e]}}},lL=Uf("children"),_L=Uf("firstElementChild"),pL=Uf("lastElementChild"),dL=Uf("childElementCount");function Y0(e){return function(t){return function(){return t.querySelector(e)}}}var mL=$(Oe);var Z0=function(e){var t=mL(Ft),a=Y0(e);return function(d){return t(a(d))}};var gd=V;var Lc=function(e,t,a){var d=0,g;return function(n){if(d===2)return g;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,g=a(),d=2,g}};var Dd=function(e){return Vr(e.widget)},Cd=Lc("patchWidget","Halogen.VDom.DOM",function(){return function(e,t){if(t instanceof Fa)return Cd(291)(e,oi(t.value0));if(t instanceof so){var a=zr(e.widget,t.value0),d=Sc(function(g){return Bt(new Wt(g.value0,{build:e.build,widget:a},Cd(296),Dd))})(a);return d}return Dd(e),e.build(t)}}),bL=Cd(286),zf=function(e){var t=Mc(e.node);return Ec(e.node,t)},Vf=Lc("patchText","Halogen.VDom.DOM",function(){return function(e,t){if(t instanceof Fa)return Vf(82)(e,oi(t.value0));if(t instanceof uo){if(e.value===t.value0)return Bt(new Wt(e.node,e,Vf(85),zf));if(nr){var a={build:e.build,node:e.node,value:t.value0};return ud(t.value0,e.node),Bt(new Wt(e.node,a,Vf(89),zf))}}return zf(e),e.build(t)}}),SL=Vf(77),Gf=function(e){var t=Mc(e.node);return Ec(e.node,t),ad(e.children,function(a,d){return Vr(d)}),Vr(e.attrs)},jf=function(e){var t=Mc(e.node);return Ec(e.node,t),nd(e.children,Vr),Vr(e.attrs)},eC=function(e,t,a,d){var g=t===d;return g?e instanceof k&&a instanceof k&&e.value0===a.value0||e instanceof q&&a instanceof q:!1},Jf=Lc("patchElem","Halogen.VDom.DOM",function(){return function(e,t){if(t instanceof Fa)return Jf(135)(e,oi(t.value0));if(t instanceof Ma&&eC(e.ns,e.name,t.value0,t.value1)){var a=_n(t.value3),d=_n(e.children);if(d===0&&a===0){var s=zr(e.attrs,t.value2),i={build:e.build,node:e.node,attrs:s,ns:t.value0,name:t.value1,children:e.children};return Bt(new Wt(e.node,i,Jf(149),jf))}var g=function(p,m){return Vr(m)},n=function(p,m,h){var l=zr(m,h);return fo(p,hr(l),e.node),l},u=function(p,m){var h=e.build(m);return fo(p,hr(h),e.node),h},f=od(e.children,t.value3,n,g,u),s=zr(e.attrs,t.value2),i={build:e.build,node:e.node,attrs:s,ns:t.value0,name:t.value1,children:f};return Bt(new Wt(e.node,i,Jf(172),jf))}return jf(e),e.build(t)}}),TL=Jf(130),Qf=Lc("patchKeyed","Halogen.VDom.DOM",function(){return function(e,t){if(t instanceof Fa)return Qf(222)(e,oi(t.value0));if(t instanceof co&&eC(e.ns,e.name,t.value0,t.value1)){var a=_n(t.value3);if(e.length===0&&a===0){var f=zr(e.attrs,t.value2),s={build:e.build,node:e.node,attrs:f,ns:t.value0,name:t.value1,children:e.children,length:0};return Bt(new Wt(e.node,s,Qf(237),Gf))}var d=function(i,p){return Vr(p)},g=function(i,p,m,h){var l=zr(m,h.value1);return fo(p,hr(l),e.node),l},n=function(i,p,m){var h=e.build(m.value1);return fo(p,hr(h),e.node),h},u=wc(e.children,t.value3,_r,g,d,n),f=zr(e.attrs,t.value2),s={build:e.build,node:e.node,attrs:f,ns:t.value0,name:t.value1,children:u,length:a};return Bt(new Wt(e.node,s,Qf(261),Gf))}return Gf(e),e.build(t)}}),wL=Qf(217),EL=function(e,t,a){var d=e.buildWidget(e)(a),g=Sc(function(n){return Bt(new Wt(n.value0,{build:t,widget:d},bL,Dd))})(d);return g},ML=function(e,t,a){var d=id(a,e.document),g={build:t,node:d,value:a};return Bt(new Wt(d,g,SL,zf))},FL=function(e,t,a,d,g,n){var u=Wf(Ea(a),d,e.document),f=gd(u),s=function(h,l,r){var o=t(r.value1);return fo(l,hr(o),f),o},i=Tc(n,_r,s),p=e.buildAttributes(u)(g),m={build:t,node:f,attrs:p,ns:a,name:d,children:i,length:_n(n)};return Bt(new Wt(f,m,wL,Gf))},LL=function(e,t,a,d,g,n){var u=Wf(Ea(a),d,e.document),f=gd(u),s=function(h,l){var r=t(l);return fo(h,hr(r),f),r},i=rd(n,s),p=e.buildAttributes(u)(g),m={build:t,node:f,attrs:p,ns:a,name:d,children:i};return Bt(new Wt(f,m,TL,jf))},Ac=function(e){var t=Lc("build","Halogen.VDom.DOM",function(){return function(d){if(d instanceof uo)return ML(e,t(59),d.value0);if(d instanceof Ma)return LL(e,t(60),d.value0,d.value1,d.value2,d.value3);if(d instanceof co)return FL(e,t(61),d.value0,d.value1,d.value2,d.value3);if(d instanceof so)return EL(e,t(62),d.value0);if(d instanceof Fa)return t(63)(oi(d.value0));throw new Error("Failed pattern match at Halogen.VDom.DOM (line 58, column 27 - line 63, column 52): "+[d.constructor.name])}}),a=t(58);return a};function Kf(e){return typeof e}function xc(e){return e===void 0}var rC=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};var nC=function(e){return function(t){return function(a){return(a|0)===a?e(a):t}}},uu=function(e){return e};var Xf=isFinite;var Sd=Math.round;var oC=Nn(Hs),iC=la(Hs);var cC=function(){return nC(k.create)(q.value)}(),UL=function(e){if(!Xf(e))return 0;if(e>=uu(oC))return oC;if(e<=uu(iC))return iC;if(nr)return tr(0)(cC(e));throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[e.constructor.name])},sC=function(e){return UL(Sd(e))};var wd=function(){var e=nf(Hg);return function(t){return _p(e(t))}}();var fC=function(e){return function(t){return new Rr(e,new _e(t.value0,t.value1))}};var ci=function(e){return e.length};var Yf=function(e){return function(t){return t.substr(0,e)}},cu=function(e){return function(t){return t.substring(e)}};var lo=function(e){return function(t){if(e>=0&&e<t.length)return t.charAt(e);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var pC=function(e){return function(t){return cu(ci(t)-e|0)(t)}};var Zf=function(e){return function(t){return Yf(ci(t)-e|0)(t)}};var si=V,Ed=V;function Md(e){return e()}function mC(e,t,a,d){return a in d?t(d[a]):e}function Fd(e){return function(t){var a=[];for(var d in t)hasOwnProperty.call(t,d)&&a.push(e(d)(t[d]));return a}}var XL=Object.keys||Fd(function(e){return function(){return e}});var Ld=function(e){return function(t){return function(a){return function(d){return function(g){return e(t,a,d,g)}}}}};var aA=gt(_f);var gC=function(){return Ld(mC)(q.value)(k.create)}();var Ad=function(e){var t=Dp(e);return function(a){return Md(function(){var g=Fc();return lf(t(a))(function(n){return aA(_d(n.value0)(n.value1)(g))})(),g})}};function Ic(e){return function(){return function(t){return e(t)()}}}function Id(e){return function(t){return function(a){return function(d){return function(){return d.addEventListener(e,t,a)}}}}}function Rd(e){return function(t){return function(a){return function(d){return function(){return d.removeEventListener(e,t,a)}}}}}var oA=function(e,t,a){var d=0,g;return function(n){if(d===2)return g;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,g=a(),d=2,g}};var Pd=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Hd=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),po=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),vo=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),mo=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),fi=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),iA=ii,Od=La,uA=function(e,t){var a=cd(null,e,t);if(a)return $f(null,e,t);var d=Kf(ii(e,t));return d==="string"?La(e,"",t):e==="rowSpan"?La(e,1,t):e==="colSpan"?La(e,1,t):La(e,ld,t)},CC=function(e){if(e instanceof po&&e.value0 instanceof k)return"attr/"+(e.value0.value0+(":"+e.value1));if(e instanceof po)return"attr/:"+e.value1;if(e instanceof vo)return"prop/"+e.value0;if(e instanceof mo)return"handler/"+e.value0;if(e instanceof fi)return"ref";throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 182, column 16 - line 187, column 16): "+[e.constructor.name])},yC=V;var bC=function(e){return function(t){var a=function(p){return function(m,h){if(h instanceof po)return $f(Ea(h.value0),h.value1,t);if(h instanceof vo)return uA(h.value0,t);if(h instanceof mo){var l=pd(h.value0,p);return fd(h.value0,_r(l),t)}if(h instanceof fi)return void 0;throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 169, column 5 - line 179, column 18): "+[h.constructor.name])}},d=function(p){return p instanceof k?e(p.value0)():void 0},g=function(p){var m=gC("ref")(p.props);return m instanceof k&&m.value0 instanceof fi?d(m.value0.value0(new Hd(t))):void 0},n=function(p,m){return function(h,l,r,o){if(r instanceof po&&o instanceof po){var c=r.value2===o.value2;return c||Bf(Ea(o.value0),o.value1,o.value2,t),o}if(r instanceof vo&&o instanceof vo){var _=ui(r.value1,o.value1);if(_)return o;if(o.value0==="value"){var D=iA("value",t),C=ui(D,o.value1);return C||Od(o.value0,o.value1,t),o}return Od(o.value0,o.value1,t),o}if(r instanceof mo&&o instanceof mo){var b=pd(o.value0,p);return vt(o.value1)(qt(b))(),vd(o.value0,b,m),o}return o}},u=function(p){return function(m,h,l){if(l instanceof po)return Bf(Ea(l.value0),l.value1,l.value2,t),l;if(l instanceof vo)return Od(l.value0,l.value1,t),l;if(l instanceof mo){var r=ii(l.value0,p);if(td(l.value0,p))return vt(l.value1)(qt(r))(),l;var o=It(l.value1)(),c=Ic(function(_){return function(){var C=Pe(o)();return d(C(_))}})();return vd(l.value0,new J(c,o),p),sd(l.value0,c,t),l}if(l instanceof fi)return d(l.value0(new Pd(t))),l;throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 113, column 5 - line 135, column 15): "+[l.constructor.name])}},f=oA("patchProp","Halogen.VDom.DOM.Prop",function(){return function(p,m){var h=md(),l=a(p.events),r=n(p.events,h),o=u(h),c=wc(p.props,m,CC,r,l,o),_={events:dd(h),props:c};return Bt(new Wt(void 0,_,f(100),g))}}),s=f(87),i=function(p){var m=md(),h=Tc(p,CC,u(m)),l={events:dd(m),props:h};return Bt(new Wt(void 0,l,s,g))};return i}};var kd=function(e){return e},EC=function(e){return kd(so.create(e))},fA=function(e){return e.toPropValue},Rc=function(e){return kd(uo.create(e))},MC=function(e){return new fi(function(t){return e(function(a){if(a instanceof Pd)return new k(a.value0);if(a instanceof Hd)return q.value;throw new Error("Failed pattern match at Halogen.HTML.Core (line 109, column 21 - line 111, column 23): "+[a.constructor.name])}(t))})},FC=function(e){var t=fA(e);return function(a){var d=vo.create(a);return function(g){return d(t(g))}}};var Wd={toPropValue:function(){var e=jt();return function(t){return yC(e(t))}}()};var Bd=function(){return mo.create}(),LC=function(e){return function(t){return function(a){return function(d){return new Ma(e,t,a,d)}}}};var lA=pe(de);var tl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),$d=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),qd=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),AC=function(e){return function(t){return new qd(e,t)}},xC=function(){return $d.create}(),IC=function(e){var t=Q(e);return function(a){return function(d){return function(g){return function(n){return function(u){if(n instanceof tl)return new J(new _e({func:t(n.value0),count:u},a),d);if(n instanceof $d)return new J(new _e({func:g(n.value0),count:u},a),d);if(n instanceof qd)return IC(e)(a)(fC(n.value1)(d))(g)(n.value0)(u+1|0);throw new Error("Failed pattern match at Control.Applicative.Free (line 102, column 41 - line 105, column 81): "+[n.constructor.name])}}}}}},RC=function(e){var t=Xe(e.Apply0());return function(a){return function(d){return function(g){if(a instanceof He)return new Ye(g);if(a instanceof _e){var n=t(a.value0.func)(g),u=a.value0.count===1;if(u)return a.value1 instanceof He?new Ye(n):RC(e)(a.value1)(d)(n);if(d instanceof He)return new Ye(n);if(d instanceof _e)return new Je(new J(new _e({func:n,count:a.value0.count-1|0},a.value1),new Rr(d.value0,d.value1)));throw new Error("Failed pattern match at Control.Applicative.Free (line 83, column 11 - line 88, column 50): "+[d.constructor.name])}throw new Error("Failed pattern match at Control.Applicative.Free (line 72, column 3 - line 88, column 50): "+[a.constructor.name])}}}},OC={map:function(e){return function(t){return AC(new tl(e))(t)}}},PC=function(e){var t=RC(e),a=Q(e),d=IC(e);return function(g){return function(n){var u=function(f){var s=!1,i;function p(m){if(m.value1.value0 instanceof tl){var h=t(m.value0)(m.value1.value1)(a(m.value1.value0.value0));if(h instanceof Ye)return s=!0,h.value0;if(h instanceof Je){f=h.value0;return}throw new Error("Failed pattern match at Control.Applicative.Free (line 54, column 17 - line 56, column 24): "+[h.constructor.name])}if(m.value1.value0 instanceof $d){var h=t(m.value0)(m.value1.value1)(g(m.value1.value0.value0));if(h instanceof Ye)return s=!0,h.value0;if(h instanceof Je){f=h.value0;return}throw new Error("Failed pattern match at Control.Applicative.Free (line 57, column 17 - line 59, column 24): "+[h.constructor.name])}if(m.value1.value0 instanceof qd){var l=new Rr(m.value1.value0.value1,m.value1.value1);f=d(m.value0)(l)(g)(m.value1.value0.value0)(1);return}throw new Error("Failed pattern match at Control.Applicative.Free (line 53, column 5 - line 62, column 47): "+[m.value1.value0.constructor.name])}for(;!s;)i=p(f);return i};return u(new J(He.value,wd(n)))}}},HC=function(e){return PC(e)(lA)},NC={apply:function(e){return function(t){return AC(e)(t)}},Functor0:function(){return OC}},kC=function(){return{pure:tl.create,Apply0:function(){return NC}}}(),_A=PC(kC),Ud=function(e){return _A(function(t){return xC(e(t))})};var BC=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),$C=V,qC=V;function zd(e){return function(t){return e===t}}var su=zd;var mA=gt(Oe);var hA=se(Zr);var gA=ce(wt),DA=Et(xt),CA=DA(Nt);var rl=function(e){return e},zC=function(e){return function(t){return e(function(a){return mA(t(a))})}};var Gr=function(e){return function(t){return e(t)}};var jr=function(){var t=It([])();return{emitter:function(a){return function(){return en(function(g){return gA(g)([a])})(t)(),en(Cp(su)(a))(t)}},listener:function(a){return hA(Pe(t))(CA(function(d){return d(a)}))}}};var Gd=pe(de);var bA=Pf();var VC=function(e){return e},GC=function(e){return e},Oc=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Pc=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),al=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),_i=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Hc=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Nc=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),ol=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),il=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),ul=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),cl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),kc=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var fu=function(e){return e};var Jr=function(e){return it(new Pc(function(t){return e},Gd))};var ho=function(e){return it(new Nc(e,void 0))};var lu=function(){return function(e){var t=bA(e);return function(a){var d=t(a);return function(g){return function(n){return function(u){return it(new Hc(qC(new BC(function(f){var s=Q(f);return function(i){var p=Qe(s(q.value))(i),m=d(g)(n);return function(h){return p(m(h))}}},u,Gd))))}}}}}},jd=ir,sl=ir;var jC={lift:function(e){return function(t){return fu(it(_i.create(t)))}}},pi=Xu,Aa={state:function(e){return fu(it(Oc.create(e)))},Monad0:function(){return pi}};var di=function(e){return{liftEffect:function(){var t=Ke(e);return function(a){return fu(it(_i.create(t(a))))}}(),Monad0:function(){return pi}}};var JC=function(e){var t=di(e.MonadEffect0());return{liftAff:function(){var a=Yn(e);return function(d){return fu(it(_i.create(a(d))))}}(),MonadEffect0:function(){return t}}};var Wc=function(e){return it(new kc(e,Gd))},go=Ja;var xa=$r,SA=se(xa);var Do=nn,TA=Q(Do),Jd={tailRecM:function(e){return function(t){return SA(e(t))(function(a){if(a instanceof Gt)return Sr(Jd)(e)(a.value0);if(a instanceof Pt)return TA(a.value0);throw new Error("Failed pattern match at Halogen.Query.HalogenM (line 105, column 26 - line 107, column 21): "+[a.constructor.name])})}},Monad0:function(){return pi}};var pu=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),du=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),vu=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),mu=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),hu=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var wA=function(e,t,a){var d=0,g;return function(n){if(d===2)return g;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,g=a(),d=2,g}};var EA=function(e,t){return ui(e.value0,t.value0)&&ui(e.value1,t.value1)&&e.value1(e.value3,t.value3)};var QC=function(e){return e.value2(e.value3)};var KC=function(e){var t=function(n){return Vr(n.vdom)},a=wA("patchThunk","Halogen.VDom.Thunk",function(){return function(n,u){var f=EA(n.thunk,u);if(f)return Bt(new Wt(hr(n.vdom),n,a(112),t));var s=zr(n.vdom,e(QC(u)));return Bt(new Wt(hr(s),{vdom:s,thunk:u},a(115),t))}}),d=a(108),g=function(n){return function(u){var f=Ac(n)(e(QC(u)));return Bt(new Wt(hr(f),{thunk:u,vdom:f},d,t))}};return g};var fl=Oi(go),Xd=Et(Do)(Kt),MA=$(go);var XC=Q(Do),FA=Pf(),LA=V0(),AA=G0(),Bc=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),ll=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Yd=V,Zd=V,vi=function(e){return function(t){if(t instanceof pu)return fl(Xd(e.handleAction)(e.initialize))(t.value0);if(t instanceof du)return fl(Xd(e.handleAction)(e.finalize))(t.value0);if(t instanceof vu)return fl(Xd(e.handleAction)(e.receive(t.value0)))(t.value1);if(t instanceof mu)return fl(e.handleAction(t.value0))(t.value1);if(t instanceof hu)return P0(function(a){var d=MA(Qe(t.value1(void 0))(a));return function(g){return d(e.handleQuery(g))}})(t.value0);throw new Error("Failed pattern match at Halogen.Component (line 182, column 15 - line 192, column 71): "+[t.constructor.name])}},xA=V,mi=V;var ta=function(){return{handleAction:Te(XC(void 0)),handleQuery:Te(XC(q.value)),receive:Te(q.value),initialize:q.value,finalize:q.value}}(),ev=function(){return function(e){var t=FA(e),a=LA(e),d=AA(e);return function(g){var n=t(g),u=a(g),f=d(g);return function(s){return function(i){return function(p){return function(m){return function(h){return xA({get:n(s)(i),pop:u(s)(i),set:f(s)(i),component:p,input:m,output:h})}}}}}}}};var _l=function(){return LC(q.value)}();var tv=_l("style");var pl=_l("div"),Du=pl([]);var rv=_l("button");function nv(e){return function(){return e.stopPropagation()}}function Co(e){return e.charCodeAt(0)}function YC(e){return String.fromCharCode(e)}var $c={Applicative0:function(){return Pi},Plus1:function(){return ig}};var ZC=la(Iu),ey=Nn(Iu);var ty=function(e){return e.fromEnum};var hi=function(e){return function(t){return function(a){return e(t(a)+1|0)}}},gi=function(e){return function(t){return function(a){return e(t(a)-1|0)}}};var av=function(e){return e>=Co(ZC)&&e<=Co(ey)?new k(YC(e)):q.value},qA={succ:hi(av)(Co),pred:gi(av)(Co),Ord0:function(){return Os}};var ry=function(){return{cardinality:Co(ey)-Co(ZC)|0,toEnum:av,fromEnum:Co,Bounded0:function(){return Iu},Enum1:function(){return qA}}}();var ov="DOMContentLoaded";var iy="click";var ex=V;var tx=function(e){return function(t){return Bd(e)(function(a){return new k(new ai(t(a)))})}};var uy=function(){var e=tx(iy);return function(t){return e(ex(t))}}();var nx=$(Ja),cy=pe(de),sy=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var Uc=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),zc=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Vc=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Gc=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),jc=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),ml=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Jc=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),Qc=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Kc=function(){function e(t,a,d){this.value0=t,this.value1=a,this.value2=d}return e.create=function(t){return function(a){return function(d){return new e(t,a,d)}}},e}(),fy=function(e){return e};var iv=ki,Xc=ir,ax={lift:function(e){return function(t){return fy(it(zc.create(t)))}}},ox=mt(ax),ix=Xu;var uv=function(e){return{liftEffect:function(){var t=ox(e.Monad0()),a=Ke(e);return function(d){return t(a(d))}}(),Monad0:function(){return ix}}};var ly=Ja,_y=function(e){var t=$(e);return{map:function(a){return function(d){if(d instanceof Uc)return new Uc(nx(a)(d.value0));if(d instanceof zc)return new zc(t(a)(d.value0));if(d instanceof Vc)return new Vc(function(g){return a(d.value0(g))});if(d instanceof Gc)return new Gc(d.value0,a(d.value1));if(d instanceof jc)return new jc(d.value0,a(d.value1));if(d instanceof ml)return new ml(d.value0,a(d.value1));if(d instanceof Jc)return new Jc(d.value0,d.value1,function(g){return a(d.value2(g))});if(d instanceof Qc)return new Qc(d.value0,a(d.value1));if(d instanceof Kc)return new Kc(d.value0,d.value1,a(d.value2));throw new Error("Failed pattern match at Halogen.Shell.Free (line 34, column 1 - line 43, column 38): "+[a.constructor.name,d.constructor.name])}}}};var Di=$r,ux=se(Di);var Ci=nn,cr=function(e){return fy(it(Uc.create(e)))},py=function(e){return function(t){return it(new Kc(e,t,void 0))}},cx=function(e){return it(new Gc(e,void 0))};var dy=function(e){return it(new Qc(e,void 0))},hl=function(e){return it(new jc(e,void 0))},na=function(){return it(new Vc(cy))}(),Fn=function(e){return ux(na)(function(t){return cx(e(t))})},vy=function(e){return function(t){return it(new Jc(e,t,cy))}};var my=e=>()=>e.type,cv=e=>()=>e.cursorY,sv=e=>()=>e.cursorX,fv=e=>()=>e.viewportY,lv=e=>()=>e.baseY,_v=e=>()=>e.length,hy=e=>t=>()=>e.getLine(t),pv=e=>()=>e.getNullCell();var Cu=function(e){return xc(e)?q.value:new k(Ed(e))};var fx=$(Oe),lx=function(){function e(){}return e.value=new e,e}(),_x=function(){function e(){}return e.value=new e,e}(),gy=function(e){return function(t){return fx(Cu)(hy(e)(t))}},Dy=function(e){return function(){var a=my(e)();return a==="normal"?lx.value:_x.value}};var vv=e=>()=>e.isWrapped,mv=e=>()=>e.length;var Sl=pe(de),aa=$(Oe),hv=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Dl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),gv=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Dv=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Cv=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Cl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),yl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),yv=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),bl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),bv=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),mx={map:function(e){return function(t){if(t instanceof hv)return new hv(function(a){return e(t.value0(a))});if(t instanceof Dl)return new Dl(function(a){return e(t.value0(a))});if(t instanceof gv)return new gv(function(a){return e(t.value0(a))});if(t instanceof Dv)return new Dv(function(a){return e(t.value0(a))});if(t instanceof Cv)return new Cv(function(a){return e(t.value0(a))});if(t instanceof Cl)return new Cl(function(a){return e(t.value0(a))});if(t instanceof yl)return new yl(t.value0,function(a){return e(t.value1(a))});if(t instanceof yv)return new yv(t.value0,function(a){return e(t.value1(a))});if(t instanceof bl)return new bl(t.value0,function(a){return e(t.value1(a))});if(t instanceof bv)return new bv(function(a){return e(t.value0(a))});throw new Error("Failed pattern match at Halogen.Buffer.Free (line 62, column 1 - line 72, column 48): "+[e.constructor.name,t.constructor.name])}}},hx=ja(mx);var Cy=function(e){var t=e.Monad0(),a=se(Yo(t.Bind1())),d=an(tu(t)),g=Ke(Za(e));return function(n){var u=function(f){if(f instanceof hv)return a(d)(function(s){return g(aa(f.value0)(Dy(s)))});if(f instanceof Dl)return a(d)(function(s){return g(aa(f.value0)(sv(s)))});if(f instanceof gv)return a(d)(function(s){return g(aa(f.value0)(cv(s)))});if(f instanceof Dv)return a(d)(function(s){return g(aa(f.value0)(fv(s)))});if(f instanceof Cv)return a(d)(function(s){return g(aa(f.value0)(lv(s)))});if(f instanceof Cl)return a(d)(function(s){return g(aa(f.value0)(_v(s)))});if(f instanceof yl)return a(d)(function(s){return g(aa(f.value1)(gy(s)(f.value0)))});if(f instanceof yv)return g(aa(f.value1)(vv(f.value0)));if(f instanceof bl)return g(aa(f.value1)(mv(f.value0)));if(f instanceof bv)return a(d)(function(s){return g(aa(f.value0)(pv(s)))});throw new Error("Failed pattern match at Halogen.Buffer.Free (line 19, column 5 - line 21, column 40): "+[f.constructor.name])};return hx(ru(n))(u)}},yy=function(e){return it(new bl(e,Sl))};var by=function(e){return it(new yl(e,Sl))};var Sy=function(){return it(new Dl(Sl))}();var Ty=function(){return it(new Cl(Sl))}();var Sv=e=>()=>e.cursorBlink,Tv=e=>t=>()=>e.cursorBlink=t,wv=e=>()=>e.fontFamily,Ev=e=>t=>()=>e.fontFamily=t;var Ey={fromString:pe(de)},ht=function(e){return e.fromString};var gx=function(){function e(u){this.fn=u}var t={},a=function(u,f){this.head=u,this.tail=f};function d(u){return new a(u,t)}function g(u){return function(f){return new a(u,f)}}function n(u){for(var f=[],s=u;s!==t;)f.push(s.head),s=s.tail;return f}return function(u){return function(f){return function(s){var i=function(m,h){return u(f(g)(s(m)))(h)},p=function(m,h,l){if(h===0)return m;var r=l[h-1];return new e(function(){var o=p(i(r,m),h-1,l);return o})};return function(m){for(var h=f(d)(s(m[m.length-1])),l=p(h,m.length-1,m);l instanceof e;)l=l.fn();return f(n)(l)}}}}}();var Sx=typeof Array.from=="function",uG=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",cG=typeof String.prototype.fromCodePoint=="function",Tx=typeof String.prototype.codePointAt=="function",My=function(e){return Tx?function(t){return t.codePointAt(0)}:e};var Fy=function(e){return function(t){return Sx?function(a){return Array.from(a,t)}:e}};var Yc=ty(ry),Fx=$(pt),Lx=yn(Ji);var Ly=function(e){return function(t){return(((e-55296|0)*1024|0)+(t-56320|0)|0)+65536|0}};var Ay=function(e){return 56320<=e&&e<=57343},xy=function(e){return 55296<=e&&e<=56319},Ax=function(e){var t=ci(e);if(t===0)return q.value;if(t===1)return new k({head:Yc(lo(0)(e)),tail:""});var a=Yc(lo(1)(e)),d=Yc(lo(0)(e)),g=xy(d)&&Ay(a);return g?new k({head:Ly(d)(a),tail:cu(2)(e)}):new k({head:d,tail:cu(1)(e)})},xx=function(e){return Fx(function(t){return new J(t.head,t.tail)})(Ax(e))},Ix=function(e){return Lx(xx)(e)},Rx=function(e){var t=Yc(lo(0)(e)),a=xy(t)&&ci(e)>1;if(a){var d=Yc(lo(1)(e)),g=Ay(d);return g?Ly(t)(d):t}return t},Ox=My(Rx),Px=Fy(Ix)(Ox),Tl=function(e){return _n(Px(e))};var Fv=qh($i);var Iy=Fe(Wn);var Wx=function(){function e(t,a,d,g){this.value0=t,this.value1=a,this.value2=d,this.value3=g}return e.create=function(t){return function(a){return function(d){return function(g){return new e(t,a,d,g)}}}},e}();var Bx=function(e){return function(t){return function(a){return function(d){var g=Fv(0)(1)(t),n=Fv(0)(1)(a),u=Fv(0)(1)(d);return new Wx(e,g,n,u)}}}};var Ry=function(e){return function(t){return function(a){return Bx(e)(t)(a)(1)}}},Oy=Ry(0)(0)(1);var Py=function(e){var t=function(f){return Iy(uu(sC(100*f))/100)},a=t(e.value1*100)+"%",d=t(e.value2*100)+"%",g=t(e.value0),n=Iy(e.value3),u=e.value3===1;return u?"hsl("+(g+(", "+(a+(", "+(d+")"))))):"hsla("+(g+(", "+(a+(", "+(d+(", "+(n+")")))))))};var Lv=Ry(0)(0)(0);var Hy=$(Tt),Ny=Ko(pn),$x=ce(wt),qx=Ks(Nt)(yr);var Or=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Pr=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Ux=function(e){return e};var zx=function(e){return e},Ia=function(e){return e.value};var yu={append:function(e){return function(t){if(e instanceof Pr&&t instanceof Pr)return new Pr(e.value0+t.value0);if(e instanceof Pr&&t instanceof Or)return new Or(Hy(Ny(function(a){return e.value0+a}))(t.value0));if(e instanceof Or&&t instanceof Pr)return new Or(Hy(Ny(function(a){return t.value0+a}))(e.value0));if(e instanceof Or&&t instanceof Or)return new Or($x(e.value0)(t.value0));throw new Error("Failed pattern match at CSS.Property (line 23, column 1 - line 27, column 59): "+[e.constructor.name,t.constructor.name])}}},Vx=ce(yu),Av={append:function(e){return function(t){return Vx(e)(t)}}},ky=ce(Av);var Zc=function(e){if(e instanceof Or)return tr("")(qx("")(e.value0));if(e instanceof Pr)return e.value0;throw new Error("Failed pattern match at CSS.Property (line 32, column 1 - line 32, column 28): "+[e.constructor.name])};var El=function(){return{fromString:Pr.create}}(),Wy=ht(El),Hr={fromString:function(e){return Ux(Wy(e))}},Ml=ht(Hr);var es={value:function(e){return Ml(Py(e))}};var yi={value:function(){var e=Fe(Wn);return function(t){return Ml(e(t))}}()},yo={value:Ml},ts=function(e){var t=Ia(e);return function(a){var d=Ia(a);return{value:function(g){return ky(t(g.value0))(ky(Ml(" "))(d(g.value1)))}}}};var gr={fromString:function(e){return zx(Wy(e))}};var By=function(e){return e};var Fl=function(e){return e};var Gx=Ad(Nt);var $y=wt,rs=function(e){return si(Gx(e))};var qy=Ou;var jx=function(e){return function(t){return[new J(e,si(t))]}},bi=function(e){return Fl(jx(e))},Iv=jt();var Uy=bi("fontFamily");var zy=bi("cursorBlink");var Gy=$(Oe),eI=Lt(At),jy=pe(de),Ll=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Al=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),xl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Rv=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),tI={map:function(e){return function(t){if(t instanceof Ll)return new Ll(function(a){return e(t.value0(a))});if(t instanceof Al)return new Al(t.value0,e(t.value1));if(t instanceof xl)return new xl(function(a){return e(t.value0(a))});if(t instanceof Rv)return new Rv(t.value0,e(t.value1));throw new Error("Failed pattern match at Halogen.Terminal.Free.Options (line 43, column 1 - line 47, column 52): "+[e.constructor.name,t.constructor.name])}}},rI=ja(tI);var ns=function(e){return it(new Al(e,void 0))},Jy=function(e){var t=e.Monad0(),a=Yo(t.Bind1()),d=se(a),g=an(tu(t)),n=Ke(Za(e)),u=eI(a),f=Q(Tf(t.Applicative0()));return function(s){var i=function(p){if(p instanceof Ll)return d(g)(function(m){return n(Gy(p.value0)(Sv(m)))});if(p instanceof Al)return d(g)(function(m){return u(n(Tv(m)(p.value0)))(function(){return f(p.value1)})});if(p instanceof xl)return d(g)(function(m){return n(Gy(p.value0)(wv(m)))});if(p instanceof Rv)return d(g)(function(m){return u(n(Ev(m)(p.value0)))(function(){return f(p.value1)})});throw new Error("Failed pattern match at Halogen.Terminal.Free.Options (line 19, column 5 - line 21, column 49): "+[p.constructor.name])};return rI(ru(s))(i)}},Qy=function(){return it(new xl(jy))}(),Ky=function(){return it(new Ll(jy))}();var Zy=Es(Yy(),1),Rl=()=>new Zy.FitAddon;var tb=Es(eb(),1),Pl=()=>new tb.WebglAddon;var nb=Es(rb(),1),Nl=()=>new nb.WebLinksAddon;var ab={addon:V},ob={addon:V},ib={addon:pe(de)};var kl=function(e){return e.addon};var Nv=e=>e.active,kv=e=>e.normal,Wv=e=>e.alternate;var fb=Es(sb(),1),lb=e=>t=>()=>new fb.Terminal(e,t),_b=e=>()=>e.element,pb=e=>()=>e.textarea,$v=e=>()=>e.rows,qv=e=>()=>e.cols,as=e=>e.buffer,Uv=e=>()=>e.markers;var zv=e=>e.options,Vv=e=>t=>()=>e.onBell(t),Gv=e=>t=>()=>e.onBinary(a=>t(a)());var jv=e=>t=>()=>e.onData(a=>t(a)()),Jv=e=>t=>()=>e.onKey(a=>t(a)()),Qv=e=>t=>()=>e.onLineFeed(t),Kv=e=>t=>()=>e.onRender(a=>t(a)()),Xv=e=>t=>()=>e.onWriteParsed(t),Yv=e=>t=>()=>e.onResize(a=>t(a)()),Zv=e=>t=>()=>e.onScroll(a=>t(a)()),em=e=>t=>()=>e.onSelectionChange(t),tm=e=>t=>()=>e.onTitleChange(a=>t(a)());var rm=e=>t=>()=>e.open(t);var nm=e=>t=>a=>()=>e.write(t,a),am=e=>t=>a=>()=>e.writeln(t,a);var db=e=>t=>()=>e.loadAddon(t);var vb=$(Oe);var mb=function(){var e=vb(Cu);return function(t){return e(pb(t))}}();var hb=function(e){return function(t){return lb(rs(e))(rs(t))}},gb=function(e){var t=kl(e);return function(a){return function(d){return db(a)(t(d))}}};var Db=function(){var e=vb(Cu);return function(t){return e(_b(t))}}();var Bl=$(Ja),os=pe(de),Ra=$(Oe),im=Cy(Cf)(Us),Cb=Lt(At),$l=ac(jD),gI=gb(ib),ql=se($r),um=Cb($r),bu=Yr(nn),Ul=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),cm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),sm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),zl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Vl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Gl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),fm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),lm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),_m=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),jl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Jl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),pm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Ql=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Kl=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Xl=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),DI={map:function(e){return function(t){if(t instanceof Ul)return new Ul(Bl(e)(t.value0));if(t instanceof cm)return new cm(function(a){return e(t.value0(a))});if(t instanceof sm)return new sm(function(a){return e(t.value0(a))});if(t instanceof zl)return new zl(function(a){return e(t.value0(a))});if(t instanceof Vl)return new Vl(function(a){return e(t.value0(a))});if(t instanceof Gl)return new Gl(Bl(e)(t.value0));if(t instanceof fm)return new fm(Bl(e)(t.value0));if(t instanceof lm)return new lm(Bl(e)(t.value0));if(t instanceof _m)return new _m(function(a){return e(t.value0(a))});if(t instanceof jl)return new jl(t.value0,e(t.value1));if(t instanceof Jl)return new Jl(t.value0,e(t.value1));if(t instanceof pm)return new pm(function(a){return e(t.value0(a))});if(t instanceof Ql)return new Ql(function(a){return e(t.value0(a))});if(t instanceof Kl)return new Kl(function(a){return e(t.value0(a))});if(t instanceof Xl)return new Xl(t.value0,function(a){return e(t.value1(a))});throw new Error("Failed pattern match at Halogen.Terminal.Free (line 96, column 1 - line 111, column 48): "+[e.constructor.name,t.constructor.name])}}},CI=ja(DI),Su=function(e){return it(new Jl(e,void 0))},Ut=function(e){return it(new jl(e,void 0))};var dm=function(e){return it(new Gl(e))},yI=function(){return it(new Ql(os))}(),bI=function(){return it(new Kl(os))}();var yb=function(e){var t=e.MonadEffect0(),a=t.Monad0(),d=Yo(a.Bind1()),g=se(d),n=an(tu(a)),u=Za(t),f=Jy(u),s=Ke(u),i=Yn(I0(e)),p=Cb(d);return function(m){var h=ru(m),l=f(h),r=function(o){if(o instanceof Ul)return g(n)(function(c){return Ya(l(o.value0))(zv(c))});if(o instanceof cm)return g(n)(function(c){return s(Ra(o.value0)(Db(c)))});if(o instanceof sm)return g(n)(function(c){return s(Ra(o.value0)(mb(c)))});if(o instanceof zl)return g(n)(function(c){return s(Ra(o.value0)($v(c)))});if(o instanceof Vl)return g(n)(function(c){return s(Ra(o.value0)(qv(c)))});if(o instanceof Gl)return g(n)(function(c){return s(Ya(im(o.value0))(Nv(as(c))))});if(o instanceof fm)return g(n)(function(c){return s(Ya(im(o.value0))(kv(as(c))))});if(o instanceof lm)return g(n)(function(c){return s(Ya(im(o.value0))(Wv(as(c))))});if(o instanceof _m)return g(n)(function(c){return s(Ra(o.value0)(Uv(c)))});if(o instanceof jl)return g(n)(function(c){return g(i(mc))(function(_){return p(s(nm(c)(o.value0)(qp(vc(o.value1)(_)))))(function(){return i(Vp(_))})})});if(o instanceof Jl)return g(n)(function(c){return g(i(mc))(function(_){return p(s(am(c)(o.value0)(qp(vc(o.value1)(_)))))(function(){return i(Vp(_))})})});if(o instanceof pm)return s(Ra(function(c){return o.value0(ks(c))})($l(Rl)));if(o instanceof Ql)return s(Ra(function(c){return o.value0(ks(c))})($l(Nl)));if(o instanceof Kl)return s(Ra(function(c){return o.value0(ks(c))})($l(Pl)));if(o instanceof Xl)return g(n)(function(c){return s(Ra(function(_){return o.value1(jh(_))})($l(gI(c)(o.value0))))});throw new Error("Failed pattern match at Halogen.Terminal.Free (line 32, column 5 - line 34, column 55): "+[o.constructor.name])};return CI(h)(r)}},bb=function(){return it(new zl(os))}(),Ti=function(e){return it(Ul.create(e))};var Sb=function(e){var t=kl(e);return function(a){return it(new Xl(t(a),os))}},SI=Sb(ob),TI=Sb(ab),Tb=function(e){return ql(bI)(function(t){return um(function(){if(t instanceof q)return bu(e)(Su("WebGL Addon unavailable"));if(t instanceof k)return um(bu(e)(Ut("Loading WebGL ")))(function(){return ql(SI(t.value0))(function(a){return bu(e)(function(){return Su(a?"OK":"FAILED")}())})});throw new Error("Failed pattern match at Halogen.Terminal.Free (line 164, column 3 - line 169, column 67): "+[t.constructor.name])}())(function(){return ql(yI)(function(a){if(a instanceof q)return bu(e)(Su("WebLinks Addon unavailable"));if(a instanceof k)return um(bu(e)(Ut("Loading WebLinks ")))(function(){return ql(TI(a.value0))(function(d){return bu(e)(function(){return Su(d?"OK":"FAILED")}())})});throw new Error("Failed pattern match at Halogen.Terminal.Free (line 171, column 3 - line 176, column 67): "+[a.constructor.name])})})})};var wb=function(){return it(new Vl(os))}();var Eb=V;var Mb=Lt(At)(xa),MI=rc(Aa),FI=Q(Do),LI=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),AI=function(e){return function(t){return rv([uy(function(a){return LI.create(Eb(a))})])([Rc(t)])}},xI=function(e){return function(t){return Mb(MI(t.value0))(function(){return FI(new k(t.value1))})}},II=function(e){var t=Ke(di(e.MonadEffect0()));return function(a){return Mb(t(nv(a.value0)))(function(){return ho(cr(Ut(`click!\r
`)))})}},Fb=function(e){return mi({initialState:Xa(" "),render:AI(e),eval:vi({handleAction:II(e),handleQuery:xI(e),receive:ta.receive,initialize:ta.initialize,finalize:ta.finalize})})};var wi=function(){return window};function Lb(e){return e.readyState}var is=function(){function e(){}return e.value=new e,e}(),NI=function(){function e(){}return e.value=new e,e}(),kI=function(){function e(){}return e.value=new e,e}();var Ab=function(e){return e==="loading"?new k(is.value):e==="interactive"?new k(NI.value):e==="complete"?new k(kI.value):q.value};var BI=$(Oe);var Ib=V;var Rb=V;var Ob=function(e){return BI(function(){var t=tr(is.value);return function(a){return t(Ab(a))}}())(function(){return Lb(e)})};function Hb(e,t,a){var d=Object.prototype.toString.call(a);return d.indexOf("[object HTML")===0&&d.indexOf("Element]")===d.length-8?t(a):e}var Nb=V;var vm=function(e){return Hb(q.value,k.create,e)};function Tu(e){return function(){return e.document}}var Bb=V;var Ub=se(Mr),IR=Ke(Fr),hm=$t(Zr),RR=Ls(Zr),zb=Q(Kn),OR=$t(Wr),PR=Q(xt),HR=$(Oe),NR=Lt(At),kR=Ur(Af),WR=function(e){return Ub(IR(hm(RR(function(){var t=Z0(e);return function(a){return t(Ib(a))}}())(Tu))(wi)))(function(t){return zb(OR(vm)(t))})},Vb=xf(lr(ya)(Te(PR(void 0)))),BR=Ca(function(e){return function(){var a=hm(Ob)(hm(Tu)(wi))();if(a instanceof is){var d=HR(Bb)(wi)(),g=Ic(function(n){return e(new Je(void 0))})();return Id(ov)(g)(!1)(d)(),ti(Rd(ov)(g)(!1)(d))}return e(new Je(void 0))(),y0}}),Gb=NR(Mr)(BR)(function(){return Ub(WR("body"))(function(e){return Qe(kR(wn("Could not find body")))(zb)(e)})});var jb=function(){var e=function(t){return function(a){return new k(new Nf(t,a))}};return function(t){return MC(e(t))}}(),Jb=function(e){return FC(e)};var Qb=function(e){return Jb(e)("type")};var UR=ev();var Xb=function(){return function(e){var t=UR(e);return function(a){var d=t(a);return function(g){return function(n){return function(u){return function(f){return function(s){return EC(new Bc(d(g)(n)(u)(f)(function(i){return k.create(s(i))})))}}}}}}}};var XR=gt(go);var YR=lu();var gm=function(){return function(e){var t=YR(e);return function(a){var d=t(a);return function(g){return function(n){return function(u){return XR(d(g)(n)(u(void 0)))}}}}}};var bo=function(e){return function(){console.log(e)}},Zl=function(e){return function(){console.warn(e)}};var a2=ce(wt),Zb=Q(Pi),o2=Ee(Hn(yr)),Dr=he(Qt),i2=he(ka(Qt)),So=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Oa=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),To=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),wo=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Eo=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Mo=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Fo=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Lo=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Ao=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Pa=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),wu=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),eS=function(e){return e},t_=function(){function e(){}return e.value=new e,e}(),Dm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Cm=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),ym=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),tS=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),rS=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),us=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),je=function(e){return function(t){return new us(a2(e.value0)(t),e.value1)}},_t=function(){return new us([],t_.value)}(),nS=function(e){return eS(Zb(Pa.create(e)))};var u2={eq:function(e){return function(t){return e instanceof So&&t instanceof So||e instanceof Oa&&t instanceof Oa||e instanceof To&&t instanceof To?e.value0===t.value0:e instanceof wo&&t instanceof wo||e instanceof Eo&&t instanceof Eo||e instanceof Mo&&t instanceof Mo||e instanceof Fo&&t instanceof Fo||e instanceof Lo&&t instanceof Lo||e instanceof Ao&&t instanceof Ao?e.value0===t.value0&&e.value1===t.value1:e instanceof Pa&&t instanceof Pa?e.value0===t.value0:e instanceof wu&&t instanceof wu?e.value0===t.value0&&o2(e.value1)(t.value1):!1}}};var aS={compare:function(e){return function(t){if(e instanceof So&&t instanceof So)return Dr(e.value0)(t.value0);if(e instanceof So)return X.value;if(t instanceof So)return te.value;if(e instanceof Oa&&t instanceof Oa)return Dr(e.value0)(t.value0);if(e instanceof Oa)return X.value;if(t instanceof Oa)return te.value;if(e instanceof To&&t instanceof To)return Dr(e.value0)(t.value0);if(e instanceof To)return X.value;if(t instanceof To)return te.value;if(e instanceof wo&&t instanceof wo){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:Dr(e.value1)(t.value1)}if(e instanceof wo)return X.value;if(t instanceof wo)return te.value;if(e instanceof Eo&&t instanceof Eo){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:Dr(e.value1)(t.value1)}if(e instanceof Eo)return X.value;if(t instanceof Eo)return te.value;if(e instanceof Mo&&t instanceof Mo){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:Dr(e.value1)(t.value1)}if(e instanceof Mo)return X.value;if(t instanceof Mo)return te.value;if(e instanceof Fo&&t instanceof Fo){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:Dr(e.value1)(t.value1)}if(e instanceof Fo)return X.value;if(t instanceof Fo)return te.value;if(e instanceof Lo&&t instanceof Lo){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:Dr(e.value1)(t.value1)}if(e instanceof Lo)return X.value;if(t instanceof Lo)return te.value;if(e instanceof Ao&&t instanceof Ao){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:Dr(e.value1)(t.value1)}if(e instanceof Ao)return X.value;if(t instanceof Ao)return te.value;if(e instanceof Pa&&t instanceof Pa)return Dr(e.value0)(t.value0);if(e instanceof Pa)return X.value;if(t instanceof Pa)return te.value;if(e instanceof wu&&t instanceof wu){var a=Dr(e.value0)(t.value0);return a instanceof X?X.value:a instanceof te?te.value:i2(e.value1)(t.value1)}throw new Error("Failed pattern match at CSS.Selector (line 0, column 0 - line 0, column 0): "+[e.constructor.name,t.constructor.name])}},Eq0:function(){return u2}};var r_=function(e){return new us([],new Dm(e))},Yt=function(e){return function(t){return new us([],new ym(e,t))}},oS=function(e){return function(t){return new us([],new Cm(e,t))}};var tt=function(e){return eS(Zb(Oa.create(e)))};var c2=jt();var s2=function(e){return c2(Rp(e))};var iS=function(e){return qt(s2(e))};var l2=$(Op(qo));var _2=Xe(Ef(wt)(Ws)),p2=se(Pp(wt)(H_));var uS=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),cS=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),sS=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),fS=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Sm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),n_=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),Tm=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),lS=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),_S=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),pS=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),dS=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}();var d2=function(e){return e},a_=function(e){return iS(e)},vS=function(){var e=Sa(n0(Ou)($s));return function(t){return d2(e(ec(t)))}}(),ut=function(e){return function(t){return vS(new Tm(new Sm(e),a_(t)))}};var zt=function(e){var t=Ia(e);return function(a){return function(d){return vS(new n_(By(a),t(d)))}}},wm=function(e){var t=zt(e);return function(a){return t(a)}};var v2={map:function(e){return function(t){return l2(e)(t)}}};var m2={apply:function(e){return function(t){return _2(e)(t)}},Functor0:function(){return v2}},mS={bind:function(e){return function(t){return p2(e)(function(a){return function(d){return d}(t(a))})}},Apply0:function(){return m2}};var oa=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Kr=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Nr=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var gS=function(e){return e instanceof Nr?new k(e.value1):e instanceof Kr?new k(e.value0):q.value},DS=function(e){return e instanceof Nr?new k(e.value0):e instanceof oa?new k(e.value0):q.value};var CS=function(e){var t=ce(e);return function(a){var d=ce(a);return{append:function(g){return function(n){if(g instanceof oa&&n instanceof oa)return new oa(t(g.value0)(n.value0));if(g instanceof oa&&n instanceof Kr)return new Nr(g.value0,n.value0);if(g instanceof oa&&n instanceof Nr)return new Nr(t(g.value0)(n.value0),n.value1);if(g instanceof Kr&&n instanceof oa)return new Nr(n.value0,g.value0);if(g instanceof Kr&&n instanceof Kr)return new Kr(d(g.value0)(n.value0));if(g instanceof Kr&&n instanceof Nr)return new Nr(n.value0,d(g.value0)(n.value1));if(g instanceof Nr&&n instanceof oa)return new Nr(t(g.value0)(n.value0),g.value1);if(g instanceof Nr&&n instanceof Kr)return new Nr(g.value0,d(g.value1)(n.value0));if(g instanceof Nr&&n instanceof Nr)return new Nr(t(g.value0)(n.value0),d(g.value1)(n.value1));throw new Error("Failed pattern match at Data.These (line 23, column 1 - line 32, column 56): "+[g.constructor.name,n.constructor.name])}}}}};var E2=ce(As),M2=Ze(Ba),bS=Go(Nt),SS=bS(Ba),i_=qn(Nt)(Ba),ia=$(Tt),Mm=Xe(Ho),F2=ce(wt),TS=Mt(Nt),L2=TS(Ba),A2=hp(aS),u_=$(pt),x2=ht(Ey),wS=se(Wr),I2=Zs(lp(Nt)),ES=$(Qi(Tt));var R2=Ks(Nt)(yr),O2=se(ko),P2=af($c),H2=$n(ku(fn)),N2=qn(Ju(Nt))(Ba),k2=Fe(Wn),c_=function(e){return e},W2=function(e){return e},Fm=function(e){return function(t){return function(a){return t+(e+a)}}},B2={append:function(e){return function(t){return e+t}}},$2={append:function(e){return function(t){return e+t}}},MS=CS(B2)($2),FS=Gh(MS),o_=TS(FS),q2=bS(FS),cs=ce(P_(MS)),yS=function(e){var t=lr(function(a){return M2})(function(a){return SS([a.value0,": ",a.value1])});return i_("; ")(ia(t)(e))},U2=function(e){if(e instanceof So)return"#"+e.value0;if(e instanceof Oa)return"."+e.value0;if(e instanceof To)return"["+(e.value0+"]");if(e instanceof wo)return"["+(e.value0+("='"+(e.value1+"']")));if(e instanceof Eo)return"["+(e.value0+("^='"+(e.value1+"']")));if(e instanceof Mo)return"["+(e.value0+("$='"+(e.value1+"']")));if(e instanceof Fo)return"["+(e.value0+("*='"+(e.value1+"']")));if(e instanceof Lo)return"["+(e.value0+("~='"+(e.value1+"']")));if(e instanceof Ao)return"["+(e.value0+("|='"+(e.value1+"']")));if(e instanceof Pa)return":"+e.value0;if(e instanceof wu)return":"+(e.value0+("("+(i_(",")(e.value1)+")")));throw new Error("Failed pattern match at CSS.Render (line 178, column 1 - line 178, column 33): "+[e.constructor.name])},z2=function(e){return function(t){if(e.length===0&&t instanceof t_)return["*"];if(t instanceof t_)return[""];if(t instanceof Dm)return[t.value0];if(t instanceof Cm)return Mm(ia(Fm(" > "))(Ha(t.value0)))(Ha(t.value1));if(t instanceof ym)return Mm(ia(Fm(" "))(Ha(t.value0)))(Ha(t.value1));if(t instanceof tS)return Mm(ia(Fm(" + "))(Ha(t.value0)))(Ha(t.value1));if(t instanceof rS)return F2(Ha(t.value0))(Ha(t.value1));throw new Error("Failed pattern match at CSS.Render (line 143, column 1 - line 143, column 63): "+[e.constructor.name,t.constructor.name])}},Ha=function(e){return ia(function(t){return t+L2(U2)(A2(e.value0))})(z2(e.value0)(e.value1))},V2=function(){var e=i_(", ");return function(t){return e(Ha(t))}}(),Fi=function(e){return e.length===0?q.value:u_(function(t){return new Rr(t.head,t.tail)})(mp(e))};var Eu=function(e){if(e.value0 instanceof fS)return Qe(e.value0.value0)(function(t){return oS(Eu(t))(e.value0.value0)})(Fi(e.value1));if(e.value0 instanceof Sm)return Qe(e.value0.value0)(function(t){return Yt(Eu(t))(e.value0.value0)})(Fi(e.value1));if(e.value0 instanceof cS)return Qe(e.value0.value0)(function(t){return Yt(e.value0.value0)(Eu(t))})(Fi(e.value1));if(e.value0 instanceof sS)return Qe(r_("TODO"))(Eu)(Fi(tc(e.value0.value0)(Er(e.value0)(e.value1))));if(e.value0 instanceof uS)return Qe(je(_t)(e.value0.value0))(function(t){return je(Eu(t))(e.value0.value0)})(Fi(e.value1));throw new Error("Failed pattern match at CSS.Render (line 171, column 3 - line 176, column 102): "+[e.value0.constructor.name])},G2=function(e){return Zc(e)},j2=function(e){return k.create(Kr.create(c_(x2("@import url("+(e+`);
`)))))},J2=function(e){return e},Lm=function(e){return wS(e)(function(){var t=u_(J2);return function(a){return t(gS(a))}}())},Q2=function(e){return e},LS=function(e){return wS(e)(function(){var t=u_(Q2);return function(a){return t(DS(a))}}())},K2=function(e){return Qe(e.value0)(function(t){return"("+(e.value0+(": "+(Zc(t)+")")))})(e.value1)},X2=function(e){return"@media "+(G2(e.value1)+I2(E2)(ES(function(t){return function(a){return" and "+a}(K2(t))})(e.value2)))};var Y2=function(e){return function(t){if(e instanceof Pr&&t instanceof Pr)return[new Je(new J(e.value0,t.value0))];if(e instanceof Or&&t instanceof Pr)return ia(function(a){return new Je(new J(a.value0+a.value1,t.value0))})(e.value0);if(e instanceof Pr&&t instanceof Or)return ia(function(a){return new Je(new J(e.value0,a.value0+a.value1))})(t.value0);if(e instanceof Or&&t instanceof Or)return ia(function(a){return Qe(new Ye(a.value0+a.value1))(function(){var d=J.create(a.value0+a.value1);return function(g){return Je.create(d(function(n){return a.value0+n}(g)))}}())(R2(a.value0)(t.value0))})(e.value0);throw new Error("Failed pattern match at CSS.Render (line 158, column 1 - line 158, column 80): "+[e.constructor.name,t.constructor.name])}},AS=function(e){return Y2(e.value0)(e.value1)},Z2=function(e){return function(t){var a=O2(t)(AS),d=u_(function(n){return oa.create(W2(yS(P2(n))))})(Fi(a)),g=function(n){return k.create(Kr.create(c_(i_(" ")([V2(Eu(n)),"{",yS(a),`}
`]))))};return Qe(d)(g)(Fi(e))}},ss=function(e){return function(t){var a=function(o){return o instanceof lS?new k(new J(o.value0,o.value1)):q.value},d=o_(va(Ge(e5)(e)))(ga(a)(t)),g=function(o){return o instanceof n_?new k(new J(o.value0,o.value1)):q.value},n=function(){var o=ga(g)(t),c=H2(yD)(o);return c?Z2(e)(o):q.value}(),u=function(o){return ss(Er(o)(e))},f=function(o){return o instanceof Tm?new k(new J(o.value0,o.value1)):q.value},s=q2(ia(va(u))(ga(f)(t))),i=function(o){return o instanceof pS?new k(o.value0):q.value},p=o_(t5)(ga(i)(t)),m=function(o){return o instanceof dS?new k(o.value0):q.value},h=o_(j2)(ga(m)(t)),l=function(o){return o instanceof _S?new k(o.value0):q.value},r=o_(n5)(ga(l)(t));return cs(n)(cs(h)(cs(p)(cs(r)(cs(s)(d)))))}},e5=function(e){return function(t){return function(a){return k.create(Kr.create(c_(X2(e)+(" { "+(tr("")(Lm(ss(t)(a)))+` }
`)))))}}},t5=function(e){var t=" "+(e.value0+(" { "+(N2(" ")(ES(va(r5))(e.value1))+` }
`))),a=["@keyframes","@-webkit-keyframes","@-moz-keyframes","@-o-keyframes"],d=SS(ia(function(g){return g+t})(a));return new k(new Kr(d))},r5=function(e){return function(t){var a=tr("")(LS(ss([])(t)));return k2(e)+("% "+("{ "+(a+" }")))}},n5=function(e){return k.create(Kr.create(c_("@font-face { "+(tr("")(LS(ss([])(e)))+` }
`))))},xS=function(){var e=ss([]);return function(t){return e(a_(t))}}();var o5=Qb(Wd);var IS=function(e){var t=tr("")(Lm(xS(e)));return tv([o5("text/css")])([Rc(t)])};var fs=function(){return new Or([new J("-webkit-",""),new J("-moz-",""),new J("-ms-",""),new J("-o-",""),new J("","")])}();var OS=ce(Av),PS=Ia(yi),HS=ht(Hr),RS=Fe(Wn),u5=ce(yu);var s_=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),c5=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),s5=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),f5=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}(),l5=function(){function e(t,a){this.value0=t,this.value1=a}return e.create=function(t){return function(a){return new e(t,a)}},e}();var Li=function(e){if(e instanceof s_)return Zc(e.value0);if(e instanceof c5)return Zn(function(t){return Zn(function(a){return"("+(Li(t)+(" + "+(Li(a)+")")))})(e.value1)})(e.value0);if(e instanceof s5)return Zn(function(t){return Zn(function(a){return"("+(Li(t)+(" - "+(Li(a)+")")))})(e.value1)})(e.value0);if(e instanceof f5)return Zn(function(t){return"("+(RS(e.value0)+(" * "+(Li(t)+")")))})(e.value1);if(e instanceof l5)return Zn(function(t){return"("+(Li(t)+(" / "+(RS(e.value0)+")")))})(e.value1);throw new Error("Failed pattern match at CSS.Size (line 29, column 1 - line 29, column 43): "+[e.constructor.name])},xo={value:function(e){return e instanceof s_?e.value0:u5(fs)(new Pr("calc"+Li(e)))}};var yt=function(e){return new s_(OS(PS(e))(HS("px")))};var Am=function(e){return new s_(OS(PS(e))(HS("em")))};var d5=ht(gr),v5=zt(es);var xm=v5(d5("background-color"));var lt=ht(Hr),kS=function(){function e(){}return e.value=new e,e}(),h5=function(){function e(){}return e.value=new e,e}(),WS=function(){function e(){}return e.value=new e,e}(),g5=function(){function e(){}return e.value=new e,e}(),D5=function(){function e(){}return e.value=new e,e}(),C5=function(){function e(){}return e.value=new e,e}(),BS=function(){function e(){}return e.value=new e,e}(),Im=function(){function e(){}return e.value=new e,e}(),y5=function(){function e(){}return e.value=new e,e}(),b5=function(){function e(){}return e.value=new e,e}(),S5=function(){function e(){}return e.value=new e,e}(),T5=function(){function e(){}return e.value=new e,e}(),w5=function(){function e(){}return e.value=new e,e}(),E5=function(){function e(){}return e.value=new e,e}(),M5=function(){function e(){}return e.value=new e,e}(),F5=function(){function e(){}return e.value=new e,e}(),L5=function(){function e(){}return e.value=new e,e}(),A5=function(){function e(){}return e.value=new e,e}(),x5=function(){function e(){}return e.value=new e,e}(),I5=function(){function e(){}return e.value=new e,e}(),R5=function(){function e(){}return e.value=new e,e}(),O5=function(){function e(){}return e.value=new e,e}(),P5=function(){function e(){}return e.value=new e,e}(),H5=function(){function e(){}return e.value=new e,e}(),N5=function(){function e(){}return e.value=new e,e}(),k5=function(){function e(){}return e.value=new e,e}(),W5=function(){function e(){}return e.value=new e,e}(),B5=function(){function e(){}return e.value=new e,e}(),$5=function(){function e(){}return e.value=new e,e}(),q5=function(){function e(){}return e.value=new e,e}(),U5=function(){function e(){}return e.value=new e,e}(),z5=function(){function e(){}return e.value=new e,e}(),V5=function(){function e(){}return e.value=new e,e}();var G5={value:function(e){if(e instanceof kS)return lt("default");if(e instanceof h5)return lt("help");if(e instanceof WS)return lt("pointer");if(e instanceof g5)return lt("progress");if(e instanceof D5)return lt("wait");if(e instanceof C5)return lt("cell");if(e instanceof BS)return lt("crosshair");if(e instanceof Im)return lt("text");if(e instanceof y5)return lt("vertical-text");if(e instanceof b5)return lt("alias");if(e instanceof S5)return lt("copy");if(e instanceof T5)return lt("move");if(e instanceof w5)return lt("no-drop");if(e instanceof E5)return lt("not-allowed");if(e instanceof M5)return lt("grab");if(e instanceof F5)return lt("grabbing");if(e instanceof L5)return lt("all-scroll");if(e instanceof A5)return lt("col-resize");if(e instanceof x5)return lt("row-resize");if(e instanceof I5)return lt("n-resize");if(e instanceof R5)return lt("e-resize");if(e instanceof O5)return lt("s-resize");if(e instanceof P5)return lt("w-resize");if(e instanceof H5)return lt("ne-resize");if(e instanceof N5)return lt("nw-resize");if(e instanceof k5)return lt("se-resize");if(e instanceof W5)return lt("sw-resize");if(e instanceof B5)return lt("ew-resize");if(e instanceof $5)return lt("ns-resize");if(e instanceof q5)return lt("nesw-resize");if(e instanceof U5)return lt("nwse-resize");if(e instanceof z5)return lt("zoom-in");if(e instanceof V5)return lt("zoom-out");throw new Error("Failed pattern match at CSS.Cursor (line 47, column 1 - line 80, column 40): "+[e.constructor.name])}};var Rm=function(){return WS.value}();var Om=function(){return kS.value}(),Ai=zt(G5)(ht(gr)("cursor")),$S=function(){return BS.value}();var f_=ht(gr),_s=ht(Hr);var Na=function(){var e=zt(yo)(f_("z-index")),t=Fe(Bo);return function(a){return e(t(a))}}();var J5={value:function(e){return e}};var Q5={value:function(e){return e}};var l_=_s("relative"),Xr=zt(J5)(f_("position")),qS=zt(yi)(f_("opacity"));var US=_s("inline-block");var zS=_s("none");var __=zt(Q5)(f_("display"));var VS=_s("block"),An=_s("absolute");var X5=ht(gr);var GS=zt(es)(X5("color"));var Fu=zt(xo),Io=ht(gr),jS=ts(xo)(xo),JS=zt(ts(jS)(jS)),Pm=Fu(Io("width")),Ro=Fu(Io("top")),p_=Fu(Io("right"));var QS=function(e){return function(t){return function(a){return function(d){return JS(Io("padding"))(new J(new J(e,t),new J(a,d)))}}}};var KS=function(e){return function(t){return function(a){return function(d){return JS(Io("margin"))(new J(new J(e,t),new J(a,d)))}}}};var xi=Fu(Io("left")),Hm=Fu(Io("height")),Nm=Fu(Io("bottom"));var XS=ht(Hr),YS=ht(gr);var eO={value:function(e){return e}},ZS=zt(eO),eT=XS("scroll"),tT=ZS(YS("overflow-y"));var km=ZS(YS("overflow")),Wm=XS("hidden");var Bm=ht(Hr),rO=ht(gr);var nO={value:function(e){return e}},rT=Bm("underline"),d_=zt(nO)(rO("text-decoration")),nT=Bm("overline");var aT=Bm("line-through");var oe=Lt(At)(mS),Zt=zt(yo),Jt=ht(gr),oO=wm(yo),iO=ce(yu),uO=ht(El),cO=zt(yi),oT=function(){var e=je(_t)(tt("xterm")),t=je(_t)(tt("xterm-viewport")),a=oe(ut(je(_t)(tt("xterm-underline-1")))(d_(rT)))(function(){return oe(ut(je(_t)(tt("xterm-underline-2")))(Zt(Jt("text-decoration"))("double underline")))(function(){return oe(ut(je(_t)(tt("xterm-underline-3")))(Zt(Jt("text-decoration"))("wavy underline")))(function(){return oe(ut(je(_t)(tt("xterm-underline-4")))(Zt(Jt("text-decoration"))("dotted underline")))(function(){return ut(je(_t)(tt("xterm-underline-5")))(Zt(Jt("text-decoration"))("dashed underline"))})})})}),d=je(_t)(tt("xterm-scroll-area")),g=je(_t)(tt("xterm-screen")),n=je(_t)(tt("xterm-decoration-overview-ruler")),u=oe(ut(je(_t)(tt("xterm-overline")))(d_(nT)))(function(){return oe(ut(je(je(_t)(tt("xterm-underline-1")))(tt("xterm-overline")))(Zt(Jt("text-decoration"))("overline underline")))(function(){return oe(ut(je(je(_t)(tt("xterm-underline-2")))(tt("xterm-overline")))(Zt(Jt("text-decoration"))("overline double underline")))(function(){return oe(ut(je(je(_t)(tt("xterm-underline-3")))(tt("xterm-overline")))(Zt(Jt("text-decoration"))("overline wavy underline")))(function(){return oe(ut(je(je(_t)(tt("xterm-underline-4")))(tt("xterm-overline")))(Zt(Jt("text-decoration"))("overline dotted underline")))(function(){return ut(je(je(_t)(tt("xterm-underline-5")))(tt("xterm-overline")))(Zt(Jt("text-decoration"))("overline dashed underline"))})})})})}),f=je(_t)(tt("xterm-message")),s=je(_t)(tt("live-region")),i=je(_t)(tt("xterm-helper-textarea")),p=je(_t)(tt("xterm-helpers")),m=je(_t)(tt("xterm-dim")),h=je(_t)(tt("xterm-decoration-top")),l=je(_t)(tt("xterm-decoration-container")),r=je(_t)(tt("xterm-decoration")),o=je(_t)(tt("composition-view")),c=je(_t)(tt("xterm-char-measure-element")),_=oe(Xr(An))(function(){return oe(xi(yt(0)))(function(){return oe(Ro(yt(0)))(function(){return oe(Nm(yt(0)))(function(){return oe(p_(yt(0)))(function(){return oe(Na(10))(function(){return oe(Zt(Jt("color"))("transparent"))(function(){return Zt(Jt("pointer-events"))("none")})})})})})})}),D=je(_t)(tt("xterm-accessibility"));return oe(ut(e)(oe(Ai(Im.value))(function(){return oe(Xr(l_))(function(){return oO(iO(fs)(uO("user-select")))("none")})})))(function(){return oe(ut(je(e)(tt("focus")))(Zt(Jt("outline"))("none")))(function(){return oe(ut(je(e)(nS("focus")))(Zt(Jt("outline"))("none")))(function(){return oe(ut(Yt(e)(p))(oe(Xr(An))(function(){return oe(Ro(yt(0)))(function(){return Na(5)})})))(function(){return oe(ut(Yt(e)(i))(oe(QS(yt(0))(yt(0))(yt(0))(yt(0)))(function(){return oe(cO(Jt("border"))(0))(function(){return oe(KS(yt(0))(yt(0))(yt(0))(yt(0)))(function(){return oe(Xr(An))(function(){return oe(qS(0))(function(){return oe(xi(Am(-9999)))(function(){return oe(Ro(yt(0)))(function(){return oe(Pm(yt(0)))(function(){return oe(Hm(yt(0)))(function(){return oe(Na(-5))(function(){return oe(Zt(Jt("whitespace"))("nowrap"))(function(){return oe(km(Wm))(function(){return Zt(Jt("resize"))("none")})})})})})})})})})})})})))(function(){return oe(ut(Yt(e)(o))(oe(xm(Lv))(function(){return oe(GS(Oy))(function(){return oe(__(zS))(function(){return oe(Xr(An))(function(){return oe(Zt(Jt("white-space"))("nowrap"))(function(){return Na(1)})})})})})))(function(){return oe(ut(Yt(e)(je(o)(tt("active"))))(__(VS)))(function(){return oe(ut(Yt(e)(t))(oe(xm(Lv))(function(){return oe(tT(eT))(function(){return oe(Ai(Om))(function(){return oe(Xr(An))(function(){return oe(p_(yt(0)))(function(){return oe(xi(yt(0)))(function(){return oe(Ro(yt(0)))(function(){return Nm(yt(0))})})})})})})})))(function(){return oe(ut(Yt(e)(g))(Xr(l_)))(function(){return oe(ut(Yt(e)(Yt(g)(r_("canvas"))))(oe(Xr(An))(function(){return oe(xi(yt(0)))(function(){return Ro(yt(0))})})))(function(){return oe(ut(Yt(e)(d))(Zt(Jt("visibility"))("hidden")))(function(){return oe(ut(c)(oe(__(US))(function(){return oe(Zt(Jt("visibility"))("hidden"))(function(){return oe(Xr(An))(function(){return oe(Ro(yt(0)))(function(){return oe(xi(Am(-9999)))(function(){return Zt(Jt("line-height"))("normal")})})})})})))(function(){return oe(ut(je(e)(tt("enable-mouse-events")))(Ai(Om)))(function(){return oe(ut(je(e)(tt("xterm-cursor-pointer")))(Ai(Rm)))(function(){return oe(ut(Yt(e)(je(_t)(tt("xterm-cursor-pointer"))))(Ai(Rm)))(function(){return oe(ut(je(je(e)(tt("column-select")))(tt("focus")))(Ai($S)))(function(){return oe(ut(Yt(e)(D))(_))(function(){return oe(ut(Yt(e)(f))(_))(function(){return oe(ut(Yt(e)(s))(oe(Xr(An))(function(){return oe(xi(yt(-9999)))(function(){return oe(Pm(yt(1)))(function(){return oe(Hm(yt(1)))(function(){return km(Wm)})})})})))(function(){return oe(ut(m)(Zt(Jt("opacity"))("1 !important")))(function(){return oe(a)(function(){return oe(u)(function(){return oe(ut(je(_t)(tt("xterm-strikethrough")))(d_(aT)))(function(){return oe(ut(Yt(Yt(g)(l))(r))(oe(Na(6))(function(){return Xr(An)})))(function(){return oe(ut(Yt(Yt(g)(l))(je(r)(tt("xterm-decoration-top-layer"))))(Na(7)))(function(){return oe(ut(n)(oe(Na(8))(function(){return oe(Xr(An))(function(){return oe(Ro(yt(0)))(function(){return oe(p_(yt(0)))(function(){return Zt(Jt("pointer-events"))("none")})})})})))(function(){return ut(h)(oe(Na(2))(function(){return Xr(l_)}))})})})})})})})})})})})})})})})})})})})})})})})})})})}();var iT=e=>()=>e.dispose();var uT={toDisposable:pe(de)},lO=function(e){return e.toDisposable},cT=function(e){return{dispose:function(){var t=lO(e);return function(a){return iT(t(a))}}()}},sT=function(e){return e.dispose};var ct=se(xa),$m=Jo(Aa),pO=$(ro),dO=yb(gc)(au),xn=Qa(Aa),In=Lt(At)(xa),vO=Et(xt)(Nt),mO=sT(cT(uT)),qm=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),hO=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),gO=function(){function e(){}return e.value=new e,e}(),DO=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),Um=function(){function e(){}return e.value=new e,e}(),CO=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),yO=function(){function e(){}return e.value=new e,e}(),bO=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),SO=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),TO=function(){function e(){}return e.value=new e,e}(),wO=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),fT=function(){function e(){}return e.value=new e,e}(),lT=function(){function e(){}return e.value=new e,e}(),vn=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),EO=function(e){return function(t){return Du([IS(oT),pl([jb("terminal")])([])])}},MO=function(e){var t=Yn(JC(e));return function(a){return ct($m)(function(d){return t(pO(k.create)(Ya(dO(a))(d.terminal)))})}},FO=function(e){var t=Ke(di(e.MonadEffect0())),a=function(l){return ct(t(jr))(function(r){return ct(t(Xv(l)(Gr(r.listener)(new vn(yO.value)))))(function(o){return ct(Jr(r.emitter))(function(){return xn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},d=function(l){return ct(t(jr))(function(r){return ct(t(tm(l)(function(){var o=Gr(r.listener);return function(c){return o(vn.create(wO.create(c)))}}())))(function(o){return ct(Jr(r.emitter))(function(){return xn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},g=function(l){return ct(t(jr))(function(r){return ct(t(em(l)(Gr(r.listener)(new vn(TO.value)))))(function(o){return ct(Jr(r.emitter))(function(){return xn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},n=function(l){return ct(t(jr))(function(r){return ct(t(Zv(l)(function(){var o=Gr(r.listener);return function(c){return o(vn.create(SO.create(c)))}}())))(function(o){return ct(Jr(r.emitter))(function(){return xn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},u=function(l){return ct(t(jr))(function(r){return ct(t(Yv(l)(function(){var o=Gr(r.listener);return function(c){return o(vn.create(bO.create(c)))}}())))(function(o){return ct(Jr(r.emitter))(function(){return xn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},f=function(l){return ct(t(jr))(function(r){return ct(t(Kv(l)(function(){var o=Gr(r.listener);return function(c){return o(vn.create(CO.create(c)))}}())))(function(o){return ct(Jr(r.emitter))(function(){return xn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},s=function(l){return ct(t(jr))(function(r){return ct(t(Qv(l)(Gr(r.listener)(new vn(Um.value)))))(function(o){return ct(Jr(r.emitter))(function(){return xn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},i=function(l){return ct(t(jr))(function(r){return ct(t(Jv(l)(function(){var o=Gr(r.listener);return function(c){return o(vn.create(DO.create(c)))}}())))(function(o){return ct(Jr(r.emitter))(function(){return xn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},p=function(l){return ct(t(jr))(function(r){return ct(t(jv(l)(function(){var o=Gr(r.listener);return function(c){return o(vn.create(qm.create(c)))}}())))(function(o){return ct(Jr(r.emitter))(function(){return xn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},m=function(l){return ct(t(jr))(function(r){return ct(t(Gv(l)(function(){var o=Gr(r.listener);return function(c){return o(vn.create(hO.create(c)))}}())))(function(o){return ct(Jr(r.emitter))(function(){return xn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})},h=function(l){return ct(t(jr))(function(r){return ct(t(Vv(l)(Gr(r.listener)(new vn(gO.value)))))(function(o){return ct(Jr(r.emitter))(function(){return xn(function(c){var _={};for(var D in c)({}).hasOwnProperty.call(c,D)&&(_[D]=c[D]);return _.disposables=Er(o)(c.disposables),_})})})})};return function(l){if(l instanceof fT)return ct(Wc("terminal"))(function(r){if(r instanceof q)return t(bo("no terminal element"));if(r instanceof k)return ct($m)(function(o){return In(t(rm(o.terminal)(r.value0)))(function(){return In(h(o.terminal))(function(){return In(m(o.terminal))(function(){return In(i(o.terminal))(function(){return In(s(o.terminal))(function(){return In(f(o.terminal))(function(){return In(a(o.terminal))(function(){return In(u(o.terminal))(function(){return In(n(o.terminal))(function(){return In(g(o.terminal))(function(){return In(d(o.terminal))(function(){return p(o.terminal)})})})})})})})})})})})});throw new Error("Failed pattern match at Halogen.Terminal (line 73, column 5 - line 88, column 28): "+[r.constructor.name])});if(l instanceof lT)return ct($m)(function(r){return t(vO(mO)(r.disposables))});if(l instanceof vn)return ho(l.value0);throw new Error("Failed pattern match at Halogen.Terminal (line 70, column 16 - line 92, column 23): "+[l.constructor.name])}},_T=function(e){return mi({initialState:function(t){return{terminal:t,disposables:[]}},render:EO(e),eval:vi({handleAction:FO(e),handleQuery:MO(e),receive:ta.receive,initialize:new k(fT.value),finalize:new k(lT.value)})})};var LO=ce(wt),dT=Xb(),vT={reflectSymbol:function(){return"terminal"}},AO=dT(vT)(Bi),xO=$(Tt),mT={reflectSymbol:function(){return"process"}},IO=dT(mT)(Xc),RO=B0(Ji),hT=Lp(pi),zm=se(hT),v_=mt(yf)(pi),OO=lu()(vT)(Bi),gT=Q(Do),PO=$(go),HO=mt(jC),m_=Jo(Aa),Ii=Q(Ap(pi)),DT=Lt(At),ps=DT(hT),CT=YD(Aa),Vm=Qa(CT),NO=Xi(CT),kO=wa(Xc),WO=kr(iv),BO=gn(iv),$O=Cc(Xc),qO=gm()(mT)(Xc),UO=XD(Jd),ds=se(xa),zO=ce($y),VO=Ze(qy),GO=DT(xa),jO=Qa(Aa),Gm=gt(go),JO=$(pt),QO=Q(Ci);var yT=function(){function e(){}return e.value=new e,e}(),bT=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),ST=function(){function e(t){this.value0=t}return e.create=function(t){return new e(t)},e}(),TT=function(){return ar.value}(),wT=function(){return ar.value}(),KO=function(e){var t=_T(e);return function(a){return Du(LO([function(){if(a.terminal instanceof q)return Du([]);if(a.terminal instanceof k)return AO(TT)(void 0)(t)(a.terminal.value0)(bT.create);throw new Error("Failed pattern match at Halogen.Shell (line 69, column 8 - line 71, column 80): "+[a.terminal.constructor.name])}()])(xO(function(d){return IO(wT)(d.value0)(d.value1.value0)(d.value1.value1)(ST.create)})(RO(a.processes))))}},ET=function(e){var t=e.MonadEffect0().Monad0(),a=HO(t),d=ja(_y(t.Bind1().Apply0().Functor0()))(UO);return function(g){var n=function(u){if(u instanceof Uc)return zm(v_(OO(TT)(void 0)(u.value0)))(function(s){return gT(s)});if(u instanceof zc)return PO(k.create)(a(u.value0));if(u instanceof Vc)return zm(v_(m_))(function(s){return Ii(u.value0(s.shell.shell))});if(u instanceof Gc)return ps(Vm(function(s){var i={};for(var p in s)({}).hasOwnProperty.call(s,p)&&(i[p]=s[p]);return i.shell=function(){var m={};for(var h in s.shell)({}).hasOwnProperty.call(s.shell,h)&&(m[h]=s.shell[h]);return m.shell=u.value0,m}(),i}))(function(){return Ii(u.value1)});if(u instanceof jc)return ps(Vm(function(s){var i={};for(var p in s)({}).hasOwnProperty.call(s,p)&&(i[p]=s[p]);return i.interpreter=u.value0,i}))(function(){return Ii(u.value1)});if(u instanceof ml)return ps(v_(ho(u.value0)))(function(){return Ii(u.value1)});if(u instanceof Jc){var f=function(s){return Qe(0)(function(i){return i.key})(q0(s))};return zm(NO(function(s){var i={};for(var p in s)({}).hasOwnProperty.call(s,p)&&(i[p]=s[p]);return i.processes=kO(WO(BO)(f(s.processes)))(new J(u.value0,u.value1))(s.processes),i}))(function(s){return Ii(u.value2(f(s.processes)))})}if(u instanceof Qc)return ps(Vm(function(s){var i={};for(var p in s)({}).hasOwnProperty.call(s,p)&&(i[p]=s[p]);return i.processes=$O(u.value0)(s.processes),i}))(function(){return Ii(u.value1)});if(u instanceof Kc)return ps(v_(qO(wT)(u.value0)(sy.create(u.value1))))(function(){return Ii(u.value2)});throw new Error("Failed pattern match at Halogen.Shell (line 111, column 5 - line 113, column 22): "+[u.constructor.name])};return QD(d(n)(g))}},XO=function(e){var t=Ke(di(e.MonadEffect0())),a=ET(e);return function(d){if(d instanceof yT)return ds(t(hb(zO(Iv(Uy)('"Cascadia Code", Menlo, monospace'))(Iv(zy)(!0)))(VO)))(function(g){return GO(jO(function(n){var u={};for(var f in n)({}).hasOwnProperty.call(n,f)&&(u[f]=n[f]);return u.terminal=new k(g),u}))(function(){return ds(m_)(function(n){return Gm(a(n.shell.init))})})});if(d instanceof bT)return ds(m_)(function(g){return Gm(a(g.interpreter(d.value0)))});if(d instanceof ST)return Gm(a(d.value0));throw new Error("Failed pattern match at Halogen.Shell (line 80, column 16 - line 91, column 51): "+[d.constructor.name])}},YO=function(e){var t=ET(e);return function(a){return ds(m_)(function(d){return ds(t(d.shell.query(a.value0)))(function(g){return gT(JO(a.value1)(g))})})}},MT=function(e){return mi({initialState:function(t){return{shell:t,interpreter:Te(QO(void 0)),terminal:q.value,processes:Mn}},render:KO(e),eval:vi({handleAction:XO(e),handleQuery:YO(e),receive:ta.receive,initialize:new k(yT.value),finalize:ta.finalize})})};var FT=Q(Ci),g_=se(Di),LT=Lt(At),vs=LT(Di),ms=LT($r),AT=Yr(nn),h_=se($r),tP=wr(op)(nn),rP=Et(nn)(Kt);var jm=function(e){var t=Ke(uv(e));return function(a){return function(d){return d instanceof qm?a(d.value0):d instanceof Um?t(bo("line feed")):FT(void 0)}}},hs=function(e){return e.prompt},gs=function(e){return e.cmd},xT=function(e){return function(t){var a=gs(t),d=a(pn),g=a(Da),n=hs(t)(Da);return function(u){return g_(na)(function(f){return vs(Fn(Xo(d)("")))(function(){return g_(u(qr(f)(g)))(function(s){return cr(ms(AT(!hf(jn(qr(f)(g))))(Ut(`\r
`+s)))(function(){return Ut(`\r
`+qr(f)(n))}))})})})}}},nP=function(e){return function(t){var a=gs(t),d=a(Da),g=hs(t)(Da),n=a(pn);return g_(na)(function(u){return vs(cr(h_(dm(Sy))(function(f){var s=f===0;return s?ms(Ut("\x1BM"))(function(){return h_(dm(h_(Ty)(function(i){return h_(by(i-1|0))(function(p){return tP(yy)(p)})})))(function(i){return ms(Ut("\x9BK"))(function(){return Ge(rP)(i)(function(p){var m=(Tl(qr(u)(d))-1|0)<=p;return m?ms(Ut(qr(u)(g)))(function(){return Ut(Zf(1)(qr(u)(d)))}):Ut(Zf(1)(pC(p)(qr(u)(d))))})})})}):AT(Tl(qr(u)(d))>0)(Ut("\b \b"))})))(function(){return Fn(mf(n)(Zf(1)))})})}},Jm=function(e){var t=nP(e),a=Ke(uv(e));return function(d){var g=gs(d)(pn),n=hs(d)(Da),u=t(d);return function(f){return function(s){return s===""?vs(Fn(Xo(g)("")))(function(){return g_(na)(function(i){return cr(ms(Ut("^C"))(function(){return Ut(`\r
`+qr(i)(n))}))})}):s==="\r"?f:s==="\x7F"?u:s>=" "&&s<="~"||s>="\xA0"?vs(Fn(mf(g)(function(i){return i+s})))(function(){return cr(Ut(s))}):vs(a(bo("non-printable: "+s)))(function(){return FT(void 0)})}}}};var D_={suspend:l0,fork:_0,join:pc,Monad0:function(){return ei},Functor1:function(){return g0}};var C_=function(e){return e.fork};var RT=V,Rn=V,OT=function(e){var t=Et(e)(Kt);return function(a){return Rn(function(d){return t(a)(d.rendering)})}},oP=V,PT=function(e){return function(t){return Rn(function(a){return oP(t(a.rendering))})}},iP=V,y_=function(e){return function(t){return e(t)}},HT=function(e){return function(t){return function(a){return function(d){return function(){var n=It({})(),u=It(iu)(),f=It(iu)(),s=It(a)(),i=It(new k(He.value))(),p=It(new k(He.value))(),m=It(q.value)(),h=It(1)(),l=It(new k(Mn))(),r=It(Mn)(),o={component:e,state:e.initialState(t),refs:Mn,children:iu,childrenIn:u,childrenOut:f,selfRef:n,handlerRef:s,pendingQueries:i,pendingOuts:p,pendingHandlers:m,rendering:q.value,fresh:h,subscriptions:l,forks:r,lifecycleHandlers:d};return vt(o)(n)(),iP(n)}}}}};var uP=Et(xt)(Kt),cP=$t(Wr),sP=ni(jd),Vt=se(Mr),bt=Ke(Fr),fP=Lt(At),On=fP(Mr),qT=Et(Kn),lP=qT(Sn),UT=C_(D_),_P=lc(ri)(Sn),ua=Q(Kn),pP=$(Qp),NT=eo(ri),dP=$(ro),kT=nu(ri),vP=$(pt),mP=wa(jd),hP=HC(Up),gP=Cc(sl),DP=hh(Bn),CP=wa(sl),WT=qT(Kt),BT=ni(sl),yP=ni(Qt),bP=rD(au),SP=U0(Qt),TP=function(e){return function(t){return function(){var d=Pe(t)(),g=Pe(d.subscriptions)();return uP(rl)(cP(sP(e))(g))()}}},b_=function(e){return function(t){return Vt(bt(Pe(e)))(function(a){if(a instanceof q)return t;if(a instanceof k)return bt(vt(new k(new _e(t,a.value0)))(e));throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 188, column 33 - line 190, column 57): "+[a.constructor.name])})}},S_=function(e){return function(t){return On(bt(vt({initializers:He.value,finalizers:He.value})(e)))(function(){return Vt(bt(t))(function(a){return Vt(bt(Pe(e)))(function(d){return On(lP(UT)(d.finalizers))(function(){return On(_P(d.initializers))(function(){return ua(a)})})})})})}},Ri=xf(lr(ya)(Te(Q(xt)(void 0)))),$T=function(e){return function(t){return Vt(bt(Pe(t)))(function(a){return bt(W_(function(d){return{state:d+1|0,value:e(d)}})(a.fresh))})}},Km=function(e){return function(t){return function(a){return Vt(bt(Pe(t)))(function(d){return Oo(e)(t)(d.component.eval(new hu(pP(k.create)(N0(a)),Te(q.value))))})}}},Oo=function(e){return function(t){return function(a){var d=function(n){return function(u){return Vt(bt(Pe(n)))(function(f){return $C(function(s){var i=function(p){return NT(Vt(bt(Pe(p)))(function(m){return Rn(function(h){return Km(e)(h.selfRef)(s.value1)})(m)}))};return dP(s.value2)(kT(s.value0(Up)(i)(f.children)))})(u)})}},g=function(n){return function(u){if(u instanceof Oc)return Vt(bt(Pe(n)))(function(f){var s=u.value0(f.state);if(su(f.state)(s.value1))return ua(s.value0);if(nr)return On(bt(vt({component:f.component,state:s.value1,refs:f.refs,children:f.children,childrenIn:f.childrenIn,childrenOut:f.childrenOut,selfRef:f.selfRef,handlerRef:f.handlerRef,pendingQueries:f.pendingQueries,pendingOuts:f.pendingOuts,pendingHandlers:f.pendingHandlers,rendering:f.rendering,fresh:f.fresh,subscriptions:f.subscriptions,forks:f.forks,lifecycleHandlers:f.lifecycleHandlers})(n)))(function(){return On(S_(f.lifecycleHandlers)(e(f.lifecycleHandlers)(n)))(function(){return ua(s.value0)})});throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 86, column 7 - line 92, column 21): "+[s.constructor.name])});if(u instanceof Pc)return Vt($T(VC)(n))(function(f){return Vt(bt(zC(u.value0(f))(function(s){return Ri(Xm(e)(n)(new ai(s)))})))(function(s){return Vt(bt(Pe(n)))(function(i){return On(bt(en(vP(mP(f)(s)))(i.subscriptions)))(function(){return ua(u.value1(f))})})})});if(u instanceof al)return On(bt(TP(u.value0)(n)))(function(){return ua(u.value1)});if(u instanceof _i)return u.value0;if(u instanceof Hc)return d(n)(u.value0);if(u instanceof Nc)return Vt(bt(Pe(n)))(function(f){return Vt(bt(Pe(f.handlerRef)))(function(s){return On(b_(f.pendingOuts)(s(u.value0)))(function(){return ua(u.value1)})})});if(u instanceof ol)return kT(hP(Ud(function(){var f=Oo(e)(n);return function(s){return NT(f(s))}}())(u.value0)));if(u instanceof il)return Vt($T(GC)(n))(function(f){return Vt(bt(Pe(n)))(function(s){return Vt(bt(It(!1)))(function(i){return Vt(UT(h0(bt(function(){return en(gP(f))(s.forks)(),vt(!0)(i)()}))(Oo(e)(n)(u.value0))))(function(p){return On(bt(DP(Pe(i))(en(CP(f)(p))(s.forks))))(function(){return ua(u.value1(f))})})})})});if(u instanceof ul)return Vt(bt(Pe(n)))(function(f){return Vt(bt(Pe(f.forks)))(function(s){return On(WT(pc)(BT(u.value0)(s)))(function(){return ua(u.value1)})})});if(u instanceof cl)return Vt(bt(Pe(n)))(function(f){return Vt(bt(Pe(f.forks)))(function(s){return On(WT(dc(wn("Cancelled")))(BT(u.value0)(s)))(function(){return ua(u.value1)})})});if(u instanceof kc)return Vt(bt(Pe(n)))(function(f){return ua(u.value1(yP(u.value0)(f.refs)))});throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 83, column 12 - line 139, column 33): "+[u.constructor.name])}};return bP(g(t))(a)}}},Xm=function(e){return function(t){return function(a){if(a instanceof Nf)return bt(Ge(en)(t)(y_(function(d){return{component:d.component,state:d.state,refs:SP(Te(a.value1))(a.value0)(d.refs),children:d.children,childrenIn:d.childrenIn,childrenOut:d.childrenOut,selfRef:d.selfRef,handlerRef:d.handlerRef,pendingQueries:d.pendingQueries,pendingOuts:d.pendingOuts,pendingHandlers:d.pendingHandlers,rendering:d.rendering,fresh:d.fresh,subscriptions:d.subscriptions,forks:d.forks,lifecycleHandlers:d.lifecycleHandlers}})));if(a instanceof ai)return Vt(bt(Pe(t)))(function(d){return Oo(e)(t)(d.component.eval(new mu(a.value0,void 0)))});throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 52, column 20 - line 58, column 62): "+[a.constructor.name])}}};var EP=se(Zr),MP=Lt(At),KT=Qs(xt)(Kt),XT=Et(Kn)(Sn),YT=C_(D_),Cs=$t(Zr),ZT=Et(xt),ew=ZT(Kt),zT=ZT(ur),VT=MP(Mr),FP=lc(ri)(Sn),Ds=Ke(Fr),GT=Q(xt),Ym=$(Oe),Zm=Q(Kn),eh=Yr(xt),LP=PT(Oe),AP=gt(ro),jT=j0(xt),xP=OT(xt),IP=Sr(Us),RP=Oi(Oe),th=se(Mr),OP=Ke(Cf),JT=function(){return It({initializers:He.value,finalizers:He.value})}(),QT=function(e){return function(){var a=Pe(e)();return vt(q.value)(e)(),KT(a)(function(){var d=XT(YT);return function(g){return Ri(d(jo(g)))}}())()}},PP=function(e){return function(){return Cs(ew(zT(rl)))(Pe(e.subscriptions))(),vt(q.value)(e.subscriptions)(),Cs(zT(function(){var a=dc(wn("finalized"));return function(d){return Ri(a(d))}}()))(Pe(e.forks))(),vt(Mn)(e.forks)()}},tw=function(e){return function(t){return function(a){var d=function(p){return function(m){return Rn(function(h){var l=Oo(u)(h.selfRef)(h.component.eval(new pu(void 0)));return en(function(r){return{initializers:new _e(VT(FP(jo(r.initializers)))(function(){return VT(l)(function(){return Ds(function(){return QT(h.pendingQueries)(),QT(h.pendingOuts)()})})}),m),finalizers:r.finalizers}})(p)})}},g=function(p){return function(m){return function(h){return Zd(function(l){return function(){var o=JT(),c=HT(l)(h)(m)(o)(),_=Pe(p)();return vt({initializers:He.value,finalizers:_.finalizers})(p)(),Cs(Rn(function(){var D=u(p);return function(C){return D(function(b){return b.selfRef}(C))}}()))(Pe(c))(),Cs(d(p)(_.initializers))(Pe(c))(),c}})}}},n=function(p){return function(m){return function(h){return function(l){return Yd(function(r){return function(){var c=Ym(r.pop)(Pe(h))(),_=function(){if(c instanceof k){vt(c.value0.value1)(h)();var C=Pe(c.value0.value0)();return Rn(function(b){return function(){return Ge(vt)(b.handlerRef)(function(){var v=Qe(Zm(void 0))(m);return function(y){return v(r.output(y))}}())(),Ri(Oo(u)(b.selfRef)(b.component.eval(new vu(r.input,void 0))))()}})(C)(),c.value0.value0}if(c instanceof q)return g(p)(function(){var b=Qe(Zm(void 0))(m);return function(S){return b(r.output(S))}}())(r.input)(r.component)();throw new Error("Failed pattern match at Halogen.Aff.Driver (line 213, column 14 - line 222, column 98): "+[c.constructor.name])}(),D=Ym(function(C){return qi(r.get(C))})(Pe(l))();return eh(D)(Zl("Halogen: Duplicate slot address was detected during rendering, unexpected results may occur"))(),en(r.set(_))(l)(),EP(Pe(_))(LP(function(C){if(C instanceof q)return GD("Halogen internal error: child was not initialized in renderChild");if(C instanceof k)return GT(e.renderChild(C.value0));throw new Error("Failed pattern match at Halogen.Aff.Driver (line 227, column 37 - line 229, column 50): "+[C.constructor.name])}))()}})}}}},u=function(p){return function(m){return function(){var l=Pe(m)(),r=Ym(pa)(Pe(l.pendingHandlers))();eh(r)(vt(new k(He.value))(l.pendingHandlers))(),vt(iu)(l.childrenOut)(),vt(l.children)(l.childrenIn)();var o=function(){var b=b_(l.pendingHandlers),S=Xm(u)(l.selfRef);return function(v){return b(AP(S(v)))}}(),c=function(){var b=b_(l.pendingQueries);return function(S){return b(o(ai.create(S)))}}(),_=e.render(function(b){return Ri(o(b))})(n(p)(c)(l.childrenIn)(l.childrenOut))(l.component.render(l.state))(l.rendering)(),D=Pe(l.childrenOut)(),C=Pe(l.childrenIn)();return jT(C)(function(b){return function(){var v=Pe(b)();return xP(e.removeChild)(v)(),f(p)(v)()}})(),Ge(en)(l.selfRef)(y_(function(b){return{component:b.component,state:b.state,refs:b.refs,children:D,childrenIn:b.childrenIn,childrenOut:b.childrenOut,selfRef:b.selfRef,handlerRef:b.handlerRef,pendingQueries:b.pendingQueries,pendingOuts:b.pendingOuts,pendingHandlers:b.pendingHandlers,rendering:new k(_),fresh:b.fresh,subscriptions:b.subscriptions,forks:b.forks,lifecycleHandlers:b.lifecycleHandlers}}))(),eh(r)(Ge(IP)(void 0)(function(b){return function(){var v=Pe(l.pendingHandlers)();vt(new k(He.value))(l.pendingHandlers)(),ew(function(){var T=XT(YT);return function(w){return Ri(T(jo(w)))}}())(v)();var y=Pe(l.pendingHandlers)(),M=Qe(!1)($g)(y);return M?RP(vt(q.value)(l.pendingHandlers))(new Pt(void 0))():new Gt(void 0)}}))()}}},f=function(p){return Rn(function(m){return function(){PP(m)();var l=Oo(u)(m.selfRef)(m.component.eval(new du(void 0)));return en(function(r){return{initializers:r.initializers,finalizers:new _e(l,r.finalizers)}})(p)(),jT(m.children)(function(r){return function(){var c=Pe(r)();return f(p)(c)()}})()}})},s=function(p){return function(m){return function(h){return th(Ds(Pe(p)))(function(l){return l?Zm(q.value):Km(u)(m)(h)})}}},i=function(p){return function(m){return function(h){return S_(m)(function(){var r=Pe(p)();return r?void 0:(vt(!0)(p)(),f(m)(h)(),Rn(function(o){return function(){var _=OP(Pe(o.selfRef))();return KT(_.rendering)(e.dispose)()}})(h)())})}}};return th(Ds(JT))(function(p){return th(Ds(It(!1)))(function(m){return S_(p)(function(){var l=jr(),r=Cs(Pe)(g(p)(function(){var o=Gr(l.listener);return function(c){return Ds(o(c))}}())(a)(t))();return Rn(function(o){return GT({query:s(m)(o.selfRef),messages:l.emitter,dispose:i(m)(p)(r)})})(r)()})})})}}};var Pn=function(e){return function(t){return function(){return t[e]}}};var NP=Pn("baseURI"),kP=Pn("ownerDocument"),rw=Pn("parentNode"),WP=Pn("parentElement");var BP=Pn("childNodes"),$P=Pn("firstChild"),qP=Pn("lastChild"),UP=Pn("previousSibling"),nw=Pn("nextSibling"),zP=Pn("nodeValue");var VP=Pn("textContent");function rh(e){return function(t){return function(a){return function(){a.insertBefore(e,t)}}}}function T_(e){return function(t){return function(){t.appendChild(e)}}}function nh(e){return function(t){return function(){t.removeChild(e)}}}var aw=$(Oe);var ah=function(){var e=aw(Ft);return function(t){return e(rw(t))}}();var ow=function(){var e=aw(Ft);return function(t){return e(nw(t))}}();var oh=function(e,t,a){var d=0,g;return function(n){if(d===2)return g;if(d===1)throw new ReferenceError(e+" was needed before it finished initializing (module "+t+", line "+n+")",t,n);return d=1,g=a(),d=2,g}},ih=gt(Oe),KP=Q(xt),XP=Et(xt)(Kt),YP=jt(),ZP=Yr(xt),eH=$n(ku(ku(fn))),tH=pe(de),rH=se(Mr),nH=Ke(Fr),aH=$(Oe),oH=$t(Zr);var iH=function(e){return function(t){return function(a){return t instanceof k&&a instanceof k?ih(rh(e)(t.value0)(a.value0)):t instanceof q&&a instanceof k?ih(T_(e)(a.value0)):KP(void 0)}}},iw=function(e){return function(){var a=ah(e.node)();return XP(function(d){return nh(e.node)(d)})(a)()}},uH=function(e){return function(t){return function(a){var d=RT(function(f){return f.node}),g=function(f){return f instanceof k?Vr(f.value0):void 0},n=function(f){var s=KC(YP)(f),i=oh("patch","Halogen.VDom.Driver",function(){return function(o,c){if(o instanceof k){if(c instanceof Bc)return Vr(o.value0),m(100)(c.value0);if(c instanceof ll){var _=zr(o.value0,c.value0);return Bt(new Wt(hr(_),new k(_),i(103),g))}throw new Error("Failed pattern match at Halogen.VDom.Driver (line 97, column 22 - line 103, column 79): "+[c.constructor.name])}return p(104)(c)}}),p=oh("render","Halogen.VDom.Driver",function(){return function(o){if(o instanceof Bc)return m(86)(o.value0);if(o instanceof ll){var c=s(o.value0);return Bt(new Wt(hr(c),new k(c),i(89),g))}throw new Error("Failed pattern match at Halogen.VDom.Driver (line 84, column 7 - line 89, column 75): "+[o.constructor.name])}}),m=oh("renderComponentSlot","Halogen.VDom.Driver",function(){return function(o){var c=Pe(t)(),_=c(o)(),D=d(_);return Bt(new Wt(D,q.value,i(117),g))}}),h=i(91),l=p(82),r=m(109);return l},u=bC(e);return{buildWidget:n,buildAttributes:u,document:a}}}},cH=function(e){return function(t){var a=function(d){return function(g){return function(n){return function(u){if(u instanceof q)return function(){var s=It(g)(),i=uH(d)(s)(e),p=Ac(i)(n),m=hr(p);return ih(T_(m)(Nb(t)))(),{machine:p,node:m,renderChildRef:s}};if(u instanceof k)return function(){vt(g)(u.value0.renderChildRef)();var s=ah(u.value0.node)(),i=ow(u.value0.node)(),p=zr(u.value0.machine,n),m=hr(p);return ZP(eH(su)(u.value0.node)(m))(iH(m)(i)(s))(),{machine:p,node:m,renderChildRef:u.value0.renderChildRef}};throw new Error("Failed pattern match at Halogen.VDom.Driver (line 157, column 5 - line 173, column 80): "+[u.constructor.name])}}}};return{render:a,renderChild:tH,removeChild:iw,dispose:iw}}},uw=function(e){return function(t){return function(a){return rH(nH(aH(Rb)(oH(Tu)(wi))))(function(d){return tw(cH(d)(a))(e)(t)})}}};var uh=$(ly),cw=Fe(Bo),fH=Fe(Vh),sw=Lt(At),mn=sw(Di),ch=Q(Ci),ys=se(Di),fw=Et(Ci)(Kt),lH=Ee($o(yr)),w_=sw($r),sh=se(Mr),_H=jm(Fr),pH=MT(gc);var bs={cmd:function(e){return wp(function(t){return new J(t.command,function(a){return{prompt:t.prompt,command:a,foreground:t.foreground}})})(e)},prompt:function(e){return wp(function(t){return new J(t.prompt,function(a){return{prompt:a,command:t.command,foreground:t.foreground}})})(e)}},lw=gs(bs),_w=lw(Da),fh=lw(pn),dH=hs(bs)(Da),vH=Jm(Fr)(bs),mH=function(e){return jn(e)==="rows"?uh(cw)(cr(bb)):jn(e)==="cols"?uh(cw)(cr(wb)):jn(e)==="blink"?uh(fH)(cr(Ti(Ky))):jn(e)==="blinkon"?mn(cr(Ti(ns(!0))))(function(){return ch("")}):jn(e)==="blinkoff"?mn(cr(Ti(ns(!1))))(function(){return ch("")}):jn(e)==="fontFamily"?cr(Ti(Qy)):ch('unrecognised command "'+(e+`"\r
available commands [button,rows,cols,blink,blinkon,blinkoff,fontFamily`))},hH=function(e){return ys(na)(function(t){return mn(Ge(fw)(t.foreground)(function(a){return py(a)(qr(t)(_w))}))(function(){return mn(cr(Ut(`\r
`)))(function(){return Fn(Xo(fh)(""))})})})},pw=function(e){var t=Fb(e),a=xT(e.MonadEffect0())(bs);return function(d){return ys(na)(function(g){var n=Yu(function(u){return!hf(u)})(Ep(" ")(qr(g)(_w)));return lH(gp(n))(new k("button"))?mn(Fn(Xo(fh)("")))(function(){return ys(vy(t)(tc(1)(n)))(function(u){return mn(Fn(function(f){return{prompt:f.prompt,command:f.command,foreground:new k(u)}}))(function(){return mn(cr(w_(Ti(ns(!1)))(function(){return Ut(`\r
`)})))(function(){return hl(gH(e)(d))})})})}):a(mH)})}},gH=function(e){var t=e.MonadEffect0(),a=jm(t),d=Jm(t)(bs),g=hH(e);return function(n){return a(function(u){return u===""?ys(na)(function(f){return mn(Ge(fw)(f.foreground)(function(s){return dy(s)}))(function(){return mn(Fn(function(s){return{prompt:s.prompt,command:s.command,foreground:q.value}}))(function(){return mn(Fn(Xo(fh)("")))(function(){return ys(na)(function(s){return mn(cr(w_(Ti(ns(!0)))(function(){return w_(Ut("^C"))(function(){return Ut(`\r
`+qr(s)(dH))})})))(function(){return hl(a(d(pw(e)(n))))})})})})})}):d(g)(u)})}},DH=pw(gc)(au),dw=Vb(sh(Gb)(function(e){return sh(mc)(function(t){var a={init:mn(cr(w_(Tb(!0))(function(){return Ut("> ")})))(function(){return hl(_H(vH(DH)))}),query:function(d){return cr(Ut(d))},shell:{prompt:"> ",command:"",foreground:q.value}};return sh(uw(pH)(a)(e))(function(d){return vc(d.query)(t)})})}));dw();
</script>
  </body>
</html>
